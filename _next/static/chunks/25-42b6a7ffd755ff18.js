"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[25],{79418:function(e,t,n){function o(e){if(null!=e&&("string"!=typeof e||""!==e.trim()))return parseInt(e)}function i(e){if(null!=e&&("string"!=typeof e||""!==e.trim()))return r(e)}function r(e){return!0===e||!1===e?e:"number"==typeof e?e>0:("string"==typeof e&&(e=e.toLowerCase()),"true"===e||"false"===e)?"true"===e:"yes"===e||"no"===e?"yes"===e:"t"===e||"f"===e?"t"===e:("y"===e||"n"===e)&&"y"===e}n.d(t,{$Q:function(){return i},LC:function(){return o},gx:function(){return r},zW:function(){return function e(t){if(t instanceof Array)return t.map(function(t){return"object"==typeof t&&(t=e(t)),t});{let n={};for(let o in t)if(t.hasOwnProperty(o)){let i=(o.charAt(0).toLowerCase()+o.slice(1)||o).toString(),r=t[o];(r instanceof Array||null!==r&&r.constructor===Object)&&(r=e(r)),n[i]=r}return n}}}})},30089:function(e,t,n){n.d(t,{Cc:function(){return p},H7:function(){return b},av:function(){return g},f_:function(){return x},if:function(){return u},kh:function(){return h},ot:function(){return m},pC:function(){return y},tL:function(){return f},te:function(){return d},yg:function(){return v}});var o=n(6121),i=n(20920),r=n(15785),s=n(71359),a=n(45080),l=n(12569),c=n(24132);let d=(e,t)=>{if(void 0!==e){let o=(0,i.Z)();if(void 0!==e.key&&null!==e.key){var n;return{...e,key:"".concat(t,"-").concat(null!==(n=e.key)&&void 0!==n?n:"undefined","+").concat(o)}}}},u=e=>e?Object.fromEntries(e.split(";").map(e=>e.trim().split(":").map(e=>e.trim()))):{},p=e=>e?Object.fromEntries(e.split(";").map(e=>e.trim().split(":").map(e=>e.trim()))):{},h=e=>{if(null!=e&&0!==e.length)return(0,o.Q)(e,{columns:!1,skip_empty_lines:!0,trim:!0})[0]},f=e=>null==e?void 0:e.map((e,t)=>""===e?" ".repeat(t):e),x=e=>{let t=parseFloat(null!=e?e:"");return isNaN(t)?void 0:t},g=e=>{let t=null==e?void 0:e.toLowerCase(),n=s.Q[t];if(void 0===n)throw console.error("Unknown slider input type: ".concat(e)),"Unknown slider input type: ".concat(e);return n},m=e=>{let t=null==e?void 0:e.toLowerCase(),n=c.rT[t];if(void 0===n)throw console.error("Unknown graph input type: ".concat(e)),"Unknown graph input type: ".concat(e);return n},v=e=>{let t=null==e?void 0:e.toLowerCase(),n=l.J[t];if(void 0===n)throw console.error("Unknown graph orientation: ".concat(e)),"Unknown graph orientation: ".concat(e);return n},b=e=>{let t=null==e?void 0:e.toLowerCase(),n=a.L[t];if(void 0===n)throw console.error("Unknown text input type: ".concat(e)),"Unknown text input type: ".concat(e);return n},y=e=>{let t=null==e?void 0:e.toLowerCase(),n=r.S[t];if(void 0===n)throw console.error("Unknown slide activity: ".concat(e)),"Unknown slide activity: ".concat(e);return n}},8260:function(e,t,n){n.d(t,{S9:function(){return c},UJ:function(){return l},ZP:function(){return d},Zp:function(){return a}});var o=n(2265),i=n(11144);let r=(e,t)=>{let{sid:n,pid:o,qid:i}=e;return{id:void 0,created:void 0,questionId:i,participantId:o,jsonValue:void 0,mimeType:void 0,pII:t}},s=e=>{let t={};return e.forEach(e=>{var n;t[e.questionId]=[...null!==(n=t[e.questionId])&&void 0!==n?n:[],e]}),t},a=(e,t,n)=>{var o;return null!==(o=l(e,t))&&void 0!==o?o:r(t,null!=n&&n)},l=(e,t)=>null==e?void 0:e.find(e=>e.questionId===t.qid&&e.participantId===t.pid),c=e=>(null==e?void 0:e.jsonValue)!==void 0;function d(e){var t;let{session:n}=(0,o.useContext)(i.z),[r,a]=(0,o.useState)(null!==(t=n.answers)&&void 0!==t?t:[]),[l,c]=(0,o.useState)(s(n.answers));return(0,o.useEffect)(()=>{var t;a(void 0!==e?n.answers.filter(t=>t.questionId===e):[]),c(null!==(t=s(n.answers))&&void 0!==t?t:{})},[n.answers]),{answers:r,allAnswers:l}}},11144:function(e,t,n){n.d(t,{Z:function(){return h},z:function(){return p}});var o=n(57437),i=n(2265),r=n(79418),s=n(94547),a=n(83593),l=n(71432),c=n(5085),d=n(37570),u=n(1973);let p=(0,i.createContext)({});function h(e){let t=(0,i.useContext)(d.H),{sessionToken:n}=(0,i.useContext)(c.rZ),[h,f]=(0,i.useState)(t.session),[x,g]=(0,i.useState)(-1),[m,v]=(0,i.useState)(t.publicContent),{api:b,start:y}=(0,i.useContext)(u.E),w=(0,i.useContext)(c.rZ),j=async()=>{console.debug("Refresh session...");try{if(w.role===s._b.Controller){var e;if((null===(e=w.user)||void 0===e?void 0:e.access_token)===void 0)throw"User or access token is undefined";let o=await y(b.getDeliberationSessionAdmin(t.sid,n,w.user.access_token,"live-session-refresh"));(0,l.r)(o)&&f(o)}else{let e=await y(b.getDeliberationSession(t.sid,n,"live-session-refresh"));(0,l.r)(e)&&f(e)}}catch(e){console.error("Error fetching session data.",e)}},[k,S]=(0,i.useState)();(0,i.useEffect)(()=>(a.Z.on(a.M.WSS_Distribute_Message,S),a.Z.on(a.M.WSS_Update_ConnectionState,S),a.Z.on(a.M.WSS_Refresh_Session,S),()=>{a.Z.off(a.M.WSS_Distribute_Message,S),a.Z.off(a.M.WSS_Update_ConnectionState,S),a.Z.off(a.M.WSS_Refresh_Session,S)}),[]),(0,i.useEffect)(()=>{if(void 0!==k)switch(k.type){case a.M.WSS_Update_ConnectionState:C(k.data);break;case a.M.WSS_Distribute_Message:I(k.data);break;case a.M.WSS_Refresh_Session:j()}},[k]);let Z=(0,i.useRef)(!1),C=e=>{console.debug("Connection state changed: ".concat(s.um[e])),e===s.um.Joined&&(j(),Z.current=!0)},I=e=>{if("send"===e.action)switch(e.type){case"full-session-update":let t=(0,r.zW)(e.data.session);f(e=>{var n;return{...t,joinCode:null!==(n=t.joinCode)&&void 0!==n?n:e.joinCode}});break;case"simple-session-update":let n=(0,r.zW)(e.data.session);f(e=>{var t;return{...n,joinCode:null!==(t=n.joinCode)&&void 0!==t?t:e.joinCode,answers:e.answers,chimeMeetingData:e.chimeMeetingData,liveExperienceState:e.liveExperienceState,documentation:e.documentation}});break;case"live-state-update":let o=(0,r.zW)(e.data.liveState);o.sequence>h.liveExperienceState.sequence?f(e=>({...e,liveExperienceState:o})):console.warn("Ignoring stale live state update");break;case"meeting-update":let i=(0,r.zW)(e.data.meeting);f(e=>({...e,chimeMeetingData:i}));break;case"answer-summary-update":let s=e.data.questionId,a=(0,r.zW)(e.data.answers);f(e=>({...e,answers:[...h.answers.filter(e=>e.questionId!==s),...a]}))}};return(0,o.jsx)(p.Provider,{value:{session:h,publicContent:m},children:e.children})}},37471:function(e,t,n){n.d(t,{C:function(){return x},Z:function(){return h}});var o=n(57437),i=n(2265),r=n(70972),s=n(94547),a=n(83593),l=n(27785),c=n(71432),d=n(5085);let u={debug:!1,connectionTimeout:3e3,maxReconnectionDelay:1e4,minReconnectionDelay:100,reconnectionDelayGrowFactor:1.3,maxRetries:1/0},p=(e,t,n)=>({deviceId:e.deviceId,sessionId:n,sessionToken:e.sessionToken,role:e.role,deviceName:void 0,participantName:t.participantName}),h=(0,i.createContext)({}),f=[s.um.Online,s.um.Connecting,s.um.Connected,s.um.Joining];function x(e){var t;let n=null!==(t=e.endpoint)&&void 0!==t?t:"wss://8nx0u0zcla.execute-api.eu-west-1.amazonaws.com/test";if(!n)throw"No endpoint found for Zeitgeist WSS";let x=(0,i.useContext)(d.rZ),g=(0,i.useContext)(l.K),m=(0,i.useRef)(null),[v,b]=(0,i.useState)(s.um.Init),[y,w]=(0,i.useState)(!1),[j,k]=(0,i.useState)(!1),[S,Z]=(0,i.useState)(),[C,I]=(0,i.useState)();(0,i.useEffect)(()=>(a.Z.on(a.M.WSS_Request_Reconnect,I),a.Z.on(a.M.WSS_Request_Disconnect,I),()=>{a.Z.off(a.M.WSS_Request_Reconnect,I),a.Z.off(a.M.WSS_Request_Disconnect,I)}),[]),(0,i.useEffect)(()=>{if(void 0!==C)switch(C.type){case a.M.WSS_Request_Reconnect:b(s.um.Connecting);break;case a.M.WSS_Request_Disconnect:b(s.um.UserDisconnecting)}},[C]);let D=(0,i.useCallback)(e=>{try{return m.current.send(JSON.stringify(e)),!0}catch(e){return console.error("ZgResilientWssConnectionProvider",e),!1}},[m]),[E,P]=(0,i.useState)({state:v,isError:j,joinedOnce:y,sendMessage:D}),A=(0,i.useCallback)(()=>{if(!(0,c.r)(window)||!(0,c.r)(window.navigator))throw console.error("ZgResilientWssConnectionProvider: Window or navigator is undefined."),"Window undefined.";window.addEventListener("online",()=>{b(s.um.Online)}),window.addEventListener("offline",()=>{b(s.um.Offline)})},[]);(0,i.useEffect)(()=>{Z(p(x,g,e.sid))},[x.deviceId,e.sid,x.sessionToken,x.role,g.participantName]),(0,i.useEffect)(()=>{P({state:v,isError:j,joinedOnce:y,sendMessage:D})},[m,v,j,y,D]),(0,i.useEffect)(()=>{switch(console.debug("ZgResilientWssConnectionProvider: WSS state change",s.um[v]),a.Z.emit({type:a.M.WSS_Update_ConnectionState,data:v}),v){case s.um.Init:A(),console.debug("ZgResilientWssConnectionProvider: online = ".concat(window.navigator.onLine)),b(window.navigator.onLine?s.um.Online:s.um.Offline);break;case s.um.Offline:F(s.um.Offline);break;case s.um.Online:b(s.um.Connecting);break;case s.um.Connecting:B();break;case s.um.Connected:b(s.um.Joining);break;case s.um.Joining:q();break;case s.um.Joined:w(!0);break;case s.um.Error:R();break;case s.um.UserDisconnecting:F(s.um.Disconnected)}k(v===s.um.Error)},[v]);let R=()=>{setTimeout(()=>{(!(0,c.r)(m.current)||[r.Z.CLOSING,r.Z.CLOSED].includes(m.current.readyState))&&(console.debug("ZgResilientWssConnectionProvider: Recreating socket..."),B())},2e3)},B=()=>{F(s.um.Connecting),m.current=T()},T=()=>{let e=new r.Z(n,[],u);return e.onopen=e=>{console.debug("ZgResilientWssConnectionProvider: WSS opened",e),b(s.um.Connected)},e.onclose=e=>{console.warn("ZgResilientWssConnectionProvider: WSS closed unexpectedly",e),b(s.um.Disconnected)},e.onerror=e=>{console.error("ZgResilientWssConnectionProvider: WSS unexpected error",e),b(s.um.Error)},e.onmessage=async e=>{await M(e)},e},F=e=>{try{(0,c.r)(m.current)&&(m.current.onopen=null,m.current.onclose=null,m.current.onerror=null,m.current.onmessage=null,m.current.close())}catch(e){console.warn("ZgResilientWssConnectionProvider",e)}finally{m.current=null,b(e)}},q=()=>{var e,t;console.info("ZgResilientWssConnectionProvider: Joining session...");let n={action:"join",deviceId:S.deviceId,sessionId:S.sessionId,sessionToken:S.sessionToken,deviceName:null!==(e=S.deviceName)&&void 0!==e?e:null,participantName:null!==(t=S.participantName)&&void 0!==t?t:null,role:S.role};m.current.send(JSON.stringify(n))},M=e=>{if(null==e?void 0:e.data){let t=JSON.parse(e.data);if(t&&"send"===t.action)switch(t.type){case"remote-log":_(t);break;case"join-confirmation":N(t);break;default:a.Z.emit({type:a.M.WSS_Distribute_Message,data:t})}}},_=e=>{switch(e.data.severity){case"debug":console.debug("ZgResilientWssConnectionProvider: Remote debug log",e.data.message);break;case"info":console.info("ZgResilientWssConnectionProvider: Remote info log",e.data.message);break;case"warn":console.warn("ZgResilientWssConnectionProvider: Remote warn log",e.data.message);break;case"error":console.error("ZgResilientWssConnectionProvider: Remote error log",e.data.message);break;default:console.log("ZgResilientWssConnectionProvider: Remote log",e.data.message)}},N=e=>{console.info("ZgResilientWssConnectionProvider: Join confirmation"),b(s.um.Joined)};return(0,o.jsxs)(o.Fragment,{children:[j&&!y&&(0,o.jsx)("p",{children:e.error}),!j&&!y&&f.includes(v)&&e.load,y&&(0,o.jsx)(h.Provider,{value:E,children:e.children})]})}},67506:function(e,t,n){n.d(t,{G:function(){return u},Z:function(){return p}});var o,i,r=n(57437),s=n(80237),a=n(2265),l=n(83593),c=n(71432),d=n(1973);let u=(0,a.createContext)({});function p(e){var t;let{api:n,start:o}=(0,a.useContext)(d.E),[i,p]=(0,a.useState)(0),[h,f]=(0,a.useState)(),[x,g]=(0,a.useState)(null!==(t=e.checks)&&void 0!==t?t:3);(0,a.useEffect)(()=>{switch(i){case 0:l.Z.emit({type:l.M.Content_Progress_Update,data:{overall:{completed:0,total:x},bars:{}}}),p(1);break;case 1:m().then(e=>{f(e),p(3)}).catch(e=>{console.error(e),p(2)})}},[i]);let m=async()=>{switch(e.mode){case"server-date-lib":return b();case"zg-server-time":return v();default:throw Error("Unsupported time sync mode")}},v=async()=>{let e;await o(n.getServerTime());let t=Number.MAX_SAFE_INTEGER,i=0;for(let r=0;r<x;r++){let s=Date.now(),a=await o(n.getServerTime());if(!(0,c.r)(a))continue;let d=Date.now(),u=d-s,p=(s+d)/2,h=a.timestamp-p;u<t&&(t=u,i=h,e=a),l.Z.emit({type:l.M.Content_Progress_Update,data:{overall:{completed:r+1,total:x},bars:{}}}),await new Promise(e=>setTimeout(e,1e3))}return{offset:i,rtt:t,source:e,toServerTime:e=>Math.round(e+i),fromServerTime:e=>Math.round(e-i)}},b=async()=>{let e;console.warn("ServerDateLib is only accurate to the second.");for(let t=0;t<x;t++){await new Promise(e=>setTimeout(e,1e3));let n=await (0,s.a)();(void 0===e||Math.abs(n.uncertainty)<Math.abs(e.uncertainty))&&(e=n),l.Z.emit({type:l.M.Content_Progress_Update,data:{overall:{completed:t+1,total:x},bars:{}}})}return{offset:e.offset,source:e,rtt:e.uncertainty,toServerTime:t=>t+e.offset,fromServerTime:t=>t-e.offset}};return(0,r.jsxs)(r.Fragment,{children:[(0===i||1===i)&&e.load,2===i&&e.error,3===i&&(0,r.jsx)(u.Provider,{value:h,children:e.children})]})}(o=i||(i={}))[o.Init=0]="Init",o[o.Synchronising=1]="Synchronising",o[o.Error=2]="Error",o[o.Complete=3]="Complete"},53622:function(e,t,n){n.d(t,{Z:function(){return a},p:function(){return s}});var o=n(57437),i=n(2265),r=n(79418);let s=(0,i.createContext)({});function a(e){var t;let[n,a]=(0,i.useState)({language:null!==(t=e.searchParams.get("lang"))&&void 0!==t?t:void 0,voiceFocus:(0,r.$Q)(e.searchParams.get("vf")),backgroundBlur:(0,r.$Q)(e.searchParams.get("bb")),storage:e.searchParams.get("storage")});return(0,o.jsx)(s.Provider,{value:n,children:e.children})}},70883:function(e,t,n){n.d(t,{Z:function(){return d},l:function(){return c}});var o=n(57437),i=n(2265),r=n(83593),s=n(11144),a=n(37471),l=n(5085);let c=(0,i.createContext)({});function d(e){let t=(0,i.useContext)(l.rZ),{session:n}=(0,i.useContext)(s.z),[d,u]=(0,i.useState)([]),[p,h]=(0,i.useState)(d.find(e=>e.deviceId===t.deviceId)),[f,x]=(0,i.useState)([]),g=(0,i.useContext)(a.Z);(0,i.useEffect)(()=>{g.sendMessage({action:"request",type:"subscription-update",sessionId:e.sid})},[]);let[m,v]=(0,i.useState)();(0,i.useEffect)(()=>(r.Z.on(r.M.WSS_Distribute_Message,v),()=>{r.Z.off(r.M.WSS_Distribute_Message,v)}),[]),(0,i.useEffect)(()=>{void 0!==m&&m.type===r.M.WSS_Distribute_Message&&b(m.data)},[m]);let b=e=>{if("send"===e.action&&"subscription-update"===e.type){var t;u(null!==(t=e.data.subscriptions)&&void 0!==t?t:[])}};return(0,i.useEffect)(()=>{h(d.find(e=>e.deviceId===t.deviceId))},[d,t]),(0,i.useEffect)(()=>{var e;x(null!==(e=n.deviceIdBanList)&&void 0!==e?e:[])},[n.deviceIdBanList]),(0,o.jsx)(c.Provider,{value:{subscriptions:d,thisUser:p,deviceIdBanList:f},children:e.children})}},4766:function(e,t,n){n.d(t,{Ao:function(){return h},QZ:function(){return f},XU:function(){return g},ZP:function(){return v},_3:function(){return p},sQ:function(){return x},u5:function(){return u}});var o=n(57437),i=n(2265),r=n(94547),s=n(15785),a=n(71432),l=n(11144),c=n(5085),d=n(1973);let u=()=>{let{revealIndex:e,setRevealIndex:t,targetIndex:n,setTargetIndex:o}=(0,i.useContext)(m);if(!(0,a.r)(t))throw Error("useRevealState should be used within ZgSessionLiveSlideDataProvider");return{revealIndex:e,setRevealIndex:t,targetIndex:n,setTargetIndex:o}},p=()=>{let{revealIndex:e,setTargetIndex:t}=(0,i.useContext)(m);if(!(0,a.r)(t))throw Error("useRevealControls should be used within ZgSessionLiveSlideDataProvider");return{revealIndex:e,setTargetIndex:t}},h=()=>{let{slideData:e}=(0,i.useContext)(m);if(!(0,a.r)(e))throw Error("useSlideData should be used within ZgSessionLiveSlideDataProvider");return{slideData:e}},f=()=>{let{setSlideData:e}=(0,i.useContext)(m);if(!(0,a.r)(e))throw Error("useSlideData should be used within ZgSessionLiveSlideDataProvider");return{setSlideData:e}},x=()=>{let{allSlideAnswerRules:e}=(0,i.useContext)(m);if(!(0,a.r)(e))throw Error("useSlideAnswerRules should be used within ZgSessionLiveSlideDataProvider");return{allSlideAnswerRules:e}},g=()=>{let{setAllSlideAnswerRules:e}=(0,i.useContext)(m);if(!(0,a.r)(e))throw Error("useWriteSlideAnswerRules should be used within ZgSessionLiveSlideDataProvider");return{setAllSlideAnswerRules:e}},m=(0,i.createContext)({});function v(e){let{role:t}=(0,i.useContext)(c.rZ),{session:n}=(0,i.useContext)(l.z),{user:u,sessionToken:p,deviceId:h}=(0,i.useContext)(c.rZ),[f,x]=(0,i.useState)({}),[g,v]=(0,i.useState)(s.I),[b,y]=(0,i.useState)(),[w,j]=(0,i.useState)();(0,i.useRef)(0);let{start:k,api:S}=(0,i.useContext)(d.E);(0,i.useEffect)(()=>{t===r._b.Controller&&Z()},[]),(0,i.useEffect)(()=>{(0,a.r)(b)&&(console.debug("revealIndex changed slide index: ".concat(b)),t===r._b.Controller&&(C(b),I(b)))},[b]);let Z=()=>{let e=window.localStorage.getItem("RevealState-".concat(n.id));e&&j(JSON.parse(e).index)},C=e=>{if(t===r._b.Controller){let t=JSON.stringify({index:e});window.localStorage.setItem("RevealState-".concat(n.id),t)}},I=async e=>{if(!(0,a.r)(u)||t!==r._b.Controller||!(0,a.r)(n.id)||!(0,a.r)(p))return;let o={action:"set-slide-position",sessionId:n.id,ticks:Date.now(),originator:h,parameters:{indexh:e}};console.debug("Sending slide index: ".concat(e)),await k(S.postFacilitatorAction(u.access_token,p,o))};return(0,o.jsx)(m.Provider,{value:{allSlideAnswerRules:f,setAllSlideAnswerRules:x,slideData:g,setSlideData:v,revealIndex:b,setRevealIndex:y,targetIndex:w,setTargetIndex:j},children:e.children})}},93191:function(e,t,n){n.d(t,{N:function(){return l},Z:function(){return c}});var o=n(57437),i=n(57818),r=n(2265),s=n(5085),a=n(31842);let l=(0,r.createContext)({});function c(e){let t=(0,r.useContext)(a.F),[c,d]=(0,r.useState)(),{role:u}=(0,r.useContext)(s.rZ);return(0,r.useEffect)(()=>{let r=(0,i.default)(()=>Promise.all([n.e(885),n.e(589),n.e(441)]).then(n.bind(n,50441)),{loadableGenerated:{webpack:()=>[50441]},ssr:!1}),s=(0,i.default)(()=>Promise.all([n.e(518),n.e(218),n.e(589),n.e(4),n.e(567)]).then(n.bind(n,90567)),{loadableGenerated:{webpack:()=>[90567]},ssr:!1});d({presentation:(0,o.jsx)(r,{sid:t.sid,role:u,slides:t.slides,sourcePresentationXml:t.sourceXml.join("\n"),embedded:!0,showBorder:!1,regenerateThumbnails:e.refresh}),previews:e.previews?(0,o.jsx)(s,{sid:t.sid,slides:t.slides,sourcePresentationXml:t.sourceXml.join("\n"),regenerateThumbnails:e.refresh}):void 0})},[]),(0,o.jsx)(o.Fragment,{children:c&&(0,o.jsx)(l.Provider,{value:c,children:e.children})})}},5085:function(e,t,n){n.d(t,{ZP:function(){return h},rZ:function(){return p}});var o,i,r=n(57437),s=n(2265),a=n(67022),l=n(20920),c=n(94547),d=n(71432),u=n(1973);(o=i||(i={}))[o.Init=0]="Init",o[o.Authenticating=1]="Authenticating",o[o.AuthError=2]="AuthError",o[o.AuthNotRequired=3]="AuthNotRequired",o[o.Authenticated=4]="Authenticated",o[o.ExchangingJoinCode=5]="ExchangingJoinCode",o[o.JoinCodeError=6]="JoinCodeError",o[o.JoinCodeAccepted=7]="JoinCodeAccepted",o[o.Ready=8]="Ready";let p=(0,s.createContext)({});function h(e){var t;let[n,o]=(0,s.useState)((null===(t=window)||void 0===t?void 0:t.localStorage.getItem("DeviceId"))||(0,l.Z)());(0,s.useEffect)(()=>{window&&window.localStorage.setItem("DeviceId",n)},[n]);let[h,f]=(0,s.useState)(0),[x,g]=(0,s.useState)(void 0),[m,v]=(0,s.useState)(e.role),[b,y]=(0,s.useState)(),[w,j]=(0,s.useState)(!1),[k,S]=(0,s.useState)(!1),[Z,C]=(0,s.useState)({deviceId:n,role:m,state:h,user:x,sessionToken:b,noUserWarning:k});(0,s.useEffect)(()=>{C({...Z,state:h})},[h]),(0,s.useEffect)(()=>{C({...Z,user:x})},[x]),(0,s.useEffect)(()=>{C({...Z,role:m})},[m]),(0,s.useEffect)(()=>{C({...Z,sessionToken:b})},[b]),(0,s.useEffect)(()=>{C({...Z,noUserWarning:k})},[k]);let I=(0,a.aC)(),{api:D,start:E}=(0,s.useContext)(u.E);return(0,s.useEffect)(()=>I.events.addAccessTokenExpiring(async()=>{console.debug("Access token renewal with auth.signinSilent()...");let e=await I.signinSilent();console.debug("User renewal: ".concat(e?"found":"not found")),g(e)}),[I.events,I.signinSilent]),(0,s.useEffect)(()=>{switch(console.debug("User state",i[h]),h){case 0:switch(m){case c._b.Controller:f(1);break;case c._b.Client:f(3),g(null);break;default:throw"Unsupported role: ".concat(c._b[m])}break;case 1:I.signinSilent().then(e=>{null!==e?(console.info("User found",e.profile.email),g(e),f(4)):(console.debug("Not authenticated"),g(void 0),f(2))}).catch(e=>{console.error(e),g(void 0),f(2)});break;case 2:case 6:break;case 4:case 3:f(5);break;case 5:let t={deviceId:n,role:m,joinCode:e.joinCode,sessionId:e.sid};E(D.exchangeJoinCodeForSessionToken(t,null==x?void 0:x.access_token)).then(e=>{(0,d.r)(e)?(y(e.sessionToken),f(7)):console.debug("Join code exchange superseded.")}).catch(e=>{console.error(e),f(6)});break;case 7:f(8)}j(!![2,6].find(e=>e===h))},[h]),(0,s.useEffect)(()=>{S(null===x),null===x&&8===h&&console.error("No user found through Auth. The facilitator will not be able to manage the session.")},[x]),(0,r.jsxs)(r.Fragment,{children:[w&&e.err,8!==h&&!w&&e.load,8===h&&!w&&(0,r.jsx)(p.Provider,{value:Z,children:e.children})]})}},31842:function(e,t,n){n.d(t,{F:function(){return nx},Z:function(){return ng}});var o,i,r,s,a,l,c=n(57437),d=n(53463),u=n(2265),p=n(22599),h=n.n(p),f=n(20920),x=n(79418),g=n(94547),m=n(71432);let v={select:["key","label","layout","groups"],text:["key","label","textPlaceholder","textValidationRegex","textMaxLength"],"multi-select":["key","label","groups","selectionQuestion","selectionObject","selectionObject_plural","minSelections","maxSelections"]},b=e=>{if(!Object.hasOwn(v,e.mode))return{validations:["DemographicInputType mode not recognised: ".concat(e.mode)],requiredFields:[]};let t=v[e.mode],n=[];for(let o of t)(0,m.r)(e[o])||n.push("".concat(e.mode," required field invalid: ").concat(o));return{validations:!(n.length>0)||n,requiredFields:t}},y={gbr:{key:"postcode",label:"Postcode (first half)",mode:"text",layout:"column",textPlaceholder:"What is the first half of your postcode?",textValidationRegex:"^[a-zA-Z]{1,2}[0-9][0-9a-zA-Z]?$",textCapitalisation:!0,textValidationMessage:"Please enter a valid UK postcode",groups:[],textMaxLength:15}},w={key:"gender",label:"Gender",mode:"select",layout:"column",groups:[{label:"Gender",choices:[{display:"Female",key:"f"},{display:"Male",key:"m"},{display:"Non-binary",key:"nb"},{display:"I would rather not say",key:"prefer-not-to-say"}]}]},j={key:"age",label:"Age range",mode:"select",layout:"grid",layoutProps:{columns:2},groups:[{label:"Age",choices:[{display:"14 - 17",key:"14-17"},{display:"18 - 25",key:"18-25"},{display:"26 - 35",key:"26-35"},{display:"36 - 45",key:"36-45"},{display:"46 - 55",key:"46-55"},{display:"56 - 65",key:"56-65"},{display:"66 - 75",key:"66-75"},{display:"76+",key:"76+"},{display:"I would rather not say",key:"prefer-not-to-say"}]}]},k={key:"ethnicity",label:"Ethnicity",mode:"select",layout:"row",groups:[{label:"Asian or Asian British",choices:[{display:"Indian",key:"Indian"},{display:"Pakistani",key:"Pakistani"},{display:"Bangladeshi",key:"Bangladeshi"},{display:"Chinese",key:"Chinese"},{display:"Any other Asian background",key:"Any other Asian background"}]},{label:"Black, Black British, Caribbean or African",choices:[{display:"Caribbean",key:"Caribbean"},{display:"African",key:"African"},{display:"Any other Black, Black British, or Caribbean background",key:"Any other Black, Black British, or Caribbean background"}]},{label:"Mixed or multiple ethnic groups",choices:[{display:"White and Black Caribbean",key:"White and Black Caribbean"},{display:"White and Black African",key:"White and Black African"},{display:"White and Asian",key:"White and Asian"},{display:"Any other Mixed or multiple ethnic background",key:"Any other Mixed or multiple ethnic background"}]},{label:"White",choices:[{display:"English, Welsh, Scottish, Northern Irish or British",key:"English, Welsh, Scottish, Northern Irish or British"},{display:"Irish",key:"Irish"},{display:"Gypsy or Irish Traveller",key:"Gypsy or Irish Traveller"},{display:"Roma",key:"Roma"},{display:"Any other White background",key:"Any other White background"}]},{label:"Other ethnic group",choices:[{display:"Arab",key:"Arab"},{display:"Any other ethnic group",key:"Any other ethnic group"}]},{label:"Unavailable",choices:[{display:"I would rather not say",key:"prefer-not-to-say"}]}]};var S=n(4087),Z=n(8260),C=n(5085),I=n(31193),D=n(96537),E=n(48620);function P(e){var t;let n=(0,u.useContext)(C.rZ),{answers:o}=(0,Z.ZP)(e.qids.qid),[i,r]=(0,u.useState)((0,Z.Zp)(o,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)),[s,a]=(0,u.useState)(i),[l,d]=(0,u.useState)(n.role!==g._b.Controller),[p,h]=(0,u.useState)(!1);(0,u.useEffect)(()=>{a(i)},[i]);let f=t=>{if(!l)return;h(!0);let n={...s,jsonValue:{answers:[{key:t,booleanValue:!0}]}};e.onAnswer(n).then(e=>{if(e)r(e);else throw"No response from submission"}).catch(e=>{console.error(e)}).finally(()=>{h(!1)})};return(0,c.jsxs)(c.Fragment,{children:[e.question&&(0,c.jsx)(E.Z,{content:e.question}),(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"row",gap:1,justifyContent:e.align},children:e.options.map((t,n)=>{var o;return(0,c.jsx)(D.Z,{variant:(null!==(o=t.variant)&&void 0!==o?o:0===n)?"contained":"outlined",color:t.colour,onClick:()=>f(t.key),disabled:!l||p,children:t.text},"ack-".concat(e.qids.qid,"-option-").concat(t.key))})})]})}var A=n(22960),R=n(58433),B=n(80511),T=n(33351),F=n(49752);function q(e){let t=e.layoutParams.length>0?parseInt(e.layoutParams[0]):6,n=(0,A.Z)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(T.Z,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,c.jsx)(T.Z,{sx:{mb:4,mx:8},children:e.question&&(0,c.jsx)(E.Z,{content:e.question})}),(0,c.jsx)(R.ZP,{container:!0,spacing:1,children:e.displayOptions.map((o,i)=>{let r=e.currentlySelectedKeys.find(e=>e===o.key);return(0,c.jsx)(R.ZP,{item:!0,xs:t,display:"flex",flexDirection:"column",alignContent:"stretch",children:(0,c.jsx)(D.Z,{"aria-label":o.ariaLabel,variant:"contained",style:{display:"flex",flexDirection:"column",justifyContent:"center",border:"solid 4px",background:r?n.palette.optionButtonSelected.main:n.palette.optionButtonUnselected.main,borderColor:r?n.palette.optionButtonSelectedBorder.main:"transparent",color:"black"},onClick:()=>e.onSelectionClick(o.key),children:(0,c.jsx)(B.Z,{variant:"submitButton",sx:{fontSize:o.fontSize,textWrap:"balance"},children:o.display})})},"answer-".concat(e.qid,"-").concat(o.key))})}),e.showSubmit&&(0,c.jsx)(T.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-end",sx:{mt:4},children:(0,c.jsx)(F.Z,{busy:e.busy,inline:!1,enabled:e.enableSubmit,onSubmit:e.onSubmit})})]})})}function M(e){let t=(0,A.Z)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(T.Z,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,c.jsx)(T.Z,{sx:{mb:4,mx:8},children:e.question&&(0,c.jsx)(E.Z,{content:e.question})}),(0,c.jsx)(T.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",gap:1},children:e.displayOptions.map((n,o)=>{let i=e.currentlySelectedKeys.find(e=>e===n.key);return(0,c.jsx)(D.Z,{"aria-label":n.ariaLabel,variant:"contained",style:{display:"flex",flexDirection:"column",justifyContent:"center",border:"solid 4px",background:i?t.palette.optionButtonSelected.main:t.palette.optionButtonUnselected.main,borderColor:i?t.palette.optionButtonSelectedBorder.main:"transparent",color:"black"},onClick:()=>e.onSelectionClick(n.key),children:(0,c.jsx)(B.Z,{variant:"submitButton",sx:{fontSize:n.fontSize,textWrap:"balance"},children:n.display})},"answer-".concat(e.qid,"-").concat(n.key))})}),e.showSubmit&&(0,c.jsx)(T.Z,{display:"flex",flexDirection:"row",justifyContent:"flex-end",sx:{mt:4},children:(0,c.jsx)(F.Z,{busy:e.busy,inline:!1,enabled:e.enableSubmit,onSubmit:e.onSubmit})})]})})}function _(e){let t=(0,A.Z)(),n=90-90/e.sourceOptions.filter(e=>!e.isAlt).length;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,c.jsx)(I.Z,{sx:{mb:4,mx:8},children:e.question&&(0,c.jsx)(E.Z,{content:e.question})}),(0,c.jsx)(I.Z,{display:"flex",flexDirection:"row",justifyContent:"center",sx:{gap:1,width:"".concat(n,"%")},children:e.displayOptions.filter(e=>!e.isAlt).map((n,o)=>{let i=e.currentlySelectedKeys.find(e=>e===n.key);return(0,c.jsxs)(I.Z,{"aria-label":n.ariaLabel,sx:{borderRadius:4,px:1,flexGrow:1,flexBasis:0},style:{minHeight:200,border:"solid 4px",background:i?t.palette.optionButtonSelected.main:t.palette.optionButtonUnselected.main,borderColor:i?t.palette.optionButtonSelectedBorder.main:"transparent",cursor:"pointer"},display:"flex",flexDirection:"column",justifyContent:"center",onClick:()=>e.onSelectionClick(n.key),children:[!!n.graphic&&(0,c.jsx)("img",{src:n.graphic,style:{alignSelf:"center",width:"40%"},alt:"".concat(n.display)}),(0,c.jsx)(B.Z,{variant:"yesNoUnsureButton",sx:{fontSize:n.fontSize,textWrap:"balance"},children:n.display})]},"option-".concat(n.key,"-").concat(e.qid))})}),(0,c.jsx)(I.Z,{display:"flex",flexDirection:"column",alignItems:"center",sx:{mt:2},children:e.sourceOptions.filter(e=>e.isAlt).map((n,o)=>{let i=e.currentlySelectedKeys.find(e=>e===n.key);return(0,c.jsx)(I.Z,{sx:{p:2,borderRadius:4},style:{background:i?t.palette.optionButtonSelected.main:"transparent",border:"solid 4px transparent",borderColor:i?t.palette.optionButtonSelectedBorder.main:"transparent",cursor:"pointer"},onClick:()=>e.onSelectionClick(n.key),display:"flex",flexDirection:"column",justifyContent:"center",children:(0,c.jsx)(B.Z,{variant:"yesNoUnsureButton",style:{borderBottom:"solid 1px black",textWrap:"balance"},children:n.display})},"option-".concat(n.key,"-").concat(e.qid))})}),e.showSubmit&&(0,c.jsx)(I.Z,{display:"flex",flexDirection:"row",justifyContent:"center",sx:{mt:4},children:(0,c.jsx)(F.Z,{busy:e.busy,inline:!1,enabled:e.enableSubmit,onSubmit:e.onSubmit})})]})})}let N=(e,t)=>t.filter(t=>!!e.find(e=>e===t.key)),O=e=>[...e].sort(()=>Math.random()-.5);function W(e){var t;let[n,o]=(0,u.useState)(e.shuffle?O(e.options):e.options),{answers:i}=(0,Z.ZP)(e.qids.qid),[r,s]=(0,u.useState)((0,Z.Zp)(i,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)),[a,l]=(0,u.useState)([]);(0,u.useEffect)(()=>{var t,n;l(N(null!==(n=null===(t=r.jsonValue)||void 0===t?void 0:t.answers.filter(e=>!0===e.booleanValue).map(e=>e.key))&&void 0!==n?n:[],e.options))},[r]);let[d,p]=(0,u.useState)(!1),h=e.role===g._b.Client,f=()=>a.length>=e.minSelections&&a.length<=e.maxSelections,x=async()=>{if(f())try{p(!0);var t={...r,jsonValue:{answers:a.map(t=>({key:t.key,booleanValue:!0,numericValue:1,index:e.options.findIndex(e=>e.key===t.key)}))}},n=await e.onAnswer(t);if(console.debug("Answer submitted ".concat(n?"ok":"error")),console.debug("Received answer response",n),n)s(n);else throw"No response received"}catch(e){console.error("Error submitting answer",e)}finally{p(!1)}},m=t=>{console.debug("Selection clicked: "+t);let n=e.options.find(e=>e.key===t);if(void 0===n)throw"Cannot identify this option from props.options";if(a.find(e=>e.key===t))l(a.filter(e=>e.key!==t));else if(a.length>=e.maxSelections){let e=a.find(e=>e.key!==t);l([...a.filter(t=>t!==e),n])}else l([...a,n])},v=()=>({onSubmit:x,onSelectionClick:m,qid:e.qids.qid,question:e.question,sourceOptions:e.options,displayOptions:n,busy:d,showSubmit:h,enableSubmit:f(),minSelections:e.minSelections,maxSelections:e.maxSelections,currentlySelectedKeys:a.map(e=>e.key),layoutParams:e.layoutParams}),[b,y]=(0,u.useState)(v());return(0,u.useEffect)(()=>{y(v())},[d,a]),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:(0,c.jsxs)(I.Z,{sx:{flexGrow:1,display:"block"},children:["yes-no-unsure"===e.layout&&(0,c.jsx)(_,{...b}),"button-grid"===e.layout&&(0,c.jsx)(q,{...b}),"buttons-inline"===e.layout&&(0,c.jsx)(M,{...b})]})})})}var K=n(44908),L=n(11929),U=n(19309);function V(e){return(0,c.jsxs)(I.Z,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,c.jsx)(I.Z,{sx:{display:"block",flexGrow:1,overflowY:"auto",overflowX:"hidden"},children:e.children}),(e.startBar||e.endBar)&&(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",pt:1},children:[(0,c.jsx)(I.Z,{children:e.startBar}),e.endBar&&(0,c.jsx)(I.Z,{children:e.endBar})]})]})}var z=n(9646);function H(e){var t;let n=(0,u.useContext)(C.rZ),{answers:o}=(0,Z.ZP)(e.qids.qid),[i,r]=(0,u.useState)((0,Z.Zp)(o,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)),[s,a]=(0,u.useState)(!1),[l,d]=(0,u.useState)(!1),[p,h]=(0,u.useState)(!1);(0,u.useEffect)(()=>{var e,t,n;a(null!==(n=null===(t=i.jsonValue)||void 0===t?void 0:null===(e=t.answers.find(e=>"consent"===e.key))||void 0===e?void 0:e.booleanValue)&&void 0!==n&&n)},[i]),(0,u.useEffect)(()=>{d(s&&n.role===g._b.Client)},[s]);let f=t=>{if(!l){console.warn("Only participants can submit answers");return}h(!0);let n={...i,jsonValue:{answers:[{key:"consent",booleanValue:s},{key:"consentText",stringValue:e.consentText}]}};e.onAnswer(n).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),null!==e)r(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{h(!1)})};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(V,{startBar:(0,c.jsx)(()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(K.Z,{control:(0,c.jsx)(L.Z,{checked:s,onChange:(e,t)=>a(t)}),label:(0,c.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.25rem"},children:e.consentText})})}),{}),endBar:(0,c.jsx)(()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(z.Z,{btnKey:"submit",btnText:(0,c.jsx)(S.Z,{i18nKey:"button.submit"}),onClick:f,disabled:!l,busy:p})}),{}),children:[e.question&&(0,c.jsx)(E.Z,{content:e.question,forceAlign:"left",sx:{fontWeight:"bold"}}),e.content.map((t,n)=>(0,c.jsx)(B.Z,{variant:"consentBody",align:"left",dangerouslySetInnerHTML:{__html:(0,U.Z)(t)}},"".concat(e.qids.qid,"-consent-body-").concat(n)))]})})}var G=n(95253),J=n(7590),Y=n(66858),Q=n(19004),X=n(55677),$=n(11656),ee=n(45133);let et=(e,t)=>({key:e.selectedKeys.join(","),display:e.selectedKeys.map(e=>t.groups.map(t=>t.choices.filter(t=>t.key===e).map(e=>e.display)).flat()).flat().join(", ")}),en=e=>{let t=e.key.split(",").map(e=>e.trim()),n=t.filter(e=>e.length>0).length;return{objects:n,selectedKeys:n>0?t:[]}},eo={objects:0,selectedKeys:[]};function ei(e){let t;let n=e.demographic.groups.length>1,o=()=>{var t;return null!==(t=e.skipOption)&&void 0!==t?t:{key:"prefer-not-to-say",display:"I would rather not say"}},[i,r]=(0,u.useState)((t=e.currentSelection,(0,m.r)(t)&&t.key!==o().key?en(t):eo)),[s,a]=(0,u.useState)(!1),[l,d]=(0,u.useState)([]),[p,h]=(0,u.useState)(!1),f=()=>{d(i.selectedKeys.map(e=>(0,m.r)(e)&&"empty"!==e))};(0,u.useEffect)(()=>{a(i.selectedKeys.every(e=>(0,m.r)(e))),f()},[i]);let x=()=>{s?e.onSelection(et(i,e.demographic)):h(!0)},g=t=>{switch(t){case"add":i.objects<e.demographic.maxSelections&&r({...i,objects:i.objects+1,selectedKeys:[...i.selectedKeys,void 0]});break;case"remove":i.objects>e.demographic.minSelections&&r({...i,objects:i.objects-1,selectedKeys:i.selectedKeys.slice(0,i.objects-1)})}},v=(e,t)=>{r({...i,selectedKeys:i.selectedKeys.map((n,o)=>o===e?"empty"!==t?t:void 0:n)})},b=(0,A.Z)();return(0,c.jsx)(V,{endBar:(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",gap:1},children:[e.skipPermitted&&(0,c.jsx)(z.Z,{btnKey:"skip",btnText:(0,c.jsx)(S.Z,{i18nKey:"demographic.input.ratherNotSay"}),variant:"outlined",onClick:t=>{e.onSelection(o())}}),(0,c.jsx)(z.Z,{btnKey:"submit",btnText:(0,c.jsx)(S.Z,{i18nKey:"demographic.input.submit"}),variant:"contained",onClick:e=>{x()}})]}),children:(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[(0,c.jsx)(D.Z,{color:"buttonStandard",variant:"text",onClick:()=>e.onBack(),children:(0,c.jsx)("img",{src:"/icons/arrow-left.svg",alt:"Back"})}),(0,c.jsx)(B.Z,{variant:"slideSubHeading",align:"left",children:e.demographic.selectionQuestion})]}),(0,c.jsxs)(R.ZP,{container:!0,spacing:1,children:[(0,c.jsx)(R.ZP,{item:!0,xs:1,sx:{display:"flex",flexDirection:"row"},children:(0,c.jsx)(z.Z,{btnKey:"remove",content:(0,c.jsx)(J.Z,{}),btnText:"",variant:"outlined",onClick:e=>{g(e)},disabled:i.objects<=e.demographic.minSelections,sx:{flexGrow:.3}})}),(0,c.jsx)(R.ZP,{item:!0,xs:10,sx:{display:"flex",flexDirection:"row"},children:(0,c.jsx)(Y.Z,{label:e.demographic.selectionObject_plural,variant:"outlined",value:"".concat(i.objects),disabled:!0,autoComplete:"off",color:"buttonStandard",InputProps:{sx:{background:"white",fontSize:"2rem"}},sx:{flexGrow:1},InputLabelProps:{sx:{fontSize:"2rem","&.MuiOutlinedInput-notchedOutline":{fontSize:"2rem"}}}})}),(0,c.jsx)(R.ZP,{item:!0,xs:1,sx:{display:"flex",flexDirection:"row"},children:(0,c.jsx)(z.Z,{btnKey:"add",content:(0,c.jsx)(G.Z,{}),btnText:"",variant:"contained",onClick:e=>{g(e)},disabled:i.objects>=e.demographic.maxSelections,sx:{flexGrow:.5}})})]}),(0,c.jsx)(R.ZP,{container:!0,rowGap:1,children:Array.from(Array(i.objects).keys()).map(t=>{var o;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(R.ZP,{item:!0,xs:2,sx:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"center"},children:(0,c.jsxs)(B.Z,{variant:"slideBody",align:"left",children:[e.demographic.selectionObject," ",t+1]})},"demographic-multi-select-for-".concat(e.demographic.key,"-").concat(t,"-label")),(0,c.jsx)(R.ZP,{item:!0,xs:10,children:(0,c.jsxs)(Q.Z,{value:null!==(o=i.selectedKeys[t])&&void 0!==o?o:"empty",fullWidth:!0,error:p&&!l[t],input:(0,c.jsx)(X.Z,{sx:{fontSize:"2rem",color:"black",textAlign:"start"}}),onChange:(e,n)=>{v(t,e.target.value)},children:[(0,c.jsxs)($.Z,{value:"empty",children:[(0,m.r)(e.demographic.selectionItemPrompt)&&(0,c.jsx)(c.Fragment,{children:e.demographic.selectionItemPrompt}),!(0,m.r)(e.demographic.selectionItemPrompt)&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(S.Z,{i18nKey:"demographic.multi-select.default-selection-item-prompt"})})]},"demographic-multi-select-for-".concat(e.demographic.key,"-index-").concat(t,"-empty")),e.demographic.groups.map((o,i)=>[n?(0,c.jsx)(ee.Z,{sx:{p:1,borderBottom:"1px solid ".concat(b.palette.divider)},children:(0,c.jsx)(c.Fragment,{children:o.label})}):void 0,...o.choices.map((o,r)=>(0,c.jsx)($.Z,{value:o.key,sx:{p:1,pl:n?2:void 0},children:(0,c.jsx)(c.Fragment,{children:o.display})},"demographic-multi-select-for-".concat(e.demographic.key,"-index-").concat(t,"-group-").concat(i,"-choice-").concat(r)))])]})},"demographic-multi-select-for-".concat(e.demographic.key,"-").concat(t,"-select"))]})})})]})})}function er(e){let t=e.demographic.groups.length>1;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[(0,c.jsx)(D.Z,{color:"buttonStandard",variant:"text",onClick:()=>e.onBack(),children:(0,c.jsx)("img",{src:"/icons/arrow-left.svg",alt:"Back"})}),(0,c.jsx)(B.Z,{variant:"slideSubHeading",align:"left",children:e.demographic.label})]}),(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",gap:4,mb:4},children:e.demographic.groups.map(n=>(0,c.jsxs)(I.Z,{display:"flex",flexDirection:"column",alignContent:"start",children:[t&&(0,c.jsx)(B.Z,{variant:"demographicGroupHeading",align:"left",sx:{mb:.8},children:n.label}),("row"===e.layout||"column"===e.layout)&&(0,c.jsx)(I.Z,{display:"flex",flexDirection:e.layout,gap:1,flexWrap:"row"===e.layout?"wrap":void 0,alignItems:"column"===e.layout?"start":void 0,children:n.choices.map(t=>{var o;return(0,c.jsx)(D.Z,{variant:"contained",color:(null===(o=e.currentSelection)||void 0===o?void 0:o.key)===t.key?"buttonStandard":"buttonQuiet",onClick:()=>{e.onSelection(t)},children:(0,c.jsx)(B.Z,{variant:"submitButton",children:t.display})},"".concat(e.demographic.label,"-section-").concat(n.label,"-value-").concat(t.key))})}),"grid"===e.layout&&(0,c.jsx)(R.ZP,{container:!0,sx:{width:e.layoutProps.columns<3?"66%":"100%"},rowGap:1,children:n.choices.map(t=>{var o;return(0,c.jsx)(R.ZP,{item:!0,xs:12/e.layoutProps.columns,sx:{px:1},children:(0,c.jsx)(D.Z,{variant:"contained",fullWidth:!0,color:(null===(o=e.currentSelection)||void 0===o?void 0:o.key)===t.key?"buttonStandard":"buttonQuiet",onClick:()=>{e.onSelection(t)},children:(0,c.jsx)(B.Z,{variant:"submitButton",sx:{py:1},children:t.display})})},"".concat(e.demographic.label,"-section-").concat(n.label,"-value-").concat(t.key))})})]},"".concat(e.demographic.label,"-section-").concat(n.label)))})]})}var es=n(90089);function ea(e){var t,n,o;let{t:i}=(0,es.$G)(),r=()=>{var t;return null!==(t=e.skipOption)&&void 0!==t?t:{key:"prefer-not-to-say",display:i("demographic.input.ratherNotSay")}},[s,a]=(0,u.useState)((null===(t=e.currentSelection)||void 0===t?void 0:t.key)!==r().key&&null!==(o=null===(n=e.currentSelection)||void 0===n?void 0:n.display)&&void 0!==o?o:""),[l,d]=(0,u.useState)(""),[p,h]=(0,u.useState)(!1),[f,x]=(0,u.useState)(!0),[g,m]=(0,u.useState)(!1),v=t=>{var n,o;return(m(!0),e.demographic.textMaxLength&&t.length>e.demographic.textMaxLength)?(d(null!==(n=e.demographic.textValidationMessage)&&void 0!==n?n:"Maximum length: ".concat(e.demographic.textMaxLength," characters")),h(!0),x(!1),!1):e.demographic.textValidationRegex&&!new RegExp(e.demographic.textValidationRegex).test(t)?(a(t),d(null!==(o=e.demographic.textValidationMessage)&&void 0!==o?o:"Please enter a valid value for ".concat(e.demographic.label,".")),h(!0),x(!1),!1):(a(t),d(""),h(!1),x(!0),!0)};return(0,u.useEffect)(()=>{g&&x(!p)},[g,p]),(0,c.jsx)(V,{endBar:(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",gap:1},children:[e.skipPermitted&&(0,c.jsx)(z.Z,{btnKey:"skip",btnText:(0,c.jsx)(S.Z,{i18nKey:"demographic.input.ratherNotSay"}),variant:"outlined",onClick:t=>{e.onSelection(r())}}),(0,c.jsx)(z.Z,{btnKey:"submit",btnText:(0,c.jsx)(S.Z,{i18nKey:"demographic.input.submit"}),variant:"contained",disabled:!f,onClick:t=>{v(s)&&e.onSelection({key:s,display:s})}})]}),children:(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[(0,c.jsx)(D.Z,{color:"buttonStandard",variant:"text",onClick:()=>e.onBack(),children:(0,c.jsx)("img",{src:"/icons/arrow-left.svg",alt:"Back"})}),(0,c.jsx)(B.Z,{variant:"slideSubHeading",align:"left",children:e.demographic.label})]}),(0,c.jsx)(Y.Z,{label:e.demographic.textPlaceholder,variant:"outlined",defaultValue:s,onChange:e=>{let t=e.target.value.trim();g?v(t):a(t)},helperText:l,error:p,autoComplete:"off",color:"buttonStandard",inputProps:{style:{textTransform:e.demographic.textCapitalisation?"uppercase":void 0}},InputProps:{sx:{background:"white",fontSize:"2rem"}},InputLabelProps:{sx:{fontSize:"2rem","&.MuiOutlinedInput-notchedOutline":{fontSize:"2rem"}}}})]})})}function el(e){var t,n,o,i;let r;let{answers:s}=(0,Z.ZP)(e.qids.qid),[a,l]=(0,u.useState)((0,Z.Zp)(s,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)),[d,p]=(0,u.useState)(!1),[f,x]=(0,u.useState)(!1),[v,b]=(0,u.useState)((r=[],(null===(n=e.showGender)||void 0===n||n)&&r.push(w),(null===(o=e.showAge)||void 0===o||o)&&r.push(j),(null===(i=e.showEthnicity)||void 0===i||i)&&r.push(k),void 0!==e.showPostcode&&r.push(y[e.showPostcode]),[...r,...e.customDemographics])),[C,P]=(0,u.useState)(),[A,R]=(0,u.useState)({});(0,u.useEffect)(()=>{let e={};(null==a?void 0:a.jsonValue)&&a.jsonValue.answers.forEach(t=>{e[t.key]={key:t.optionKey,display:t.stringValue}}),R(e)},[a]),(0,u.useEffect)(()=>{let t=h().every(v,e=>A.hasOwnProperty(e.key));x(e.role===g._b.Client&&t)},[A]);let T=async()=>{if(e.role!==g._b.Client)console.warn("Only participants can submit answers");else{let t={...a,jsonValue:{answers:Object.entries(A).map(e=>({key:e[0],optionKey:e[1].key,stringValue:e[1].display}))}};p(!0),e.onAnswer(t).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)l(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{p(!1)})}},F=!1===e.opaqueInputBox?void 0:{background:"white"},q=e=>{var t;return(0,c.jsx)(D.Z,{color:"buttonStandard",variant:"outlined",sx:{alignSelf:"stretch",py:0,...e.inputBoxSx},onClick:()=>e.onClick(),children:(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",flexGrow:1,justifyContent:"space-between"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:0},children:[void 0!==e.display&&(0,c.jsx)(B.Z,{variant:"selectTiny",children:e.label}),(0,c.jsx)(B.Z,{variant:"selectLarge",component:"div",children:null!==(t=e.display)&&void 0!==t?t:e.label})]}),(0,c.jsx)("img",{src:"/icons/select-down.svg"})]})})};return(0,c.jsxs)(c.Fragment,{children:[!(0,m.r)(C)&&(0,c.jsx)(V,{endBar:(0,c.jsx)(z.Z,{btnKey:"submit",btnText:(0,c.jsx)(S.Z,{i18nKey:"button.submit"}),onClick:()=>{T()},disabled:!f,busy:d}),children:(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,c.jsx)(I.Z,{sx:{mb:4,mx:8},children:e.question&&(0,c.jsx)(E.Z,{content:e.question})}),v.map(e=>(0,c.jsx)(q,{label:e.label,display:A.hasOwnProperty(e.key)?A[e.key].display:void 0,onClick:()=>{P(e)},inputBoxSx:F},"overview-demographic-".concat(e.key)))]})}),(0,m.r)(C)&&(0,c.jsxs)(c.Fragment,{children:["select"===C.mode&&(0,c.jsx)(er,{demographic:C,currentSelection:A[C.key],onBack:()=>{P(void 0)},onSelection:e=>{R({...A,[C.key]:e}),P(void 0)},layout:C.layout,layoutProps:C.layoutProps}),"text"===C.mode&&(0,c.jsx)(ea,{demographic:C,skipPermitted:!0,currentSelection:A[C.key],onBack:()=>{P(void 0)},onSelection:e=>{R({...A,[C.key]:e}),P(void 0)}}),"multi-select"===C.mode&&(0,c.jsx)(ei,{demographic:C,skipPermitted:!0,currentSelection:A[C.key],onBack:()=>{P(void 0)},onSelection:e=>{R({...A,[C.key]:e}),P(void 0)}})]})]})}var ec=n(83593);function ed(e){let{answers:t}=(0,Z.ZP)(e.qids.qid),n=()=>(0,Z.UJ)(t,e.qids),[o,i]=(0,u.useState)(n()),[r,s]=(0,u.useState)((0,Z.S9)(o)?1:0);return(0,u.useEffect)(()=>{i(n())},[t]),(0,u.useEffect)(()=>{s((0,Z.S9)(o)?1:0)},[o]),(0,u.useEffect)(()=>{ec.Z.emit({type:ec.M.Request_SlideRefresh})},[r]),(0,c.jsxs)(c.Fragment,{children:[0===r&&e.input,1===r&&e.completion]})}(o=s||(s={}))[o.Input=0]="Input",o[o.Completion=1]="Completion";var eu=n(40772),ep=n(14874);function eh(e){let{allAnswers:t}=(0,Z.ZP)(),n=()=>{for(let n of e.qids)if(!(0,Z.S9)((0,Z.UJ)(t[n.qid],n)))return e.qids.indexOf(n)},[o,i]=(0,u.useState)(n());(0,u.useEffect)(()=>{let e=n();o!==e&&i(e)},[t]);let r=(0,ep.Z)(),s=[.2,.25],[a]=(0,eu.u)({duration:500});return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{ref:a,className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",p:2,gap:2,boxSizing:"border-box"},children:[void 0!==o&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(E.Z,{content:e.question}),(0,c.jsx)(I.Z,{sx:{flexGrow:1,boxSizing:"border-box",overflowY:"auto",overflowX:"hidden",display:"block"},children:e.inputs[o]},"input-sequence-element-".concat(e.qids[o].qid))]}),void 0===o&&(0,c.jsx)(I.Z,{sx:{flexGrow:1,display:"block"},children:e.completion}),void 0!==o&&e.showProgress&&(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:h().range(0,e.inputs.length).map((t,n)=>(0,c.jsx)(I.Z,{sx:{background:t===o?r.palette.progressBlipSelected.main:r.palette.progressBlipUnselected.main,width:"".concat(s[t===o?1:0],"em"),height:"".concat(s[t===o?1:0],"em"),borderRadius:"".concat(s[t===o?1:0]/2,"em")}},"sequence-blip-".concat(t,"-").concat(e.qids[t].qid)))})]})})}var ef=n(26049);function ex(e){let{answers:t}=(0,Z.ZP)(e.qids.qid),n=()=>{var n;return(0,Z.Zp)(t,e.qids,null===(n=e.question)||void 0===n?void 0:n.pii)},[o,i]=(0,u.useState)(n()),[r,s]=(0,u.useState)(n()),[a,l]=(0,u.useState)(!1),[d,p]=(0,u.useState)(e.role===g._b.Client),[h,f]=(0,u.useState)({});(0,u.useEffect)(()=>{let t={...h};e.options.forEach(n=>{var i,r,s;t[n.key]=null!==(s=null===(r=o.jsonValue)||void 0===r?void 0:null===(i=r.answers.find(e=>e.key===n.key))||void 0===i?void 0:i.numericValue)&&void 0!==s?s:Math.floor((e.min+e.max)/2)}),f(t),s({...o,jsonValue:{answers:e.options.map(n=>{var o,i;return{key:n.key,numericValue:null!==(o=t[n.key])&&void 0!==o?o:Math.floor((e.min+e.max)/2),description:n.description,index:null!==(i=t[n.key])&&void 0!==i?i:Math.floor((e.min+e.max)/2)}})}})},[o]);let x=t=>h.hasOwnProperty(t)?h[t]:Math.floor((e.min+e.max)/2),m=(t,n)=>{var o,i,a;let l=null!==(i=r.jsonValue)&&void 0!==i?i:{answers:[]};l.answers=l.answers.filter(e=>e.key!==t),l.answers.push({key:t,numericValue:n,description:null!==(a=null===(o=e.options.find(e=>e.key===t))||void 0===o?void 0:o.description)&&void 0!==a?a:"".concat(n),index:n}),s({...r,jsonValue:l})},v=async()=>{e.role!==g._b.Controller&&(l(!0),e.onAnswer(r).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)i(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{l(!1)}))},b=e.max-e.min,y=b+1,w=Array.from(Array(y).keys()),j=-1!==e.labels.findIndex(t=>t.at===e.max),k=0===e.min?0:1;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1,px:e.paddingX||8},children:[(0,c.jsxs)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",gap:1,overflowX:"hidden",overflowY:"auto",justifyContent:"center",px:0},children:[(0,c.jsx)(I.Z,{sx:{mb:4},children:e.question&&(0,c.jsx)(E.Z,{content:e.question})}),(0,c.jsxs)(R.ZP,{container:!0,rowSpacing:e.rowSpacing,sx:{alignItems:"center"},children:[(0,c.jsx)(R.ZP,{xs:4}),(0,c.jsx)(R.ZP,{alignSelf:"flex-end",className:"all-labels-container",item:!0,sx:{display:"grid",gap:"".concat(16,"px"),gridTemplateColumns:"repeat(".concat(b,", 1fr)")},xs:!0===j?7:8,children:w.map((t,n)=>{if(n+1===y)return null;let o=e.labels.findIndex(e=>e.at===t+k);return -1!==o?(0,c.jsx)(I.Z,{className:"label-grid-cell",sx:{alignItems:"end",display:"flex",flexDirection:"row"},children:(0,c.jsx)(B.Z,{variant:"body1",component:"div",sx:{fontWeight:"bold",textAlign:"center",transform:"translate(calc(-50% - ".concat(8,"px), 0)"),width:"fit-content"},children:e.labels[o].text})},"".concat(e.qids.qid,"-label-").concat(n,"-at-").concat(e.labels[o].at)):(0,c.jsx)(I.Z,{className:"empty-label-placeholder"},"step-".concat(t,"-blank-label"))})}),!0===j&&(0,c.jsx)(R.ZP,{alignSelf:"flex-end",item:!0,xs:1,children:(0,c.jsx)(B.Z,{variant:"body1",component:"div",sx:{fontWeight:"bold",transform:"translate(-50%, 0)",width:"fit-content"},children:e.labels[e.labels.length-1].text})}),(0,c.jsx)(R.ZP,{sx:{height:"4px"},xs:12}),e.options.map((t,n)=>(0,c.jsxs)(u.Fragment,{children:[(0,c.jsxs)(R.ZP,{item:!0,xs:4,children:[(0,c.jsx)(B.Z,{variant:"body1",align:"left",component:"div",sx:{pr:6},children:t.title}),e.showDescriptions&&!1]}),(0,c.jsx)(R.ZP,{item:!0,xs:!0===j?7:8,children:(0,c.jsx)(ef.Z,{onCommit:e=>{m(t.key,e)},color:"secondary",sliderDefault:x(t.key),marks:!0,min:e.min,max:e.max,step:1,sliderMode:"multi",sx:{mt:1}})}),!0===j&&(0,c.jsx)(R.ZP,{xs:1})]},"".concat(e.qids.qid,"-option-").concat(t.key)))]})]}),e.role===g._b.Client&&(0,c.jsx)(I.Z,{children:(0,c.jsx)(F.Z,{onSubmit:v,text:(0,c.jsx)(S.Z,{i18nKey:"button.submit"}),busy:a,enabled:d,inline:!1,alignment:"right"})})]})})}var eg=n(45231);function em(e){let t=(0,u.useContext)(C.rZ),{answers:n}=(0,Z.ZP)(e.qids.qid),o=()=>{var t;return(0,Z.Zp)(n,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)},[i,r]=(0,u.useState)(o()),[s,a]=(0,u.useState)(o()),[l,d]=(0,u.useState)(!1),[p,f]=(0,u.useState)(!1),[x,m]=(0,u.useState)(e.points),[v,b]=(0,u.useState)(e.options.map(e=>({min:0,max:e.max}))),[y,w]=(0,u.useState)(e.options.map(()=>0)),j=(e,t)=>{w(y.map((n,o)=>o===t?e:n))};(0,u.useEffect)(()=>{let n=e.points-h().sum(y);m(n);for(let t=0;t<e.options.length;t++)b(v.map((e,t)=>({min:0,max:y[t]+n})));let o={answers:[]};for(let t=0;t<e.options.length;t++)o.answers.push({key:e.options[t].key,description:e.options[t].title,numericValue:y[t]});a({...s,jsonValue:o}),f(0===n&&t.role!==g._b.Controller)},[y,e.options,e.points,t.role]);let k=async()=>{d(!0),e.onAnswer(s).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)r(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{d(!1)})},D=(e,t)=>h().range(e,t+1,1).map((e,t)=>({value:e,label:"".concat(e)})),P=(0,A.Z)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"row",gap:1,mb:2},children:e.question&&(0,c.jsx)(E.Z,{content:e.question})}),(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:1,flexGrow:1,overflowX:"hidden",overflowY:"auto",px:1},children:e.options.map((e,n)=>(0,c.jsxs)(I.Z,{sx:{background:"#f0f0f0",p:2,borderRadius:4,display:"flex",flexDirection:"row",alignItems:"stretch",gap:2},children:[e.graphic&&(0,c.jsx)(I.Z,{sx:{width:"20%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url(".concat(e.graphic,")"),borderRadius:2}}),(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:1,width:"80%"},children:[(0,c.jsx)(B.Z,{variant:"pointsAllocationCategoryTitle",align:"left",children:e.title}),(0,c.jsx)(B.Z,{variant:"pointsAllocationCategoryDescription",align:"left",children:e.description}),(0,c.jsx)(I.Z,{sx:{px:2},children:(0,c.jsx)(ef.Z,{onCommit:e=>{j(e,n)},color:"secondary",sliderDefault:y[n],marks:D(e.min,e.max),slots:{markLabel:eg.A},min:e.min,max:e.max,step:1,sliderMode:"multi",acceptableRange:{min:v[n].min,max:v[n].max},disabled:t.role===g._b.Controller})})]})]},"points-allocation-option-".concat(n)))}),(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"end",gap:1,mx:1},children:[(0,c.jsx)(B.Z,{variant:"pointsAllocationCategoryTitle",align:"left",color:P.palette.secondary.main,children:(0,c.jsx)(S.Z,{i18nKey:"poll.pointsAllocation.remaining",options:{numberOfPoints:x}})}),(0,c.jsx)(F.Z,{enabled:p,inline:!0,busy:l,onSubmit:()=>k()})]})]})})}var ev=n(11020),eb=n(84479);let ey=(e,t,n)=>{if(void 0===e.jsonValue||0===e.jsonValue.answers.length)return ej(t,n);let o=[];return e.jsonValue.answers.forEach(e=>{let n=t.find(t=>t.key===e.key);n&&(o[e.index]=n)}),o},ew=(e,t)=>{let n={answers:[]};return t.forEach((e,t)=>{n.answers.push({key:e.key,index:t,numericValue:t,description:e.title})}),{...e,jsonValue:n}},ej=(e,t)=>t?[...e].sort(()=>Math.random()-.5):e.sort((e,t)=>e.startingIndex-t.startingIndex);function ek(e){var t;let n=(0,u.useContext)(C.rZ),{answers:o}=(0,Z.ZP)(e.qids.qid),[i,r]=(0,u.useState)((0,Z.Zp)(o,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)),[s,a]=(0,u.useState)(n.role!==g._b.Controller),[l,d]=(0,u.useState)(!1),[p,h]=(0,u.useState)(ej(e.options,e.shuffle));(0,u.useEffect)(()=>{h(ey(i,e.options,e.shuffle))},[i,e.options,e.shuffle]);let f=e=>{let t=p.findIndex(t=>t.key===e.key);if(t>0){let n=[...p];n.splice(t,1),n.splice(t-1,0,e),h(n)}},x=e=>{let t=p.findIndex(t=>t.key===e.key);if(t<p.length-1){let n=[...p];n.splice(t,1),n.splice(t+1,0,e),h(n)}},m=async()=>{if(n.role===g._b.Client&&s){d(!0);let t=ew(i,p);e.onAnswer(t).then(t=>{if(console.debug("Answer submitted ".concat(t?"ok":"error")),console.debug("Received answer response",t),null!==t)h(ey(t,e.options,e.shuffle));else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{d(!1)})}else console.warn("Only participants can submit answers")},v=(0,A.Z)(),[b]=(0,eu.u)({duration:500});return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(V,{endBar:(0,c.jsx)(z.Z,{btnKey:"submit",onClick:e=>{m()},disabled:!s,busy:l,variant:"contained",color:"buttonStandard",btnText:(0,c.jsx)(S.Z,{i18nKey:"button.submit"})}),children:[e.question&&(0,c.jsx)(I.Z,{sx:{mb:2},children:(0,c.jsx)(E.Z,{content:e.question})}),(0,c.jsx)(I.Z,{ref:b,sx:{display:"flex",flexDirection:"column"},children:p.map((t,n)=>(0,c.jsxs)(I.Z,{sx:{border:"solid 1px black",borderRadius:2,p:1.5,display:"flex",flexDirection:"row",gap:1,alignContent:"center",alignItems:"center",background:"white",mb:1,boxSizing:"border-box"},children:[(0,c.jsxs)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",pr:2},children:[t.title&&(0,c.jsx)(B.Z,{variant:"rankedListItemTitle",align:"left",children:t.title}),t.description&&(0,c.jsx)(B.Z,{variant:"rankedListItemDescription",align:"left",children:t.description})]}),(0,c.jsx)(I.Z,{onClick:()=>{f(t)},sx:{display:"flex",flexDirection:"column",background:v.palette.updinkBackground.main,color:v.palette.updinkText.main,p:.5,borderRadius:2,cursor:0===n?void 0:"pointer",opacity:0===n?0:1},children:(0,c.jsx)(eb.Z,{sx:{fontSize:"2rem"}})}),(0,c.jsx)(I.Z,{onClick:()=>{x(t)},sx:{display:"flex",flexDirection:"column",background:v.palette.downdinkBackground.main,color:v.palette.downdinkText.main,p:.5,borderRadius:2,cursor:n===p.length-1?void 0:"pointer",opacity:n===p.length-1?0:1},children:(0,c.jsx)(ev.Z,{sx:{fontSize:"2rem"}})})]},"ranked-list-".concat(e.qids.qid,"-option-").concat(t.key)))})]})})}var eS=n(71359),eZ=n(45080),eC=n(22228),eI=n(47656);function eD(e){return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:2,...e.sx},children:e.children})})}function eE(e){let{sx:t,children:n}=e;return(0,c.jsx)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",...t},children:(0,c.jsx)(I.Z,{alignSelf:"center",display:"inline-block",textAlign:"center",children:n})})}function eP(e){let{sx:t,children:n}=e;return(0,c.jsx)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",overflowY:"auto",overflowX:"hidden",display:"block",...t},children:n})}var eA=n(96044);function eR(e){var t;let{ref:n,inView:o}=(0,eA.YD)({threshold:0}),i=(0,u.useRef)(null),r=null===(t=e.shadow)||void 0===t||t;(0,u.useEffect)(()=>{if(o)(0,m.r)(i.current)&&(i.current.complete?s():i.current.addEventListener("load",s));else{var e;null===(e=i.current)||void 0===e||e.removeEventListener("load",s)}},[o,i]);let s=(0,u.useCallback)(()=>{ec.Z.emit({type:ec.M.Request_SlideRefresh})},[e.src]);return(0,c.jsx)(T.Z,{ref:n,sx:{width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center"},children:(0,c.jsx)("img",{ref:i,className:r?"shadow":"",alt:e.alt,style:{objectFit:"contain",marginLeft:"auto",marginRight:"auto",borderRadius:"0.5rem",...e.style},src:e.src})})}function eB(e){let[t,n]=(0,u.useState)(e.sideSx),[o,i]=(0,u.useState)(e.mainSx);return(0,u.useEffect)(()=>{void 0!==e.sideBackgroundImage&&n({backgroundImage:"url(".concat(e.sideBackgroundImage,")"),...e.sideSx}),void 0!==e.mainBackgroundImage&&i({backgroundImage:"url(".concat(e.mainBackgroundImage,")"),...e.mainSx})},[e.sideBackgroundImage,e.mainBackgroundImage,e.sideSx,e.mainSx]),(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},children:[(0,c.jsx)(I.Z,{sx:{width:"35%",display:"block",...e.sideSx},children:e.side}),(0,c.jsx)(I.Z,{sx:{px:2,alignSelf:"stretch",display:"block",overflowY:"auto",width:"60%",...e.mainSx},children:e.main})]})})}function eT(e){let t={backgroundImage:"url('".concat(e.src,"')")};return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"block",...t,...e.sx},children:e.children})})}function eF(e){let t={textWrap:"balance",...e.sx,color:e.color};return(0,c.jsx)(B.Z,{variant:e.variant,component:"div",sx:t,align:e.align,children:e.children})}function eq(e){let t=(0,A.Z)(),n=void 0===e.chartBackground||e.chartBackground;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1,overflowY:"hidden"},children:[e.title&&(0,c.jsx)(eF,{color:e.color,variant:"summaryTitle",sx:{p:0,px:1,textWrap:"balance"},align:"left",children:e.title}),e.prompt&&(0,c.jsx)(eF,{color:e.color,variant:"summaryPrompt",sx:{p:0,px:1,textWrap:"balance"},align:"left",children:e.prompt}),(0,c.jsx)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",gap:1,alignItems:"stretch",overflowY:"hidden"},children:e.children.map((e,o)=>(0,c.jsx)(I.Z,{sx:{background:n?t.palette.summaryChartBackground.main:void 0,borderRadius:n?4:void 0,flexGrow:1,flexBasis:0,p:2,display:"block",overflow:"auto"},children:e},"summary-slide-child-".concat(o)))})]})})}function eM(e){return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("img",{src:e.src,style:e.style,alt:e.alt})})}function e_(e){var t;let{content:n,sx:o}=e;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",...o},children:[(0,c.jsx)(B.Z,{variant:"slideHeading",children:null!==(t=n.message)&&void 0!==t?t:"Thanks!"}),n.factoid&&(0,c.jsx)(B.Z,{variant:"slideBody",sx:{mt:8},children:n.factoid})]})})}var eN=n(12569);let eO=e=>{let t=parseInt(e.replace("#",""),16);return[t>>16&255,t>>8&255,255&t]},eW=(e,t,n,o)=>{let i=eO(n),r=eO(o),s=Math.round(i[0]+(r[0]-i[0])*e/t),a=Math.round(i[1]+(r[1]-i[1])*e/t),l=Math.round(i[2]+(r[2]-i[2])*e/t);return"rgb(".concat(s,",").concat(a,",").concat(l,")")},eK=e=>{let t={};return e.forEach(e=>{var n;null===(n=e.jsonValue)||void 0===n||n.answers.forEach(e=>{var n;let o=e.key,i=null!==(n=e.numericValue)&&void 0!==n?n:0;t.hasOwnProperty(o)||(t[o]=0),t[o]+=i})}),t},eL=(e,t)=>Object.entries(eK(e)).map(e=>{var n,o,i;return{key:e[0],title:null!==(i=null===(n=t.find(t=>t.key===e[0]))||void 0===n?void 0:n.title)&&void 0!==i?i:"",description:null===(o=t.find(t=>t.key===e[0]))||void 0===o?void 0:o.description,value:e[1]}});function eU(e){let{answers:t}=(0,Z.ZP)(e.qids.qid),[n,o]=(0,u.useState)([]),[i,r]=(0,u.useState)([]),[s,a]=(0,u.useState)([]),l=(0,A.Z)();return(0,u.useEffect)(()=>{o(null!=t?t:[])},[t]),(0,u.useEffect)(()=>{r(eL(n,e.options))},[n,e.options]),(0,u.useEffect)(()=>{var t;let n=l.palette.secondary.main,o=null!==(t=e.mode)&&void 0!==t?t:"normal",r=i.sort((e,t)=>e.value-t.value);"normal"===o&&(r=r.reverse()),a([...r.map((t,o)=>{var r,s;return{backgroundColor:eW(o,i.length,null!==(r=e.startColour)&&void 0!==r?r:n,null!==(s=e.endColour)&&void 0!==s?s:"#FFFFFF"),textColor:"#000000",option:t}})])},[i,e.startColour,e.endColour,l.palette.secondary.main,e.mode]),(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",flexDirection:"column",display:"flex",gap:1},children:[e.question&&(0,c.jsx)(E.Z,{content:e.question}),(0,c.jsx)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",gap:1,justifyContent:"start"},children:s.map((t,n)=>(0,c.jsx)(I.Z,{sx:{backgroundColor:t.backgroundColor,color:t.textColor,borderRadius:2,display:"flex",flexDirection:"column",p:2},children:(0,c.jsxs)(B.Z,{variant:"orderedListItemTitle",align:"left",children:[n+1,". ",t.option.title]})},"ordered-display-".concat(e.qids.qid,"-option-").concat(t.option.key,"-").concat(n)))})]})})}function eV(e){let t=(0,A.Z)(),n=1===e.headings.filter(e=>e.expanded).length;return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e.question&&(0,c.jsx)(E.Z,{content:e.question,forceAlign:"left"}),e.headings.map((o,i)=>(0,c.jsxs)(I.Z,{sx:{flexGrow:o.expanded?1:void 0,flexBasis:o.expanded?0:void 0,display:"flex",flexDirection:"row",gap:2,p:2,alignItems:"stretch",backgroundColor:t.palette.summaryChartBackground.main,borderRadius:4},children:[o.expanded&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(I.Z,{sx:{display:"inline-block",borderRadius:2,flexGrow:0,flexShrink:0,flexBasis:n?"50%":"20%",backgroundImage:"url(".concat(o.graphic,")"),backgroundSize:"cover",backgroundPosition:"center",mr:2}}),(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"column",gap:2,alignSelf:"center"},children:[(0,c.jsx)(B.Z,{variant:"sectionHeadingTitle",align:"left",children:o.title}),o.description&&(0,c.jsx)(B.Z,{variant:"sectionHeadingDescription",align:"left",children:o.description})]})]}),!o.expanded&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(B.Z,{variant:"sectionHeadingTitleQuiet",align:"left",children:o.title})})]},"section-heading-".concat(e.uid,"-").concat(i)))]})})}function ez(e){let{answers:t}=(0,Z.ZP)(e.qids.qid),n=(0,A.Z)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",overflowX:"hidden",overflowY:"auto"},children:[e.question&&(0,c.jsx)(E.Z,{content:e.question}),(0,c.jsx)(I.Z,{display:"flex",flexDirection:"column",alignItems:"center",children:t.map((t,o)=>{var i;return(0,c.jsx)(c.Fragment,{children:null===(i=t.jsonValue)||void 0===i?void 0:i.answers.map(t=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{sx:{mb:4,px:2,mx:8},className:"shadow",style:{background:"white",border:"solid 2px",borderColor:o%2==0?n.palette.primary.main:n.palette.secondary.main,borderRadius:12,transform:"rotate(".concat(o%2==0?1.5:-1.5,"deg)")},children:(0,c.jsx)(B.Z,{variant:"slideBody",children:t.stringValue})},"speech-bubble-".concat(e.qids.qid,"-").concat(t.key))}))})})})]})})}var eH=n(73391);let eG=(e,t)=>{if(!e||0===e.length)return[];let n=new Map;return e.forEach(e=>{var t;null===(t=e.jsonValue)||void 0===t||t.answers.forEach(e=>{var t;let o=e.key,i=null!==(t=e.numericValue)&&void 0!==t?t:0;n.has(o)||n.set(o,0),n.set(o,n.get(o)+i)})}),Array.from(n.entries()).sort((e,t)=>e[1]-t[1]).reverse().slice(0,t).map(e=>({key:e[0],count:e[1]}))},eJ=(e,t)=>e&&0!==e.length?t&&0!==t.length?e.map(n=>{let o=t.find(e=>e.key===n.key);if(!o){console.warn("No description found for option: ".concat(n.key),e,t);return}return{key:n.key,title:o.title,description:o.description,graphic:o.graphic,count:n.count}}).filter(e=>!!e).map(e=>e):(console.warn("No described options available"),[]):[];function eY(e){let{answers:t}=(0,Z.ZP)(e.qids.qid),[n,o]=(0,u.useState)([]),[i,r]=(0,u.useState)([]);(0,u.useEffect)(()=>{o(eG(t,e.displayCount))},[t,e.displayCount]),(0,u.useEffect)(()=>{r(eJ(n,e.options))},[n,e.options]);let s=(0,A.Z)();return(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[e.question&&(0,c.jsx)(E.Z,{content:e.question}),(0,c.jsx)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"stretch",gap:1},children:i.map((t,n)=>(0,c.jsxs)(I.Z,{sx:{flexGrow:1,flexBasis:0,p:2,borderRadius:2,background:s.palette.summaryChartBackground.main,display:"flex",flexDirection:"column",gap:1,mt:2*n},children:[(0,c.jsx)(B.Z,{variant:"topOptionsOptionRank",align:"left",children:(0,eH.q)(n+1)}),(0,c.jsxs)(B.Z,{variant:"topOptionsOptionPoints",align:"left",children:["Total points: ",t.count]}),(0,c.jsx)(I.Z,{sx:{width:"10%",height:0,border:"4px solid black",borderRadius:"4px",mt:1,mb:3}}),(0,c.jsx)(B.Z,{variant:"topOptionsOptionTitle",align:"left",children:t.title}),void 0!==t.graphic&&(0,c.jsx)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"end"},children:(0,c.jsx)(I.Z,{sx:{maxHeight:"20vh",height:"20vh",backgroundImage:"url(".concat(t.graphic,")"),backgroundSize:"cover",backgroundPosition:"center",borderRadius:2}})},"".concat(e.qids.qid,"-top-option-").concat(n,"-graphic-").concat(t.key))]},"".concat(e.qids.qid,"-top-option-").concat(n,"-description-").concat(t.key)))})]})}function eQ(e){let t=(0,A.Z)();return(0,c.jsxs)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,c.jsxs)(I.Z,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,c.jsx)("img",{src:"/icons/updown/qmark.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,c.jsx)(eF,{variant:"upDownCategory",children:e.divisiveDescription})]}),e.mostDivisive.map((e,n)=>(0,c.jsx)(eF,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDivided.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-divisive-".concat(n,"-qid-").concat(e.qid,"-entry")))]}),(0,c.jsxs)(I.Z,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,c.jsx)("img",{src:"/icons/updown/check.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,c.jsx)(eF,{variant:"upDownCategory",children:e.supportedDescription})]}),e.mostlySupported.map((e,n)=>(0,c.jsx)(eF,{variant:"upDownQuestion",sx:{background:t.palette.backgroundAgree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-supported-".concat(n,"-qid-").concat(e.qid,"-entry")))]}),(0,c.jsxs)(I.Z,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,c.jsx)("img",{src:"/icons/updown/cross.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,c.jsx)(eF,{variant:"upDownCategory",children:e.opposedDescription})]}),e.mostlyOpposed.map((e,n)=>(0,c.jsx)(eF,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDisagree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-disagreed-".concat(n,"-qid-").concat(e.qid,"-entry")))]})]})}function eX(e){let t=(0,A.Z)(),n=t.palette.secondary.main;return(0,c.jsx)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:(0,c.jsx)(I.Z,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",py:2},children:e.ordered.map((t,o)=>(0,c.jsxs)(eF,{variant:"orderedListItemTitle",sx:{background:eW(o,e.ordered.length,n,"#FFFFFF"),borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:[o+1,". ",t.assertion," ",0==o&&"(highest)",o==e.ordered.length-1&&"(lowest)"]},"summary-updown-ordered-".concat(o,"-qid-").concat(t.qid,"-entry")))})})}function e$(e){let t=(0,A.Z)();return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:(0,c.jsxs)(R.ZP,{container:!0,flexGrow:1,children:[(0,c.jsx)(R.ZP,{item:!0,xs:12,sx:{pb:1},children:(0,c.jsxs)(I.Z,{sx:{height:"100%",width:"100%",background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",overflowX:"hidden",overflowY:"auto"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,c.jsx)("img",{src:"/icons/updown/qmark.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,c.jsx)(eF,{variant:"upDownCategory",children:e.divisiveDescription})]}),e.mostDivisive.map((e,n)=>(0,c.jsx)(eF,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDivided.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-divisive-".concat(n,"-qid-").concat(e.qid,"-entry")))]})}),(0,c.jsx)(R.ZP,{item:!0,xs:6,sx:{pr:1},children:(0,c.jsxs)(I.Z,{sx:{height:"100%",width:"100%",background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",overflowX:"hidden",overflowY:"auto"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,c.jsx)("img",{src:"/icons/updown/check.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,c.jsx)(eF,{variant:"upDownCategory",children:e.supportedDescription})]}),e.mostlySupported.map((e,n)=>(0,c.jsx)(eF,{variant:"upDownQuestion",sx:{background:t.palette.backgroundAgree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-supported-".concat(n,"-qid-").concat(e.qid,"-entry")))]})}),(0,c.jsx)(R.ZP,{item:!0,xs:6,sx:{p:0},children:(0,c.jsxs)(I.Z,{sx:{height:"100%",width:"100%",background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",overflowX:"hidden",overflowY:"auto"},children:[(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,c.jsx)("img",{src:"/icons/updown/cross.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,c.jsx)(eF,{variant:"upDownCategory",children:e.opposedDescription})]}),e.mostlyOpposed.map((e,n)=>(0,c.jsx)(eF,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDisagree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-opposed-".concat(n,"-qid-").concat(e.qid,"-entry")))]})})]})})})}function e0(e){let{allAnswers:t}=(0,Z.ZP)(),[n,o]=(0,u.useState)([]),[i,r]=(0,u.useState)([]),[s,a]=(0,u.useState)([]),[l,d]=(0,u.useState)([]),[p,h]=(0,u.useState)([]);return(0,u.useEffect)(()=>{let n=[],i=[],s=[],l=[],c=[];Object.entries(t).forEach(t=>{let[o,r]=t;if(void 0!==Object.keys(e.questions).find(e=>e===o)){let t=r.filter(e=>{var t,n;return(null===(n=e.jsonValue)||void 0===n?void 0:null===(t=n.answers[0])||void 0===t?void 0:t.numericValue)!==void 0&&(0,eC.EV)(e.jsonValue.answers[0].numericValue)===eC.l$.Yes}).length,a=r.filter(e=>{var t,n;return(null===(n=e.jsonValue)||void 0===n?void 0:null===(t=n.answers[0])||void 0===t?void 0:t.numericValue)!==void 0&&(0,eC.EV)(e.jsonValue.answers[0].numericValue)===eC.l$.No}).length,d=r.filter(e=>{var t,n;return(null===(n=e.jsonValue)||void 0===n?void 0:null===(t=n.answers[0])||void 0===t?void 0:t.numericValue)!==void 0&&(0,eC.EV)(e.jsonValue.answers[0].numericValue)===eC.l$.Unsure}).length,u=e.questions[o].assertion,p={qid:o,assertion:u,yes:t,no:a,unsure:d,score:t-a},h=t+a;h>0?t>=2*h/3?n=[...n,p]:a>=2*h/3?i=[...i,p]:s=[...s,p]:l=[...l,p],c.push(p)}}),c.sort((e,t)=>t.score-e.score),r(n),a(i),o(s),d(l),h(c)},[t,e.questions]),(0,c.jsxs)(c.Fragment,{children:["tshape"===e.layout&&(0,c.jsx)(e$,{mostDivisive:n,mostlySupported:i,mostlyOpposed:s,unanswered:l,ordered:p,divisiveDescription:e.divisiveDescription,supportedDescription:e.supportedDescription,opposedDescription:e.opposedDescription,unansweredDescription:e.unansweredDescription}),"column"===e.layout&&(0,c.jsx)(eQ,{mostDivisive:n,mostlySupported:i,mostlyOpposed:s,unanswered:l,ordered:p,divisiveDescription:e.divisiveDescription,supportedDescription:e.supportedDescription,opposedDescription:e.opposedDescription,unansweredDescription:e.unansweredDescription}),"ordered"===e.layout&&(0,c.jsx)(eX,{mostDivisive:n,mostlySupported:i,mostlyOpposed:s,unanswered:l,ordered:p,divisiveDescription:e.divisiveDescription,supportedDescription:e.supportedDescription,opposedDescription:e.opposedDescription,unansweredDescription:e.unansweredDescription})]})}var e1=n(59143),e2=n(48235),e5=n(58237),e3=n(5994),e4=n(22790),e8=n(91533),e6=n(2774),e7=n(76377);function e9(e){let t=(0,ep.Z)();return(0,c.jsxs)(T.Z,{sx:{alignItems:"center",border:"1px solid ".concat(t.palette.rankingBreakdownBoxBorder.main),borderRadius:"5px",display:"flex",flexDirection:"row",gap:"0.15rem",padding:"0 0.2rem",minWidth:"2.75rem"},children:[e.vote===eC.l$.No&&(0,c.jsxs)(c.Fragment,{children:["arrow"===e.style&&(0,c.jsx)(e1.Z,{htmlColor:t.palette.rankingBarNegative.main}),"icon"===e.style&&(0,c.jsx)(e5.Z,{htmlColor:t.palette.rankingBarNegative.main}),"thumb"===e.style&&(0,c.jsx)(e6.Z,{htmlColor:t.palette.rankingBarNegative.main})]}),e.vote===eC.l$.Unsure&&(0,c.jsxs)(c.Fragment,{children:["arrow"===e.style&&(0,c.jsx)(e8.Z,{htmlColor:t.palette.rankingBarNeutral.main}),"icon"===e.style&&(0,c.jsx)(e4.Z,{htmlColor:t.palette.rankingBarNeutral.main}),"thumb"===e.style&&(0,c.jsx)(e8.Z,{htmlColor:t.palette.rankingBarNeutral.main})]}),e.vote===eC.l$.Yes&&(0,c.jsxs)(c.Fragment,{children:["arrow"===e.style&&(0,c.jsx)(e2.Z,{htmlColor:t.palette.rankingBreakdownArrowPositive.main}),"icon"===e.style&&(0,c.jsx)(e3.Z,{htmlColor:t.palette.rankingBreakdownArrowPositive.main}),"thumb"===e.style&&(0,c.jsx)(e7.Z,{htmlColor:t.palette.rankingBreakdownArrowPositive.main})]}),(0,c.jsx)(B.Z,{variant:"body1",sx:{margin:"0 !important"},children:e.count})]})}function te(e){return(0,c.jsx)(T.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row",height:"2.5rem",marginRight:"0.25rem"},children:(0,c.jsxs)(T.Z,{sx:{display:"flex",flexDirection:"row",gap:"0.25rem",height:"1.75rem",userSelect:"none"},children:[(0,c.jsx)(e9,{style:"arrow",count:e.answer.no,vote:eC.l$.No}),(0,c.jsx)(e9,{style:"arrow",count:e.answer.unsure,vote:eC.l$.Unsure}),(0,c.jsx)(e9,{style:"arrow",count:e.answer.yes,vote:eC.l$.Yes})]})})}function tt(e){let t=(0,ep.Z)();return(0,c.jsxs)(T.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row",marginRight:"0.25rem"},children:[(0,c.jsx)(te,{answer:e.answer}),(0,c.jsx)(T.Z,{sx:{alignItems:"center",backgroundColor:"color-mix(in srgb, ".concat(0!==e.answer.score?e.answer.score>0?t.palette.rankingBreakdownArrowPositive.main:t.palette.rankingBarNegative.main:t.palette.rankingBarNeutral.main,", transparent 80%)"),border:"1px solid ".concat(0!==e.answer.score?e.answer.score>0?t.palette.rankingBreakdownArrowPositive.main:t.palette.rankingBarNegative.main:t.palette.rankingBarNeutral.main),borderRadius:"50%",display:"flex",flexDirection:"row",height:"2rem",justifyContent:"center",width:"2rem"},children:(0,c.jsx)(B.Z,{sx:{color:t.palette.rankingBarBorder.main,margin:"0 !important",textAlign:"center",userSelect:"none"},variant:"body1",children:to(e.answer.score)})})]})}function tn(e){let t=(0,ep.Z)(),n="1.5rem",o="10rem";if(void 0===e.highestScore||void 0===e.lowestScore)return null;{let i=Math.abs(e.answer.score);0===i&&(i=1);let r=e.highestScore;Math.abs(e.lowestScore)>e.highestScore?r=Math.abs(e.lowestScore):0===e.lowestScore&&0===e.highestScore&&(r=4);let s="".concat(i/r*50,"%");return(0,c.jsxs)(T.Z,{sx:{backgroundColor:t.palette.rankingBarBackground.main,border:"".concat("1px"," solid ").concat(t.palette.rankingBarBorder.main),borderRadius:"5px",height:"calc(".concat(n," + (2 * ").concat("1px","))"),marginRight:"0.25rem",overflow:"hidden",width:"calc(".concat(o," + (2 * ").concat("1px","))")},children:[(0,c.jsx)(T.Z,{sx:{backgroundColor:"".concat(0!==e.answer.score?e.answer.score>0?t.palette.rankingBarPositive.main:t.palette.rankingBarNegative.main:t.palette.rankingBarNeutral.main),height:"".concat(n),position:"relative",left:"".concat(0!==e.answer.score?e.answer.score>0?"calc(".concat(o," / 2)"):"calc((".concat(o," / 2) - ").concat(s,")"):"calc((".concat(o," / 2) - (").concat(s," / 2))")),width:"".concat(0===e.answer.score?"calc(".concat(s," + ").concat("1px",")"):"".concat(s))}}),(0,c.jsx)(T.Z,{sx:{backgroundColor:t.palette.rankingBarCentreLine.main,height:"".concat(n),left:"50%",position:"relative",top:"calc(-".concat(n,")"),width:"".concat("1px")}})]})}}let to=e=>"".concat(e>0?"+":"").concat(e);function ti(e){switch(e.visualisationType){case"bar-centre-scale":default:return(0,c.jsx)(tn,{answer:e.answer,highestScore:e.highestScore,lowestScore:e.lowestScore});case"breakdown-only":return(0,c.jsx)(te,{answer:e.answer});case"breakdown-with-score":return(0,c.jsx)(tt,{answer:e.answer})}}function tr(e){let t=(0,ep.Z)(),{allAnswers:n}=(0,Z.ZP)(),o=new RegExp("^".concat(e.qid).concat(eI.O,"[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$")),i=Object.entries(n).filter(e=>{let[t,n]=e;return o.test(t)});if(0===i.length)return null;let r=[];for(let t of i){let n=t[0].replace("".concat(e.qid).concat(eI.O),""),o=0,i=0,a=0,l=0;for(let e of t[1]){var s;let t=null===(s=e.jsonValue)||void 0===s?void 0:s.answers[0].numericValue;void 0!==t&&(o+=t,-1===t?a+=1:0===t?l+=1:1===t&&(i+=1))}r.push({originalAnswerId:n,score:o,yes:i,no:a,unsure:l})}r.sort((e,t)=>t.score-e.score);let a=r[r.length-1].score,l=r[0].score;return(0,c.jsx)(T.Z,{sx:{margin:"0.5rem auto 0 auto"},children:r.map((o,i)=>{var r;return(0,c.jsxs)(T.Z,{sx:{backgroundColor:"".concat(i%2!=0?t.palette.rankedListAltBackground.main:"none"),borderBottom:"1px solid ".concat(t.palette.rankedListItemBorder.main),display:"grid",gap:"0",gridTemplateColumns:"42rem 1fr",padding:"0.5rem 0"},children:[(0,c.jsx)(T.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,c.jsx)(B.Z,{sx:{margin:"0 !important",padding:"0 1rem 0 0.25rem",textAlign:"left"},children:null===(r=n[e.qid][n[e.qid].findIndex(e=>e.id===o.originalAnswerId)].jsonValue)||void 0===r?void 0:r.answers[0].stringValue})}),(0,c.jsx)(T.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"end"},children:(0,c.jsx)(ti,{answer:o,highestScore:l,lowestScore:a,visualisationType:e.visualisationType})})]},o.originalAnswerId)})})}var ts=n(11144),ta=n(67506),tl=n(1973),tc=n(76513),td=n(95114),tu=n(99128),tp=n(15536),th=n.n(tp),tf=n(70883),tx=n(31655);let tg=(e,t)=>{var n;return null===(n=t.find(t=>t.deviceId===e))||void 0===n?void 0:n.participantName};function tm(e){let{subscriptions:t,thisUser:n}=(0,u.useContext)(tf.l),{session:o}=(0,u.useContext)(ts.z),[i,r]=(0,u.useState)({}),[s,a]=(0,u.useState)({});(0,u.useEffect)(()=>{var t,n,i;r(null!==(i=JSON.parse(null!==(n=null===(t=o.liveExperienceState)||void 0===t?void 0:t.videoReadinessJson)&&void 0!==n?n:"{}")[e.videoId])&&void 0!==i?i:{})},[o.liveExperienceState]),(0,u.useEffect)(()=>{a(Object.fromEntries(t.filter(e=>e.deviceId!==(null==n?void 0:n.deviceId)).map(e=>e.deviceId).map(e=>[e,e in i?i[e]:void 0])))},[i,t]);let l=e=>void 0===e?"gray":e?"green":"red",d=e=>void 0===e?"checking":e?"ready":"not ready yet";return(0,c.jsxs)(c.Fragment,{children:[Object.entries(s).some(e=>!0!==e[1])&&(0,c.jsxs)(B.Z,{variant:"body2",color:"black",component:"div",children:[" ",(0,c.jsx)(S.Z,{i18nKey:"video.notAllReady"})]}),(0,c.jsx)(I.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",gap:1},children:Object.entries(s).map((n,o)=>{var i;return(0,c.jsx)(tx.Z,{title:"".concat(null!==(i=tg(n[0],t))&&void 0!==i?i:"Unknown"," (").concat(d(n[1]),")"),children:(0,c.jsx)(I.Z,{sx:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",borderColor:l(n[1]),borderWidth:"2px",borderStyle:"solid",backgroundColor:!0===n[1]?l(n[1]):"transparent"}})},"video-".concat(e.videoId,"-readiness-").concat(o,"-").concat(n[0]))})})]})}var tv=n(40395),tb=n(63858);let ty=(e,t,n,o,i)=>e!==g.tB.Playing&&!t&&n!==g._b.Controller&&o&&tb.G6&&i,tw=(e,t,n)=>t===g._b.Controller||e||!n||!tb.G6;function tj(e){let{api:t,start:n}=(0,u.useContext)(tl.E),[o,i]=(0,u.useState)(tw(e.playedOnce,e.role,e.audio)),[r,s]=(0,u.useState)(!1),[a,l]=(0,u.useState)(!1),[d,p]=(0,u.useState)(!1);(0,u.useEffect)(()=>{i(tw(e.playedOnce,e.role,e.audio))},[e.playedOnce,e.role,e.audio,e.inView]),(0,u.useEffect)(()=>{e.setMayPlay(o)},[e.setMayPlay,o]),(0,u.useEffect)(()=>{s(ty(e.playMode,o,e.role,e.audio,e.inView))},[e.playMode,o,e.role,e.audio,e.inView]),(0,u.useEffect)(()=>{e.role===g._b.Client&&e.inView&&h(o)},[o,e.inView,e.role]);let h=async o=>{let i={action:"video-readiness-update",sessionId:e.sessionId,deviceId:e.deviceId,ticks:Date.now(),parameters:{videoId:e.videoId,ready:o}};try{l(!0),await n(t.postParticipantAction(e.sessionToken,i,!1))}catch(e){console.error(e),p(!0)}finally{l(!1)}},f=async e=>{try{await x()}catch(e){console.error(e),i(!1),p(!0)}};(0,u.useEffect)(()=>{e.setShowActivationFailed(d),e.setOverrideControls(d)},[d]);let x=async()=>{if(!(0,m.r)(e.playerRef.current))throw Error("Unable to activate video: Player not ready");try{await e.playerRef.current.play(),e.playerRef.current.pause()}catch(e){throw console.error(e),Error("Failed to activate video")}};return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(tv.Z,{open:e.inView&&r,setOpen:s,onSelect:f,dismissible:!1,showCloseButton:!1,title:"Ready for video?",prompt:"Please let us know when you are ready to watch the video.",promptGraphicUri:e.posterUri,options:[{key:"ready",text:"Ready",filled:!0}],busy:a})})}function tk(e){let{toServerTime:t,fromServerTime:n}=(0,u.useContext)(ta.G),{sid:o}=(0,u.useContext)(nx),{api:i,start:r}=(0,u.useContext)(tl.E),{user:s,sessionToken:a,role:l,deviceId:d}=(0,u.useContext)(C.rZ),{session:p}=(0,u.useContext)(ts.z),h=(0,u.useRef)(null),[f,x]=(0,u.useState)(!1),{ref:v,inView:b}=(0,eA.YD)({threshold:0}),[y,w]=(0,u.useState)(!1),[j,k]=(0,u.useState)(0),[Z,D]=(0,u.useState)(g.tB.NotStarted),E=(0,u.useRef)(),[P,A]=(0,u.useState)(0),[R,T]=(0,u.useState)(),[F,q]=(0,u.useState)(),M=(0,u.useRef)((0,tc.g)(p.liveExperienceState.originatorTimestampsJson)),_=(0,u.useRef)(p.liveExperienceState.originator),[N,O]=(0,u.useState)(!1),[W,K]=(0,u.useState)(!1),[L,U]=(0,u.useState)(!1),[V,H]=(0,u.useState)(!1),[G,J]=(0,u.useState)(!1),Y=(0,u.useContext)(td.Nx);(0,u.useEffect)(()=>{(0,m.r)(h.current)&&(h.current.addEventListener("play",e=>{O(!0),D(g.tB.Playing)}),h.current.addEventListener("pause",e=>{D(g.tB.Paused)}),h.current.addEventListener("ended",e=>{D(g.tB.Ended)}),document.addEventListener("visibilitychange",()=>w("visible"===document.visibilityState)),w("visible"===document.visibilityState))},[h]),(0,u.useEffect)(()=>{if((0,m.r)(h.current)&&(0,m.r)(null==Y?void 0:Y.state.current.audioOutputDevice)){if((0,m.r)(h.current.setSinkId))try{h.current.setSinkId(Y.state.current.audioOutputDevice)}catch(e){console.warn("Error setting audio output device for SimplifiedVideoSlide",e)}else console.debug("Audio.setSinkId not defined")}},[h,null==Y?void 0:Y.state.current.audioOutputDevice]),(0,u.useEffect)(()=>{b?(k(1),Q().then(()=>{k(2)}).catch(e=>{console.error(e),k(3)}).finally(()=>{er(),O(!1),D(g.tB.Paused)})):X().then(()=>{k(0)}).catch(e=>{console.error(e),k(3)}).finally(()=>{er(),O(!1),D(g.tB.NotStarted),l===g._b.Controller&&$(g.tB.NotStarted)})},[b]),(0,u.useEffect)(()=>{U(l!=g._b.Controller&&Z!==g.tB.Playing)},[l,Z]);let Q=async()=>{if(!(0,m.r)(h.current))throw Error("Player not ready to load video");console.debug("Loading video ".concat(e.videoId)),h.current.setAttribute("src",e.videoUri),h.current.load()},X=async()=>{if(null===h.current)throw Error("Player not ready");console.debug("Unloading video ".concat(e.videoId)),h.current.removeAttribute("src"),h.current.load()},$=async(n,l)=>{if(null===h.current)throw Error("Player not ready");try{x(!0);let c=h.current.currentTime,u={sessionId:o,videoId:e.videoId,modeChange:n,modeChangePosition_s:n===g.tB.NotStarted?0:c,modeChangeServerTime_ms:t(null!=l?l:Date.now())},p={action:"set-video-sync",sessionId:o,parameters:u,originator:d,ticks:Date.now()};await r(i.postFacilitatorAction(s.access_token,a,p,!1))}catch(e){console.error("sync error",e)}finally{x(!1)}},ee=e=>{if(!(0,m.r)(h.current)){console.warn("Video player not ready for user interactions");return}switch(e){case"restart":h.current.currentTime=0,h.current.pause(),$(g.tB.NotStarted),ei();break;case"back":h.current.currentTime-=15,h.current.pause(),$(g.tB.Paused),ei();break;case"play-pause":Z===g.tB.Playing?$(g.tB.Paused):$(g.tB.Playing,Date.now()+2e3);break;case"fwd":h.current.currentTime+=15,h.current.pause(),$(g.tB.Paused),ei()}};(0,u.useEffect)(()=>{let t=p.liveExperienceState,n=t.originator,o=(0,tc.g)(t.originatorTimestampsJson);void 0===_||_.current;let i=void 0===M.current[n]||o[n]>M.current[n];if(!(0,m.r)(F)||i){_.current=n,M.current=o;let i=t.videoSync.find(t=>t.videoId===e.videoId);(0,m.r)(i)&&et(F,i)&&q(i)}},[p.liveExperienceState]);let et=(e,t)=>!!th()(e)||e.modeChange!==t.modeChange||e.modeChangePosition_s!==t.modeChangePosition_s||e.modeChangeServerTime_ms!==t.modeChangeServerTime_ms;(0,u.useEffect)(()=>{2===j&&(ei(),b&&(0,m.r)(F)&&G&&en(F))},[j,b,F,Z,G]);let en=e=>{if((0,m.r)(h.current)||console.warn("Video player not ready to enact sync"),void 0!==R&&(clearTimeout(R),T(void 0)),e.modeChange!==g.tB.Playing){eo(e);return}let t=n(e.modeChangeServerTime_ms)-Date.now();console.debug("Video sync scheduled for "+t+"ms");let o=t<0?Math.abs(t/1e3):0,i={...e,modeChangePosition_s:e.modeChangePosition_s+o},r=setTimeout(()=>{T(void 0),eo(i)},Math.max(0,t));T(r)},eo=e=>{if(null===h.current){console.warn("Player not ready to enact sync");return}console.debug("Video sync enaction: ".concat(g.tB[e.modeChange]," at ").concat(e.modeChangePosition_s,"s"));let t=Math.min(Math.round((e.modeChangePosition_s+Number.EPSILON)*1e3)/1e3,isFinite(h.current.duration)?h.current.duration:0);console.debug("newPosition",t),console.debug("duration",h.current.duration),h.current.currentTime=t,e.modeChange===g.tB.Playing&&h.current.currentTime<h.current.duration?h.current.play():h.current.pause()};(0,u.useEffect)(()=>{let t={type:ec.M.Media_Playback_Update,data:{muteFacilitator:e.muteFacilitator,videoId:e.videoId,isPlaying:Z===g.tB.Playing}};ec.Z.emit(t),ei(),void 0!==E.current&&(clearInterval(E.current),E.current=void 0),Z===g.tB.Playing&&void 0===E.current&&(E.current=setInterval(()=>{Z===g.tB.Playing?ei():(0,m.r)(E.current)&&(clearInterval(E.current),E.current=void 0)},100))},[Z,e.videoId]);let ei=()=>{(0,m.r)(h.current)?A(h.current.currentTime/h.current.duration*100):console.warn("Player not ready to update progress bar")},er=()=>{A(0)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(tj,{role:l,videoId:e.videoId,audio:e.audio,inView:b,docVisible:y,state:j,playMode:Z,deviceId:d,sessionId:o,playedOnce:N,playerRef:h,sessionToken:a,setOverrideControls:K,setShowActivationFailed:H,setMayPlay:J,posterUri:e.posterUri}),(0,c.jsxs)(I.Z,{className:"stretch",ref:v,sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",gap:1,p:0},children:[3!==j&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},children:(0,c.jsxs)(I.Z,{sx:{position:"relative",flexGrow:1},children:[(0,c.jsxs)(I.Z,{sx:{position:"absolute",top:"100%",left:0,right:0},children:[L&&(0,c.jsx)(B.Z,{variant:"body2",color:"white",children:(0,c.jsx)(S.Z,{i18nKey:"video.videoReadiness"})}),V&&(0,c.jsx)(B.Z,{variant:"body2",color:"red",children:(0,c.jsx)(S.Z,{i18nKey:"video.videoInitFailed"})}),W&&(0,c.jsx)(B.Z,{variant:"body2",color:"red",children:(0,c.jsx)(S.Z,{i18nKey:"video.videoManualControl"})})]}),(0,c.jsx)("video",{ref:h,style:{width:"100%",height:"100%",borderRadius:"0.5rem",overflow:"hidden",objectFit:"contain",backgroundColor:"rgba(0,0,0,0.5)"},poster:e.posterUri,preload:"auto",loop:!1,autoPlay:!1,controls:W,disablePictureInPicture:!0,muted:!e.audio,crossOrigin:"anonymous",className:"shadow",playsInline:!0,"webkit-playsinline":"true"}),e.controls&&null!==h.current&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(I.Z,{sx:{position:"absolute",left:"50%",bottom:0},children:(0,c.jsxs)(I.Z,{sx:{position:"relative",left:"-50%",bottom:0,p:1,background:"rgba(255,255,255,0.75)",borderRadius:"0.5rem",alignSelf:"center",display:"flex",flexDirection:"column",gap:1},children:[(0,c.jsx)(tu.Z,{variant:1===j?"indeterminate":"determinate",value:P,color:1===j?"primary":"error"}),(0,c.jsxs)(I.Z,{sx:{display:"flex",flexDirection:"row",alignSelf:"stretch",justifyContent:"center",gap:1},children:[(0,c.jsx)(z.Z,{variant:"outlined",disabled:2!==j||f,btnKey:"restart",btnText:"Restart",onClick:ee}),(0,c.jsx)(z.Z,{variant:"outlined",disabled:2!==j||f,btnKey:"back",btnText:"-15s",onClick:ee}),(0,c.jsx)(z.Z,{disabled:2!==j||f,btnKey:"play-pause",variant:Z===g.tB.Playing?"outlined":"contained",busy:void 0!==R,btnText:Z===g.tB.Playing?"Pause":"Play",onClick:ee}),(0,c.jsx)(z.Z,{variant:"outlined",disabled:2!==j||f,btnKey:"fwd",btnText:"+15s",onClick:ee})]}),(0,c.jsx)(tm,{videoId:e.videoId})]})})})]})})}),3===j&&(0,c.jsx)("p",{children:(0,c.jsx)(S.Z,{i18nKey:"video.videoInitFailed"})})]})]})}(i=a||(a={}))[i.Unloaded=0]="Unloaded",i[i.Loading=1]="Loading",i[i.Ready=2]="Ready",i[i.Error=3]="Error";var tS=n(4766);function tZ(e){let{setAllSlideAnswerRules:t}=(0,tS.XU)(),[n,o]=(0,u.useState)(void 0);return(0,u.useEffect)(()=>{let t=[];e.children.forEach(e=>{(0,u.isValidElement)(e)&&e.props.qIds.qid&&t.push(e.props.qIds.qid)}),o(t)},[e.children]),(0,u.useEffect)(()=>{void 0!==n&&void 0!==t&&n.forEach(n=>{t(t=>({...t,[n]:function(e){let t={};return Object.entries(e).forEach(e=>{let[n,o]=e;"noselfvoting"===n&&"true"===o&&(t[n]=!0)}),t}(e.rules)}))})},[n,e.rules,t]),e.children}function tC(e){let{session:t}=(0,u.useContext)(ts.z);return t.remoteConfiguration===e.config?e.children:null}var tI=n(30089);let tD=e=>({replace:(t,n)=>tE(t,e)}),tE=(e,t)=>{if(e instanceof d.W_&&e.attribs){var n;let o;switch(e.tagName.toLowerCase()){case"sidebarlayout":o=t7(e,t);break;case"fullpagescrollinglayout":o=t9(e,t);break;case"fullpagecentredlayout":o=ne(e,t);break;case"columnlayout":o=nt(e,t);break;case"slidebackgroundimage":o=nn(e,t);break;case"imageslide":o=t4(e,t);break;case"videoslide":o=tM(e,t);break;case"summaryslidelayout":o=t_(e,t);break;case"sectionheading":o=ni(e,t);break;case"slidetext":o=nr(e,t);break;case"slideimage":case"img":o=ns(e,t);break;case"inputorcompletion":o=t8(e,t);break;case"inputsequence":o=t6(e,t);break;case"sliderinput":o=tN(e,t);break;case"textinput":o=tU(e,t);break;case"demographicinput":o=tG(e,t);break;case"updownvoteinput":o=tJ(e,t);break;case"updownvoteinputsequence":o=tY(e,t);break;case"closedchoiceinput":o=tQ(e,t);break;case"pointsallocationinput":o=tX(e,t);break;case"multisliderinput":o=t$(e,t);break;case"acknowledgementinput":o=t0(e,t);break;case"rankedlistinput":o=t1(e,t);break;case"consentinput":o=t2(e,t);break;case"completion":o=no(e,t);break;case"speechbubbles":o=tL(e,t);break;case"selectiongraph":o=tO(e,t);break;case"updownvoteresults":o=tW(e,t);break;case"updownvoteresultsrankedlist":o=tK(e,t);break;case"topoptions":o=t5(e,t);break;case"orderedlist":o=t3(e,t);break;case"answerrules":o=tF(e,t);break;case"remoteconfiguration":o=tq(e,t);break;default:return e}return null!==(n=(0,tI.te)(o,t.keyPrefix))&&void 0!==n?n:o}},tP=(e,t)=>{let n=e.children.map((e,n)=>tD(t).replace(e,n)).filter(e=>null!=e&&!1!==e).map(e=>e instanceof d.W_?(0,d.du)([e],tD(t)):e);return u.Children.toArray(n)},tA=e=>{let t=[];for(let n of e.children)if(n instanceof d.W_&&"option"===n.tagName){let e=n.attribs.key,o=n.attribs.title,i=n.attribs.description;if(e&&o)t.push({key:e,title:o,description:i});else throw console.warn("KeyedOption option without key or title",n),"KeyedOption option without key or title"}return t},tR=(e,t)=>{let n=[];for(let o of e.children.filter(e=>e instanceof d.W_).map(e=>e))void 0!==o.attribs.qid?n.push(tB(t,o)):n=[...n,...tR(o,t)];return n},tB=(e,t)=>{let n=t.attribs.qid;if(void 0===n)throw console.error("Question id not found for element",t),"Question id not found for element";return{sid:e.sessionId,pid:e.deviceId,qid:n}},tT=e=>{var t,n;let o=e.attribs.instruction,i=null!==(n=null!==(t=e.attribs.question)&&void 0!==t?t:e.attribs.statement)&&void 0!==n?n:e.attribs.prompt,r=e.attribs.explanation,s=(0,x.gx)(e.attribs.pii);return o||i||r||void 0!==s?{instruction:o,question:i,explanation:r,pii:s}:void 0},tF=(e,t)=>{let n=e.attribs,o=tP(e,t);return(0,c.jsx)(tZ,{rules:n,children:o})},tq=(e,t)=>{let n=Number(e.attribs.config),o=tP(e,t);return(0,c.jsx)(tC,{config:n,children:o})},tM=(e,t)=>{var n;console.debug("Enriching VideoSlide tag as VideoSlide...",e);let o=e.attribs.id,i=e.attribs.videouri,r=e.attribs.posteruri,s=t.role===g._b.Controller,a=t.role===g._b.Controller||t.remoteMedia,l=null===(n=(0,x.$Q)(e.attribs["mute-facilitator"]))||void 0===n||n;return(0,c.jsx)(tk,{videoId:o,controls:s,audio:a,videoUri:i,posterUri:r,muteFacilitator:l})},t_=(e,t)=>{console.debug("Enriching SummarySlideLayout tag as SummarySlideLayout...",e);let n=e.attribs.color,o=e.attribs.title,i=e.attribs.prompt,r=void 0!==e.attribs.chartbackground?(0,x.gx)(e.attribs.chartbackground):void 0,s=tP(e,t);return(0,c.jsx)(eq,{color:n,title:o,prompt:i,chartBackground:r,children:s})},tN=(e,t)=>{var n;console.debug("Enriching SliderInput tag as SliderInput...",e);let o=tB(t,e),i=tT(e),r=(0,tI.av)(e.attribs.type),s=r===eS.Q.categorical?(0,tI.kh)(e.attribs.marks):void 0,a=r!==eS.Q.categorical?null===(n=(0,tI.kh)(e.attribs.range))||void 0===n?void 0:n.map(e=>(0,tI.f_)(e.trim())):void 0,l=r!==eS.Q.categorical?(0,tI.f_)(e.attribs.step):void 0,d=(0,x.gx)(e.attribs.showunsure);return(0,c.jsx)(eS.Z,{qids:o,role:t.role,type:r,marks:s,numericRange:a,numericStep:l,question:i,showUnsure:d,onAnswer:t.onAnswer})},tO=(e,t)=>{var n;console.debug("Enriching SelectionGraph tag as AnswerGraphMuiChart...",e);let o=tB(t,e),i=tT(e),r=(0,tI.yg)(e.attribs.orientation),s=(0,tI.ot)(e.attribs.type),a=null===(n=(0,tI.kh)(e.attribs.range))||void 0===n?void 0:n.map(e=>h().toNumber(e.trim())),l=(0,tI.tL)((0,tI.kh)(e.attribs.categories)),d={sortOn:e.attribs.sorton,sortOrder:e.attribs.sortorder},u=tA(e),p={left:e.attribs.marginleft?Number(e.attribs.marginleft):void 0},f=e.attribs.categorieslegendfontsize,x=e.attribs.valueslegendfontsize;if(o&&void 0!==s)return(0,c.jsx)(eN.Z,{role:t.role,qids:o,question:i,inputType:s,orientation:r,categories:l,sorting:d,range:a?{lo:a[0],hi:a[1],step:a[2]}:void 0,margin:p,categoriesLegendFontSize:f,valuesLegendFontSize:x,options:u});throw console.error("SelectionGraph without qIds, type, or range",e.attribs),"SelectionGraph without qIds, type, or range"},tW=(e,t)=>{console.debug("Enriching UpDownVoteResults tag as UpDownVoteResults...",e);let n=e.attribs.layout,o=e.attribs.divisivedescription,i=e.attribs.supporteddescription,r=e.attribs.opposeddescription,s=e.attribs.unanswereddescription,a={};for(let t of e.children)if(t instanceof d.W_&&"result"===t.tagName){let e=t.attribs.qid,n=t.attribs.assertion;void 0!==e&&(a[e]={assertion:n})}return(0,c.jsx)(e0,{questions:a,layout:n,divisiveDescription:null!=o?o:(0,c.jsx)(S.Z,{i18nKey:"upDownResult.divisiveDescription"}),supportedDescription:null!=i?i:(0,c.jsx)(S.Z,{i18nKey:"upDownResult.supportedDescription"}),opposedDescription:null!=r?r:(0,c.jsx)(S.Z,{i18nKey:"upDownResult.opposedDescription"}),unansweredDescription:null!=s?s:(0,c.jsx)(S.Z,{i18nKey:"upDownResult.unansweredDescription"})})},tK=(e,t)=>(console.debug("Enriching UpDownVoteResultsRankedList tag as UpDownVoteResultsRankedList...",e),(0,c.jsx)(tr,{qid:e.attribs.qid,visualisationType:e.attribs.visualisationtype})),tL=(e,t)=>{console.debug("Enriching SpeechBubbles tag as SpeechBubbles (with children)...",e);let n=tB(t,e),o=tT(e);return(0,c.jsx)(ez,{qids:n,question:o})},tU=(e,t)=>{var n;let o;console.debug("Enriching TextInput tag as TextInput...",e);let i=tB(t,e),r=tT(e),s=(0,tI.H7)(e.attribs.type),a=e.attribs.label,l=e.attribs.help,u=e.attribs.submittext,p=e.attribs.skiptext,f=h().parseInt(e.attribs.mincheckboxes),g=(0,x.gx)(null!==(n=e.attribs.textrequired)&&void 0!==n?n:"true"),m=[];for(let t of e.childNodes)if(t instanceof d.W_&&"information"===t.tagName&&(o={heading:t.attribs.heading,body:t.children}),t instanceof d.W_&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.text,o=(0,x.gx)(t.attribs.required);m.push({key:e,text:n,initial:!1,required:o,checked:!1})}let v=e.attribs.maxlength,b=e.attribs.minrows,y=(0,x.gx)(e.attribs.multiline),w=(0,x.gx)(e.attribs.fullheight);if(void 0===r||void 0===r.pii)throw"pii not defined for TextInput";return(0,c.jsx)(eZ.Z,{qids:i,role:t.role,type:s,label:a,help:l,textRequired:g,minCheckboxes:f,information:o,onAnswer:t.onAnswer,checkboxes:m,question:r,submitText:u,skipText:p,maxLength:v?Number(v):void 0,minRows:b?Number(b):void 0,multiline:y,fullHeight:w})},tV=e=>{let t=[];for(let n of e)if(n instanceof d.W_&&"demographicinputtype"===n.tagName){let e=n.attribs.key,o=n.attribs.label,i=n.attribs.layout,r=n.attribs.mode,s=n.attribs.textplaceholder,a=n.attribs.textvalidationregex,l=(0,x.LC)(n.attribs.textmaxlength),c=(0,x.LC)(n.attribs.columns),d=void 0!==c?{columns:c}:void 0,u=n.attribs.selectionquestion,p=n.attribs.selectionobject,h=n.attribs.selectionobject_plural,f={key:e,label:o,layout:i,layoutProps:d,groups:[],mode:r,textPlaceholder:s,textValidationRegex:a,textMaxLength:l,selectionQuestion:u,selectionObject:p,selectionObject_plural:h,selectionItemPrompt:n.attribs.selectionitemprompt,minSelections:(0,x.LC)(n.attribs.minselections),maxSelections:(0,x.LC)(n.attribs.maxselections)},{validations:g,requiredFields:m}=b(f);if(!0!==g)throw console.error("Invalid DemographicInputTypes",g),"Invalid DemographicInputTypes:\n"+g.join("\n");m.find(e=>"groups"===e)&&(f.groups=tz(n.children)),t.push(f)}return t},tz=e=>{let t=[];for(let n of e)if(n instanceof d.W_&&"demographicgroup"===n.tagName){let e=n.attribs.label;if(e){let o=tH(n.children);t.push({label:e,choices:o})}else throw console.warn("DemographicGroup without label",n),"DemographicGroup without label"}return t},tH=e=>{let t=[];for(let n of e)if(n instanceof d.W_&&"demographic"===n.tagName){let e=n.attribs.display,o=n.attribs.value;if(e&&o)t.push({display:e,key:o});else throw console.warn("Demographic without display or value",n),"Demographic without display or value"}return t},tG=(e,t)=>{console.debug("Enriching DemographicInput tag as DemographicInput...",e);let n=tB(t,e),o=tT(e),i=(0,x.gx)(e.attribs.showage),r=(0,x.gx)(e.attribs.showgender),s=(0,x.gx)(e.attribs.showethnicity),a=e.attribs.showpostcode,l=tV(e.children);return(0,c.jsx)(el,{role:t.role,qids:n,onAnswer:t.onAnswer,question:o,showAge:i,showGender:r,showEthnicity:s,showPostcode:a,customDemographics:l})},tJ=(e,t)=>{console.debug("Enriching UpDownVoteInput tag as UpDownVoteInput...",e);let n=tB(t,e),o=tT(e),i=e.attribs.assertion;return(0,c.jsx)(eC.ZP,{qids:n,role:t.role,question:o,assertion:i,onAnswer:t.onAnswer})},tY=(e,t)=>{console.debug("Enriching UpDownVoteInputSequence tag as UpDownVoteInputSequence...",e);let n=tB(t,e),o=tT(e),i=(0,x.gx)(e.attribs.showprogress),r=tP(e,t),s=r[r.length-1];return(0,c.jsx)(eI.Z,{completion:s,onAnswer:t.onAnswer,qIds:n,question:o,role:t.role,showProgress:i})},tQ=(e,t)=>{console.debug("Enriching ClosedChoiceInput tag as ClosedChoiceInput...",e);let n=tB(t,e),o=tT(e),i=parseInt(e.attribs.minselections),r=parseInt(e.attribs.maxselections),s=e.attribs.layout,a=e.attribs.layoutparams,l=a?(0,tI.kh)(a):[],u=[],p=(0,x.gx)(e.attribs.shuffle);for(let t of e.children)if(t instanceof d.W_&&"option"===t.tagName){let e=t.attribs["aria-label"],n=t.attribs.fontsize,o=t.attribs.value,i=t.attribs.display,r=t.attribs.graphic,s=(0,x.gx)(t.attribs.isalt);o&&i&&u.push({key:o,display:i,graphic:r,isAlt:s,ariaLabel:e,fontSize:n})}return(0,c.jsx)(W,{qids:n,role:t.role,question:o,options:u,shuffle:p,onAnswer:t.onAnswer,layout:s,layoutParams:l,minSelections:i,maxSelections:r,contentStore:t.contentStore})},tX=(e,t)=>{console.debug("Enriching PointsAllocationInput tag as PointsAllocationInput...",e);let n=tB(t,e),o=tT(e),i=parseInt(e.attribs.points),r=[];for(let t of e.children)if(t instanceof d.W_&&"option"===t.tagName){let e=t.attribs.title,n=t.attribs.description,o=t.attribs.key,i=parseInt(t.attribs.min),s=parseInt(t.attribs.max),a=t.attribs.graphic;if(e&&n&&o&&void 0!==i&&void 0!==s)r.push({title:e,description:n,key:o,min:i,max:s,graphic:a});else throw"PointsAllocationInput Option without title, description, key, min, or max"}return(0,c.jsx)(em,{qids:n,question:o,points:i,options:r,onAnswer:t.onAnswer})},t$=(e,t)=>{console.debug("Enriching MultiSliderInput tag as MultiSliderInput...",e);let n=tB(t,e),o=tT(e),i=parseInt(e.attribs.min),r=parseInt(e.attribs.max),s=[],a=[],l=Number(e.attribs.paddingX)||void 0,u=Number(e.attribs.rowspacing)||void 0,p=(0,x.gx)(e.attribs.showdescriptions);for(let t of e.children)if(t instanceof d.W_&&"label"===t.tagName){let e=parseFloat(t.attribs.at),n=t.attribs.text;void 0!==e&&n&&s.push({at:e,text:n})}else if(t instanceof d.W_&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.title,o=t.attribs.description;e&&n&&a.push({key:e,title:n,description:o})}return(0,c.jsx)(ex,{qids:n,question:o,min:i,max:r,labels:s,options:a,paddingX:l,rowSpacing:u,showDescriptions:p,role:t.role,onAnswer:t.onAnswer})},t0=(e,t)=>{console.debug("Enriching AcknowledgementInput tag as AcknowledgementInput...",e);let n=tB(t,e),o=tT(e),i=e.attribs.align,r=[];for(let t of e.children)if(t instanceof d.W_&&"option"===t.tagName){let e=t.attribs.text,n=t.attribs.key,o=t.attribs.variant,i=t.attribs.colour;e&&n&&r.push({text:e,key:n,variant:o,colour:i})}return(0,c.jsx)(P,{qids:n,question:o,options:r,align:i,onAnswer:t.onAnswer})},t1=(e,t)=>{console.debug("Enriching RankedListInput tag as RankedListInput...",e);let n=tB(t,e),o=tT(e),i=[],r=(0,x.gx)(e.attribs.shuffle),s=0;for(let t of e.children)if(t instanceof d.W_&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.title,o=t.attribs.description;n&&i.push({key:e,title:n,description:o,startingIndex:s++})}return(0,c.jsx)(ek,{qids:n,question:o,options:i,shuffle:r,onAnswer:t.onAnswer})},t2=(e,t)=>{console.debug("Enriching ConsentInput tag as ConsentInput...",e);let n=tB(t,e),o=tT(e),i=e.attribs.consenttext;return(0,c.jsx)(H,{qids:n,question:o,consentText:i,onAnswer:t.onAnswer,content:e.children})},t5=(e,t)=>{console.debug("Enriching TopOptions tag as TopOptionsSummary...",e);let n=tB(t,e),o=tT(e),i=parseInt(e.attribs.count),r=[];for(let t of e.children)if(t instanceof d.W_&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.title,o=t.attribs.description,i=t.attribs.graphic;e&&n&&o&&r.push({key:e,title:n,description:o,graphic:i})}return(0,c.jsx)(eY,{qids:n,question:o,options:r,displayCount:i})},t3=(e,t)=>{console.debug("Enriching OrderedList tag as OrderedListDisplay...",e);let n=tB(t,e),o=tT(e),i=e.attribs.startcolour,r=e.attribs.endcolour,s=e.attribs.mode,a=tA(e);return(0,c.jsx)(eU,{qids:n,question:o,options:a,role:t.role,startColour:i,endColour:r,mode:s})},t4=(e,t)=>{console.debug("Enriching ImageSlide tag as ImageSlide...",e);let n=e.attribs.src,o=e.attribs.alt,i=(0,tI.Cc)(e.attribs.style);return(0,c.jsx)(eR,{style:i,alt:o,src:n})},t8=(e,t)=>{let n=tP(e,t);console.debug("Enriching InputOrCompletion tag as InputOrCompletion (with children)...",n);let o=tB(t,e);return(0,c.jsx)(ed,{qids:o,input:n[0],completion:n[1]})},t6=(e,t)=>{let n=tP(e,t);console.debug("Enriching InputSequence tag as InputSequence (with children)...",n);let o=[];for(let e=0;e<n.length-1;e++)o.push(n[e]);let i=n[n.length-1],r=tT(e),s=(0,x.gx)(e.attribs.showprogress),a=tR(e,t);return(0,c.jsx)(eh,{question:r,showProgress:s,qids:a,inputs:o,completion:i,role:t.role})},t7=(e,t)=>{console.debug("Enriching SideBarLayout tag as SideBarLayout (with children)...",e);let n=tP(e,t),o=(0,tI.if)(e.attribs.sidestyle),i=(0,tI.if)(e.attribs.mainstyle),r=e.attribs.sidebackgroundimage,s=e.attribs.mainbackgroundimage;return(0,c.jsx)(eB,{side:n[0],sideSx:o,main:n[1],mainSx:i,sideBackgroundImage:r,mainBackgroundImage:s,contentStore:t.contentStore})},t9=(e,t)=>{console.debug("Enriching FullPageScrollingLayout tag as FullPageScrollingLayout (with children)...",e);let n=(0,tI.if)(e.attribs.sx),o=tP(e,t);return(0,c.jsx)(eP,{sx:n,children:o})},ne=(e,t)=>{console.debug("Enriching FullPageCentredLayout tag as FullPageCentredLayout (with children)...",e);let n=(0,tI.if)(e.attribs.sx),o=tP(e,t);return(0,c.jsx)(eE,{sx:n,children:o})},nt=(e,t)=>{console.debug("Enriching ColumnLayout tag as ColumnLayout (with children)...",e);let n=(0,tI.if)(e.attribs.sx),o=tP(e,t);return(0,c.jsx)(eD,{sx:n,children:o})},nn=(e,t)=>{console.debug("Enriching SlideBackgroundImage tag as SlideBackgroundImage (with children)...",e);let n=tP(e,t),o=e.attribs.src,i=(0,tI.if)(e.attribs.sx);return(0,c.jsx)(eT,{src:o,sx:i,children:n})},no=(e,t)=>{console.debug("Enriching Completion tag as CompletionDisplay (with children)...",e);let n=e.attribs.message,o=e.attribs.factoid,i=(0,tI.if)(e.attribs.sx);return(0,c.jsx)(e_,{content:{message:n,factoid:o},sx:i})},ni=(e,t)=>{console.debug("Enriching SectionHeading tag as SectionHeading...",e);let n=(0,f.Z)(),o=tT(e),i=[];for(let t of e.children)if(t instanceof d.W_&&"heading"===t.tagName){let e=t.attribs.title,n=t.attribs.description,o=t.attribs.graphic,r=(0,x.gx)(t.attribs.expanded);if(e)i.push({title:e,description:n,graphic:o,expanded:r});else throw console.warn("SectionHeading without title",t),"SectionHeading without title"}return(0,c.jsx)(eV,{question:o,headings:i,uid:n})},nr=(e,t)=>{console.debug("Enriching SlideText tag as SlideText (with children)...",e);let n=tP(e,t),o=(0,tI.if)(e.attribs.sx),i=e.attribs.color,r=e.attribs.align,s=e.attribs.variant;return(0,c.jsx)(eF,{variant:s,sx:o,color:i,align:r,children:n})},ns=(e,t)=>{console.debug("Enriching ImageSlide tag as ImageSlide...",e);let n=e.attribs.src,o=(0,tI.Cc)(e.attribs.style);return(0,c.jsx)(eM,{src:n,style:o})},na=["src","graphic","videoUri","posterUri","sideBackgroundImage","mainBackgroundImage","data-background-image"],nl=["style","sideStyle","mainStyle"];class nc{getAsSectionTags(e,t){let n=new DOMParser().parseFromString(e,"text/xml").getElementsByTagName("section"),o=[];console.debug("Module ".concat(t," contains ").concat(n.length," sections."));for(let e=0;e<n.length;e++){let i=n.item(e);i&&i.setAttribute("key","module-".concat(t,"-section-").concat(e));let r=new XMLSerializer().serializeToString(i);o.push(r)}return h().join(o,"\n")}reset(){this.progressData={overall:{completed:0,total:0},bars:{}},this.sendUpdate()}updateProgress(e,t,n){this.progressData.bars[e]={completed:t,total:n},this.progressData.overall.completed=h().sum(Object.entries(this.progressData.bars).map(e=>e[1].completed)),this.progressData.overall.total=h().sum(Object.entries(this.progressData.bars).map(e=>e[1].total)),this.sendUpdate()}sendUpdate(){var e;null===(e=this.onUpdate)||void 0===e||e.call(this,{overall:this.progressData.overall,bars:{}})}findAllReplacements(e,t){void 0===e&&(e=this.dom.documentElement),t=this.appendNodeReplacements(e,t);for(let n=0;n<e.childNodes.length;n++)t=this.findAllReplacements(e.childNodes[n],t);return t}appendNodeReplacements(e,t){let n=[...t];if(e.nodeType===Node.ELEMENT_NODE){for(let t of na)if(e.hasAttribute(t)||e.hasAttribute(t.toLowerCase())){var o;let i=null!==(o=e.getAttribute(t))&&void 0!==o?o:e.getAttribute(t.toLowerCase());if(void 0===n.find(e=>e.key===i)){let e=async()=>{try{return await this.zcs.getAsUrl(i,(e,t,n)=>{this.updateProgress(e,t,n)})}catch(e){throw console.error("Error fetching ".concat(t,": ").concat(i),e),e}},o={key:i,getUrlPromise:e,targets:[],attempts:0};n.push(o)}n.find(e=>e.key===i).targets.push({element:e,attribute:t})}for(let t of nl)if(e.hasAttribute(t)){let o=e.getAttribute(t);if(o.includes("url(")){let i=o.match(/url\(([^)]+)\)/)[1];if(i=h().trim(i,"\"' ()"),void 0===n.find(e=>e.key===i)){let e=async()=>{try{return await this.zcs.getAsUrl(i,(e,t,n)=>{this.updateProgress(e,t,n)})}catch(e){throw console.error("Error fetching ".concat(t,": ").concat(i),e),e}},o={key:i,getUrlPromise:e,targets:[],attempts:0};n.push(o)}n.find(e=>e.key===i).targets.push({element:e,attribute:t})}}}return n}async replaceAllReplacements(e){do{let t=e.filter(e=>this.shouldTryAgain(e)),n=await Promise.all(t.map(e=>this.replace(e)));if(n.some(e=>!e.succeeded)){let e=n.filter(e=>!1===e.succeeded);console.warn("".concat(e.length," failed replacements"),e),await new Promise(e=>setTimeout(e,1e3))}}while(e.some(e=>this.shouldTryAgain(e)));if(e.some(e=>!1===e.succeeded)){let t=e.filter(e=>!1===e.succeeded);console.error("".concat(t.length," replacements failed"),t)}return new XMLSerializer().serializeToString(this.dom)}async replace(e){try{e.attempts++;let t=await e.getUrlPromise();for(let n of e.targets){let o=n.element.getAttribute(n.attribute),i=null==o?void 0:o.replace(e.key,t);n.element.setAttribute(n.attribute,i)}e.succeeded=!0}catch(t){console.warn("Error fetching ".concat(e.key),t),e.succeeded=!1,e.error=t}finally{return e}}shouldTryAgain(e){return!0!==e.succeeded&&e.attempts<3}constructor(e,t,n){this.source=e,this.zcs=t,this.onUpdate=n,this.progressData={overall:{completed:0,total:0},bars:{}},this.dom=new DOMParser().parseFromString(e,"text/xml"),this.reset()}}class nd{async init(){if(this.initialised)return;this.storageAvailable="none"!==this.storageFlag&&void 0!==window&&void 0!==window.navigator&&void 0!==window.navigator.storage,this.persistAvailable=this.storageAvailable&&void 0!==window.navigator.storage.persist,this.mayPersist=this.storageAvailable&&void 0!==window.navigator.storage.persist&&await window.navigator.storage.persist(),this.retrieveAvailable=this.storageAvailable&&void 0!==window.navigator.storage.getDirectory,this.estimateAvailable=this.storageAvailable&&void 0!==window.navigator.storage.estimate;let e={"Workshop dir":this.workshopDir,"Storage Available":this.storageAvailable,"Persist Available":this.persistAvailable,"Retrieve available":this.retrieveAvailable,"Estimate available":this.estimateAvailable,"May Persist":this.mayPersist};if(this.estimateAvailable){let t=await navigator.storage.estimate();e.Quota=t.quota,e.Usage=t.usage}else e.Quota="N/K",e.Usage="N/K";console.table(e),this.initialised=!0}async getAsUrl(e,t){if(!this.initialised)throw"Not initialised";if(e.startsWith("blob:"))return console.debug("getAsUrl","blob: url requested - passing back the same url."),e;let n=await this.getAsEntry(e,t);try{return URL.createObjectURL(n.content)}catch(t){return console.warn("getAsUrl","Unable to create blob URL for: ".concat(e),t),n.sourceUrl}}async getAsEntry(e,t){if(!this.initialised)throw"Not initialised";if(e.startsWith("blob:")){let n=e.substring(5);return await this.getAsEntry(n,t)}let n=this.forceFetch?null:await this.getCacheData(e);if(this.forceFetch&&console.debug("getAsEntry","cache skip for: ".concat(e)),null!==n&&(void 0===n.content||0===n.content.size)&&(n=null),console.debug("getAsEntry","Cache ".concat(null===n?"miss for":"hit for",": ").concat(e)),null===n){try{n=await this.fetchContent({key:e},t)}catch(t){throw console.error("getAsEntry","Unable to fetch data for: ".concat(e),t),t}try{void 0!==n.content&&n.content.size>0?(console.debug("getAsEntry","Cacheing ".concat(n.content.size," bytes of data for: ").concat(e),n),await this.storeCacheData(n)):(void 0===n.content&&console.warn("getAsEntry","Content for ".concat(e," is undefined.")),void 0!==n.content&&0===n.content.size&&console.warn("getAsEntry","Content for ".concat(e," has 0 bytes.")))}catch(t){console.warn("getAsEntry","Unable to cache the data for: ".concat(e),t)}}return n}async storeCacheData(e){if(this.persistAvailable){var t;let n=e.key.split("/").slice(-1)[0],o=new Date;e.created=null!==(t=e.created)&&void 0!==t?t:o,e.updated=o;let i=await window.navigator.storage.getDirectory(),r=await i.getDirectoryHandle("workshops",{create:!0}),s=await r.getDirectoryHandle(this.workshopDir,{create:!0}),a=await s.getDirectoryHandle("content",{create:!0}),l=await a.getFileHandle(n,{create:!0}),c=await l.createWritable();try{await c.write(e.content)}catch(e){throw console.warn("storeCacheData","error writing to cache",e),e}finally{await c.close(),console.debug("storeCacheData","content stored",e.key)}}}async getCacheData(e){if(!this.retrieveAvailable)return null;try{let t=e.split("/").slice(-1)[0],n=await window.navigator.storage.getDirectory(),o=await n.getDirectoryHandle("workshops",{create:!0}),i=await o.getDirectoryHandle(this.workshopDir,{create:!0}),r=await i.getDirectoryHandle("content",{create:!0}),s=await r.getFileHandle(t),a=await s.getFile();return{key:e,content:a}}catch(e){return console.warn("getCacheData - error encountered, this is a cache miss",e),null}}async fetchContent(e,t){return(await this.fetchContents([e],t))[0]}async fetchContents(e,t){let n=await this.getAccessUrls(e.map(e=>this.fixKeyForS3(e.key))),o=e.map(e=>({key:e.key,url:n.objectKeysToAccessUrls[this.fixKeyForS3(e.key)]}));console.debug("fetchContents","Fetched keysToUrls",o);let i=o.map(e=>this.download(e,t));console.debug("fetchContents","Fetching ".concat(i.length," content items..."));let r=await Promise.all(i);return console.debug("fetchContents","fetch contents complete",r),r}async download(e,t){let n=0;do{try{var o;let n=await fetch(e.url);if(null===n.body)throw"No content found in response for: ".concat(e.key,", at: ").concat(e.url);let i=n.headers.get("Content-Length");if(null===i)throw"Content-Length not found in response for: ".concat(e.key,", at: ").concat(e.url);let r=null!==(o=n.headers.get("Content-Type"))&&void 0!==o?o:void 0;if(void 0===r)throw"Content-Type not found in response for: ".concat(e.key,", at: ").concat(e.url);console.debug("download","".concat(e.key," content-type: ").concat(r));let s=n.body.getReader(),a=Number.parseInt(i);void 0!==t&&t(e.key,0,a);let l=[],c=0;for(;;){let{done:n,value:o}=await s.read();if(n)break;l.push(o),c+=o.length,void 0!==t&&t(e.key,c,a)}let d=new Uint8Array(c),u=0;for(let e of l)d.set(e,u),u+=e.length;return{content:new Blob(l,{type:r}),sourceUrl:e.url,key:e.key}}catch(t){console.warn("download","Error fetching: ".concat(e.key,", attempt: ").concat(n),t),await new Promise(e=>setTimeout(e,1e3))}n++}while(n<3);throw"Failed to fetch: ".concat(e.key)}async getAccessUrls(e){let t={objectKeys:e.filter(e=>this.isKeyForS3(e))},n=e.filter(e=>!this.isKeyForS3(e));console.debug("getAccessUrls","requests to s3 for:",t);let o=await this.start(this.api.postWorkshopContentAccessRequest(this.session.id,this.sessionToken,t));if((0,m.r)(o))return n.forEach(e=>o.objectKeysToAccessUrls[e]=e),o;throw"No access urls response"}fixKeyForS3(e){if(this.isKeyForS3(e)){e=h().trim(e,"/");let t="workshops/".concat(this.workshopDir,"/");e.startsWith(t)||(e="".concat(t).concat(e))}return e}isKeyForS3(e){return!e.startsWith("https://")&&!e.startsWith("http://")}constructor(e,t,n,o,i,r,s){this.api=e,this.start=t,this.session=n,this.sessionToken=o;let a=i.split("/").slice(-2)[0];this.workshopDir=a,this.forceFetch=r,this.initialised=!1,this.storageAvailable=!1,this.persistAvailable=!1,this.mayPersist=!1,this.retrieveAvailable=!1,this.estimateAvailable=!1,this.storageFlag=s}}var nu=n(53622);(r=l||(l={}))[r.Init=0]="Init",r[r.RetrievingRawSlides=1]="RetrievingRawSlides",r[r.RawSlidesError=2]="RawSlidesError",r[r.EnrichingSlides=3]="EnrichingSlides",r[r.EnrichmentError=4]="EnrichmentError",r[r.InflatingSlides=5]="InflatingSlides",r[r.InflationError=6]="InflationError",r[r.Ready=7]="Ready";let np=[0,1],nh=[2,4,6],nf=[3,5],nx=(0,u.createContext)({});function ng(e){let{api:t,start:n}=(0,u.useContext)(tl.E),{session:o}=(0,u.useContext)(ts.z),i=(0,u.useContext)(C.rZ),[r,s]=(0,u.useState)(0),[a,p]=(0,u.useState)([]),[h,f]=(0,u.useState)([]),[x,m]=(0,u.useState)(void 0),[v,b]=(0,u.useState)(!0),[y,w]=(0,u.useState)(!1),[j,k]=(0,u.useState)(!1),{storage:S}=(0,u.useContext)(nu.p);(0,u.useEffect)(()=>{switch(console.debug("Static content state",l[r]),r){case 0:s(1);break;case 1:Z().then(e=>{p(e),s(3)}).catch(e=>{console.error(e),s(2)});break;case 3:D().then(e=>{f(e),s(5)}).catch(e=>{console.error(e),s(4)});break;case 5:E().then(e=>{m(e),s(7)}).catch(e=>{console.error(e),s(6)})}b(void 0!==np.find(e=>e===r)),w(void 0!==nf.find(e=>e===r)),k(void 0!==nh.find(e=>e===r))},[r]);let Z=async()=>{let e=[];for(let r of o.sessionPresentationUris||[]){if(!r)throw"Presentation link empty in session data.";let s=new nd(t,n,o,i.sessionToken,r,!0,S);await s.init();let a=r.split("/").pop(),l=await s.getAsEntry(a,void 0),c=await l.content.text();if(!c)throw"No content found in presentation file.";e.push(c)}return e},I=e=>{ec.Z.emit({type:ec.M.Content_Progress_Update,data:e})},D=async()=>{let r=[];for(let s=0;s<a.length;s++){let l=o.sessionPresentationUris[s],c=a[s];if(!l)throw"Presentation link empty in session data.";let d=new nd(t,n,o,i.sessionToken,l,e.refresh,S);await d.init();let u=new nc(c,d,I),p=u.findAllReplacements(void 0,[]);console.debug("".concat(p.length," unique resources to replace"),p);let h=await u.replaceAllReplacements(p),f=u.getAsSectionTags(h,s);if(!f)throw"No sections found in presentation.";r.push(f)}return r},E=async()=>{let r=[];for(let s=0;s<h.length;s++){let a=o.sessionPresentationUris[s],l=h[s];if(!a)throw"Presentation link empty in session data.";if(!l)throw"No content found in presentation xml.";let c=new nd(t,n,o,i.sessionToken,a,e.refresh,S);await c.init();let u={sessionId:o.id,deviceId:i.deviceId,role:i.role,remoteMedia:o.remoteConfiguration!==g.VS.InPerson,remoteCall:o.remoteConfiguration===g.VS.RemoteWithVideoCall,keyPrefix:"module-".concat(s),contentStore:c,onAnswer:P},p=(0,d.ZP)(l,tD(u)),f=(p instanceof Array?p:[p]).map((e,t)=>(0,tI.te)(e,"module-".concat(s))).filter(e=>void 0!==e);r.push(...f)}return r},P=async o=>{var r;return null!==(r=await n(t.postDeliberationAnswer(e.sid,o,i.sessionToken)))&&void 0!==r?r:null};return(0,c.jsxs)(c.Fragment,{children:[v&&e.init,y&&e.load,j&&e.err,7===r&&(0,c.jsx)(nx.Provider,{value:{sid:e.sid,presentationXml:h,sourceXml:a,slides:x},children:e.children})]})}},37570:function(e,t,n){n.d(t,{H:function(){return x},Z:function(){return g}});var o,i,r=n(57437),s=n(2265),a=n(94547),l=n(71432),c=n(20909),d=n(5085),u=n(1973);(o=i||(i={}))[o.Init=0]="Init",o[o.RetrievingSession=1]="RetrievingSession",o[o.RetrievingPublicContent=2]="RetrievingPublicContent",o[o.SessionError=3]="SessionError",o[o.Ready=4]="Ready";let p=[3],h=[0],f=[1,2],x=(0,s.createContext)({});function g(e){let{api:t,start:n}=(0,s.useContext)(u.E),{user:o,role:g,sessionToken:m}=(0,s.useContext)(d.rZ),[v,b]=(0,s.useState)(0),[y,w]=(0,s.useState)(),[j,k]=(0,s.useState)(),[S,Z]=(0,s.useState)(!0),[C,I]=(0,s.useState)(!1),[D,E]=(0,s.useState)(!1);(0,s.useEffect)(()=>{switch(console.debug("Static data state",i[v]),v){case 0:b(1);break;case 1:P().then(e=>{if((0,l.r)(e))w(e),b(2);else throw"Could not retrieve session."}).catch(e=>{console.error(e),b(3)});break;case 2:A().then(e=>{k(e),b(4)}).catch(e=>{console.error(e),b(3)})}I(void 0!==f.find(e=>e===v)),E(void 0!==p.find(e=>e===v)),Z(void 0!==h.find(e=>e===v))},[v]);let P=async()=>g===a._b.Controller?await n(t.getDeliberationSessionAdmin(e.sid,m,o.access_token,void 0)):await n(t.getDeliberationSession(e.sid,m,void 0)),A=async()=>{let e={workshopDirectory:(0,c.X)(y.sessionPresentationUris[0])};return await n(t.postPublicContentAccessRequest(y.id,e))};return(0,r.jsxs)(r.Fragment,{children:[S&&e.init,C&&e.load,D&&e.err,4===v&&(0,r.jsx)(x.Provider,{value:{sid:y.id,session:y,publicContent:j},children:e.children})]})}},89384:function(e,t,n){n.d(t,{Ay:function(){return r},K0:function(){return o},ax:function(){return i}});let o=!0,i=!0,r={audio:!0,video:!0,audioDevice:void 0,audioOutputDevice:null,videoDevice:void 0,voiceFocus:!0,backgroundBlur:!0,startMeeting:!0}},95114:function(e,t,n){n.d(t,{Nx:function(){return f},ZP:function(){return g},ko:function(){return x}});var o=n(57437),i=n(6722),r=n(2265),s=n(11144),a=n(53622),l=n(5085),c=n(71432);let d=["Microsoft Teams Audio","ZoomAudioDevice"];var u=n(89384),p=n(71242),h=n(23030);let f=(0,r.createContext)(void 0);function x(){let e=(0,r.useContext)(f);if(void 0===e)throw"Error: this component must be used within a <ZgMeetingConfigProvider>";return e}function g(e){var t,n;let{meetingStatus:x,isStarted:g}=(0,r.useContext)(h.O),m=(0,r.useContext)(a.p),v=(0,i.fjl)(),{isVideoEnabled:b,toggleVideo:y}=(0,i.Onx)(),{muted:w,toggleMute:j}=(0,i.HI)(),[k,S]=(0,r.useState)(),[Z,C]=(0,r.useState)(),[I,D]=(0,r.useState)(),{selectedDevice:E,devices:P}=(0,i.m6Y)(),{selectedDevice:A,devices:R}=(0,i.rzj)(),{selectedDevice:B,devices:T}=(0,i.ULf)(),{isVoiceFocusSupported:F,addVoiceFocus:q}=(0,i.kjH)(),{isBackgroundBlurSupported:M,createBackgroundBlurDevice:_}=(0,i.QvM)(),{session:N}=(0,r.useContext)(s.z),{deviceId:O}=(0,r.useContext)(l.rZ),[W,K]=(0,r.useState)(!1),L={settings:{offerVoiceFocus:null!==(t=m.voiceFocus)&&void 0!==t?t:u.K0,offerBackgroundBlur:null!==(n=m.backgroundBlur)&&void 0!==n?n:u.ax},preference:(0,c.r)(e.initialPrefs)?{...e.initialPrefs,startMeeting:!0}:u.Ay,current:{isInitialised:!1,isMeetingStarted:g,isAudioEnabled:!w,isVideoEnabled:b,isVoiceFocusEnabled:!1,isVoiceFocusSupported:F,isBackgroundBlurEnabled:!1,isBackgroundBlurSupported:M,audioInputDevice:E,audioOutputDevice:A,videoInputDevice:B,availableAudioInputDevices:k,availableAudioOutputDevices:Z,availableVideoInputDevices:I}},[U,V]=(0,r.useState)(L);return(0,r.useEffect)(()=>{U.current.isInitialised||(U.current.isMeetingStarted&&(0,c.r)(U.current.videoInputDevice)&&(0,c.r)(U.current.audioInputDevice)?(console.debug("ZgMeetingConfigProvider: Video call initialised"),V(t=>({...t,preference:{...t.preference,...e.initialPrefs},current:{...t.current,isInitialised:!0}}))):console.warn("ZgMeetingConfigProvider: Video call not initialised",{isMeetingStarted:U.current.isMeetingStarted,videoInputDevice:U.current.videoInputDevice,audioInputDevice:U.current.audioInputDevice}))},[U.current.isInitialised,U.current.isMeetingStarted,U.current.videoInputDevice,U.current.audioInputDevice]),(0,r.useEffect)(()=>{S(P.map(e=>e).filter(e=>!d.some(t=>e.label.toLowerCase().includes(t.toLowerCase())))),C(R.map(e=>e).filter(e=>!d.some(t=>e.label.toLowerCase().includes(t.toLowerCase())))),D(T.map(e=>e).filter(e=>!0))},[P,R,T]),(0,r.useEffect)(()=>{var t;console.debug("video call preferences updated"),null===(t=e.onUpdatePrefs)||void 0===t||t.call(e,U.preference)},[U.preference]),(0,r.useEffect)(()=>{V(e=>({...e,current:{...e.current,availableAudioInputDevices:k,availableAudioOutputDevices:Z,availableVideoInputDevices:I}}))},[k,Z,I]),(0,r.useEffect)(()=>{console.debug("Audio enabled: ".concat(!w)),V(e=>({...e,current:{...e.current,isAudioEnabled:!w}}))},[w]),(0,r.useEffect)(()=>{console.debug("Video enabled: ".concat(b)),V(e=>({...e,current:{...e.current,isVideoEnabled:b}}))},[b]),(0,r.useEffect)(()=>{U.current.isInitialised&&(0,c.r)(E)&&U.preference.audio===w&&(console.debug("toggling audio to ".concat(U.preference.audio?"on":"off")),j())},[U.current.isInitialised,U.preference.audio,w]),(0,r.useEffect)(()=>{(async()=>{U.current.isInitialised&&(0,c.r)(B)&&U.preference.video!==b&&(console.debug("toggling video to ".concat(U.preference.video?"on":"off")),await y())})()},[U.current.isInitialised,U.preference.video,b,B]),(0,r.useEffect)(()=>{(0,c.r)(E)&&(console.debug("Audio input device started",E),V(e=>({...e,current:{...e.current,audioInputDevice:E,isVoiceFocusEnabled:(0,p.gg)(E)}})))},[E]),(0,r.useEffect)(()=>{(0,c.r)(A)&&(console.debug("Audio output device started",A),V(e=>({...e,current:{...e.current,audioOutputDevice:A}})))},[A]),(0,r.useEffect)(()=>{(0,c.r)(B)&&(console.debug("Video input device started",B),V(e=>({...e,current:{...e.current,videoInputDevice:B,isBackgroundBlurEnabled:(0,p.SB)(B)}})))},[B]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.AX)(E);if(!(0,c.r)(U.preference.audioDevice)){V(t=>({...t,preference:{...t.preference,audioDevice:e}}));return}if(e!==U.preference.audioDevice&&(0,c.r)(U.preference.audioDevice)){if((0,p.gg)(E)&&(0,c.r)(U.preference.audioDevice)&&U.preference.voiceFocus){let e=await E.chooseNewInnerDevice(U.preference.audioDevice);await v.startAudioInputDevice(e)}else await v.startAudioInputDevice(U.preference.audioDevice)}};U.current.isInitialised&&e()},[U.current.isInitialised,U.preference.audioDevice,E]),(0,r.useEffect)(()=>{let e=async()=>{if(!(0,c.r)(U.preference.audioOutputDevice)){V(e=>({...e,preference:{...e.preference,audioOutputDevice:A}}));return}A!==U.preference.audioOutputDevice&&(0,c.r)(U.preference.audioOutputDevice)&&await v.startAudioOutputDevice(U.preference.audioOutputDevice)};U.current.isInitialised&&e()},[U.current.isInitialised,U.preference.audioOutputDevice,A]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.rW)(B);if(!(0,c.r)(U.preference.videoDevice)){V(t=>({...t,preference:{...t.preference,videoDevice:e}}));return}(0,c.r)(U.current.audioInputDevice)&&e!==U.preference.videoDevice&&(console.debug("Switching video device from, to:",B,U.preference.videoDevice),(0,c.r)(U.preference.videoDevice)&&await v.startVideoInputDevice(U.preference.videoDevice))};U.current.isInitialised&&e()},[U.current.isInitialised,U.preference.videoDevice,B,U.current.audioInputDevice]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.Wc)(U.current.isVoiceFocusSupported,U.preference.voiceFocus,E,q);(0,c.r)(e)&&e!==E&&await v.startAudioInputDevice(e)};U.settings.offerVoiceFocus&&U.current.isInitialised&&e()},[U.current.isInitialised,U.settings.offerVoiceFocus,U.current.isVoiceFocusSupported,U.preference.voiceFocus,E]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.tg)(U.current.isBackgroundBlurSupported,U.preference.backgroundBlur,B,_);(0,c.r)(e)&&B!==e&&(console.debug("Switching video device (BB)",B,e),await v.startVideoInputDevice(e))};U.settings.offerBackgroundBlur&&U.current.isInitialised&&e()},[U.current.isInitialised,U.settings.offerBackgroundBlur,U.current.isBackgroundBlurSupported,U.preference.backgroundBlur,B]),(0,r.useEffect)(()=>{V(e=>({...e,current:{...e.current,isVoiceFocusSupported:F}}))},[F]),(0,r.useEffect)(()=>{V(e=>({...e,current:{...e.current,isBackgroundBlurSupported:M}}))},[M]),(0,r.useEffect)(()=>{V(e=>({...e,current:{...e.current,isMeetingStarted:g}}))},[g]),(0,r.useEffect)(()=>{V(e=>({...e,current:{...e.current,isMeetingStarted:x===i.ytK.Succeeded}}))},[x]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(f.Provider,{value:{state:U,controls:{selectAudioEnabled:e=>{V(t=>({...t,preference:{...t.preference,audio:e}}))},selectVideoEnabled:e=>V(t=>({...t,preference:{...t.preference,video:e}})),selectAudioDevice:e=>V(t=>({...t,preference:{...t.preference,audioDevice:e}})),selectAudioOutputDevice:e=>V(t=>({...t,preference:{...t.preference,audioOutputDevice:e}})),selectVideoDevice:e=>V(t=>({...t,preference:{...t.preference,videoDevice:e}})),selectVoiceFocus:e=>V(t=>({...t,preference:{...t.preference,voiceFocus:e}})),selectBackgroundBlur:e=>V(t=>({...t,preference:{...t.preference,backgroundBlur:e}})),selectStartMeeting:e=>V(t=>({...t,preference:{...t.preference,startMeeting:e}}))}},children:e.children})})}},71242:function(e,t,n){n.d(t,{AX:function(){return a},SB:function(){return s},Wc:function(){return c},gg:function(){return r},rW:function(){return l},tg:function(){return d}});var o=n(8963),i=n(71432);function r(e){return(0,i.r)(e)&&e instanceof o.VoiceFocusTransformDevice}function s(e){return(0,i.r)(e)&&e instanceof o.DefaultVideoTransformDevice}let a=async e=>(0,i.r)(e)?r(e)?await e.getInnerDevice():e:void 0,l=async e=>(0,i.r)(e)?s(e)?await e.getInnerDevice():e:void 0,c=async(e,t,n,o)=>{if(t&&!r(n)&&void 0===e)return console.debug("Unable to apply Voice Focus: not ready yet"),n;if(t&&!r(n)&&!1===e)return console.warn("Unable to apply Voice Focus: not supported"),n;let s=!0===e&&!0===t&&(0,i.r)(n)&&!r(n),a=!1===t&&(0,i.r)(n)&&r(n);return s?await o(n):a?(n.stop(),n.getInnerDevice()):void 0},d=async(e,t,n,o)=>{if(t&&!s(n)&&void 0===e)return console.debug("Unable to apply Background Blur: not ready yet"),n;if(t&&!s(n)&&!1===e)return console.warn("Unable to apply Background Blur: not supported"),n;let r=!0===e&&!0===t&&(0,i.r)(n)&&!s(n),a=!1===t&&(0,i.r)(n)&&s(n);return r?(console.debug("Applying background blur to video device",n),await o(n)):a?n.getInnerDevice():void 0}},23030:function(e,t,n){n.d(t,{O:function(){return x},Z:function(){return y}});var o=n(57437),i=n(6722),r=n(8963),s=n(2265),a=n(11144),l=n(53622),c=n(70883),d=n(5085),u=n(94547),p=n(71432),h=n(89384),f=n(51364);let x=(0,s.createContext)({}),g=e=>new r.MeetingSessionConfiguration({MeetingId:e.chimeMeetingId,MediaPlacement:{AudioHostUrl:e.audioHostUrl,SignalingUrl:e.signalingUrl,TurnControlUrl:e.turnControlUrl,AudioFallbackUrl:e.audioFallbackUrl,EventIngestionUrl:e.eventIngestionUrl,ScreenDataUrl:e.screenDataUrl,ScreenViewingUrl:e.screenViewingUrl}},{ExternalUserId:e.chimeAttendeeExternalId,AttendeeId:e.chimeAttendeeId,JoinToken:e.chimeJoinToken}),m=(e,t,n,o,i)=>!i&&void 0!==n&&(e===u._b.Controller||t===u._y.Open||o),v=(e,t)=>({deviceLabels:i.C$T.AudioAndVideo,enableWebAudio:!0,eventController:b(e)}),b=e=>new r.DefaultEventController(e,new r.ConsoleLogger("SDK",r.LogLevel.INFO),new r.NoOpEventReporter);function y(e){let t=(0,i.fjl)(),n=(0,i.dpf)(),r=(0,s.useContext)(l.p),[u,b]=(0,s.useState)({meetingStatus:n,isStarted:!1}),{session:y}=(0,s.useContext)(a.z),{subscriptions:w}=(0,s.useContext)(c.l),{role:j,deviceId:k}=(0,s.useContext)(d.rZ),{zgJoinResponse:S,isPreview:Z}=(0,s.useContext)(f.C),[C,I]=(0,s.useState)(),[D,E]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(0,p.r)(y.deviceIdBanList)&&E(y.deviceIdBanList.includes(k))},[y,k]),(0,s.useEffect)(()=>()=>{t.getAttendee=void 0,t.leave()},[]),(0,s.useEffect)(()=>{b({...u,meetingStatus:n})},[n]),(0,s.useEffect)(()=>{n===i.ytK.Succeeded&&D&&t.leave()},[n,D]),(0,s.useEffect)(()=>{if(m(j,y.facilitationState,S,Z,D)){if(S.chimeMeetingId!==(null==C?void 0:C.meetingId)){let e=g(S);console.debug("ZgMeetingConnectionProvider: updating meeting config",S,e),I(e)}}else I(void 0)},[j,y.facilitationState,S,Z,C]),(0,s.useEffect)(()=>{(async()=>{if(t.meetingId!==(null==C?void 0:C.meetingId)&&(console.debug("ZgMeetingConnectionProvider: Current meeting id has changed...",null==C?void 0:C.meetingId),n===i.ytK.Succeeded&&(console.debug("ZgMeetingConnectionProvider: Disconnecting from previous meeting..."),await t.leave()),(0,p.r)(null==C?void 0:C.meetingId)&&n!==i.ytK.Succeeded&&n!==i.ytK.Reconnecting))try{var e;console.debug("ZgMeetingConnectionProvider: Joining meeting...",C),await t.join(C,v(C,null!==(e=r.voiceFocus)&&void 0!==e?e:h.K0)),console.debug("ZgMeetingConnectionProvider: Successfully joined meeting."),console.debug("ZgMeetingConnectionProvider: Starting meeting..."),await t.start(),console.debug("ZgMeetingConnectionProvider: Meeting start succeeded.")}catch(e){console.error("ZgMeetingConnectionProvider: Error joining meeting",e)}})()},[C,n]);let P=(0,s.useCallback)(async(e,t)=>{void 0===t&&console.warn("Undefined pid passed from chime.");var n,o=w.find(e=>e.deviceId===t);return void 0===o&&console.warn("No subscription found for pid: ".concat(t),w),{name:null!==(n=null==o?void 0:o.participantName)&&void 0!==n?n:"Unknown"}},[w]);return(0,s.useEffect)(()=>{t.getAttendee=P},[P]),(0,s.useEffect)(()=>{console.debug("ZgMeetingConnectionProvider: meeting status: ".concat(i.ytK[n])),b(e=>({...e,isStarted:n===i.ytK.Succeeded}))},[n]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(x.Provider,{value:u,children:e.children})})}},51364:function(e,t,n){n.d(t,{C:function(){return f},Z:function(){return x}});var o,i,r=n(57437),s=n(27270),a=n(2265),l=n(11144),c=n(5085),d=n(1973),u=n(94547),p=n(39501),h=n(71432);(o=i||(i={}))[o.Init=0]="Init",o[o.NoMeeting=1]="NoMeeting",o[o.Joining=2]="Joining",o[o.JoiningError=3]="JoiningError",o[o.Ready=4]="Ready";let f=(0,a.createContext)({});function x(e){var t,n;let[o,x]=(0,a.useState)(0),{session:g}=(0,a.useContext)(l.z),{api:m,start:v}=(0,a.useContext)(d.E),{deviceId:b,sessionToken:y,user:w}=(0,a.useContext)(c.rZ),{participantName:j}=(0,a.useContext)(p.o),[k,S]=(0,a.useState)(),Z=e=>e.remoteConfiguration===u.VS.RemoteWithVideoCall;(0,a.useEffect)(()=>{0===o&&x(Z(g)?2:1)},[o,g]),(0,a.useEffect)(()=>{2!==o||I.current||C()},[o]);let C=async()=>{try{let t=await D();(0,h.r)(t)?(S({zgJoinResponse:t,isPreview:e.isPreview}),x(4)):console.debug("postMeetingJoinRequest superseded")}catch(e){console.error(e),x(3)}};(0,a.useEffect)(()=>{if(!e.isPreview&&4===o){var t,n;(null===(t=g.chimeMeetingData)||void 0===t?void 0:t.chimeMeetingId)!==(null==k?void 0:null===(n=k.zgJoinResponse)||void 0===n?void 0:n.chimeMeetingId)&&x(2)}},[null===(t=g.chimeMeetingData)||void 0===t?void 0:t.chimeMeetingId,null==k?void 0:null===(n=k.zgJoinResponse)||void 0===n?void 0:n.chimeMeetingId,e.isPreview]),(0,a.useEffect)(()=>{2===o&&(0,h.r)(null==k?void 0:k.zgJoinResponse)&&x(4)},[k]);let I=(0,a.useRef)(!1),D=async()=>{if(!I.current){console.debug("posting meeting join request"),I.current=!0;try{return await v(m.postMeetingJoinRequest(g.id,y,b,e.isPreview,j,null==w?void 0:w.access_token))}catch(e){throw e}finally{I.current=!1}}};return(0,a.useEffect)(()=>{console.debug("MeetingDataProvider state: ".concat(i[o]),k)},[o,k]),(0,r.jsxs)(r.Fragment,{children:[0===o&&(0,r.jsx)(r.Fragment,{children:e.joinView}),2===o&&(0,r.jsx)(r.Fragment,{children:e.joinView}),1===o&&(0,r.jsx)(s.Z,{severity:"error",children:"This is not a remote video call workshop."}),3===o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.Z,{severity:"error",children:["There was an unexpected error setting up the video call",e.isPreview?" preview":"","."]}),(0,r.jsx)(s.Z,{severity:"info",children:"Please reload the page."})]}),4===o&&(null==k?void 0:k.zgJoinResponse)&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(f.Provider,{value:k,children:e.children})})]})}},61190:function(e,t,n){n.d(t,{Z:function(){return f}});var o=n(57437),i=n(31193),r=n(27270),s=n(6722),a=n(2265),l=n(90089),c=n(4087),d=n(40395),u=n(23030);let p=[s.ytK.Failed,s.ytK.Ended,s.ytK.JoinedFromAnotherDevice,s.ytK.TerminalFailure,s.ytK.Left],h=(e,t)=>e===s.ytK.Succeeded||t&&!p.some(t=>t===e);function f(e){let{meetingStatus:t}=(0,a.useContext)(u.O),[n,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t===s.ytK.Succeeded&&p(!0)},[t]);let[f,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{x(h(t,n))},[t,n]);let g=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(t===s.ytK.Loading){var e;g.current=null!==(e=g.current)&&void 0!==e?e:setTimeout(()=>{m()},5e3)}return()=>{g.current&&(clearTimeout(g.current),g.current=null)}},[t]);let m=()=>{g.current&&(clearTimeout(g.current),g.current=null),f||b(!0)};(0,a.useEffect)(()=>{f&&(b(!1),g.current&&(clearTimeout(g.current),g.current=null))},[f]);let[v,b]=(0,a.useState)(!1),{t:y}=(0,l.$G)();return(0,o.jsxs)(o.Fragment,{children:[f&&e.children,!f&&(0,o.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",...e.sx},children:[(t===s.ytK.Loading||t===s.ytK.Reconnecting)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Z,{severity:"info",children:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.joining"})}),(0,o.jsx)(d.Z,{options:[{key:"ready",text:"Ready",filled:!1}],open:v,setOpen:b,title:y("videoCall.outcomeMessages.interaction.title"),content:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.interaction.content"})})]}),t===s.ytK.Failed&&(0,o.jsx)(r.Z,{severity:"error",children:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.failed"})}),t===s.ytK.Ended&&(0,o.jsx)(r.Z,{severity:"warning",children:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.ended"})}),t===s.ytK.JoinedFromAnotherDevice&&(0,o.jsx)(r.Z,{severity:"warning",children:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.joinedFromAnotherDevice"})}),t===s.ytK.TerminalFailure&&(0,o.jsx)(r.Z,{severity:"error",children:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.terminalFailure"})}),t===s.ytK.Left&&(0,o.jsx)(r.Z,{severity:"info",children:(0,o.jsx)(c.Z,{i18nKey:"videoCall.outcomeMessages.left"})})]})]})}},23336:function(e,t,n){n.d(t,{fF:function(){return O},T6:function(){return W},sc:function(){return K},Ym:function(){return L},mp:function(){return U},ZP:function(){return V},Hk:function(){return N}});var o=n(57437),i=n(4087),r=n(71432),s=n(22960),a=n(31193),l=n(6722),c=n(90952),d=n(24072),u=n(2265),p=n(95114),h=n(71242),f=n(14595),x=n(45133),g=n(47905),m=n(11656),v=n(86917),b=n(21395),y=n(7547),w=n(60926),j=n(37091),k=n(76396),S=n(33351);function Z(e){let t=(0,l.Ldn)(),[n,r]=(0,u.useState)(0),{muted:s}=(0,l.HI)(),a=(0,u.useCallback)(e=>{s?r(0):r(parseFloat(e.toFixed(2)))},[r,s]);(0,l.CUE)(a);let c=e=>(0,o.jsx)(S.Z,{sx:{borderWidth:1,flexGrow:1,height:"".concat(.25,"rem"),borderTopLeftRadius:e.isStart?"".concat(.125,"rem"):0,borderBottomLeftRadius:e.isStart?"".concat(.125,"rem"):0,borderTopRightRadius:e.isEnd?"".concat(.125,"rem"):0,borderBottomRightRadius:e.isEnd?"".concat(.125,"rem"):0,backgroundColor:n>=e.min?e.indicatorColor:"transparent",...e.sx}});return(0,o.jsxs)(S.Z,{sx:{display:"flex",flexDirection:"row",gap:0,...e.sx},children:[!s&&Array(20).fill(void 0).map((e,t)=>.05*t).map((e,i)=>(0,o.jsx)(c,{min:e,value:n,indicatorColor:"callControlMenuItem.main",isStart:0===i,isEnd:e<=n&&n<e+.05},"meter-".concat(t,"-cell-").concat(i))),s&&(0,o.jsx)(i.Z,{i18nKey:"audio.muted"})]})}function C(e){let t=(0,s.Z)(),n=t=>{e.config.controls.selectAudioOutputDevice(t)},a=async()=>{let t=new Audio("/sounds/00-ding.mp3");if(t.volume=.5,(0,r.r)(e.config.state.current.audioOutputDevice)){if((0,r.r)(t.setSinkId))try{await t.setSinkId(e.config.state.current.audioOutputDevice)}catch(e){console.warn("Error setting audio output device for AudioMenu (test speaker)",e)}else console.debug("Audio.setSinkId not defined")}return t},l=(0,u.useCallback)(async()=>{(await a()).play()},[a]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f.Z,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),(0,o.jsx)(x.Z,{disableSticky:!0,sx:{backgroundColor:"transparent",py:L},children:(0,o.jsx)(g.Z,{sx:{color:"callControlMenuItem.main",pl:K,userSelect:"none"},children:(0,o.jsx)("b",{children:(0,o.jsx)(i.Z,{i18nKey:"audio.audioOutputSelection"})})})}),e.audioOutputDeviceList.map(e=>(0,o.jsxs)(m.Z,{disableRipple:!0,onClick:()=>n(e.deviceType.deviceId),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.selected&&(0,o.jsx)(v.Z,{sx:{color:"callControlButton.main"},children:(0,o.jsx)(w.Z,{})}),(0,o.jsx)(g.Z,{inset:!e.selected,sx:{color:e.selected?"callControlButton.main":"callControlMenuItem.main"},children:N(e.deviceType)})]},"menu-item-select-".concat(e.deviceType.label))),(0,o.jsx)(f.Z,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),(0,o.jsxs)(m.Z,{disableRipple:!1,sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),onClick:()=>{l()},children:[(0,o.jsx)(v.Z,{children:(0,o.jsx)(j.Z,{color:t.palette.callControlButtonIcon.main,size:"1.25rem"})}),(0,o.jsx)(g.Z,{sx:{color:"callControlMenuItem.main"},children:"Test speaker"})]},"menu-item-output-audio-test")]})}function I(e){var t,n;let r=(0,s.Z)(),a=t=>{e.config.controls.selectAudioDevice(t)},l=async t=>{e.config.controls.selectVoiceFocus(t)},d=e.config.state.settings.offerVoiceFocus&&!0===e.config.state.current.isVoiceFocusSupported;return(0,o.jsxs)(b.Z,{...(0,k.wK)(e.popupState),anchorPosition:{left:null===(t=e.popupState.anchorEl)||void 0===t?void 0:t.getBoundingClientRect().left,top:(null===(n=e.popupState.anchorEl)||void 0===n?void 0:n.getBoundingClientRect().top)-W},anchorReference:"anchorPosition",sx:U,transformOrigin:{vertical:"bottom",horizontal:"left"},children:[(0,o.jsx)(x.Z,{disableSticky:!0,sx:{backgroundColor:"transparent",py:L},children:(0,o.jsx)(g.Z,{sx:{color:"callControlMenuItem.main",pl:K,userSelect:"none"},children:(0,o.jsx)("b",{children:(0,o.jsx)(i.Z,{i18nKey:"audio.audioInputSelection"})})})}),e.audioInputDeviceList&&e.audioInputDeviceList.map(e=>(0,o.jsxs)(m.Z,{disableRipple:!0,onClick:()=>a(e.deviceType.deviceId),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.selected&&(0,o.jsx)(v.Z,{sx:{color:"callControlButton.main"},children:(0,o.jsx)(w.Z,{})}),(0,o.jsx)(g.Z,{inset:!e.selected,sx:{color:e.selected?"callControlButton.main":"callControlMenuItem.main"},children:N(e.deviceType)})]},"menu-item-select-".concat(e.deviceType.label))),d&&(0,o.jsx)(f.Z,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),d&&(0,o.jsxs)(m.Z,{disableRipple:!0,onClick:()=>l(!e.config.state.current.isVoiceFocusEnabled),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.config.state.current.isVoiceFocusEnabled&&(0,o.jsx)(v.Z,{sx:{color:e.config.state.current.isVoiceFocusEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,o.jsx)(w.Z,{})}),(0,o.jsx)(g.Z,{inset:!e.config.state.current.isVoiceFocusEnabled,sx:{color:e.config.state.current.isVoiceFocusEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,o.jsx)(i.Z,{i18nKey:"audio.reduceBackgroundNoise"})})]},"menu-item-select-voice-focus"),e.showAudioInputVisualisation&&(0,o.jsx)(f.Z,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),e.showAudioInputVisualisation&&(0,o.jsxs)(y.ZP,{sx:{mb:1},children:[(0,o.jsx)(v.Z,{sx:{minWidth:"36px"},children:(0,o.jsx)(c.Z,{color:r.palette.callControlButtonIcon.main,size:"1.25rem"})}),(0,o.jsx)(g.Z,{sx:{pl:0},children:(0,o.jsx)(Z,{sx:{width:"100%",minWidth:"100px",userSelect:"none",color:"callControlMenuItem.main"}})})]},"menu-item-input-audio-visualisation"),e.audioOutputDeviceList&&0!==e.audioOutputDeviceList.length&&(0,o.jsx)(C,{config:e.config,audioOutputDeviceList:e.audioOutputDeviceList})]})}var D=n(60335),E=n(47726),P=n(16604),A=n(91713),R=n(90089);function B(e){let{t}=(0,R.$G)(),n=(0,s.Z)().palette.callControlButtonIcon.main,i="",r="";return"audio"===e.control?(i=t("audio.enableMic"),r=t("audio.muteMic")):"camera"===e.control&&(i=t("video.enableCamera"),r=t("video.disableCamera")),(0,o.jsxs)(D.Z,{disabled:e.busy,disableFocusRipple:!0,"aria-label":e.enabled?r:i,onClick:e.toggleFn,sx:t=>({backgroundColor:e.enabled?"callControlButton.main":"callControlButtonOff.main",height:O,position:e.showMenu?"absolute":"initial",right:e.showMenu?"0":"initial",width:O,"&:hover":{backgroundColor:e.enabled?"callControlButton.dark":"callControlButtonOff.main"},"&:focus-visible":{...t.customStyles.focusRingReverse}}),children:["audio"===e.control&&(0,o.jsx)(o.Fragment,{children:e.enabled?(0,o.jsx)(c.Z,{color:n,size:32}):(0,o.jsx)(E.Z,{color:n,size:32})}),"camera"===e.control&&(0,o.jsx)(o.Fragment,{children:e.enabled?(0,o.jsx)(P.Z,{color:n,size:32}):(0,o.jsx)(A.Z,{color:n,size:32})})]})}var T=n(83345),F=n(96610);function q(e){let{t}=(0,R.$G)(),n="";return"audio"===e.control?n=t("audio.settingsMenu"):"camera"===e.control&&(n=t("video.settingsMenu")),(0,o.jsx)(D.Z,{disabled:e.busy,disableFocusRipple:!0,"aria-label":n,...(0,k.vW)(e.popupState),sx:t=>({backgroundColor:e.enabled?"callControlMenuButton.main":"callControlButtonOff.dark",borderRadius:"30px",height:"100%",pl:"10px",pr:"calc(".concat(O," + 6px)"),"&:hover":{backgroundColor:e.enabled?"callControlButton.main":"callControlButtonOff.dark"},"&:focus-visible":{...t.customStyles.focusRingReverse}}),children:e.popupState.isOpen?(0,o.jsx)(T.Z,{sx:{color:"callControlButtonIcon.main"}}):(0,o.jsx)(F.Z,{sx:{color:"callControlButtonIcon.main"}})})}var M=n(10414);function _(e){var t,n;let r=async t=>{e.config.controls.selectBackgroundBlur(t)},s=t=>{e.config.controls.selectVideoDevice(t)},a=e.config.state.settings.offerBackgroundBlur&&!0===e.config.state.current.isBackgroundBlurSupported;return(0,o.jsxs)(b.Z,{...(0,k.wK)(e.popupState),anchorPosition:{left:null===(t=e.popupState.anchorEl)||void 0===t?void 0:t.getBoundingClientRect().left,top:(null===(n=e.popupState.anchorEl)||void 0===n?void 0:n.getBoundingClientRect().top)-W},anchorReference:"anchorPosition",sx:U,transformOrigin:{vertical:"bottom",horizontal:"left"},children:[(0,o.jsx)(x.Z,{disableSticky:!0,sx:{backgroundColor:"transparent",py:L},children:(0,o.jsx)(g.Z,{sx:{color:"callControlMenuItem.main",pl:K,userSelect:"none"},children:(0,o.jsx)("b",{children:(0,o.jsx)(i.Z,{i18nKey:"video.videoInputSelection"})})})}),e.videoDeviceList&&e.videoDeviceList.map(e=>(0,o.jsxs)(m.Z,{disableRipple:!0,onClick:()=>s(e.deviceType.deviceId),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.selected&&(0,o.jsx)(v.Z,{sx:{color:"callControlButton.main"},children:(0,o.jsx)(w.Z,{})}),(0,o.jsx)(g.Z,{inset:!e.selected,sx:{color:e.selected?"callControlButton.main":"callControlMenuItem.main"},children:N(e.deviceType)})]},"menu-item-select-".concat(e.deviceType.label))),a&&(0,o.jsx)(f.Z,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),a&&(0,o.jsxs)(m.Z,{disableRipple:!0,onClick:()=>r(!e.config.state.current.isBackgroundBlurEnabled),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.config.state.current.isBackgroundBlurEnabled&&(0,o.jsx)(v.Z,{sx:{color:e.config.state.current.isBackgroundBlurEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,o.jsx)(M.Z,{})}),(0,o.jsx)(g.Z,{inset:!e.config.state.current.isBackgroundBlurEnabled,sx:{color:e.config.state.current.isBackgroundBlurEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,o.jsx)(i.Z,{i18nKey:"video.blurBackground"})})]},"menu-item-select-background-blur")]})}let N=e=>e.label,O="52px",W=8,K="36px",L="6px",U={"& .MuiPaper-root":{backgroundColor:"callControlMenuBackground.main",border:"2px solid",borderColor:"callControlButton.main",borderRadius:"10px"}};function V(e){let[t,n]=(0,u.useState)(),[f,x]=(0,u.useState)(),[g,m]=(0,u.useState)(),v=(0,p.ko)(),b=(0,s.Z)(),y=async()=>{v.controls.selectVideoEnabled(!v.state.current.isVideoEnabled)},w=async()=>{v.controls.selectAudioEnabled(!v.state.current.isAudioEnabled)};(0,u.useEffect)(()=>{(async()=>{if((0,r.r)(v.state.current.availableAudioInputDevices)){let e=(0,r.r)(v.state.current.audioInputDevice)?await (0,l.Zws)(await (0,h.AX)(v.state.current.audioInputDevice)):void 0;n(v.state.current.availableAudioInputDevices.map(t=>({deviceType:t,selected:t.deviceId===e})))}})()},[v.state.current.availableAudioInputDevices,v.state.current.audioInputDevice]),(0,u.useEffect)(()=>{(async()=>{if((0,r.r)(v.state.current.availableAudioOutputDevices)){let e=(0,r.r)(v.state.current.audioOutputDevice)?await (0,l.Zws)(v.state.current.audioOutputDevice):void 0;x(v.state.current.availableAudioOutputDevices.map(t=>({deviceType:t,selected:t.deviceId===e})))}})()},[v.state.current.availableAudioOutputDevices,v.state.current.audioOutputDevice]),(0,u.useEffect)(()=>{(async()=>{if((0,r.r)(v.state.current.availableVideoInputDevices)){let e=(0,r.r)(v.state.current.videoInputDevice)?await (0,h.rW)(v.state.current.videoInputDevice):void 0;m(v.state.current.availableVideoInputDevices.map(t=>({deviceType:t,selected:t.deviceId===e})))}})()},[v.state.current.availableVideoInputDevices,v.state.current.videoInputDevice]);let j=e=>(0,o.jsx)(a.Z,{className:e.className,sx:{height:O,position:"relative"},children:e.children});return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(a.Z,{className:e.className,sx:{display:"flex",flexDirection:e.direction,gap:2,justifyContent:"center",m:2,...e.sx},children:[(0,o.jsxs)(j,{className:"camera-controls-container",children:[e.showCameraConfigMenu&&(0,o.jsx)(d.ZP,{variant:"popover",popupId:"camera-menu-popup",children:t=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(q,{busy:e.busy,control:"camera",enabled:v.state.current.isVideoEnabled,popupState:t}),(0,o.jsx)(_,{config:v,popupState:t,videoDeviceList:g})]})}),(0,o.jsx)(B,{busy:e.busy,control:"camera",enabled:v.state.current.isVideoEnabled,showMenu:e.showCameraConfigMenu,toggleFn:y})]}),(0,o.jsxs)(j,{className:"audio-controls-container",children:[e.showAudioConfigMenu&&(0,o.jsx)(d.ZP,{variant:"popover",popupId:"audio-menu-popup",children:n=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(q,{busy:e.busy,control:"audio",enabled:v.state.current.isAudioEnabled,popupState:n}),(0,o.jsx)(I,{audioInputDeviceList:t,audioOutputDeviceList:f,config:v,showAudioInputVisualisation:!0,popupState:n})]})}),(0,o.jsx)(B,{busy:e.busy,control:"audio",enabled:v.state.current.isAudioEnabled,showMenu:e.showAudioConfigMenu,toggleFn:w})]}),e.isPreview&&(0,o.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[(0,o.jsx)(a.Z,{sx:{color:"callControlMenuItem.main",fontSize:"0.75rem",userSelect:"none"},children:(0,o.jsx)(i.Z,{i18nKey:"onboarding.preview.audio.prompt"})}),(0,o.jsxs)(a.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row",gap:.5,height:"1.5rem"},children:[(0,o.jsx)(c.Z,{color:b.palette.callControlButtonIcon.main,size:"1.25rem"}),(0,o.jsx)(Z,{sx:{color:"callControlMenuItem.main",width:"100px"}})]})]})]})})}},88880:function(e,t,n){n.d(t,{ZP:function(){return g}});var o=n(57437),i=n(70883),r=n(80511),s=n(33351),a=n(6722),l=n(2265),c=n(31193);let d=()=>(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(c.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",border:"solid 2px grey",borderRadius:1},children:"TEST"})}),u=e=>(0,o.jsx)(c.Z,{className:"shadow",sx:{borderRadius:"0.5rem",overflow:"hidden",background:"lightgray",height:"100%",width:"100%",position:"relative"},children:(0,o.jsx)(c.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,o.jsxs)(r.Z,{variant:"body2",color:"gray",align:"center",sx:{mx:4,textWrap:"balance"},children:["space reserved for ",e.name]})})}),p=(e,t)=>{var n;return null===(n=Object.entries(t).find(t=>t[1].externalUserId===e))||void 0===n?void 0:n[1]},h=e=>{let{tiles:t,attendeeIdToTileId:n}=(0,a.akC)(),{tileId:r,isVideoEnabled:s}=(0,a.Onx)(),{thisUser:c}=(0,l.useContext)(i.l),{roster:d}=(0,a.dJs)(),h=p(e.subscription.deviceId,d),[x,g]=(0,l.useState)();return(0,l.useEffect)(()=>{if(!e.test){if(h){var o;let i=e.subscription.deviceId===(null==c?void 0:c.deviceId);g({subscription:e.subscription,attendee:h,isLocal:i,hasVideo:i?s:!!h&&t.some(e=>e===n[h.chimeAttendeeId]),tileId:null!==(o=i?r:h?n[h.chimeAttendeeId]:void 0)&&void 0!==o?o:void 0,muted:void 0})}else g(void 0)}},[e.subscription.subscriptionId,s,t,c,d]),(0,o.jsxs)(o.Fragment,{children:[x&&(0,o.jsx)(f,{subscription:x.subscription,attendee:x.attendee,isLocal:x.isLocal,hasVideo:x.hasVideo,tileId:x.tileId,muted:void 0},"video-call-tile-".concat(x.tileId)),!x&&(0,o.jsx)(u,{name:e.subscription.participantName})]})},f=(0,l.memo)(function(e){let{muted:t}=(0,a.zDY)(e.attendee.chimeAttendeeId);return(0,o.jsx)(x,{...e,muted:t})},(e,t)=>{var n,o;let i=e.tileId===t.tileId,r=e.isLocal===t.isLocal,s=e.hasVideo===t.hasVideo,a=e.subscription.subscriptionId===t.subscription.subscriptionId&&e.subscription.participantName===t.subscription.participantName,l=(null===(n=e.attendee)||void 0===n?void 0:n.chimeAttendeeId)===(null===(o=t.attendee)||void 0===o?void 0:o.chimeAttendeeId),c=e.muted===t.muted;return i&&r&&s&&a&&l&&c}),x=(0,l.memo)(function(e){return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(s.Z,{className:"shadow",sx:{borderRadius:"0.5rem",overflow:"hidden",background:"gray",height:"100%",width:"100%",position:"relative"},children:[e.hasVideo&&!e.isLocal&&(0,o.jsx)(a.ZzX,{name:e.subscription.participantName,tileId:e.tileId}),e.hasVideo&&e.isLocal&&(0,o.jsx)(a.OuP,{nameplate:e.subscription.participantName}),!e.hasVideo&&(0,o.jsx)(s.Z,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,o.jsx)(r.Z,{variant:"body2",color:"white",children:e.subscription.participantName})}),(0,o.jsx)(s.Z,{sx:{position:"absolute",left:"1rem",top:"1rem"},children:(0,o.jsx)("img",{style:{width:"2rem",height:"2rem"},src:e.muted?"/icons/av/mic-disabled.svg":"/icons/av/mic-enabled.svg"})})]})})},(e,t)=>{var n,o;let i=e.tileId===t.tileId,r=e.isLocal===t.isLocal,s=e.hasVideo===t.hasVideo,a=e.subscription.subscriptionId===t.subscription.subscriptionId&&e.subscription.participantName===t.subscription.participantName,l=(null===(n=e.attendee)||void 0===n?void 0:n.chimeAttendeeId)===(null===(o=t.attendee)||void 0===o?void 0:o.chimeAttendeeId),c=e.muted===t.muted;return i&&r&&s&&a&&l&&c});var g=(0,l.memo)(e=>(0,o.jsxs)(o.Fragment,{children:[e.test&&(0,o.jsx)(d,{}),!e.test&&(0,o.jsx)(h,{subscription:e.subscription})]}),(e,t)=>e.subscription.subscriptionId===t.subscription.subscriptionId)},89504:function(e,t,n){n.d(t,{ZP:function(){return p},fp:function(){return c},wB:function(){return d}});var o=n(57437),i=n(94547),r=n(2265),s=n(70883),a=n(51364),l=n(88880);let c=(0,r.createContext)({}),d=(e,t)=>{if(void 0===e&&void 0===t)return!0;if(void 0===e||void 0===t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].subscriptionId!=e[n].subscriptionId)return!1;return!0},u=(e,t)=>{if(void 0===e&&void 0===t)return!0;if(void 0===e||void 0===t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].key!==t[n].key)return!1;return!0};function p(e){let{subscriptions:t,deviceIdBanList:n,thisUser:p}=(0,r.useContext)(s.l),{isPreview:h}=(0,r.useContext)(a.C),[f,x]=(0,r.useState)([]),[g,m]=(0,r.useState)([]),[v,b]=(0,r.useState)({tiles:[]});(0,r.useEffect)(()=>{let o=t.filter(e=>void 0===n.find(t=>e.deviceId===t)),r=[...o.filter(e=>e.deviceId!==(null==p?void 0:p.deviceId)&&e.role===i._b.Controller)].sort((e,t)=>e.deviceId.localeCompare(t.deviceId)),s=[...o.filter(e=>e.deviceId!==(null==p?void 0:p.deviceId)&&e.role===i._b.Client)].sort((e,t)=>e.deviceId.localeCompare(t.deviceId)),a=h?p?[p]:[]:e.role===i._b.Client?[...r,...p?[p]:[],...s]:[...p?[p]:[],...r,...s];d(a,f)||x(a)},[t,n]);let y=e=>"video-tile-".concat(e.subscriptionId);return(0,r.useEffect)(()=>{let e=[];f.forEach((t,n)=>{let i=g.find(e=>e.key===y(t));i?e.push(i):e.push((0,o.jsx)(l.ZP,{subscription:t,test:!1},y(t)))}),u(e,g)||m(e)},[f]),(0,r.useEffect)(()=>{b({tiles:g})},[g]),(0,o.jsx)(c.Provider,{value:v,children:e.children})}},6519:function(e,t,n){n.d(t,{Z:function(){return l}});var o=n(57437),i=n(31193),r=n(2265),s=n(89504);let a={0:{columns:1,rows:1},1:{columns:1,rows:1},2:{columns:1,rows:2},3:{columns:1,rows:3},4:{columns:2,rows:2},5:{columns:2,rows:3},6:{columns:2,rows:3},7:{columns:2,rows:4},8:{columns:2,rows:4},9:{columns:3,rows:3},10:{columns:3,rows:4},11:{columns:3,rows:4},12:{columns:3,rows:4},13:{columns:4,rows:4},14:{columns:4,rows:4},15:{columns:4,rows:4},16:{columns:4,rows:4}};function l(e){let{tiles:t}=(0,r.useContext)(s.fp),[n,l]=(0,r.useState)({rows:1,columns:1});return(0,r.useEffect)(()=>{let e=t.length;if(e<=16)l({rows:a[e].rows,columns:a[e].columns});else{let t=Math.ceil(Math.sqrt(e));l({rows:t,columns:Math.ceil(e/t)})}},[t]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(i.Z,{sx:{...e.sx,width:"100%",height:"100%",display:"grid",gap:1,gridTemplateRows:"repeat(".concat(n.rows,", 1fr)"),gridTemplateColumns:"repeat(".concat(n.columns,", 1fr)")},children:t})})}},39501:function(e,t,n){n.d(t,{o:function(){return eZ},Z:function(){return eC}});var o,i,r=n(57437),s=n(31193),a=n(80511),l=n(2265),c=n(11144),d=n(37471),u=n(67506),p=n(70883),h=n(4766),f=n(93191),x=n(5085),g=n(31842),m=n(37570),v=n(1973),b=n(94547),y=n(4087);function w(e){let{keepAwake:t}=e,[n,o]=(0,l.useState)(),[i,s]=(0,l.useState)();return(0,l.useEffect)(()=>{if(void 0===n&&void 0!==window.navigator){var e;o(null===(e=window.navigator)||void 0===e?void 0:e.wakeLock)}},[]),(0,l.useEffect)(()=>{console.debug("Wake lock: ".concat(void 0===n?"unavailable":"available",", keepAwake: ").concat(t));try{void 0===n||(t&&void 0===i&&n.request("screen").then(e=>{console.debug("Wake lock sentinel acquired"),s(e)}).catch(e=>{console.error("Wake lock exception",e)}),t||(void 0!==i&&console.debug("Releasing wake lock sentinel..."),null==i||i.release().then(()=>{console.debug("Wake lock sentinel released."),s(void 0)})))}catch(e){console.warn("Unable to request screen lock",e)}return()=>{void 0!==i&&console.debug("Relesaing wake lock sentinel..."),null==i||i.release().then(()=>{console.debug("Wake lock sentinel released."),s(void 0)})}},[n,t]),(0,r.jsx)(r.Fragment,{})}function j(e){let{children:t}=e;return(0,r.jsx)(s.Z,{sx:{position:"fixed",right:"1.5rem",bottom:"1.5rem",zIndex:10},children:t})}function k(e){let{children:t}=e;return(0,r.jsx)(s.Z,{sx:{position:"fixed",right:"1.5rem",top:"1.5rem",zIndex:10},children:t})}function S(e){let{children:t}=e;return(0,r.jsx)(s.Z,{sx:{position:"fixed",left:"1.5rem",bottom:"1.5rem",zIndex:10},children:t})}var Z=n(69779),C=n(48234),I=n(22960),D=n(31655),E=n(60335);function P(e){let{session:t}=(0,l.useContext)(c.z),n=(0,l.useContext)(x.rZ),o=(0,l.useMemo)(()=>{var t;return(null===(t=e.elementRef)||void 0===t?void 0:t.current)||document.documentElement},[e.elementRef]),[i,s]=(0,l.useState)(),a=async()=>{try{!1!==document.fullscreenEnabled?o.requestFullscreen?await o.requestFullscreen({navigationUI:"hide"}):o.webkitRequestFullscreen?await o.webkitRequestFullscreen():o.webkitEnterFullscreen?await o.webkitEnterFullscreen():o.mozRequestFullScreen?await o.mozRequestFullScreen():o.msRequestFullscreen?await o.msRequestFullscreen():console.warn("No request full screen variants found"):console.warn("Fullscreen not enabled")}catch(e){console.error("Error entering fullscreen",e)}},d=async()=>{try{let e=document;document.fullscreenElement?await document.exitFullscreen():e.webkitFullscreenElement?await e.webkitExitFullscreen():e.mozFullScreenElement?await e.mozCancelFullScreen():e.msFullscreenElement?await e.msExitFullscreen():console.warn("No exit full screen variants found")}catch(e){console.error("Error exiting fullscreen",e)}};(0,l.useEffect)(()=>{document.onfullscreenchange=e=>{s(null!==document.fullscreenElement)}},[]),(0,l.useEffect)(()=>{n.role===b._b.Client&&void 0!==o&&(e.goFullScreen&&!i&&t.facilitationState!==b._y.Closed&&a(),!e.goFullScreen&&i&&d())},[e.goFullScreen,o]),(0,l.useEffect)(()=>{t.facilitationState===b._y.Closed&&(console.debug("Session closed: exit fullscreen"),d())},[t.facilitationState]);let u=(0,I.Z)();return(0,r.jsx)(r.Fragment,{children:n.role===b._b.Client&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(D.Z,{title:i?(0,r.jsx)(y.Z,{i18nKey:"button.exitFullScreen"}):(0,r.jsx)(y.Z,{i18nKey:"button.goFullScreen"}),children:(0,r.jsx)(E.Z,{"aria-label":i?"back to desktop":"go full screen",onClick:()=>i?d():a(),sx:{border:"2px solid",borderColor:u.palette.promptPanelBackground.main,background:u.palette.slideSectionBackground.main,opacity:.75,"&:hover":{backgroundColor:u.palette.slideSectionBackground.main,opacity:1}},children:i?(0,r.jsx)(C.Z,{}):(0,r.jsx)(Z.Z,{})})})})})}var A=n(53771),R=n(27270);let B=[b.um.Error,b.um.Offline],T=[b.um.Disconnected],F=[b.um.Online,b.um.Connecting,b.um.Connected,b.um.Joining];(o=i||(i={})).Disconnected="Disconnected from the workshop server.",o.Connecting="Please wait, connecting to the workshop server...",o.Error="An error occurred while connecting to the workshop server.";let q=e=>F.includes(e),M=e=>B.includes(e),_=e=>T.includes(e),N=e=>_(e)?"Disconnected from the workshop server.":q(e)?"Please wait, connecting to the workshop server...":M(e)?"An error occurred while connecting to the workshop server.":void 0;function O(){let e=(0,l.useContext)(d.Z),[t,n]=(0,l.useState)(e.state),[o,i]=(0,l.useState)(void 0);return(0,l.useEffect)(()=>{console.debug("Connection warning, state: ".concat(b.um[e.state])),n(e.state)},[e.state]),(0,l.useEffect)(()=>{i(N(t))},[t]),(0,r.jsx)(r.Fragment,{children:o&&(0,r.jsxs)(R.Z,{variant:"filled",severity:"An error occurred while connecting to the workshop server."===o?"error":"info",children:[o," (",b.um[t],")"]})})}var W=n(56798),K=n(83593);function L(e){let[t,n]=(0,l.useState)(!1),[o,i]=(0,l.useState)();(0,l.useEffect)(()=>(K.Z.on(K.M.WSS_Update_ConnectionState,i),()=>{K.Z.off(K.M.WSS_Update_ConnectionState,i)}),[]),(0,l.useEffect)(()=>{void 0!==o&&o.type===K.M.WSS_Update_ConnectionState&&o.data>=b.um.Connecting&&n(!0)},[o]);let s=()=>{switch(e.mode){case"reconnect-wss":K.Z.emit({type:K.M.WSS_Request_Reconnect});break;case"reload-session":K.Z.emit({type:K.M.WSS_Refresh_Session})}},a=(0,I.Z)();return(0,r.jsx)(r.Fragment,{children:t&&(0,r.jsx)(D.Z,{title:(0,r.jsx)(y.Z,{i18nKey:"button.reconnect"}),children:(0,r.jsx)(E.Z,{"aria-label":"refresh",onClick:()=>s(),sx:{border:"2px solid",borderColor:a.palette.promptPanelBackground.main,background:a.palette.slideSectionBackground.main,opacity:.75,"&:hover":{backgroundColor:a.palette.slideSectionBackground.main,opacity:1}},children:(0,r.jsx)(W.Z,{})})})})}function U(){let{session:e}=(0,l.useContext)(m.H);return(0,l.useEffect)(()=>{document.title=e.sessionName},[]),(0,r.jsx)(r.Fragment,{})}var V=n(33351);function z(e){return(0,r.jsx)(r.Fragment,{children:e.role===b._b.Client&&(0,r.jsx)(V.Z,{sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:1},children:e.children})})}var H=n(71432);function G(){return(0,l.useEffect)(()=>{var e;let t=[/defaultProps/,/of chart should be greater than 0/,/It will be ignored./,/If you accidentally passed it from a parent component, remove it from the DOM element./,/Form submission canceled because the form is not connected/,/Enriching/,/Added non-passive event/,/Form submission canceled/,/Added non-passive event listener/,/Violation/,/Warning: Invalid DOM/,/Canvas2D/],n=console.error,o=console.warn,i=console.info,r=console.debug,s=null===(e=window)||void 0===e?void 0:e.onerror;return console.error=function(){for(var e=arguments.length,o=Array(e),i=0;i<e;i++)o[i]=arguments[i];t.some(e=>o.some(t=>e.test("".concat(t))))||n(...o)},console.warn=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];t.some(e=>n.some(t=>e.test("".concat(t))))||o(...n)},console.info=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.some(e=>n.some(t=>e.test("".concat(t))))||i(...n)},console.debug=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.some(e=>n.some(t=>e.test("".concat(t))))||r(...n)},(0,H.r)(window)&&(window.onerror=(e,t,n,o,i)=>{}),()=>{console.error=n,console.warn=o,console.debug=r,console.info=i,(0,H.r)(s)&&(window.onerror=s)}},[]),(0,r.jsx)(r.Fragment,{})}var J=n(44100),Y=n(27785),Q=n(9646),X=n(99128),$=n(69540),ee=n(17696),et=n(61570),en=n(87913),eo=n(8487),ei=n(86514),er=n(80438),es=n(67630),ea=n(10745),el=n(44330),ec=n(24309),ed=n(63858);let eu={get_request:!1,get_success:!1,get_fail_system:!1,get_fail_user:!1,get_fail_could_not_start:!1,get_fail_unknown_error:!1},ep=e=>e.get_fail_system||e.get_fail_user||e.get_fail_could_not_start||e.get_fail_unknown_error,eh=e=>{let{prompts:t}=e;return(0,r.jsxs)(r.Fragment,{children:[t.get_success&&(0,r.jsx)(R.Z,{severity:"success",children:"Your camera and microphone are ready to go!"}),t.get_request&&(0,r.jsx)(R.Z,{severity:"info",children:"If prompted by your browser, please grant permission to access your camera and microphone."}),t.get_fail_system&&(0,r.jsx)(R.Z,{severity:"error",children:"Your browser has denied access to your camera and microphone. Please check your browser settings and reload the page."}),t.get_fail_user&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.Z,{severity:"warning",children:"Your browser has been denied access to your camera and/or microphone."}),(0,r.jsxs)(a.Z,{variant:"h4",component:"h2",color:"white",children:["What to do next on ",ed.KC]}),ed.i7&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(et.Z,{fontSize:"inherit"}),children:"If you see a crossed video camera icon at the end of your address bar, click it to change permissions."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(en.Z,{fontSize:"inherit"}),children:"If you don't see a camera icon, click the info icon at the beginning of the address bar for the page settings."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(eo.Z,{fontSize:"inherit"}),children:"Grant permission to access camera and microphone from there."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(ei.Z,{fontSize:"inherit"}),children:"When done, reload the page."})]}),ed.vU&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(et.Z,{fontSize:"inherit"}),children:"If you see a crossed video camera or microphone icon at the start of your address bar, click it to change permissions."}),(0,r.jsxs)(R.Z,{severity:"info",icon:(0,r.jsx)(er.Z,{fontSize:"inherit"}),children:["If you don't see those icons, choose ",(0,r.jsx)("b",{children:"Tools"})," > ",(0,r.jsx)("b",{children:"Page Info"})," from the menu."]}),(0,r.jsxs)(R.Z,{severity:"info",icon:(0,r.jsx)(eo.Z,{fontSize:"inherit"}),children:["Grant permission to access camera and microphone from the ",(0,r.jsx)("b",{children:"Permissions"})," tab."]}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(ei.Z,{fontSize:"inherit"}),children:"When done, reload the page."}),(0,r.jsx)("img",{src:"/instructions/permissions-dialog-ff.png",style:{width:"80%",alignSelf:"center"}})]}),ed.G6&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(R.Z,{severity:"info",icon:(0,r.jsx)(er.Z,{fontSize:"inherit"}),children:["Choose ",(0,r.jsx)("b",{children:"Safari"})," > ",(0,r.jsx)("b",{children:"Settings"})," from the menu, then click ",(0,r.jsx)("b",{children:"Websites"}),"."]}),(0,r.jsxs)(R.Z,{severity:"info",icon:(0,r.jsx)(es.Z,{fontSize:"inherit"}),children:["Choose the Camera settings, and set this site to ",(0,r.jsx)("b",{children:"Allow"}),"."]}),(0,r.jsxs)(R.Z,{severity:"info",icon:(0,r.jsx)(ea.Z,{fontSize:"inherit"}),children:["Choose the Microphone settings, and set this site to ",(0,r.jsx)("b",{children:"Allow"}),"."]}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(el.Z,{fontSize:"inherit"}),children:"When done, reload the page."}),(0,r.jsx)("img",{src:"/instructions/permissions-dialog-sf.png",style:{width:"80%",alignSelf:"center"}})]}),ed.un&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(er.Z,{fontSize:"inherit"}),children:"Select Settings and more... and select Settings."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(eo.Z,{fontSize:"inherit"}),children:"Select Cookies and Site Permissions on the left side."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(ei.Z,{fontSize:"inherit"}),children:"Under Site Permissions, select Camera or Microphone."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(el.Z,{fontSize:"inherit"}),children:"Grant permissions there"}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(ec.Z,{fontSize:"inherit"}),children:"When done, reload this page."})]}),!ed.i7&&!ed.vU&&!ed.G6&&!ed.un&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(R.Z,{severity:"warning",children:["We don't have instructions for ",ed.KC,"."]}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(er.Z,{fontSize:"inherit"}),children:"Please grant camera and microphone permissions for this page."}),(0,r.jsx)(R.Z,{severity:"info",icon:(0,r.jsx)(eo.Z,{fontSize:"inherit"}),children:"When done, reload the page."})]})]}),t.get_fail_could_not_start&&(0,r.jsx)(R.Z,{severity:"warning",children:"Your camera and microphone are in use by another application. Please close the other application, refresh this page, and try again."}),t.get_fail_unknown_error&&(0,r.jsx)(R.Z,{severity:"error",children:"An unexpected error has prevented us from checking your camera and microphone. Please reload the page to try again."})]})},ef=[{title:"Can we use your microphone and camera during this workshop?",body:"This session will involve participation and discussion, so we will need to use your microphone and camera in order to see and hear you."},{title:"Are you sure?",body:"Unfortunately, without granting access to your microphone and camera you will not be able to participate in the session. Please select below to either allow access, or to navigate out of the session."}];function ex(e){let{session:t}=(0,l.useContext)(m.H),[n,o]=(0,l.useState)(0),[i,c]=(0,l.useState)(eu),[d,u]=(0,l.useState)(!1),[p,h]=(0,l.useState)(!1),f=t.remoteConfiguration===b.VS.RemoteWithVideoCall;(0,l.useEffect)(()=>{f&&(u(!0),x().then(e=>{h(e)}).catch(e=>{console.error(e)}).finally(()=>{u(!1)}))},[]),(0,l.useEffect)(()=>{p&&e.onGrant(!0)},[p]);let x=async()=>{if(void 0===navigator)return console.warn("Navigator required to check permissions"),!1;try{let e=await navigator.permissions.query({name:"camera"});return"granted"===e.state}catch(e){return console.error("Error checking camera permissions",e),!1}},g=async()=>{let e=await v();if(!0===e||!1===e)h(e),c({...eu,get_success:e,get_fail_unknown_error:!e});else{let{type:t,name:n,message:o}=e;h(!1),console.error("Permission denied: ".concat(n,", ").concat(o)),c({...eu,get_success:!1,get_fail_system:t===$.wS.SystemPermissionDenied,get_fail_user:t===$.wS.UserPermissionDenied,get_fail_could_not_start:t===$.wS.CouldNotStartVideoSource,get_fail_unknown_error:null==t||t===$.wS.Generic})}},v=async()=>{try{let e=await (0,$.TD)();if(void 0!==e)return e;throw{type:$.wS.Generic,name:"Unknown",message:"Unknown error"}}catch(e){if(void 0!==e)return e;return{type:$.wS.Generic,name:"Unknown",message:"Unknown error"}}},y=()=>{window.location.reload()};return(0,r.jsxs)(r.Fragment,{children:[!p&&f&&(0,r.jsx)(ee.Z,{children:(0,r.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,r.jsx)(a.Z,{variant:"h2",color:"white",children:ef[n].title}),(0,r.jsx)(a.Z,{variant:"body1",color:"white",children:ef[n].body}),(0,r.jsx)(s.Z,{sx:{alignSelf:"stretch",display:"flex",flexDirection:"column",gap:2},children:(0,r.jsx)(eh,{prompts:i})}),(0,r.jsxs)(s.Z,{sx:{mt:4,display:"flex",flexDirection:"column",gap:2},children:[d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.Z,{sx:{mt:4,backgroundColor:"#444444","& .MuiLinearProgress-bar":{backgroundColor:"white"}}}),(0,r.jsx)(a.Z,{variant:"body2",color:"white",children:"Checking for permission..."})]}),!d&&!ep(i)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q.Z,{btnKey:"allow",busy:!1,disabled:!1,onClick:g,color:"buttonReverse",btnText:"ALLOW"}),0===n&&(0,r.jsx)(Q.Z,{btnKey:"deny",variant:"text",busy:!1,disabled:!1,onClick:()=>o(1),color:"buttonReverse",btnText:"DO NOT ALLOW"}),1===n&&(0,r.jsx)(Q.Z,{btnKey:"deny",variant:"text",busy:!1,disabled:!1,onClick:()=>y(),color:"buttonReverse",btnText:"EXIT WORKSHOP"})]}),!d&&ep(i)&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(Q.Z,{btnKey:"allow",variant:"outlined",busy:!1,disabled:!1,onClick:()=>{window.location.reload()},color:"buttonReverse",btnText:"RELOAD PAGE"})})]})]})}),(p||!f)&&(0,r.jsx)(r.Fragment,{children:e.children})]})}var eg=n(69161);function em(e){let{children:t}=e,{publicContent:n,session:o}=(0,l.useContext)(m.H),[i,a]=(0,l.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[!i&&(0,r.jsx)(ee.Z,{privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,r.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,r.jsx)(eg.Z,{session:o,layout:"column",welcome:!0,white:!0}),(0,r.jsx)(Q.Z,{color:"buttonReverse",btnText:(0,r.jsx)(y.Z,{i18nKey:"button.getStarted"}),btnKey:"start",onClick:e=>{a(!0)},sx:{mt:4}})]})}),i&&(0,r.jsx)(r.Fragment,{children:t})]})}let ev=e=>e.remoteConfiguration===b.VS.InPerson;function eb(e){let{children:t}=e,{session:n}=(0,l.useContext)(m.H),[o,i]=(0,l.useState)(ev(n));return(0,r.jsxs)(r.Fragment,{children:[!o&&(0,r.jsx)(ee.Z,{children:(0,r.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,r.jsx)(a.Z,{variant:"h2",color:"white",children:"We recommend using WiFi rather than mobile data"}),(0,r.jsx)(a.Z,{variant:"body1",color:"white",children:"This session involves watching some video content which requires more data usage. So we recommend you use WiFi so as not to use up too much mobile data."}),(0,r.jsx)(Q.Z,{color:"buttonReverse",btnText:"CONTINUE",btnKey:"start",onClick:e=>{i(!0)},sx:{mt:4}})]})}),o&&(0,r.jsx)(r.Fragment,{children:t})]})}let ey=e=>{let{bar:t}=e;return(0,r.jsx)(J.Z,{preTitle:(0,r.jsx)(y.Z,{i18nKey:"onboarding.welcomeTo"}),title:"Zeitgeist test",bar:t})},ew=()=>(0,r.jsx)(J.Z,{preTitle:(0,r.jsx)(y.Z,{i18nKey:"onboarding.thanks"}),title:(0,r.jsx)(y.Z,{i18nKey:"onboarding.almostThere"}),bar:"Synchronizing clocks..."}),ej=()=>(0,r.jsx)(J.Z,{preTitle:(0,r.jsx)(y.Z,{i18nKey:"onboarding.thanks"}),title:(0,r.jsx)(y.Z,{i18nKey:"onboarding.almostThere"}),bar:"Loading workshop content. This may take a few minutes..."}),ek=()=>(0,r.jsx)(J.Z,{preTitle:(0,r.jsx)(y.Z,{i18nKey:"onboarding.thanks"}),title:(0,r.jsx)(y.Z,{i18nKey:"onboarding.almostThere"}),bar:"Connecting you to the workshop..."}),eS=e=>{let{descriptionKey:t,adviceKey:n}=e;return(0,r.jsxs)(s.Z,{sx:{width:"100%",height:"100%",border:"solid 4px red",p:2,textWrap:"wrap",display:"flex",flexDirection:"column",gap:2},children:[(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(a.Z,{variant:"h1",children:(0,r.jsx)(y.Z,{i18nKey:t})}),(0,r.jsx)(y.Z,{i18nKey:n,wrapper:(0,r.jsx)(a.Z,{variant:"body1"})})]}),(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(a.Z,{variant:"h2",children:(0,r.jsx)(y.Z,{i18nKey:"onboarding.warnings.*.description"})}),(0,r.jsx)(y.Z,{i18nKey:"onboarding.warnings.*.advice",wrapper:(0,r.jsx)(a.Z,{variant:"body1"})})]})]})},eZ=(0,l.createContext)({});function eC(e){let{role:t,sid:n,joinCode:o,refresh:i,children:a}=e,[Z,C]=(0,l.useState)(!1),[I,D]=(0,l.useState)("Unknown"),[E,R]=(0,l.useState)(!1),[B,T]=(0,l.useState)(!1),F=t===b._b.Controller;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(s.Z,{sx:{width:"100%",height:"100%"},children:(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(j,{children:(0,r.jsx)(A.Z,{})}),(0,r.jsx)(G,{}),(0,r.jsx)(x.ZP,{role:t,sid:n,joinCode:o,load:(0,r.jsx)(ey,{bar:"Checking access to the workshop..."}),err:(0,r.jsx)(eS,{descriptionKey:"onboarding.warnings.ZgSessionUserProvider.description",adviceKey:"onboarding.warnings.ZgSessionUserProvider.advice"}),children:(0,r.jsxs)(m.Z,{sid:n,init:(0,r.jsx)(ey,{}),load:(0,r.jsx)(ey,{bar:(0,r.jsx)(y.Z,{i18nKey:"onboarding.loadingWorkshop"})}),err:(0,r.jsx)(eS,{descriptionKey:"onboarding.warnings.ZgStaticSessionDataProvider.description",adviceKey:"onboarding.warnings.ZgStaticSessionDataProvider.advice"}),children:[(0,r.jsx)(U,{}),(0,r.jsxs)(c.Z,{children:[(0,r.jsx)(k,{children:(0,r.jsxs)(z,{role:t,children:[(0,r.jsx)(L,{mode:"reconnect-wss"}),(0,r.jsx)(P,{goFullScreen:Z})]})}),(0,r.jsx)(em,{children:(0,r.jsx)(Y.Z,{submitName:D,children:(0,r.jsx)(ex,{onGrant:R,children:(0,r.jsx)(eb,{children:(0,r.jsx)(eZ.Provider,{value:{participantName:I,videoCallPermissionsGranted:E,storagePermissionsGranted:B},children:(0,r.jsx)(u.Z,{mode:"zg-server-time",load:(0,r.jsx)(ew,{}),error:(0,r.jsx)(eS,{descriptionKey:"onboarding.warnings.ZgServerTimeProvider.description",adviceKey:"onboarding.warnings.ZgServerTimeProvider.advice"}),children:(0,r.jsx)(g.Z,{sid:n,refresh:i,init:(0,r.jsx)(ej,{}),load:(0,r.jsx)(ej,{}),err:(0,r.jsx)(eS,{descriptionKey:"onboarding.warnings.ZgStaticSessionContentProvider.description",adviceKey:"onboarding.warnings.ZgStaticSessionContentProvider.advice"}),children:(0,r.jsxs)(d.C,{sid:n,load:(0,r.jsx)(ek,{}),error:(0,r.jsx)(eS,{descriptionKey:"onboarding.warnings.ZgResilientWssConnectionProvider.description",adviceKey:"onboarding.warnings.ZgResilientWssConnectionProvider.advice"}),children:[(0,r.jsx)(S,{children:(0,r.jsx)(O,{})}),(0,r.jsx)(h.ZP,{children:(0,r.jsx)(f.Z,{store:F,refresh:i,previews:!0,children:(0,r.jsxs)(p.Z,{sid:n,children:[(0,r.jsx)(w,{keepAwake:!0}),a]})})})]})})})})})})})})]})]})})]})})})}},17696:function(e,t,n){n.d(t,{Z:function(){return S}});var o=n(57437),i=n(31193),r=n(2265),s=n(90089),a=n(88904),l=n(41665),c=n(69065),d=n(80824),u=n(66124),p=n(23269),h=n(98784),f=n(96537),x=n(48612),g=n(53622),m=n(4087),v=n(80511),b=n(7547),y=n(32184);let w={a:e=>(0,o.jsx)(l.Z,{href:e.href,rel:"noopener",sx:{color:"#000"},target:"_blank",children:e.children}),h1:e=>(0,o.jsx)(v.Z,{sx:{fontSize:"3rem",marginBottom:"1.25rem"},variant:"h1",children:e.children}),h2:e=>(0,o.jsx)(v.Z,{sx:{fontSize:"1.875rem",marginBottom:"1.5rem",marginTop:"3.25rem","&:first-of-type":{marginTop:"2.25rem"}},variant:"h2",children:e.children}),li:e=>(0,o.jsx)(b.ZP,{sx:{display:"list-item",paddingBottom:"0",paddingTop:"0"},children:e.children}),ol:e=>(0,o.jsx)(y.Z,{component:"ol",start:e.start,sx:{listStyleType:"lower-alpha",marginTop:"0",paddingBottom:"0",paddingInlineStart:"2rem",paddingTop:"0"},children:e.children}),p:e=>(0,o.jsx)(v.Z,{sx:{marginBottom:"1.25rem"},variant:"body3",children:e.children}),ul:e=>(0,o.jsx)(y.Z,{sx:{listStyleType:"disc",paddingBottom:"0",paddingInlineStart:"2rem",paddingTop:"0"},children:e.children})};function j(){let{t:e}=(0,s.$G)(),{language:t}=(0,r.useContext)(g.p),[n,i]=(0,r.useState)(!1),[v,b]=(0,r.useState)(void 0),y=t||x.aB||x.k$;(0,r.useEffect)(()=>{fetch("/privacy-notice-".concat(y,".md")).then(e=>{if(!0===e.ok)return e.text();throw Error("Response not OK")}).then(e=>{b(e)}).catch(t=>{console.error("Error fetching privacy notice: ",t),b(e("onboarding.privacyNotice.errorLoading",{email:"collective.intelligence@nesta.org.uk"}))})},[]);let j=()=>{i(!0)},k=()=>{i(!1)},S=e=>{e.preventDefault(),j()};return void 0!==v?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Z,{color:"#fff",href:"#privacy-notice",onClick:e=>S(e),variant:"body3",children:(0,o.jsx)(m.Z,{i18nKey:"onboarding.privacyNotice.link"})}),(0,o.jsxs)(c.Z,{"aria-labelledby":"privacy-notice-dialog-title",maxWidth:"md",onClose:k,open:n,scroll:"paper",children:[(0,o.jsx)(d.Z,{id:"privacy-notice-dialog-title",children:(0,o.jsx)(m.Z,{i18nKey:"onboarding.privacyNotice.heading"})}),(0,o.jsx)(u.Z,{dividers:!0,sx:{padding:"0"},children:(0,o.jsx)(p.Z,{color:"#000",component:"div",ref:e=>{null!==e&&e.focus()},sx:{padding:"2.5rem",":focus-visible":{outline:"none"}},tabIndex:0,variant:"body3",children:(0,o.jsx)(a.U,{components:w,children:v})})}),(0,o.jsx)(h.Z,{children:(0,o.jsx)(f.Z,{color:"buttonStandard",onClick:k,sx:{fontSize:"1rem"},children:(0,o.jsx)(m.Z,{i18nKey:"button.close"})})})]})]}):null}function k(e){let[t,n]=(0,r.useState)(!1),[s,x]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{fetch(e.workshopInformationUrl).then(e=>{if(!0===e.ok)return e.text();throw Error("Response not OK")}).then(e=>{x(e)}).catch(e=>console.error("Error fetching workshop information: ",e))},[e.workshopInformationUrl]);let g=()=>{n(!0)},v=()=>{n(!1)},b=e=>{e.preventDefault(),g()};return void 0!==s?(0,o.jsxs)(i.Z,{sx:{borderLeft:"1px solid #ffffffaa",marginLeft:"1rem",paddingLeft:"1rem"},children:[(0,o.jsx)(l.Z,{color:"#fff",href:"#workshop-information",onClick:e=>b(e),variant:"body3",children:(0,o.jsx)(m.Z,{i18nKey:"onboarding.workshopInformationLink"})}),(0,o.jsxs)(c.Z,{"aria-labelledby":"workshop-information-dialog-title",maxWidth:"md",onClose:v,open:t,scroll:"paper",children:[(0,o.jsx)(d.Z,{id:"workshop-information-dialog-title",children:(0,o.jsx)(m.Z,{i18nKey:"onboarding.workshopInformationLink"})}),(0,o.jsx)(u.Z,{dividers:!0,sx:{padding:"0"},children:(0,o.jsx)(p.Z,{color:"#000",component:"div",ref:e=>{null!==e&&e.focus()},sx:{padding:"2.5rem",":focus-visible":{outline:"none"}},tabIndex:0,variant:"body3",children:(0,o.jsx)(a.U,{components:w,children:s})})}),(0,o.jsx)(h.Z,{children:(0,o.jsx)(f.Z,{color:"buttonStandard",onClick:v,sx:{fontSize:"1rem"},children:(0,o.jsx)(m.Z,{i18nKey:"button.close"})})})]})]}):null}function S(e){var t;let n=null===(t=e.background)||void 0===t||t;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(i.Z,{sx:{width:"100%",height:"100%",backgroundImage:n?"url(/images/zg-poster.png)":void 0,backgroundSize:"cover",backgroundPosition:"center",position:"relative",overflow:"hidden"},children:[(0,o.jsx)(i.Z,{sx:{position:"absolute",left:0,top:0,width:"50%",bottom:0,backgroundColor:"#3E7075CC"}}),e.rightHalfBackground&&(0,o.jsx)(i.Z,{sx:{position:"absolute",right:"0",top:0,width:"50%",bottom:0,backgroundColor:e.rightHalfBackground}}),(0,o.jsxs)(i.Z,{sx:{position:"absolute",left:"5%",right:"5%",top:0,bottom:0,display:"flex",flexDirection:"column",justifyContent:"center",overflowY:"auto"},children:[(0,o.jsx)(i.Z,{sx:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center"},children:(0,o.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"start"},children:[(0,o.jsx)(i.Z,{sx:{flexGrow:1,flexBasis:0,p:2,pr:"10%"},children:e.children}),(0,o.jsx)(i.Z,{sx:{flexGrow:1,flexBasis:0,p:2},children:e.rightPanel})]})}),(0,o.jsxs)(i.Z,{className:"onboarding-full-width-footer-container",sx:{display:"flex",flexDirection:"row",pl:2,pb:4},children:[e.privacyNotice&&(0,o.jsx)(j,{}),e.workshopInformationUrl&&(0,o.jsx)(k,{workshopInformationUrl:e.workshopInformationUrl})]})]})]})})}},69161:function(e,t,n){n.d(t,{Z:function(){return l}});var o=n(57437),i=n(4087),r=n(31193),s=n(80511),a=n(96537);function l(e){let t=!0===e.white?"white":"black",n=!0===e.white?{filter:"invert(100%) sepia(3%) saturate(594%) hue-rotate(149deg) brightness(117%) contrast(100%)"}:void 0;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.Z,{sx:{mb:2},children:[e.welcome&&(0,o.jsx)(s.Z,{variant:"body1",color:t,children:(0,o.jsx)(i.Z,{i18nKey:"onboarding.welcomeTo"})}),(0,o.jsx)(s.Z,{variant:"h2",color:t,children:e.session.sessionName})]}),(0,o.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column"===e.layout?"column":"row"},gap:2,children:[(0,o.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"column"===e.layout?"start":"center",gap:1},children:[(0,o.jsx)("img",{src:"/icons/session-date.svg",style:n}),(0,o.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column"===e.layout?"column":"row",alignItems:"column"===e.layout?"flex-start":"center",gap:1},children:[(0,o.jsx)(s.Z,{variant:"body2",color:t,children:(0,o.jsx)(i.Z,{i18nKey:"label.date"})}),(0,o.jsx)(s.Z,{variant:"body1",style:{fontWeight:"bold"},color:t,children:new Date(e.session.sessionStartTime).toDateString()})]})]}),(0,o.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"row",alignItems:"column"===e.layout?"start":"center",gap:1},children:[(0,o.jsx)("img",{src:"/icons/session-time.svg",style:n}),(0,o.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column"===e.layout?"column":"row",alignItems:"column"===e.layout?"flex-start":"center",gap:1},children:[(0,o.jsx)(s.Z,{variant:"body2",color:t,children:(0,o.jsx)(i.Z,{i18nKey:"label.time"})}),(0,o.jsx)(s.Z,{variant:"body1",style:{fontWeight:"bold"},color:t,children:new Date(e.session.sessionStartTime).toLocaleTimeString()})]})]})]}),void 0!==e.onAdvance&&(0,o.jsx)(a.Z,{variant:"contained",color:"primary",onClick:e.onAdvance,sx:{alignSelf:"start"},children:"Next"})]})}},44100:function(e,t,n){n.d(t,{Z:function(){return d}});var o=n(57437),i=n(83593),r=n(31193),s=n(80511),a=n(99128),l=n(2265),c=n(17696);function d(e){let[t,n]=(0,l.useState)(),[d,u]=(0,l.useState)({overall:{completed:0,total:0},bars:{}});return(0,l.useEffect)(()=>(i.Z.on(i.M.Content_Progress_Update,n),()=>{i.Z.off(i.M.Content_Progress_Update,n)}),[]),(0,l.useEffect)(()=>{void 0!==t&&t.type===i.M.Content_Progress_Update&&u(t.data)},[t]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(c.Z,{children:(0,o.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.preTitle&&(0,o.jsx)(s.Z,{variant:"body1",color:"white",children:e.preTitle}),e.title&&(0,o.jsx)(s.Z,{variant:"h2",color:"white",children:e.title}),(0,o.jsx)(a.Z,{sx:{mt:4,backgroundColor:"#444444","& .MuiLinearProgress-bar":{backgroundColor:"white"}},value:d.overall.total>0?100*d.overall.completed/d.overall.total:void 0,variant:d.overall.total>0?"determinate":"indeterminate"}),e.bar&&(0,o.jsx)(s.Z,{variant:"body2",color:"white",children:e.bar})]})})})}},31860:function(e,t,n){n.d(t,{Z:function(){return ep}});var o,i,r=n(57437),s=n(11144),a=n(5085),l=n(94547),c=n(89384),d=n(31193),u=n(99128),p=n(27270),h=n(6722),f=n(8963),x=n(2265),g=n(11707),m=n(71432);class v{debug(e){this.logger.debug(e)}info(e){this.logger.info(e)}warn(e){this.logger.warn(e),this.observers.forEach(t=>t(f.LogLevel.WARN,e))}error(e){this.logger.error(e),this.observers.forEach(t=>t(f.LogLevel.ERROR,e))}setLogLevel(e){this.logger.setLogLevel(e)}getLogLevel(){return this.logger.getLogLevel()}addObserver(e){this.observers.push(e)}clearObservers(){this.observers=[]}constructor(e){this.logger=new f.ConsoleLogger("ZgObservableLogger",e),this.observers=[]}}(o=i||(i={}))[o.WINDOW_ERROR=0]="WINDOW_ERROR",o[o.CONSOLE_ERROR=1]="CONSOLE_ERROR";let b=(0,x.createContext)({});var y=(0,x.memo)(function(e){let[t]=(0,x.useState)(new v(e.level)),[n,o]=(0,x.useState)({logger:t}),i=(0,x.useRef)(),s=(0,x.useRef)();(0,x.useEffect)(()=>((0,m.r)(window)&&(i.current=window.onerror,window.onerror=a,console.debug("Captured window.onerror"),s.current=console.error,console.error=l,console.debug("Captured console.error")),t.addObserver((e,t)=>{o({...n,lastLog:{level:e,msg:t}})}),()=>{t.clearObservers(),(0,m.r)(window)&&(0,m.r)(i.current)&&(window.onerror=i.current),(0,m.r)(s.current)&&(console.error=s.current)}),[]);let a=(0,x.useCallback)((e,t,r,s,a)=>{if((0,m.r)(e)){var l;null===(l=i.current)||void 0===l||l.call(i,e,t,r,s,a),o({...n,lastLog:{level:0,msg:"[WINDOW] ".concat(null==a?void 0:a.message)}})}},[i,o]),l=(0,x.useCallback)(function(){for(var e,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];(0,m.r)(i)&&(null===(e=s.current)||void 0===e||e.call(s,...i),o({...n,lastLog:{level:1,msg:JSON.stringify([...i])}}))},[s,o]);return(0,r.jsx)(b.Provider,{value:n,children:(0,r.jsx)(h.ikO,{logger:t,children:e.children})})},()=>!0);function w(e){let{logger:t}=(0,x.useContext)(b);return(0,r.jsx)(h.BAg,{options:{logger:t},children:e.children})}var j=n(37471),k=n(95114),S=n(71242),Z=n(23030);function C(e){let{state:t}=(0,x.useContext)(j.Z),{state:n}=(0,k.ko)(),{meetingStatus:o}=(0,x.useContext)(Z.O),{lastLog:i}=(0,x.useContext)(b),s=(0,h.fjl)(),{selectedDevice:a}=(0,h.m6Y)(),l=(0,h.mJL)(),[c,d]=(0,x.useState)(),[u]=(0,x.useState)({voiceFocusFellBackToInnerStream:(e,t)=>{console.warn("VoiceFocus fell back to inner stream",e,t)},voiceFocusInsufficientResources:()=>{console.warn("VoiceFocus insufficient resources")}});(0,x.useEffect)(()=>{a!==c&&(0,S.gg)(c)&&c.removeObserver(u),d(a),(0,S.gg)(a)&&a.addObserver(u)},[a]);let p=(0,x.useRef)(!1),g=async e=>{if(o!==h.ytK.Succeeded){console.debug("ZgChimeMonitor: Meeting not in Succeeded state, not restarting audio input.");return}if(p.current){console.debug("ZgChimeMonitor: Already restarting audio input.");return}p.current=!0,console.debug("ZgChimeMonitor: Restarting audio input shortly..."),await new Promise(t=>setTimeout(t,e)),console.debug("ZgChimeMonitor: Restarting audio input now."),p.current=!0;try{var t,i;let e=(0,S.gg)(c)?c.getInnerDevice():(0,m.r)(c)?c:null!==(i=n.preference.audioDevice)&&void 0!==i?i:null===(t=s.audioInputDevices)||void 0===t?void 0:t[0];if(console.info("ZgChimeMonitor: Restarting audio input device",e),(0,m.r)(e)){if((0,S.gg)(c))try{await c.stop()}catch(e){console.warn("Error encountered stopping audio transform device.",e)}await s.startAudioInputDevice(e)}else throw"No device preferences found."}catch(e){console.error("ZgChimeMonitor: Failed to restart audio input device",e)}finally{p.current=!1}};(0,x.useEffect)(()=>{void 0!==i&&(i.msg.includes("SendingAudioFailure health policy maximum warnings breached.")&&(console.warn("ZgChimeMonitor: Detected audio failure log."),g(0)),i.msg.includes("Cannot read properties of undefined (reading 'destroy_audio_buffer')")&&(console.warn("ZgChimeMonitor: Detected uncaught transform error log."),g(0)))},[i]);let v=["signalingDropped","sendingAudioFailed","meetingReconnected"];(0,x.useEffect)(()=>{void 0!==l&&(console.debug("ZgChimeMonitor: Meeting event",l.name),v.some(e=>e===l.name)&&!p.current&&g(2e3))},[l]);let y=(0,x.useRef)(!1);(0,x.useEffect)(()=>{console.debug("ZgChimeMonitor: Meeting status: ".concat(h.ytK[o])),o===h.ytK.Succeeded&&y.current&&g(0),y.current=!0},[o]),(0,x.useEffect)(()=>{o===h.ytK.Succeeded?f.DefaultDeviceController.getAudioContext().addEventListener("statechange",w):f.DefaultDeviceController.getAudioContext().removeEventListener("statechange",w)},[]);let w=(0,x.useCallback)(async e=>{let t=f.DefaultDeviceController.getAudioContext();if("suspended"===t.state)for(console.warn("ZgChimeMonitor: Audio context state: ".concat(t.state));"suspended"===t.state;)await t.resume(),await new Promise(e=>setTimeout(e,100)),"suspended"===t.state&&console.warn("ZgChimeMonitor: Failed to resume audio context - attempt ".concat(1," of 10."))},[]),C=(0,x.useRef)(),[I,D]=(0,x.useState)(),[E,P]=(0,x.useState)();return(0,x.useEffect)(()=>{var e;D(null===(e=n.current.availableAudioInputDevices)||void 0===e?void 0:e.find(e=>"default"===e.deviceId))},[n.current.availableAudioInputDevices]),(0,x.useEffect)(()=>{(async e=>{P(await (0,h.Zws)(e))})(n.current.audioInputDevice)},[n.current.audioInputDevice]),(0,x.useEffect)(()=>{"default"===E&&(0,m.r)(I)&&(0,m.r)(C.current)&&I.label!==C.current.label&&g(0),C.current=I},[I]),(0,r.jsx)(r.Fragment,{children:e.children})}var I=n(51364),D=n(83593);function E(e){let[t,n]=(0,x.useState)({}),[o,i]=(0,x.useState)(!1),[s,c]=(0,x.useState)(),{deviceId:d,role:u}=(0,x.useContext)(a.rZ),p=(0,k.ko)(),[h,f]=(0,x.useState)();(0,x.useEffect)(()=>(D.Z.on(D.M.WSS_Distribute_Message,f),D.Z.on(D.M.Media_Playback_Update,f),()=>{D.Z.off(D.M.WSS_Distribute_Message,f),D.Z.off(D.M.Media_Playback_Update,f)}),[]),(0,x.useEffect)(()=>{if(void 0!==h)switch(h.type){case D.M.WSS_Distribute_Message:m(h.data);break;case D.M.Media_Playback_Update:g(h.data)}},[h]);let g=e=>{n({...t,[e.videoId]:{update:e}})};(0,x.useEffect)(()=>{i(Object.entries(t).some(e=>e[1].update.isPlaying))},[t]),(0,x.useEffect)(()=>{o&&(c(p.state.current.isAudioEnabled),p.state.current.isAudioEnabled&&(u===l._b.Controller&&Object.entries(t).some(e=>{let[t,n]=e;return!0===n.update.isPlaying&&!1===n.update.muteFacilitator})||p.controls.selectAudioEnabled(!1))),o||void 0===s||p.state.current.isAudioEnabled===s||p.controls.selectAudioEnabled(s)},[o]);let m=e=>{"mute-update"===e.type&&v(e.data.pids)},v=e=>{p.state.current.isAudioEnabled&&(e.some(e=>e===d)||e.some(e=>"*"===e))&&p.controls.selectAudioEnabled(!1)};return(0,r.jsx)(r.Fragment,{children:e.children})}var P=n(4087),A=n(44100);function R(e){let[t,n]=(0,x.useState)(),{zgJoinResponse:o}=(0,x.useContext)(I.C);return(0,x.useEffect)(()=>{console.debug("ZgVoiceFocus notes a change in joinResponse",o),(0,m.r)(null==o?void 0:o.createMeetingResponseJson)&&n(JSON.parse(o.createMeetingResponseJson))},[o]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(h.o1U,{options:{preload:!0},createMeetingResponse:t,children:e.children})})}var B=(0,x.memo)(function(e){return(0,x.useEffect)(()=>{console.debug("Meeting preferences updated:",e.preferences)},[e.preferences]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(y,{level:f.LogLevel.WARN,children:(0,r.jsx)(h.lUb,{children:(0,r.jsx)(I.Z,{joinView:(0,r.jsx)(()=>(0,r.jsxs)(r.Fragment,{children:[e.isPreview&&(0,r.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,r.jsx)(u.Z,{}),(0,r.jsx)(p.Z,{severity:"info",children:"Setting up video call preview..."})]}),!e.isPreview&&(0,r.jsx)(A.Z,{preTitle:(0,r.jsx)(P.Z,{i18nKey:"onboarding.thanks"}),title:(0,r.jsx)(P.Z,{i18nKey:"onboarding.almostThere"}),bar:"Connecting your video call..."})]}),{}),isPreview:e.isPreview,children:(0,r.jsx)(w,{children:(0,r.jsx)(Z.Z,{children:(0,r.jsx)(R,{children:(0,r.jsx)(k.ZP,{initialPrefs:e.preferences,onUpdatePrefs:e.onUpdatePrefs,children:(0,r.jsx)(E,{children:(0,r.jsx)(C,{children:(0,r.jsx)(g.f6,{theme:h.Wbj,children:e.children})})})})})})})})})})})}),T=n(9646),F=n(23336),q=n(89504),M=n(6519),_=(0,x.memo)(function(e){let[t,n]=(0,x.useState)(!1),{role:o}=(0,x.useContext)(a.rZ),i=(0,x.useRef)(),s=e=>{i.current=e};return(0,x.useEffect)(()=>{e.onSubmitPreferences(t,i.current)},[t]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.Z,{className:"preview-call-and-alert-container",sx:{display:"flex",flexDirection:"column",gap:1,height:"45vh",width:"100%"},children:(0,r.jsx)(B,{isPreview:!0,preferences:void 0,onUpdatePrefs:e=>{s(e)},children:(0,r.jsx)(q.ZP,{role:o,children:(0,r.jsxs)(d.Z,{className:"preview-call-container",sx:{backgroundColor:"callControlPanelBackground.main",borderRadius:"10px",display:"flex",flexDirection:"column",height:"100%"},children:[(0,r.jsx)(M.Z,{isPreview:!0}),(0,r.jsxs)(d.Z,{className:"preview-call-controls-container",sx:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,r.jsx)(F.ZP,{direction:"row",showAudioConfigMenu:!0,showCameraConfigMenu:!0,busy:!1,isPreview:!0}),(0,r.jsx)(d.Z,{className:"join-button-container",sx:{alignContent:"center"},children:(0,r.jsx)(e=>{let{intent:t}=e;return console.debug("Button with intent to join:",t),(0,r.jsx)(T.Z,{btnKey:"join",disableFocusRipple:!0,sx:e=>({backgroundColor:"callControlButton.main",color:"buttonStandard.main",mr:2,my:1,"&:hover":{backgroundColor:"callControlButton.light"},"&:focus-visible":{...e.customStyles.focusRingReverse,outlineOffset:"2px"}}),variant:t?"outlined":"contained",onClick:e=>n(!t),btnText:t?(0,r.jsx)(P.Z,{i18nKey:"onboarding.leaveWorkshop"}):(0,r.jsx)(P.Z,{i18nKey:"onboarding.joinWorkshop"})})},{intent:t})})]})]})})})})})},(e,t)=>!0),N=n(97109),O=n(37570),W=n(17696),K=n(1973);function L(e){let{sid:t,period_ms:n=3e4,enabled:o=!0,duration_ms:i=6e5}=e,r=(0,x.useRef)(null),s=(0,x.useRef)(Date.now()),[a,l]=(0,x.useState)(),{api:c,start:d}=(0,x.useContext)(K.E);return(0,x.useEffect)(()=>(s.current=Date.now(),r.current=setInterval(async()=>{let e=Date.now()-s.current;if(o&&("indefinite"===i||e<=i)){let e=await d(c.getBasicDeliberationSession(t,"session-state-poll"));(0,m.r)(e)&&l(e)}},n),()=>{(0,m.r)(r.current)&&clearInterval(r.current)}),[t,n,i,o]),{session:a}}var U=n(80511),V=n(90089);function z(){let{setParticipantSessionFlags:e}=(0,x.useContext)(N.t),{sid:t}=(0,x.useContext)(O.H),{t:n}=(0,V.$G)(),{session:o}=L({sid:t});(0,x.useEffect)(()=>{D.Z.emit({type:D.M.WSS_Request_Disconnect})},[]),(0,x.useEffect)(()=>{(0,m.r)(o)&&o.facilitationState===l._y.Closed&&i()},[o]);let i=()=>{e({leftTheWorkshop:!1}),D.Z.emit({type:D.M.WSS_Request_Reconnect})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{color:"white",sx:{mb:4},variant:"h1",children:(0,r.jsx)(P.Z,{i18nKey:"workshop.participantLeftHeading"})}),(0,r.jsx)(U.Z,{color:"white",sx:{mb:6},variant:"h2",children:(0,r.jsx)(P.Z,{i18nKey:"workshop.participantLeftGuidance"})}),(0,r.jsx)(T.Z,{color:"buttonReverse",btnText:n("workshop.rejoinCta"),btnKey:"start",onClick:i})]})}var H=n(41665),G=n(19783);function J(e){let t="collective.intelligence@nesta.org.uk",n=e.showHeading,o=e.showSignupMethods&&!0,[i,s]=(0,x.useState)(),{sid:a}=(0,x.useContext)(O.H),{session:c}=L({sid:a});(0,x.useEffect)(()=>{D.Z.emit({type:D.M.WSS_Request_Disconnect})},[]),(0,x.useEffect)(()=>{(0,m.r)(c)&&c.facilitationState!==l._y.Closed&&u()},[c]);let u=()=>{D.Z.emit({type:D.M.WSS_Request_Reconnect})};return(0,x.useEffect)(()=>{{let e="".concat(window.location.host,"/signup");G.toDataURL(e).then(e=>{s(e)}).catch(e=>{s(void 0),console.error(e)})}},[!0]),(0,r.jsxs)(d.Z,{color:"#fff",sx:{display:"flex",flexDirection:"column",gap:"1.5vh"},children:[n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{variant:"h2",sx:{fontWeight:"bold"},children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.sessionClosed.sessionIsClosedRegisterLinkAvailable"})}),(0,r.jsx)(U.Z,{color:"white",component:"h2",variant:"h5",sx:{mt:1},children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.sessionClosed.encouragement"})})]}),o&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(d.Z,{children:[(0,r.jsx)(U.Z,{sx:{borderTop:n?"1px solid #fff;":"none",mt:n?2:0,pt:n?3:0},children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.sessionClosed.visitWebsite"})}),(0,r.jsx)(H.Z,{href:"/signup",target:"_blank",variant:"h3",color:"#fff",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.sessionClosed.signUpText"})}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{sx:{pt:2},children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.sessionClosed.orScanQrCode"})}),(0,r.jsx)("img",{alt:"QR code for signup link: ".concat(window.location.host,"/signup}"),src:i,style:{borderRadius:"5px",marginTop:"0.5rem",height:"175px",width:"175px"}})]}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{sx:{borderTop:"1px solid #ffffffff;",mt:3,pt:3},children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.sessionClosed.emailUs"})}),(0,r.jsx)(H.Z,{href:"mailto:".concat(t),target:"_blank",variant:"h5",color:"#fff",children:t})]})]})})]})}var Y=n(69161),Q=n(33351);function X(e){return(0,r.jsxs)(Q.Z,{sx:{display:"flex",flexDirection:"column",gap:1,pt:4},children:[e.session.facilitationState>=l._y.Closed&&(0,r.jsx)(p.Z,{severity:"warning",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.thisWorkshopIsClosed"})}),e.session.facilitationState===l._y.Open&&!e.banned&&(0,r.jsxs)(p.Z,{severity:"success",children:[(0,r.jsx)(P.Z,{i18nKey:"onboarding.thisWorkshopIsOpen"}),(0,r.jsx)("br",{}),(0,r.jsx)(P.Z,{i18nKey:"onboarding.pressJoinToEnter"})]}),e.banned&&(0,r.jsx)(p.Z,{severity:"error",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.youAreRemoved"})})]})}function $(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{variant:"body1",color:"white",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.youAreAboutToJoin"})}),(0,r.jsx)(Y.Z,{session:e.session,welcome:!1,layout:"column",white:!0}),(0,r.jsx)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:1,mt:4},children:(0,r.jsx)(X,{session:e.session,banned:!0})})]})}var ee=n(40772),et=n(28125),en=n(56798),eo=n(65392),ei=n(79617),er=n(51847),es=n(33578);function ea(){let[e,t]=(0,x.useState)(!1),[n,o]=(0,x.useState)(!1),[i,s]=(0,x.useState)(!1),a=()=>{D.Z.emit({type:D.M.WSS_Refresh_Session}),o(!0),setTimeout(()=>{o(!1),t(!0)},2e3)};(0,x.useEffect)(()=>{e&&setTimeout(()=>{s(!0)},3e3)},[e]);let[l]=(0,ee.u)();return(0,r.jsxs)(ei.Z,{children:[(0,r.jsx)(er.Z,{expandIcon:(0,r.jsx)(et.Z,{}),"aria-controls":"support-panel-content",id:"support-panel",children:(0,r.jsx)(U.Z,{variant:"body1",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.supportInfoHeading"})})}),(0,r.jsx)(es.Z,{children:(0,r.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",gap:1},ref:l,children:[(0,r.jsx)(U.Z,{variant:"body2",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.supportInfoText1"})}),(0,r.jsx)(T.Z,{variant:"outlined",btnKey:"reconnect",size:"small",busy:n,startIcon:(0,r.jsx)(en.Z,{}),onClick:()=>{a()},btnText:(0,r.jsx)(P.Z,{i18nKey:"button.reconnect"})}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{variant:"body2",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.supportInfoText2"})}),(0,r.jsx)(T.Z,{variant:"outlined",btnKey:"reconnect",size:"small",startIcon:(0,r.jsx)(eo.Z,{}),onClick:()=>window.location.reload(),btnText:(0,r.jsx)(P.Z,{i18nKey:"button.reload"})})]})]})})]})}function el(e){return console.debug("session join info: start intention = ",e.startIntention),console.debug("session join info: isWaiting = ",e.session.facilitationState===l._y.Ready),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.Z,{variant:"body1",color:"white",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.youAreAboutToJoin"})}),(0,r.jsx)(Y.Z,{session:e.session,welcome:!1,layout:"column",white:!0}),(0,r.jsx)(X,{session:e.session,banned:e.banned}),e.startIntention&&e.session.facilitationState===l._y.Ready&&(0,r.jsxs)(Q.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,r.jsx)(p.Z,{severity:"info",children:(0,r.jsx)(P.Z,{i18nKey:"onboarding.waitingForOpen"})}),(0,r.jsx)(ea,{})]})]})}let ec=e=>e.remoteConfiguration===l.VS.RemoteWithVideoCall;function ed(e){let{session:t}=(0,x.useContext)(s.z),{publicContent:n}=(0,x.useContext)(O.H),{deviceId:o}=(0,x.useContext)(a.rZ),[i,c]=(0,x.useState)(!1);console.debug("ZgOnboardingMeetingSetup render"),(0,x.useEffect)(()=>{(0,m.r)(t.deviceIdBanList)&&c(t.deviceIdBanList.includes(o))},[t,o]);let d=t.facilitationState===l._y.Closed&&e.role===l._b.Client;return(0,r.jsxs)(r.Fragment,{children:[i&&(0,r.jsx)(W.Z,{background:!0,rightPanel:void 0,privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,r.jsx)($,{session:t})}),d&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(W.Z,{background:!0,rightHalfBackground:"#3E7075CC",rightPanel:(0,r.jsx)(J,{showHeading:!1,showSignupMethods:!0}),privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,r.jsx)(J,{showHeading:!0,showSignupMethods:!1})})}),!d&&e.participantLeft&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(W.Z,{background:!0,rightHalfBackground:"#3E7075CC",privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,r.jsx)(z,{})})}),!i&&!d&&!e.participantLeft&&(0,r.jsxs)(r.Fragment,{children:[ec(t)&&(0,r.jsx)(W.Z,{background:!1,rightPanel:e.videoCallPreview,privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,r.jsx)(el,{session:t,banned:i,role:e.role,startIntention:e.startIntention})}),!ec(t)&&(0,r.jsx)(W.Z,{background:!1,rightPanel:void 0,privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,r.jsx)(el,{session:t,banned:i,role:e.role,startIntention:e.startIntention})})]})]})}let eu=e=>e.remoteConfiguration===l.VS.RemoteWithVideoCall;function ep(e){var t;let{session:n}=(0,x.useContext)(s.z),{deviceId:o}=(0,x.useContext)(a.rZ),{participantSessionFlags:i}=(0,x.useContext)(N.t),d=eu(n),u=(0,x.useRef)(),[p,h]=(0,x.useState)(!1),[f,g]=(0,x.useState)(!1),[m,v]=(0,x.useState)(!d),[b,y]=(0,x.useState)(!1),w=e=>e.facilitationState===l._y.Open,j=(e,t)=>{var n,o;return null!==(o=null===(n=e.deviceIdBanList)||void 0===n?void 0:n.includes(t))&&void 0!==o&&o},k=(0,x.useCallback)((e,t)=>{console.debug("onStartIntention",e,t),u.current=t,v(e)},[]),S=(e,t,n,o,i)=>e&&(t||o===l._b.Controller)&&(!n||o===l._b.Controller)&&(!i||o===l._b.Controller);return(0,x.useEffect)(()=>{console.debug("deviceId changed",o)},[o]),(0,x.useEffect)(()=>{h(w(n)),g(j(n,o))},[n]),(0,x.useEffect)(()=>{y(S(m,p,f,e.role,null==i?void 0:i.leftTheWorkshop))},[p,m,f,e.role,null==i?void 0:i.leftTheWorkshop]),(0,r.jsxs)(r.Fragment,{children:[!b&&(0,r.jsx)(ed,{participantLeft:null==i?void 0:i.leftTheWorkshop,role:e.role,startIntention:m,videoCallPreview:d?(0,r.jsx)(_,{onSubmitPreferences:k}):void 0}),b&&d&&(0,r.jsx)(B,{isPreview:!1,preferences:null!==(t=u.current)&&void 0!==t?t:c.Ay,children:e.children}),b&&!d&&(0,r.jsx)(r.Fragment,{children:e.children})]})}},27785:function(e,t,n){n.d(t,{K:function(){return p},Z:function(){return h}});var o=n(57437),i=n(37570),r=n(4087),s=n(9646),a=n(31193),l=n(80511),c=n(66858),d=n(2265),u=n(17696);let p=(0,d.createContext)({});function h(e){let{publicContent:t}=(0,d.useContext)(i.H),[n,h]=(0,d.useState)(""),[f,x]=(0,d.useState)(!1),[g,m]=(0,d.useState)(!1),v=f&&0===n.trim().length,b=!v&&n.trim().length>0,y=t=>{b&&(e.submitName(n),m(!0))};return(0,o.jsxs)(o.Fragment,{children:[!g&&(0,o.jsx)(u.Z,{privacyNotice:!0,workshopInformationUrl:t.workshopInformationUrl,children:(0,o.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,o.jsx)(l.Z,{variant:"h2",color:"white",children:(0,o.jsx)(r.Z,{i18nKey:"onboarding.pleaseEnterName"})}),(0,o.jsx)(l.Z,{variant:"body1",color:"white",children:(0,o.jsx)(r.Z,{i18nKey:"onboarding.pleaseEnterNameExplanation"})}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y()},style:{alignSelf:"stretch"},children:[(0,o.jsx)(c.Z,{sx:{mb:4,input:{background:"#ffffffcc"}},fullWidth:!0,style:{flexGrow:1},label:(0,o.jsx)(r.Z,{i18nKey:"field.yourName"}),variant:"outlined",value:n,autoComplete:"off",autoFocus:!0,onChange:e=>{h(e.target.value),x(!0)},error:v,color:"buttonStandard"}),(0,o.jsx)(s.Z,{color:"buttonReverse",btnKey:"submit",busy:!1,disabled:!b,onClick:y,btnText:(0,o.jsx)(r.Z,{i18nKey:"button.continue"})})]})]})}),g&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(p.Provider,{value:{participantName:n},children:e.children})})]})}},96608:function(e,t,n){n.d(t,{Z:function(){return s}});var o=n(57437),i=n(80511),r=n(33351);function s(){return(0,o.jsxs)(r.Z,{component:"main",sx:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1rem"},children:[(0,o.jsx)(i.Z,{variant:"h1",sx:{fontSize:"2.25rem"},children:"The Situation Room"}),(0,o.jsxs)(i.Z,{variant:"body1",children:["Thanks for trying to join ",(0,o.jsx)("b",{children:"The Situation Room"}),"."]}),(0,o.jsxs)(i.Z,{variant:"body1",children:["Unfortunately, ",(0,o.jsx)("b",{children:"you can't use a phone"})," (or other device with a small screen) to take part in the session."]}),(0,o.jsxs)(i.Z,{variant:"body1",children:[(0,o.jsx)("b",{children:"Please use a laptop, tablet"})," or other similar device to join."]})]})}},97109:function(e,t,n){n.d(t,{t:function(){return eo},Z:function(){return ei}});var o,i,r=n(57437),s=n(2265),a=n(63858),l=n(94547),c=n(31860),d=n(78364),u=n(71432),p=n(96608),h=n(4766),f=n(93191),x=n(37570),g=n(4087),m=n(23336),v=n(89504),b=n(15785),y=n(40772),w=n(59676),j=n(81386),k=n(22960),S=n(31193),Z=n(60335),C=n(29921),I=n(88880);let D="".concat(960," / ").concat(700),E={1:{col:3,row:1,span:{cols:1,rows:1}},2:{col:3,row:2,span:{cols:1,rows:1}},3:{col:3,row:3,span:{cols:1,rows:1}},4:{col:2,row:3,span:{cols:1,rows:1}},5:{col:1,row:3,span:{cols:1,rows:1}},6:{col:4,row:1,span:{cols:1,rows:1}},7:{col:4,row:2,span:{cols:1,rows:1}},8:{col:4,row:3,span:{cols:1,rows:1}},9:{col:4,row:4,span:{cols:1,rows:1}},10:{col:3,row:4,span:{cols:1,rows:1}},11:{col:2,row:4,span:{cols:1,rows:1}},12:{col:1,row:4,span:{cols:1,rows:1}},13:{col:5,row:1,span:{cols:1,rows:1}},14:{col:5,row:2,span:{cols:1,rows:1}},15:{col:5,row:3,span:{cols:1,rows:1}},16:{col:5,row:4,span:{cols:1,rows:1}},17:{col:6,row:1,span:{cols:1,rows:1}},18:{col:6,row:2,span:{cols:1,rows:1}},19:{col:6,row:3,span:{cols:1,rows:1}},20:{col:6,row:4,span:{cols:1,rows:1}},21:{col:6,row:5,span:{cols:1,rows:1}},22:{col:5,row:5,span:{cols:1,rows:1}},23:{col:4,row:5,span:{cols:1,rows:1}},24:{col:3,row:5,span:{cols:1,rows:1}},25:{col:2,row:5,span:{cols:1,rows:1}},26:{col:1,row:5,span:{cols:1,rows:1}}},P={0:{[b.S.default]:{cols:1,rows:1},[b.S.deliberation]:{cols:1,rows:1}},1:{[b.S.default]:{cols:3,rows:2},[b.S.deliberation]:{cols:3,rows:2}},2:{[b.S.default]:{cols:3,rows:2},[b.S.deliberation]:{cols:3,rows:2}},3:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:3,rows:3}},4:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:3,rows:3}},5:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:3,rows:3}},6:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:3}},7:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:3}},8:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:3}},9:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:4}},10:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:4}},11:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:4}},12:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:4,rows:4}},13:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:5,rows:4}},14:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:5,rows:4}},15:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:5,rows:4}},16:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:5,rows:4}},17:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:4}},18:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:4}},19:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:4}},20:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:4}},21:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:5}},22:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:5}},23:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:5}},24:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:5}},25:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:5}},26:{[b.S.default]:{cols:6,rows:5},[b.S.deliberation]:{cols:6,rows:5}}},A={0:{[b.S.default]:{col:1,row:1,span:{cols:1,rows:1}},[b.S.deliberation]:{col:1,row:1,span:{cols:1,rows:1}}},1:{[b.S.default]:{col:1,row:1,span:{cols:2,rows:2}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},2:{[b.S.default]:{col:1,row:1,span:{cols:2,rows:2}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},3:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:3}}},4:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},5:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},6:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},7:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},8:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},9:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},10:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},11:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},12:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},13:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},14:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},15:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},16:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},17:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},18:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},19:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},20:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},21:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},22:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},23:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},24:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},25:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},26:{[b.S.default]:{col:1,row:1,span:{cols:5,rows:5}},[b.S.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}}},R=e=>e.map((e,t)=>(0,r.jsx)(I.ZP,{test:!0,subscription:e},"test-tile-".concat(t,"-").concat(e.subscriptionId)));var B=(0,s.memo)(function(e){var t,n,o,i,l,c,d,u;let{tiles:p}=(0,s.useContext)(v.fp),[h,f]=(0,s.useState)(!1),[x,g]=(0,s.useState)(),m=(0,s.useRef)(null),[I,B]=(0,s.useState)([]);(0,C.y)(m,B);let T=void 0!==e.testSubscriptions;(0,s.useEffect)(()=>{var t,n;let o=Math.min(null!==(n=null==p?void 0:p.length)&&void 0!==n?n:null===(t=e.testSubscriptions)||void 0===t?void 0:t.length,26),i=e.activity,r=P[o][i],s={w:960*r.cols,h:700*r.rows},a="repeat(".concat(r.cols,", 1fr)"),l="repeat(".concat(r.rows,", 1fr)"),c=e.enableExpandButton&&o>0&&e.activity===b.S.deliberation;g({colsTemplate:a,rowsTemplate:l,cells:r,gridAspect:s,litter:o,activity:i,showExpandButton:c,tiles:e.testSubscriptions?R(e.testSubscriptions):p})},[T,p,e.testSubscriptions,e.activity,e.enableExpandButton]),(0,s.useEffect)(()=>{x&&x.activity!==b.S.deliberation&&f(!1)},[x]);let[F]=(0,y.u)({duration:200}),q="0.5rem",M=(0,k.Z)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(S.Z,{className:"tiles-inner-container",sx:{width:null!==(d=null===(t=e.availableSpace)||void 0===t?void 0:t.w)&&void 0!==d?d:"100%",height:null!==(u=null===(n=e.availableSpace)||void 0===n?void 0:n.h)&&void 0!==u?u:"100%",position:"relative"},children:x&&(0,r.jsx)(S.Z,{className:"tiles-container",sx:{aspectRatio:"".concat(x.gridAspect.w,"/").concat(x.gridAspect.h),objectFit:"contain",height:a.G6?null===(o=e.availableSpace)||void 0===o?void 0:o.h:void 0,width:a.G6?null===(i=e.availableSpace)||void 0===i?void 0:i.w:void 0,maxHeight:null===(l=e.availableSpace)||void 0===l?void 0:l.h,maxWidth:null===(c=e.availableSpace)||void 0===c?void 0:c.w,mx:"auto",my:"auto",p:1},children:(0,r.jsxs)(S.Z,{className:"tiles-grid",ref:F,sx:{width:"100%",height:"100%",display:"grid",gap:q,gridTemplateColumns:x.colsTemplate,gridTemplateRows:x.rowsTemplate},children:[(0,r.jsxs)(S.Z,{ref:m,sx:{position:h?"absolute":"relative",gridColumnStart:h?void 0:A[x.litter][x.activity].col,gridColumnEnd:h?void 0:A[x.litter][x.activity].col+A[x.litter][x.activity].span.cols,gridRowStart:h?void 0:A[x.litter][x.activity].row,gridRowEnd:h?void 0:A[x.litter][x.activity].row+A[x.litter][x.activity].span.rows,width:h?void 0:"100%",height:h?void 0:"100%",left:h?"2.5vh":void 0,top:h?"2.5vh":void 0,bottom:h?"2.5vh":void 0,right:h?"2.5vh":void 0,zIndex:h?10:void 0},children:[x.showExpandButton&&(0,r.jsx)(S.Z,{sx:{position:"absolute",top:"1rem",right:"1rem",zIndex:20},children:(0,r.jsx)(Z.Z,{"aria-label":"expand presentation button",onClick:()=>f(!h),sx:{border:"2px solid",borderColor:M.palette.promptPanelBackground.main,background:M.palette.slideSectionBackground.main},children:h?(0,r.jsx)(w.Z,{}):(0,r.jsx)(j.Z,{})})}),(0,r.jsx)(S.Z,{sx:{width:"100%",height:"100%",borderRadius:2,border:h?"solid 2px white":void 0},className:"shadow",children:e.presentation})]},"presentation-cell"),x.activity===b.S.deliberation&&(0,r.jsx)(r.Fragment,{children:x.tiles.map((e,t)=>{let n=E[t+1];return void 0!==n?(0,r.jsx)(S.Z,{sx:{gridColumnStart:n.col,gridColumnEnd:n.col+n.span.cols,gridRowStart:n.row,gridRowEnd:n.row+n.span.rows},children:e},"video-cell-at-".concat(t)):(console.warn("Tile with index ".concat(t," not rendered - no position data available")),(0,r.jsx)(r.Fragment,{}))})}),x.activity!=b.S.deliberation&&(0,r.jsxs)(r.Fragment,{children:[x.tiles.slice(0,Math.min(2,x.litter)).map((e,t)=>(0,r.jsx)(S.Z,{sx:{gridColumn:P[x.litter][x.activity].cols,gridRow:t+1},children:e},"video-cell-at-".concat(t))),x.litter>2&&(0,r.jsx)(S.Z,{sx:{gridColumn:x.cells.cols,gridRowStart:3,gridRowEnd:x.cells.rows+1,overflowY:"auto"},children:x.tiles.slice(2).map((e,t)=>(0,r.jsx)(S.Z,{sx:{width:"100%",aspectRatio:D,mb:q},children:e},"video-cell-at-".concat(t)))})]})]})})})})},(e,t)=>{var n,o;let i=e.activity===t.activity,r=e.availableSpace===t.availableSpace,s=e.enableExpandButton===t.enableExpandButton,a=e.presentation===t.presentation,l=(0,v.wB)(null!==(n=e.testSubscriptions)&&void 0!==n?n:[],null!==(o=t.testSubscriptions)&&void 0!==o?o:[]);return i&&r&&s&&a&&l}),T=n(61190),F=n(44100),q=n(33351),M=n(43061),_=n(96537),N=n(90089),O=n(40395);function W(){let[e,t]=(0,s.useState)(!1),{setParticipantSessionFlags:n}=(0,s.useContext)(eo),{t:o}=(0,N.$G)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{disableFocusRipple:!0,sx:e=>({border:"2px solid",borderColor:"buttonDangerReverse.main",color:"buttonDangerReverse.main",fontWeight:"bold",height:"fit-content",px:3,py:1,width:"max-content","&:hover":{backgroundColor:"buttonDangerReverse.main",border:"2px solid",borderColor:"buttonDangerReverse.main",color:"buttonStandard.main"},"&:focus-visible":{...e.customStyles.focusRingReverse,backgroundColor:"buttonDangerReverse.main",color:"buttonStandard.main",outlineOffset:"2px"}}),variant:"outlined",onClick:()=>t(!0),children:(0,r.jsx)(g.Z,{i18nKey:"onboarding.leaveWorkshop"})}),(0,r.jsx)(O.Z,{open:e,setOpen:t,onSelect:e=>{"leave"===e&&n({leftTheWorkshop:!0})},prompt:o("workshop.leaveConfirm"),options:[{key:"leave",text:o("workshop.leaveCta"),filled:!0},{key:"return",text:o("workshop.returnCta"),filled:!1}]})]})}var K=n(86644),L=n(74732),U=n(69065),V=n(80824),z=n(66124),H=n(80511),G=n(41665),J=n(28549),Y=n(56065),Q=n(19004),X=n(11656);function $(e){let[t,n]=(0,s.useState)(""),{t:o}=(0,N.$G)(),i=()=>{e.setShowTechSupport(!1),n("")},a=()=>{i()};return(0,r.jsxs)(U.Z,{className:"tech-support-dialog",fullWidth:!0,maxWidth:"sm",onClose:()=>{i()},open:e.showTechSupport,PaperProps:{sx:{border:"3px solid #A5A5FF",borderRadius:"10px",pointerEvents:"auto"}},scroll:"paper",sx:{pointerEvents:"none","& .MuiDialog-container":{height:e.backdropHeight||"100%"}},slots:{backdrop:()=>(0,r.jsx)(S.Z,{onClick:a,sx:{backgroundColor:"rgba(0,0,0,0.7)",height:e.backdropHeight||"100%",pointerEvents:"auto",position:"fixed",width:"100%"}})},transitionDuration:0,children:[(0,r.jsxs)(S.Z,{className:"tech-support-dialog-controls",sx:{display:"flex",flexDirection:"row",justifyContent:""===t?"end":"space-between"},children:[""!==t&&(0,r.jsx)(Z.Z,{"aria-label":"back",onClick:()=>{n("")},sx:{width:"fit-content"},children:(0,r.jsx)(K.Z,{size:"24px"})}),(0,r.jsx)(Z.Z,{"aria-label":"close",onClick:i,sx:{width:"fit-content"},children:(0,r.jsx)(L.Z,{size:"24px"})})]}),(0,r.jsxs)(V.Z,{align:"center",color:"#292D32",sx:{mx:1,userSelect:"none"},variant:"h3",children:[""===t&&"What problem are you experiencing?","cannot-hear-others"===t&&(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.heading"}),"others-cannot-hear-me"===t&&(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.othersCannotHearMe.heading"}),"still-need-help"===t&&"Please tell us about the problem you're experiencing"]}),"cannot-hear-others"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{align:"center",color:"#292D32",component:"h3",variant:"h4",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.pleaseCheck"})}),(0,r.jsx)(z.Z,{sx:{mx:1,my:2,pb:0},children:(0,r.jsxs)("ol",{style:{margin:"0"},children:[(0,r.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("b",{children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.tip1Heading"})}),(0,r.jsx)("br",{}),(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.tip1Body"})]}),(0,r.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("b",{children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.tip2Heading"})}),(0,r.jsx)("br",{}),(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.tip2Body"})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("b",{children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.tip3Heading"})}),(0,r.jsx)("br",{}),(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.tip3Body"})]})]})})]}),"others-cannot-hear-me"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{align:"center",color:"#292D32",component:"h3",variant:"h4",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.pleaseCheck"})}),(0,r.jsx)(z.Z,{children:(0,r.jsxs)("ol",{children:[(0,r.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("b",{children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.othersCannotHearMe.tip1Heading"})}),(0,r.jsx)("br",{}),(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.othersCannotHearMe.tip1Body"})]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("b",{children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.othersCannotHearMe.tip2Heading"})}),(0,r.jsx)("br",{}),(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.othersCannotHearMe.tip2Body"})]})]})})]}),""!==t&&"still-need-help"!==t&&(0,r.jsxs)(z.Z,{sx:{display:"flex",flexDirection:"row",gap:2,justifyContent:"center",mb:1,p:2},children:[(0,r.jsx)(_.Z,{color:"buttonStandard",onClick:()=>{i()},sx:{fontWeight:"bold",p:"0.5rem 2rem",textTransform:"uppercase"},variant:"outlined",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.buttons.problemSolved"})}),(0,r.jsx)(_.Z,{color:"buttonStandard",onClick:()=>{n("still-need-help")},sx:{fontWeight:"bold",p:"0.5rem 2rem",textTransform:"uppercase"},variant:"contained",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.buttons.stillNeedHelp"})})]}),"still-need-help"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{align:"center",color:"#292D32",component:"h3",sx:{mx:1},variant:"h4",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.teamIsAvailable"})}),(0,r.jsx)(z.Z,{children:(0,r.jsxs)(S.Z,{sx:{display:"grid",gap:1,gridTemplateColumns:"auto 1fr",mx:"auto",my:2,width:"fit-content"},children:[(0,r.jsx)(H.Z,{sx:{mr:1},variant:"body1",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.phone"})}),(0,r.jsx)(G.Z,{href:"tel:020 7031 7209",sx:{color:"#000000ff",fontWeight:"bold"},target:"_blank",children:"020 7031 7209"}),(0,r.jsx)(H.Z,{children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.email"})}),(0,r.jsx)(G.Z,{href:"mailto:workshop-support@nesta.org.uk?subject=Workshop tech support",sx:{color:"#000000ff",fontWeight:"bold"},target:"_blank",children:"workshop-support@nesta.org.uk"})]})})]}),""===t&&(0,r.jsx)(z.Z,{sx:{textAlign:"center"},children:(0,r.jsxs)(J.Z,{sx:{my:3,minWidth:"24rem",userSelect:"none"},children:[(0,r.jsx)(Y.Z,{id:"select-problem",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.chooseProblem"})}),(0,r.jsxs)(Q.Z,{label:o("techSupport.chooseProblem"),labelId:"select-problem",onChange:e=>{n(e.target.value)},value:t,children:[(0,r.jsx)(X.Z,{value:"cannot-hear-others",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.cannotHearOthers.description"})}),(0,r.jsx)(X.Z,{value:"others-cannot-hear-me",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.othersCannotHearMe.description"})}),(0,r.jsx)(X.Z,{value:"still-need-help",children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.problems.differentProblem.description"})})]})]})})]})}(o=i||(i={})).None="",o.CannotHearOthers="cannot-hear-others",o.OthersCannotHearMe="others-cannot-hear-me",o.StillNeedHelp="still-need-help";var ee=n(53013);function et(){let{session:e}=(0,s.useContext)(x.H),{slideData:t}=(0,h.Ao)(),n=(0,s.useContext)(f.N),[o,i]=(0,s.useState)(!1),[a,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)({activity:t.activity,enableExpandButton:!0,presentation:n.presentation,availableSpace:void 0});(0,s.useEffect)(()=>{i(e.remoteConfiguration===l.VS.RemoteWithVideoCall)},[e]),(0,s.useEffect)(()=>{u({...d,activity:t.activity,enableExpandButton:!0,presentation:n.presentation})},[t.activity]);let[p,b]=(0,M.xE)();return(0,s.useEffect)(()=>{b&&b.width&&b.height&&(u({...d,availableSpace:{w:b.width,h:b.height}}),console.debug("available space: ".concat(b.width," x ").concat(b.height)))},[b]),(0,r.jsxs)(r.Fragment,{children:[o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(T.Z,{sx:{flexGrow:1},joinView:(0,r.jsx)(()=>(0,r.jsx)(F.Z,{preTitle:(0,r.jsx)(g.Z,{i18nKey:"onboarding.thanks"}),title:(0,r.jsx)(g.Z,{i18nKey:"onboarding.almostThere"}),bar:"Connecting your video call..."}),{}),children:[(0,r.jsxs)(q.Z,{className:"available-space-and-controls-container",sx:{width:"100%",height:"100%",position:"absolute",left:0,top:0,right:0,bottom:0,display:"flex",flexDirection:"column"},children:[(0,r.jsx)(q.Z,{className:"available-space-ref",ref:p,sx:{display:"block",flexGrow:1,m:0,p:0}}),(0,r.jsxs)(q.Z,{className:"call-controls-container",sx:{backgroundColor:"callControlPanelBackground.main",display:"grid",gap:2,gridTemplateColumns:"1fr 1fr 1fr",px:1},children:[(0,r.jsx)(q.Z,{className:"left-controls-container"}),(0,r.jsx)(m.ZP,{className:"centre-controls-container",direction:"row",showAudioConfigMenu:!0,showCameraConfigMenu:!0,busy:!1,isPreview:!1}),(0,r.jsxs)(q.Z,{className:"right-controls-container",sx:{alignItems:"center",alignSelf:"center",display:"flex",flexDirection:"row",justifySelf:"end",pr:1},children:[(0,r.jsx)(W,{}),(0,r.jsxs)(Z.Z,{disableFocusRipple:!0,onClick:()=>{c(e=>!e)},sx:e=>({borderRadius:"4px",flexDirection:"column",ml:2,p:.5,"&:focus-visible":{...e.customStyles.focusRingReverse,outlineOffset:"2px"},"&:hover":{"> p":{color:"#6C63FF"},"> svg":{stroke:"#6C63FF"}}}),children:[(0,r.jsx)(ee.Z,{color:"#f5f5f5",size:"32px"}),(0,r.jsx)(H.Z,{color:"white",sx:{fontSize:"14px",textTransform:"uppercase"},children:(0,r.jsx)(g.Z,{i18nKey:"techSupport.buttons.support"})})]})]})]})]}),(0,r.jsx)(q.Z,{className:"tiles-outer-container",sx:{position:"absolute",left:0,top:0,right:0,display:"block"},children:(0,r.jsx)(v.ZP,{role:l._b.Client,children:(0,r.jsx)(B,{activity:d.activity,enableExpandButton:d.enableExpandButton,presentation:d.presentation,availableSpace:d.availableSpace})})})]}),(0,r.jsx)($,{backdropHeight:b.height,showTechSupport:a,setShowTechSupport:c})]}),!o&&(0,r.jsx)(q.Z,{sx:{width:"100%",height:"100%",p:1,position:"relative"},children:n.presentation})]})}var en=n(25907);let eo=(0,s.createContext)({});function ei(e){let[t,n]=(0,s.useState)({leftTheWorkshop:!1});(0,s.useEffect)(()=>((0,u.r)(window)&&(!1===t.leftTheWorkshop?window.addEventListener("beforeunload",o):window.removeEventListener("beforeunload",o)),()=>{window.removeEventListener("beforeunload",o)}),[t.leftTheWorkshop]);let o=e=>{e.preventDefault()};return(0,r.jsx)(r.Fragment,{children:a.UA?(0,r.jsx)(p.Z,{}):(0,r.jsx)(eo.Provider,{value:{participantSessionFlags:t,setParticipantSessionFlags:n},children:(0,r.jsx)(en.Z,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:l._b.Client,children:(0,r.jsxs)(c.Z,{role:l._b.Client,children:[(0,r.jsx)(d.Z,{}),(0,r.jsx)(et,{})]})})})})}},25907:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(57437),i=n(48612),r=n(2265),s=n(90089),a=n(53622),l=n(39501);function c(e){let{language:t}=(0,r.useContext)(a.p),[n,c]=(0,r.useState)((0,i.ZP)(t));return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(s.a3,{i18n:n,children:(0,o.jsx)(l.Z,{sid:e.sid,role:e.role,refresh:e.refresh,joinCode:e.joinCode,children:e.children})})})}},15785:function(e,t,n){var o,i;n.d(t,{I:function(){return r},S:function(){return o}}),(i=o||(o={}))[i.default=0]="default",i[i.deliberation=1]="deliberation";let r={index:0,activity:0,recordingId:void 0,notes:"",qids:[],secs:void 0,transitionSound:!1}},49752:function(e,t,n){n.d(t,{Z:function(){return s}});var o=n(57437),i=n(31193),r=n(9646);function s(e){let t=()=>{var t;return(0,o.jsx)(r.Z,{btnKey:"submit",btnText:e.text,busy:e.busy,disabled:!e.enabled,variant:null!==(t=e.variant)&&void 0!==t?t:"contained",size:!0===e.large?"large":"medium",sx:e.sx,onClick:t=>e.onSubmit?e.onSubmit():null})},n="left"===e.alignment?"flex-start":"right"===e.alignment?"flex-end":"stretch";return(0,o.jsxs)(o.Fragment,{children:[e.inline&&(0,o.jsx)(t,{}),!e.inline&&(0,o.jsx)(i.Z,{sx:e.sx,display:"flex",flexDirection:"row",justifyContent:n,children:(0,o.jsx)(t,{})})]})}},71359:function(e,t,n){n.d(t,{Q:function(){return i},Z:function(){return w}});var o,i,r=n(57437),s=n(8260),a=n(94547),l=n(31193),c=n(44908),d=n(11929),u=n(22599),p=n.n(u),h=n(2265),f=n(4087),x=n(48620),g=n(49752),m=n(26049),v=n(45231);(o=i||(i={}))[o.continuous=0]="continuous",o[o.discrete=1]="discrete",o[o.categorical=2]="categorical";let b=(e,t)=>{var n;return{answers:[{key:"".concat(e),index:e,description:null!==(n=null==t?void 0:t[e])&&void 0!==n?n:"".concat(e),numericValue:1}]}},y=()=>({answers:[{key:"unsure",description:"unsure",numericValue:1}]});function w(e){var t;let{answers:n}=(0,s.ZP)(e.qids.qid),o=()=>{var t;return(0,s.Zp)(n,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)},[u,w]=(0,h.useState)(o()),[j,k]=(0,h.useState)(o()),[S,Z]=(0,h.useState)(!1),[C,I]=(0,h.useState)(e.role===a._b.Client),[D,E]=(0,h.useState)(!1);(0,h.useEffect)(()=>{var t;k({...u,jsonValue:null!==(t=u.jsonValue)&&void 0!==t?t:b(Math.floor((R()+B())/2),e.marks)})},[u]);let P=async()=>{if(e.role!==a._b.Client){console.warn("Only participants can submit answers");return}Z(!0),e.onAnswer(j).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)w(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{Z(!1)})},A=async()=>{if(e.role!==a._b.Client){console.warn("Only participants can submit answers");return}Z(!0);let t={...j,jsonValue:y()};e.onAnswer(t).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)w(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{Z(!1)})},R=()=>{switch(e.type){case 2:return 0;case 0:case 1:return e.numericRange?e.numericRange[0]:0;default:throw"Unsupported SliderInputType ".concat(i[e.type])}},B=()=>{switch(e.type){case 2:return e.marks.length-1;case 0:case 1:return e.numericRange?e.numericRange[1]:10;default:throw"Unsupported SliderInputType ".concat(i[e.type])}},T=()=>{var t,n;switch(e.type){case 2:return 1;case 0:return null!==(t=e.numericStep)&&void 0!==t?t:.01;case 1:return null!==(n=e.numericStep)&&void 0!==n?n:1;default:throw"Unsupported SliderInputType ".concat(i[e.type])}},F=e.marks?100-100/e.marks.length:void 0,q=F?"".concat(F,"%"):void 0;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(l.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,r.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"column",flexGrow:1,alignItems:"center",justifyContent:"center",px:4,gap:8},children:[(0,r.jsx)(l.Z,{children:e.question&&(0,r.jsx)(x.Z,{content:e.question})}),(0,r.jsx)(l.Z,{sx:{width:null!=q?q:"95%"},children:(0,r.jsx)(m.Z,{onCommit:t=>{k({...j,jsonValue:b(t,e.marks)})},color:"secondary",disabled:D,sliderDefault:j.jsonValue?p().toNumber(j.jsonValue.answers[0].index):Math.floor((R()+B())/2),marks:null!==(t=(()=>{switch(e.type){case 2:return e.marks.map((e,t)=>({value:t,label:e}));case 0:return;case 1:return p().range(e.numericRange[0],e.numericRange[1]+1,T()).map((e,t)=>({value:e,label:"".concat(e)}))}})())&&void 0!==t&&t,slots:{markLabel:v.A},min:R(),max:B(),step:T(),sliderMode:"solo"})}),e.showUnsure&&(0,r.jsx)(l.Z,{children:(0,r.jsx)(c.Z,{control:(0,r.jsx)(d.Z,{checked:D,onChange:(e,t)=>E(t)}),label:(0,r.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.25rem"},children:(0,r.jsx)(f.Z,{i18nKey:"button.unsure"})})})})]}),e.role===a._b.Client&&(0,r.jsx)(l.Z,{children:(0,r.jsx)(g.Z,{onSubmit:()=>{D?A():P()},text:(0,r.jsx)(f.Z,{i18nKey:"button.submit"}),busy:S,enabled:C,inline:!1,alignment:"right"})})]})})}},26049:function(e,t,n){n.d(t,{Z:function(){return a}});var o=n(57437),i=n(48024),r=n(43298),s=n(2265);function a(e){var t;let[n,a]=(0,s.useState)(null!==(t=e.sliderDefault)&&void 0!==t?t:0),[l,c]=(0,s.useState)("solo"===e.sliderMode?1:.5),d=(0,s.useMemo)(()=>(0,i.ZP)(r.ZP)({color:"secondary",height:"".concat(.8*l,"em"),"& .MuiSlider-thumb":{height:"".concat(1.6*l,"em"),width:"".concat(1.6*l,"em"),backgroundColor:"secondary",boxShadow:"0px 4px 10px 0px rgba(0, 0, 0, 0.25) inset","&::before":{display:"none"}},"& .MuiSlider-rail":{borderRadius:"".concat(.4*l,"em"),boxShadow:"0px 4px 10px 0px rgba(0, 0, 0, 0.25) inset"},"& .MuiSlider-track":{borderRadius:"".concat(.4*l,"em"),boxShadow:"0px 4px 10px 0px rgba(0, 0, 0, 0.25) inset"},"& .MuiSlider-markLabel":{fontSize:"".concat(1*l,"rem"),marginTop:"".concat(2.5*l,"em")}}),[l]);return(0,o.jsx)(d,{...e,value:n,onChange:(e,t)=>{a(t)},onChangeCommitted:(t,n)=>{let o=n;e.acceptableRange&&o>e.acceptableRange.max&&(o=e.acceptableRange.max),e.acceptableRange&&o<e.acceptableRange.min&&(o=e.acceptableRange.min),a(o),e.onCommit(o)}})}},45231:function(e,t,n){n.d(t,{A:function(){return s}});var o=n(57437),i=n(43298),r=n(80511);let s=e=>{let t=e["data-index"],n=e.ownerState.marks[t],s=e.ownerState.marks.length,a={...e.style,width:"".concat(100/s,"%"),wordWrap:"normal",whiteSpace:"wrap"};return(0,o.jsx)(i.J$,{...e,style:a,children:(0,o.jsx)(r.Z,{variant:"sliderMark",style:{display:"block",wordWrap:"normal",whiteSpace:"wrap"},children:n.label})})}},45080:function(e,t,n){n.d(t,{L:function(){return i},Z:function(){return R}});var o,i,r=n(57437),s=n(8260),a=n(94547),l=n(7630),c=n(49428),d=n(22960),u=n(31193),p=n(66858),h=n(44908),f=n(11929),x=n(96537),g=n(69065),m=n(66124),v=n(60335),b=n(80511),y=n(19309),w=n(2265),j=n(48620),k=n(49752),S=n(73391),Z=n(60320);let C=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,I=(e,t,n)=>{let o=[],r=null!=t?t:"";switch(e){case i.text:let s=n?r.length>0?null:"Please enter an answer":null;null!==s&&o.push(s);break;case i.email:let a=C.test(r.trim()),l=n?r.trim().length>0&&a?null:"Please enter a valid email address.":0===r.trim().length||a?null:"Please enter a valid email address.";null!==l&&o.push(l);break;default:throw"Unsupported TextInputType"}return o},D=(e,t)=>{if(console.debug("Validating checkboxes",e),void 0===e)return["Checkbox data undefined."];let n=e.filter(e=>e.checked).length,o=e.map((e,t)=>e.required&&!e.checked?"The ".concat((0,S.q)(t+1)," checkbox is required."):null).filter(e=>null!==e).map(e=>e),i=[];return n<t&&i.push("Please select at least ".concat(t," ").concat(1===t?"checkbox":"checkboxes",".")),[...o,...i]},E=()=>(0,r.jsx)(Z.Z,{children:(0,r.jsx)("svg",{focusable:"false","aria-hidden":"true","data-testid":"CheckBoxBlankIcon",children:(0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5",fill:"white"})})});(o=i||(i={}))[o.text=0]="text",o[o.email=1]="email";let P=(e,t)=>({...e,jsonValue:{answers:[{key:"text",stringValue:t.answer},...t.checks.map(e=>({key:e.key,stringValue:e.text,booleanValue:e.checked}))]}}),A=(e,t)=>{var n,o;return{answer:null===(o=e.jsonValue)||void 0===o?void 0:null===(n=o.answers.find(e=>"text"===e.key))||void 0===n?void 0:n.stringValue,checks:t.map(t=>{var n,o,i;return{key:t.key,text:t.text,initial:t.initial,checked:null!==(i=null===(o=e.jsonValue)||void 0===o?void 0:null===(n=o.answers.find(e=>e.key===t.key))||void 0===n?void 0:n.booleanValue)&&void 0!==i?i:t.initial,required:t.required}})}};function R(e){var t;let{answers:n}=(0,s.ZP)(e.qids.qid),[o,i]=(0,w.useState)((0,s.Zp)(n,e.qids,e.question.pii)),[S,Z]=(0,w.useState)({answer:void 0,checks:[]}),[C,R]=(0,w.useState)(!1),[B,T]=(0,w.useState)(!0),[F,q]=(0,w.useState)(e.role===a._b.Client),[M,_]=(0,w.useState)(!1),[N,O]=(0,w.useState)(!1),[W,K]=(0,w.useState)([]),[L,U]=(0,w.useState)(),[V,z]=(0,w.useState)(!1),H=()=>{z(!1)};(0,w.useEffect)(()=>{Z(A(o,e.checkboxes))},[o,e.checkboxes]);let G=()=>{var t,n;let o=[...D(S.checks,e.minCheckboxes),...I(e.type,S.answer,e.textRequired)],i=(null!==(n=null===(t=S.answer)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0;return T(!N||0===o.length&&(i||!e.textRequired)),K(o),0===o.length};(0,w.useEffect)(()=>{N&&G()},[S]);let J=async()=>{if(e.role===a._b.Client&&B){if(O(!0),G()){let t=P(o,S);console.debug("Submitting TextInput",t),R(!0),e.onAnswer(t).then(t=>{if(console.debug("Answer submitted ".concat(t?"ok":"error")),console.debug("Received answer response",t),null!==t)Z(A(t,e.checkboxes));else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{R(!1)})}}else console.warn("Only participants can submit answers")},Y=async()=>{let t=P(o,{...S,answer:void 0,checks:[]});R(!0),e.onAnswer(t).then(t=>{if(console.debug("Answer submitted ".concat(t?"ok":"error")),console.debug("Received answer response",t),null!==t)Z(A(t,e.checkboxes));else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{R(!1)})},Q=(e,t)=>{let n={...S,checks:[...S.checks]};n.checks.find(t=>t.key===e).checked=t,Z(n)};(0,w.useEffect)(()=>{U(W.join(" ")),_(W.length>0)},[W]);let X={maxlength:e.maxLength};return(0,d.Z)(),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(u.Z,{className:"stretch",sx:{width:"100%",height:e.fullHeight?"100%":"initial",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(e.question.explanation||e.question.instruction||e.question.question)&&(0,r.jsx)(u.Z,{sx:{mb:4},children:(0,r.jsx)(j.Z,{content:e.question})}),(0,r.jsx)(p.Z,{label:e.label,variant:"outlined",defaultValue:S.answer,helperText:L,type:1===e.type?"email":"text",onChange:e=>{Z({...S,answer:e.target.value})},error:M,color:"buttonStandard",autoComplete:"off",InputProps:{sx:{background:"white",fontSize:"2rem"}},InputLabelProps:{sx:{fontSize:"2rem","&.MuiOutlinedInput-notchedOutline":{fontSize:"2rem"}}},sx:{mb:2},minRows:e.minRows,multiline:e.multiline,inputProps:X}),S.checks.map((t,n)=>(0,r.jsx)(u.Z,{display:"flex",flexDirection:"row",children:(0,r.jsx)(h.Z,{control:(0,r.jsx)(f.Z,{checked:t.checked,onChange:(e,n)=>Q(t.key,n),icon:e.forceCheckboxesWhite?(0,r.jsx)(E,{}):void 0}),label:t.text})},"checkbox-".concat(e.qids.qid,"-").concat(n,"-").concat(t.key))),e.information&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{variant:"text",fullWidth:!1,color:"buttonStandard",sx:{textDecoration:"underline",alignSelf:"start",mt:2},startIcon:(0,r.jsx)(c.Z,{}),onClick:()=>z(!0),children:e.information.heading}),(0,r.jsx)(g.Z,{fullWidth:!0,maxWidth:"md",open:V,onClose:H,children:(0,r.jsxs)(m.Z,{children:[(0,r.jsx)(u.Z,{style:{position:"absolute",top:0,right:0},children:(0,r.jsx)(v.Z,{"aria-label":"close",onClick:H,children:(0,r.jsx)(l.Z,{})})}),(0,r.jsx)(u.Z,{sx:{p:2},display:"flex",flexDirection:"column",children:e.information.body.map((t,n)=>(0,r.jsx)(b.Z,{variant:"slideInfoText",align:"left",dangerouslySetInnerHTML:{__html:(0,y.Z)(t)}},"".concat(e.qids.qid,"-info-body-").concat(n)))})]})})]}),e.maxLength&&(0,r.jsx)(b.Z,{sx:{margin:"0 !important",textAlign:"left"},variant:"body1",children:"".concat((null===(t=S.answer)||void 0===t?void 0:t.length)||0," / ").concat(e.maxLength)}),(0,r.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"row",gap:1,justifyContent:"end",alignItems:"end"},children:[e.skipText&&(0,r.jsx)(k.Z,{inline:!0,busy:C,onSubmit:Y,large:!0,variant:"outlined",text:e.skipText,enabled:!0}),(0,r.jsx)(k.Z,{inline:!0,busy:C,onSubmit:J,large:!0,text:e.submitText,enabled:!N||B})]})]})})}},22228:function(e,t,n){n.d(t,{EV:function(){return m},ZP:function(){return v},l$:function(){return i}});var o,i,r=n(57437),s=n(8260),a=n(94547),l=n(4087),c=n(31193),d=n(34990),u=n(60335),p=n(80511),h=n(14874),f=n(2265),x=n(48620);(o=i||(i={}))[o.Yes=0]="Yes",o[o.No=1]="No",o[o.Unsure=2]="Unsure";let g=e=>0===e?1:1===e?-1:0,m=e=>1===e?0:-1===e?1:2;function v(e){var t;let{answers:n}=(0,s.ZP)(e.qids.qid),[o,m]=(0,f.useState)((0,s.Zp)(n,e.qids,null===(t=e.question)||void 0===t?void 0:t.pii)),[v,b]=(0,f.useState)(o),[y,w]=(0,f.useState)(!1),j=e.role===a._b.Client;(0,f.useEffect)(()=>{b({...o})},[o]);let k=async e=>{if(j&&!y){let t={...v,jsonValue:{answers:[{key:"vote",stringValue:i[e],numericValue:g(e)}]}};await S(t)}},S=async t=>{try{w(!0);let n=await e.onAnswer(t);if(null!==n)m(n);else throw"Failed to submit answer"}catch(e){console.error(e)}finally{w(!1)}},Z=(0,h.Z)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(c.Z,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsx)(x.Z,{content:e.question}),(0,r.jsxs)(c.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,r.jsxs)(d.Z,{elevation:0,sx:{p:4,mb:2,width:"60%",height:"70%",alignSelf:"center",minHeight:200,borderRadius:4,background:Z.palette.promptPanelBackground.main,display:"flex",flexDirection:"row",alignContent:"center",justifyContent:"stretch"},children:[(0,r.jsx)(c.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,r.jsx)("div",{style:{position:"absolute",width:"15%",height:"20%",padding:0,margin:0},children:(0,r.jsx)(u.Z,{sx:{position:"relative",left:"-100%",top:0,width:"100%",height:"100%",m:0,p:0},onClick:()=>k(1),disabled:!j||y,style:{opacity:j&&!y?1:.5},children:(0,r.jsx)("img",{src:"/icons/updown/cross.svg",alt:"False button icon"})})})}),(0,r.jsx)(c.Z,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",p:2},children:(0,r.jsx)(p.Z,{variant:"upDownQuestion",sx:{textAlign:"center",alignSelf:"center"},children:e.assertion})}),(0,r.jsx)(c.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,r.jsx)("div",{style:{position:"absolute",width:"15%",height:"20%",padding:0,margin:0},children:(0,r.jsx)(u.Z,{sx:{position:"relative",right:0,top:0,width:"100%",height:"100%",m:0,p:0},style:{opacity:j&&!y?1:.5},onClick:()=>k(0),disabled:!j||y,children:(0,r.jsx)("img",{src:"/icons/updown/check.svg",alt:"True button icon"})})})})]}),(0,r.jsx)(c.Z,{sx:{p:2,borderRadius:4,cursor:"pointer",opacity:j&&!y?1:.5,alignSelf:"center"},onClick:()=>k(2),display:"flex",flexDirection:"column",justifyContent:"center",children:(0,r.jsx)(p.Z,{variant:"submitButton",style:{borderBottom:"solid 1px black"},children:(0,r.jsx)(l.Z,{i18nKey:"poll.upDown.notSure"})})})]})]})})}},47656:function(e,t,n){n.d(t,{O:function(){return h},Z:function(){return f}});var o=n(57437),i=n(22599),r=n.n(i),s=n(2265),a=n(40772),l=n(14874),c=n(33351),d=n(8260),u=n(22228),p=n(48620);let h="_";function f(e){let{allAnswers:t}=(0,d.ZP)(),n=t[e.qIds.qid],i=[],f=[];if(n)for(let t of n){var x;let n=t.id,r=null===(x=t.jsonValue)||void 0===x?void 0:x.answers[0].stringValue,s="".concat(e.qIds.qid).concat(h).concat(n);n&&r&&t.participantId!==e.qIds.pid&&(i.push({qid:s,sid:e.qIds.sid,pid:e.qIds.pid}),f.push((0,o.jsx)(u.ZP,{qids:{qid:s,sid:e.qIds.sid,pid:e.qIds.pid},role:e.role,assertion:r,onAnswer:e.onAnswer})))}let g=()=>{for(let e of i)if(!(0,d.S9)((0,d.UJ)(t[e.qid],e)))return i.indexOf(e)},[m,v]=(0,s.useState)(g());(0,s.useEffect)(()=>{let e=g();m!==e&&v(e)},[t]);let b=(0,l.Z)(),y=[.2,.25],[w]=(0,a.u)({duration:500});return n&&0!==i.length?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(c.Z,{ref:w,className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",p:2,gap:2,boxSizing:"border-box"},children:[void 0!==m&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p.Z,{content:e.question}),(0,o.jsx)(c.Z,{sx:{flexGrow:1,boxSizing:"border-box",overflowY:"auto",overflowX:"hidden",display:"block"},children:f[m]},"input-sequence-element-".concat(i[m].qid))]}),void 0===m&&(0,o.jsx)(c.Z,{sx:{flexGrow:1,display:"block"},children:e.completion}),void 0!==m&&e.showProgress&&(0,o.jsx)(c.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:r().range(0,f.length).map((e,t)=>(0,o.jsx)(c.Z,{sx:{background:e===m?b.palette.progressBlipSelected.main:b.palette.progressBlipUnselected.main,width:"".concat(y[e===m?1:0],"em"),height:"".concat(y[e===m?1:0],"em"),borderRadius:"".concat(y[e===m?1:0]/2,"em")}},"sequence-blip-".concat(e,"-").concat(i[e].qid)))})]})}):null}},48620:function(e,t,n){n.d(t,{Z:function(){return s}});var o=n(57437),i=n(31193),r=n(80511);function s(e){var t,n,s,a,l,c;return(0,o.jsx)(o.Fragment,{children:((null===(t=e.content)||void 0===t?void 0:t.explanation)||(null===(n=e.content)||void 0===n?void 0:n.instruction)||(null===(s=e.content)||void 0===s?void 0:s.question))&&(0,o.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:[e.content.instruction&&(0,o.jsx)(r.Z,{variant:"questionInstruction",align:null!==(a=e.forceAlign)&&void 0!==a?a:"center",component:"div",sx:{alignSelf:"stretch",textWrap:"balance",...e.sx},children:e.content.instruction}),e.content.question&&(0,o.jsx)(r.Z,{variant:"questionPrompt",align:null!==(l=e.forceAlign)&&void 0!==l?l:"center",component:"div",sx:{alignSelf:"stretch",textWrap:"balance",...e.sx},children:e.content.question}),e.content.explanation&&(0,o.jsx)(r.Z,{variant:"questionExplanation",align:null!==(c=e.forceAlign)&&void 0!==c?c:"center",component:"div",sx:{alignSelf:"stretch",textWrap:"balance",...e.sx},children:e.content.explanation})]})})}},12569:function(e,t,n){n.d(t,{J:function(){return i},Z:function(){return b}});var o,i,r=n(57437),s=n(8260),a=n(71432),l=n(22960),c=n(41506),d=n(28651),u=n(97294),p=n(43152),h=n(22599),f=n.n(h),x=n(2265),g=n(35231),m=n(48620),v=n(24132);function b(e){var t,n,o;let{answers:i}=(0,s.ZP)(e.qids.qid),[h,b]=(0,x.useState)();(0,x.useEffect)(()=>{switch(e.inputType){case v.rT.keyed:b((0,v.oL)(i,e.options,e.sorting));break;case v.rT.categorical:b((0,v.dx)(i,e.categories,e.range,e.sorting));break;case v.rT.numerical:b((0,v.B8)((0,v.tJ)(i,e.range,e.sorting)));break;default:throw"Unsupported GraphInputType"}},[i,e.categories,e.inputType,e.range]);let y={position:"none",disableLine:!0,disableTicks:!0,tickInterval:f().range(0,1e3,1),valueFormatter:e=>""},w={id:"categories_axis",scaleType:"band",dataKey:"category",disableLine:!1,disableTicks:!1,tickLabelStyle:{fontSize:null!==(n=e.categoriesLegendFontSize)&&void 0!==n?n:"1rem"}},j=f().max(null==h?void 0:h.map(e=>e.votes)),k=(0,l.Z)();return(0,r.jsxs)(r.Fragment,{children:[e.question&&(0,r.jsx)(m.Z,{content:e.question}),(0,r.jsx)(g.h,{width:"100%",height:"100%",minWidth:50,minHeight:50,children:(0,r.jsx)(c.v,{layout:1===e.orientation?"vertical":"horizontal",margin:{left:null!==(o=null===(t=e.margin)||void 0===t?void 0:t.left)&&void 0!==o?o:1===e.orientation?50:150},grid:{horizontal:1===e.orientation&&(!(0,a.r)(j)||j<50),vertical:0===e.orientation&&(!(0,a.r)(j)||j<50)},dataset:h,barLabel:"value",sx:{[".".concat(d.Is.root)]:{},".MuiBarElement-series-votes_id":{fill:k.palette.secondary.main},".MuiBarLabel-series-votes_id":{fill:"white",fontWeight:"bolder"},["& .".concat(p.k.line)]:{strokeDasharray:"5 3",strokeWidth:1},[".".concat(u.x.tickContainer)]:{textWrap:"wrap"}},slotProps:{bar:{rx:4,ry:4}},xAxis:1===e.orientation?[w]:[y],yAxis:1===e.orientation?[y]:[w],series:[{dataKey:"votes",label:void 0,id:"votes_id",valueFormatter:e=>null===e?"No data":1===e?"1 point":"".concat(e.toFixed(0)," points")}]})})]})}(o=i||(i={}))[o.horizontal=0]="horizontal",o[o.vertical=1]="vertical"},24132:function(e,t,n){n.d(t,{B8:function(){return j},dx:function(){return x},oL:function(){return f},rT:function(){return s},tJ:function(){return g}});var o,i,r,s,a=n(71432),l=n(22599),c=n.n(l);(o=r||(r={}))[o.bar=0]="bar",(i=s||(s={}))[i.categorical=0]="categorical",i[i.numerical=1]="numerical",i[i.keyed=2]="keyed";let d=e=>e.length>0&&"category"in e[0]&&"votes"in e[0],u=e=>e.length>0&&"value"in e[0]&&"votes"in e[0],p=e=>{var t,n;return c().range(e.lo,e.hi+(null!==(t=e.step)&&void 0!==t?t:1),null!==(n=e.step)&&void 0!==n?n:1)},h=e=>e.replace(/\\n/g,"\n"),f=(e,t,n)=>m(t.map(t=>({category:h(t.title),votes:y(e,t.key)})),n),x=(e,t,n,o)=>m(v(t,n).map((t,n)=>({category:h(t),votes:b(e,n)})),o),g=(e,t,n)=>m(p(t).map(t=>({value:t,votes:w(e,t)})),n),m=(e,t)=>{if((0,a.r)(t.sortOn)){switch(t.sortOn){case"category":d(e)&&e.sort((e,t)=>e.category<t.category?-1:1);break;case"value":u(e)&&e.sort((e,t)=>e.value<t.value?-1:1);break;case"votes":e.sort((e,t)=>e.votes-t.votes);break;default:throw"Unsupported sortOn: ".concat(t.sortOn)}"desc"===t.sortOrder&&e.reverse()}return e},v=(e,t)=>{let n=void 0!==e?e:void 0!==t?p(t).map(e=>"".concat(e)):void 0;if(void 0===n)throw"Cannot determine categories";return n.filter(e=>void 0!==e).map(e=>e)},b=(e,t)=>c().sum(e.map(e=>{var n;return c().sum(null===(n=e.jsonValue)||void 0===n?void 0:n.answers.filter(e=>e.index===t).map(e=>{var t;return null!==(t=e.numericValue)&&void 0!==t?t:0}))})),y=(e,t)=>c().sum(e.map(e=>{var n;return c().sum(null===(n=e.jsonValue)||void 0===n?void 0:n.answers.filter(e=>e.key===t).map(e=>{var t;return null!==(t=e.numericValue)&&void 0!==t?t:0}))})),w=(e,t)=>b(e,t),j=e=>e.map(e=>({category:"".concat(e.value),votes:e.votes}))},78364:function(e,t,n){n.d(t,{Z:function(){return u}});var o=n(57437),i=n(2265),r=n(11144),s=n(4766),a=n(5085),l=n(94547),c=n(95114),d=n(71432);function u(){let{role:e}=(0,i.useContext)(a.rZ),{session:t}=(0,i.useContext)(r.z),{slideData:n}=(0,s.Ao)(),u=(0,i.useRef)(),p=(0,i.useContext)(c.Nx),h=async()=>{let e=new Audio("/sounds/00-ding.mp3");if(e.volume=.5,(0,d.r)(null==p?void 0:p.state.current.audioOutputDevice)){if((0,d.r)(e.setSinkId))try{await e.setSinkId(p.state.current.audioOutputDevice)}catch(e){console.warn("Error setting audio output device for SlideTransitionSound",e)}else console.debug("Audio.setSinkId not defined")}return e},f=(0,i.useCallback)(async()=>{(await h()).play()},[h]);return(0,i.useEffect)(()=>{(e===l._b.Controller||t.remoteConfiguration!==l.VS.InPerson)&&n.index!==u.current&&(u.current=n.index,n.transitionSound&&f())},[e,t.remoteConfiguration,n.index,f]),(0,o.jsx)(o.Fragment,{})}},73391:function(e,t,n){n.d(t,{q:function(){return o}});let o=e=>{let t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"}},48612:function(e,t,n){n.d(t,{k$:function(){return a},aB:function(){return l},ZP:function(){return c}});var o=n(46027),i=n(90089),r=JSON.parse('{"button":{"close":"Close","continue":"CONTINUE","getStarted":"GET STARTED","reconnect":"Reconnect","reload":"Reload page","submit":"Submit","goFullScreen":"Go full screen","exitFullScreen":"Exit full screen","retryUpload":"Retry upload","unsure":"Unsure"},"connectivityCheck":{"failure":{"heading":" Sorry, there\'s a problem","message":"There seems to be a problem with your connection to the workshop."},"fixGuidance":{"checkAgain":"To check again, just reload this page.","message":"To fix this, you could try:","mobileHotspot":"Tether to your phone\'s mobile hotspot.","wiFiNetwork":"A different network, e.g. guest Wi-Fi, or your home Wi-Fi."},"loading":"Checking your connection, please wait a moment.","success":"Your workshop connection is working well ","supportEmail":{"bodyPart1":"Hi Workshop Tech Team,%0D%0A%0D%0AI ran the workshop connectivity checker for an upcoming workshop that I\'m taking part in.%0D%0A%0D%0AThere seems to be a problem with:%0D%0A%0D%0A","bodyPart2":"%0D%0AMy workshop date is: [please enter your workshop date]%0D%0A%0D%0AMy workshop time is: [please enter your workshop time]%0D%0A%0D%0APlease get back to me ASAP via email or [please enter your phone number].%0D%0A%0D%0AMany thanks,%0D%0A%0D%0A[please enter your name]"},"techGuidance":{"contactUs":"If your workshop is starting soon, please email us and we will try to solve the issue quickly:","contactUsCopyEmail":"Copy email address","heading":"If you\'re still stuck","unblock":"Please ask your IT department to unblock the following:"},"title":"Workshop connectivity check","videoCallCheck":"Please also check your audio and camera settings:","videoCallCheckCta":"Check settings","videoCallCheckCtaTip":"(This will open the Amazon Chime Readiness Checker.)"},"label":{"date":"DATE","time":"TIME"},"field":{"yourName":"Your name"},"onboarding":{"warnings":{"*":{"description":" This could have been caused by a poor internet connection","advice":"Please check your wifi or mobile network signal strength and reload this page."},"ZgSessionUserProvider":{"description":" Authorisation did not succeed","advice":["If you are a facilitator, please log in with your facilitator account and try again.","If you are a participant, please contact support for assistance."]},"ZgStaticSessionDataProvider":{"description":" Unable to access information about this workshop session","advice":"Please confirm that you are using the correct url for your workshop."},"ZgServerTimeProvider":{"description":" Unable to synchronise clock with the server","advice":"This is required to play back videos and other media in sync with other participants."},"ZgStaticSessionContentProvider":{"description":" Unable to retrieve session content","advice":"Videos and other media are required to participate in the workshop. This can take a few minutes, and needs a good internet connection."},"ZgResilientWssConnectionProvider":{"description":" Unable to establish a live connection to the workshop","advice":"This is required to participate in the workshop."}},"welcomeTo":"WELCOME TO","loadingWorkshop":"Loading workshop information...","almostThere":"Almost there","pleaseEnterName":"Please enter your name","pleaseEnterNameExplanation":"This is so we know what to call you during the session, your name will not be saved or stored","thanks":"THANKS","youAreAboutToJoin":"YOU ARE ABOUT TO JOIN","thisWorkshopIsClosed":"This workshop is closed.","thisWorkshopIsOpen":"This workshop is open.","pressJoinToEnter":"Press JOIN WORKSHOP to enter.","youAreRemoved":"You have been removed from this workshop.","joinWorkshop":"JOIN WORKSHOP","leaveWorkshop":"LEAVE WORKSHOP","waitingForOpen":"Waiting for the host to begin the session. Please wait...","supportInfoHeading":"Support information","supportInfoText1":"If your workshop start time has passed and you are still waiting to enter the workshop, it\'s possible your device has become disconnected. Please check your internet connection, and use the reconnect button to try again.","supportInfoText2":"If you are still unable to enter the workshop, please check your invite for technical support contact information. We may ask you to reload the page.","privacyNotice":{"heading":"Zeitgeist Privacy Notice","link":"Privacy notice","errorLoading":"# Privacy notice unavailable\\n\\nWe\'re sorry, we should be able to show you a privacy notice here, but for some reason it\'s unavailable.\\n\\nPlease email [{{email}}](mailto:{{email}}) to let us know."},"workshopInformationLink":"Workshop information","sessionClosed":{"sessionIsClosed":"This workshop is now closed.","sessionIsClosedRegisterLinkAvailable":"This workshop is now closed, but please join us for a future session.","encouragement":"Use one of these methods to register, and please share with friends and family.","visitWebsite":"Visit the website","orScanQrCode":"Or scan the QR code","signUpText":"Sign up for more workshops","emailUs":"Email us at"},"preview":{"audio":{"prompt":"Your mic level"}}},"workshop":{"leaveConfirm":"Are you sure you want to leave the workshop?","leaveCta":"LEAVE THE WORKSHOP","participantLeftHeading":"Thank you for participating in this workshop!","participantLeftGuidance":"Feel free to close this tab. Or if you didn\'t mean to leave, click below to rejoin.","rejoinCta":"Rejoin workshop","returnCta":"RETURN TO THE WORKSHOP"},"videoCall":{"outcomeMessages":{"joining":"Joining the workshop video call...","interaction":{"title":"Are you there?","content":"Please click anywhere in this window to let us know you are ready to join the meeting."},"failed":"Failed to connect to the meeting. Please reload the page.","ended":"This meeting has ended.","joinedFromAnotherDevice":"You appear to have joined from another tab. Please close all other tabs and reload the page.","terminalFailure":"Unable to connect to the meeting. Please reload the page.","left":"You have left the meeting."}},"poll":{"pointsAllocation":{"remaining":"{{numberOfPoints}} points remaining"},"upDown":{"notSure":"Unsure"}},"demographic":{"multi-select":{"default-selection-item-prompt":"Please select an option","add-item":"Add","remove-item":"Remove"},"overview":{"submit":"Submit"},"input":{"submit":"Confirm","ratherNotSay":"I would rather not say"}},"audio":{"audioInputSelection":"Microphone","audioOutputSelection":"Speaker","enableMic":"Enable microphone","muteMic":"Mute microphone","reduceBackgroundNoise":"Reduce background noise","settingsMenu":"Audio settings","muted":"Muted"},"audioRecorder":{"checkMic":"Check microphone","preferredMicProblem":"Your browser seems to be using the wrong microphone. Please check your settings and select the Anker PowerConf device."},"transcribing":{"automaticTranscribing":"Automatic transcribing","downloadTranscription":"Download transcription","startTranscribing":"Start transcribing","stopTranscribing":"Stop transcribing","transcribing":"Transcribing","transcriptionId":"Transcription id","transcribingInformation":"Transcribing information","transcriptionCouldNotUpload":"The transcription could not be uploaded","transcriptionUploadFailed":"Transcription upload failed"},"techSupport":{"buttons":{"problemSolved":"Problem solved","stillNeedHelp":"I still need help","support":"Support"},"chooseProblem":"Choose from the list","email":"Email:","phone":"Phone:","pleaseCheck":"Please check the following:","problems":{"cannotHearOthers":{"description":"Audio: I can\'t hear other people","heading":"We\'re sorry that you can\'t hear other people","tip1Heading":"Check if your device\'s sound is switched on","tip1Body":"Look for a volume icon on your screen or keyboard.","tip2Heading":"Check your audio settings","tip2Body":"Click the arrow next to the microphone icon below, then select your preferred speaker from the list.","tip3Heading":"Check your tab isn\'t muted","tip3Body":"In your browser, right-click the tab and look for an \'Unmute site\' option."},"differentProblem":{"description":"A different problem"},"othersCannotHearMe":{"description":"Audio: other people can\'t hear me","heading":"We\'re sorry that other people can\'t hear you","tip1Heading":"Check your microphone isn\'t muted","tip1Body":"Look for the microphone button at the bottom of your screen. If it is red, others won\'t be able to hear you.","tip2Heading":"Check your microphone settings","tip2Body":"Click the arrow next to the microphone icon below, then select your preferred microphone from the list."}},"teamIsAvailable":"Our team is on hand and will get back to you as soon as possible."},"video":{"blurBackground":"Blur my background","disableCamera":"Disable camera","enableCamera":"Enable camera","settingsMenu":"Camera settings","videoInitFailed":"Video failed to initialise.","videoInputSelection":"Camera","videoManualControl":"Please use the video controls to start your video.","videoReadiness":"Your facilitator will start the video as soon as everybody is ready...","notAllReady":"Not all participants are ready to play video."},"upDownResult":{"divisiveDescription":"These statements split the room...","supportedDescription":"Most people agreed with...","opposedDescription":"Most people disagreed with...","unansweredDescription":"Most did not answer..."}}'),s=JSON.parse('{"button":{"continue":"DEVAM ET","getStarted":"Balayn","reconnect":"Tekrar balan","submit":"G\xf6nder","goFullScreen":"Tam ekran moduna ge\xe7","exitFullScreen":"Tam ekran kapat","unsure":"Fikrim yok"},"label":{"date":"Tarih","time":"Saat"},"field":{"yourName":"Adnz"},"onboarding":{"welcomeTo":"Ho Geldiniz","loadingWorkshop":"At\xf6lye bilgilerini y\xfckl\xfcyor...","almostThere":"Neredeyse bitti","pleaseEnterName":"L\xfctfen adnz girin","pleaseEnterNameExplanation":"Bu, seans srasnda size nasl hitap edeceimizi bilmek i\xe7indir, adnz kaydedilmeyecek veya saklanmayacaktr","thanks":"Teekk\xfcrler","youAreAboutToJoin":"Katlmak \xfczeresiniz","waitingForOpen":"Sunucuyu seans balatmay bekliyor. L\xfctfen bekleyin."},"poll":{"pointsAllocation":{"remaining":"{{numberOfPoints}} puan kald"},"upDown":{"notSure":"Fikrim yok"}},"video":{"videoInitFailed":"Video balatlamad","videoManualControl":"Videonuzu balatmak i\xe7in video kontrollerini kullann l\xfctfen","videoReadiness":"Kolaylatrcnz herkes hazr olduunda videoyu balatacak..."}}');let a="en",l="en";if(!l)throw"No language found in environment";var c=e=>(o.ZP.isInitialized||o.ZP.use(i.Db).init({resources:{en:{common:r},tr:{common:s}},lng:null!=e?e:l,fallbackLng:a,defaultNS:"common",returnObjects:!0}),o.ZP)}}]);