(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[79],{4581:(e,i,s)=>{"use strict";s.d(i,{f:()=>t,k:()=>o});let t=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/participant/session?sid=").concat(e.id,"&code=").concat(e.joinCode),o=e=>"".concat(window.location.href.split("/")[0],"//").concat(window.location.href.split("/")[2],"/facilitator/session?sid=").concat(e.id,"&code=").concat(e.joinCode)},26659:(e,i,s)=>{"use strict";s.r(i),s.d(i,{default:()=>ek});var t=s(95155),o=s(72750),n=s(68534),r=s(12115),l=s(61915),a=s(51368),c=s(62895),d=s(37052),u=s(16324),h=s(53267),p=s(18407),x=s(700),m=s(77262);function f(e){var i;let[s,o]=(0,r.useState)(),[n,l]=(0,r.useState)({overall:{completed:0,total:100},bars:{}});(0,r.useEffect)(()=>(d.A.on(d.m.Content_Progress_Update,o),()=>{d.A.off(d.m.Content_Progress_Update,o)}),[]),(0,r.useEffect)(()=>{void 0!==s&&s.type===d.m.Content_Progress_Update&&l(s.data)},[s]);let a=(0,u.A)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(h.A,{sx:{alignSelf:"center",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100%",width:"60%",maxWidth:"480px"},children:(0,t.jsxs)(p.A,{elevation:1,sx:{p:2,flexGrow:1,textAlign:"start"},children:[(0,t.jsx)(x.A,{component:"h2",variant:"h5",sx:{mb:2},style:{textAlign:"center"},children:e.title}),(0,t.jsx)(x.A,{variant:"body1",children:(0,t.jsx)("span",{style:{color:e.isError?a.palette.error.main:"inherit"},children:null!=(i=e.message)?i:"Unknown error."})}),e.children&&(0,t.jsx)(h.A,{sx:{my:1},children:e.children}),e.isBusy&&!e.showProgress&&(0,t.jsx)(m.A,{sx:{mt:2}}),e.isBusy&&e.showProgress&&(0,t.jsx)(m.A,{sx:{mt:2},value:n.overall.total>0?100*n.overall.completed/n.overall.total:void 0,variant:n.overall.total>0?"determinate":"indeterminate"}),e.isBusy&&e.showProgress&&Object.keys(n.bars).map((e,i)=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.A,{color:"secondary",sx:{mt:1},value:n.bars[e].total>0?100*n.bars[e].completed/n.bars[e].total:0,variant:"determinate"},"loading-progress-bar-".concat(i,"-").concat(e))}))]})})})}let g=e=>e.includes(c._J[c._J.administrators]),v=(0,r.createContext)({});function w(e){var i;let[s,o]=(0,r.useState)((null==(i=window)?void 0:i.localStorage.getItem("DeviceId"))||(0,a.A)());(0,r.useEffect)(()=>{window&&window.localStorage.setItem("DeviceId",s)},[s]);let[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[p,x]=(0,r.useState)(e.role),m=(0,l.As)(),g=async()=>{await m.removeUser(),h(null)};(0,r.useEffect)(()=>m.events.addAccessTokenExpiring(async()=>{console.debug("Access token renewal with auth.signinSilent()...");let e=await m.signinSilent();console.debug("User renewal: ".concat(e?"found":"not found")),h(e)}),[m.events,m.signinSilent]);let[w,y]=(0,r.useState)({user:u,role:p,deviceId:s,groups:[],onSignOut:g});(0,r.useEffect)(()=>{y({...w,role:p})},[p]),(0,r.useEffect)(()=>{y({...w,deviceId:s})},[s]),(0,r.useEffect)(()=>{var e;y({...w,user:u,groups:(null==u||null==(e=u.profile)?void 0:e.hasOwnProperty("cognito:groups"))?u.profile["cognito:groups"]:[]})},[u]);let j=async()=>{try{d(!0);let e=await m.signinSilent();null===e?await m.signinRedirect():h(e)}finally{d(!1)}};return(0,r.useEffect)(()=>{!m.isLoading&&m.user&&h(m.user)},[m.isLoading]),(0,t.jsxs)(t.Fragment,{children:[(c||m.isLoading)&&(0,t.jsx)(f,{isError:!1,isBusy:!0,title:"Checking authentication...",message:"Please wait while we confirm permission to access the facilitator overview.",showProgress:!1}),!m.isLoading&&!c&&(0,t.jsxs)(t.Fragment,{children:[null===u&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f,{isError:!1,isBusy:!1,title:"Please sign in",message:"Please sign in to use the facilitator overview.",showProgress:!1,children:(0,t.jsx)(n.A,{variant:"contained",onClick:()=>j(),disabled:c,children:"Sign in"})})}),(null==u?void 0:u.expired)&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f,{isError:!0,isBusy:!1,title:"Authentication expired",message:"Please sign in again to use the facilitator overview.",showProgress:!1,children:(0,t.jsx)(n.A,{variant:"contained",onClick:()=>j(),disabled:c,children:"Sign in"})})}),null!==w.user&&!w.user.expired&&(0,t.jsx)(v.Provider,{value:w,children:e.children})]})]})}var y=s(63148),j=s(22376),A=s(9665);function b(){let e=(0,r.useContext)(v);return(0,t.jsx)(t.Fragment,{children:e.user.profile.email})}var S=function(e){return e[e.Workshops=0]="Workshops",e[e.Reports=1]="Reports",e}({});function k(e){let[i,s]=(0,r.useState)(0),o=(0,r.useContext)(v),[l,a]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e,i,s=[];(e=o.groups).includes("facilitators")||g(e),s.push(0),((i=o.groups).includes(c._J[c._J.analysts])||g(i))&&s.push(1),a(s)},[o.groups]),(0,r.useEffect)(()=>{console.log("Selection",S[i]),e.onSetSelection(i)},[i]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.A,{children:l.map(e=>(0,t.jsx)(j.A,{onClick:()=>s(e),selected:i==e,children:(0,t.jsxs)(x.A,{variant:"facilitatorOverviewMenuItem",children:[(0,t.jsx)("img",{src:"/icons/workshops.svg",style:{height:26,verticalAlign:"middle",marginRight:12}}),S[e]]})},"facilitator-overview-menu-item-".concat(S[e])))}),e.showUsername&&(0,t.jsx)(h.A,{sx:{position:"absolute",left:"1em",bottom:"1em",zIndex:100},children:(0,t.jsxs)(A.A,{severity:"success",action:e.showSignOut?(0,t.jsx)(n.A,{color:"inherit",size:"small",onClick:o.onSignOut,children:"Sign out"}):void 0,children:["Signed in as: ",(0,t.jsx)(b,{})]})})]})}function C(e){let[i,s]=(0,r.useState)(100),[o,n]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let i,t,o,r=(i=e.menuProportion,t=void 0!==e.menu,o=void 0!==e.main,t?o?100*i:100:0);s(r),n(100-r)},[e.main]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"row",overflow:"hidden",height:"100vh",gap:2,px:1,...e.sx},children:[(0,t.jsx)(h.A,{sx:{width:"".concat(i,"%"),height:"100%",display:"block",overflowY:"auto"},children:e.menu}),(0,t.jsx)(h.A,{sx:{width:"".concat(o,"%"),height:"100%",display:"block",overflowY:"auto"},children:e.main})]})})}var T=s(3455),D=s(31747),E=s(48158),R=s(93874),F=s(95888),W=s(27088),I=s(17348),L=s(16675),_=s(76380);let P=e=>{if(null==e||""===e)return;let i=c.fT[e];if(void 0===i)throw console.error("Unknown report type: ".concat(e)),"Unknown report type: ".concat(e);return i},N=e=>{let i=Array.from(new Set(e.map(e=>Object.keys(e)).flat()));return[i,...e.map(e=>i.map(i=>e[i]))]},O=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map(e=>e.map(e=>e&&isNaN(e)?'"'.concat(e.replace(/"/g,'""'),'"'):e).join(i)).join("\n")};function q(e){let{api:i,start:s}=(0,r.useContext)(o.F),l=(0,r.useContext)(v),[a,d]=(0,r.useState)(""),[u,p]=(0,r.useState)(),[f,g]=(0,r.useState)(),[w,y]=(0,r.useState)(""),[j,A]=(0,r.useState)(!1),b=async(e,t)=>{var o,n;let r=l.user.access_token,a={action:"report",sessionId:null,originator:l.user.profile.email,parameters:{sessionIds:e.map(e=>e.id),reportType:c.fT[t],justification:"Multi-session report requested by analyst"}},d=await s(i.postAnalystAction(a,r));return(null==d?void 0:d.reportResponse)?(null==(o=d.reportResponse.errors)?void 0:o.length)>0&&console.error(d.reportResponse.errors):console.warn("No report response"),null!=(n=null==d?void 0:d.reportResponse)?n:null};return(0,r.useEffect)(()=>{f?y(JSON.stringify(f,null,2)):y("")},[f]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"column",gap:1,py:1},children:[(0,t.jsx)(T.A,{sx:{alignSelf:"end"},btnKey:"close",variant:"outlined",onClick:e.onClose,btnText:"Close"}),(0,t.jsx)(x.A,{variant:"h2",children:"Multiple workshops selected"}),(0,t.jsxs)(E.A,{children:[(0,t.jsxs)(R.A,{expandIcon:(0,t.jsx)(D.A,{}),"aria-controls":"session-list-panel-content",id:"session-list-panel-header",children:[e.sessions.length," workshops selected"]}),(0,t.jsx)(F.A,{children:(0,t.jsx)(h.A,{sx:{width:"100%",overflowX:"auto"},children:(0,t.jsx)("ul",{children:e.sessions.map(e=>(0,t.jsx)("li",{children:e.sessionName},"multi-preview-item-".concat(e.id)))})})})]}),(0,t.jsxs)(W.A,{fullWidth:!0,children:[(0,t.jsx)(I.A,{id:"report-select-label",children:"Report"}),(0,t.jsxs)(L.A,{labelId:"report-select-label",id:"report-select",value:a,label:"Report",onChange:(e,i)=>{d(e.target.value),p(P(e.target.value))},children:[(0,t.jsx)(_.A,{value:c.fT[c.fT.ContactAndConsent],children:"Contact and consent"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.EnjoymentAndSatisfaction],children:"Enjoyment and satisfaction"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.FullReport_v1],children:"Full report (v1)"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.FullReport_v2],children:"Full report (v2)"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.FullReport_v3],children:"Full report (v3)"})]})]}),j&&(0,t.jsx)(m.A,{}),(0,t.jsx)(n.A,{variant:"contained",onClick:()=>{y(""),g(void 0),void 0!==u&&(A(!0),b(e.sessions,u).then(e=>{e?g(e):(console.error("No report received."),y("Report not available."))}).catch(e=>{console.error(e),y("Unable to retrieve report: ".concat(JSON.stringify(e)))}).finally(()=>{A(!1)}))},disabled:void 0===u,children:"Generate combined report"}),f&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{variant:"h3",children:"Report ready"}),(0,t.jsxs)(E.A,{children:[(0,t.jsx)(R.A,{expandIcon:(0,t.jsx)(D.A,{}),"aria-controls":"report-details-panel-content",id:"report-details-panel-header",children:"Report details"}),(0,t.jsx)(F.A,{children:(0,t.jsx)(h.A,{sx:{width:"100%",overflowX:"auto"},children:(0,t.jsx)("pre",{children:w})})})]}),(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1,rowGap:1},children:[(0,t.jsx)(n.A,{variant:"contained",onClick:()=>{let e,i,s;return e=O(N(f.combinedReport)),i="report-combined-".concat(f.reportType,".csv"),void((s=document.createElement("a")).href="data:text/csv;charset=utf-8,".concat(e),s.download=i,s.click())},children:"Download CSV"}),(0,t.jsx)(n.A,{variant:"outlined",color:"buttonStandard",onClick:()=>{let e,i,s;return e="report-combined-".concat(f.sessionIds.length,"-sessions-").concat(f.reportType,".json"),i="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(f))),void((s=document.createElement("a")).href=i,s.download=e,s.click())},children:"Download JSON"})]})]})]})})}var U=s(66323),z=s(57184),M=s(99013);function G(e){var i,s;let{api:l,start:a}=(0,r.useContext)(o.F),{user:d}=(0,r.useContext)(v),[u,p]=(0,r.useState)(),[f,g]=(0,r.useState)(!1),[w,y]=(0,r.useState)(""),[j,A]=(0,r.useState)(),[b,S]=(0,r.useState)(),[k,C]=(0,r.useState)(""),[q,G]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g(!0),a(l.getDeliberationSessionAdmin(e.sessionListEntry.id,void 0,d.access_token,"preview-".concat(e.sessionListEntry.id))).then(e=>{(0,M.s)(e)&&p(e)}).catch(e=>{console.error(e)}).finally(()=>{g(!1)})},[e.sessionListEntry]),(0,r.useEffect)(()=>{y(""),A(void 0),S(void 0)},[u]),(0,r.useEffect)(()=>{C(""),S(void 0),void 0!==j&&(g(!0),J(j).then(e=>{if((0,M.s)(e))S(e);else throw"Could not retrieve report"}).catch(e=>{console.error(e),C("Unable to retrieve report: ".concat(JSON.stringify(e)))}).finally(()=>{g(!1)}))},[j]);let J=async e=>await a(l.getReport(u.id,d.access_token,e)),Q=async()=>{try{g(!0);let e={action:"anonymise",originator:d.profile.email,sessionId:u.id,parameters:{justification:"Anonymisation requested by analyst"}},i=await a(l.postAnalystAction(e,d.access_token));if((0,M.s)(i))p(i.session);else throw"Could not submit analyst anonymisation request."}catch(e){console.error(e)}finally{g(!1)}};return(0,r.useEffect)(()=>{b?C(JSON.stringify(b,null,2)):C("")},[b]),(0,t.jsxs)(t.Fragment,{children:[f&&(0,t.jsx)(m.A,{}),u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"column",gap:1,minHeight:"100%",py:1},children:[(0,t.jsx)(T.A,{sx:{alignSelf:"end"},btnKey:"close",variant:"outlined",onClick:e.onClose,btnText:"Close"}),(0,t.jsx)(x.A,{variant:"h2",children:"Session report"}),(0,t.jsx)(x.A,{variant:"h3",children:u.sessionName}),(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:["State: ",c.ve[u.facilitationState]]}),(0,t.jsxs)("li",{children:["Audience: ",c.Th[u.audience]]}),(0,t.jsxs)("li",{children:["Location: ",u.location]}),(0,t.jsxs)("li",{children:["Facilitator: ",u.facilitatorEmail]}),(0,t.jsxs)("li",{children:["Start: ",null==(i=(0,z.X)(u.sessionStartTime))?void 0:i.toLocaleString()]}),(0,t.jsxs)("li",{children:["Unique participants: ",new Set(u.answers.map(e=>e.participantId)).size]}),(0,t.jsxs)("li",{children:["Questions answered: ",new Set(u.answers.map(e=>e.questionId)).size," (non PII)"]})]}),(0,t.jsx)(x.A,{variant:"h3",children:"Select report"}),(0,t.jsxs)(W.A,{fullWidth:!0,children:[(0,t.jsx)(I.A,{id:"report-select-label",children:"Report"}),(0,t.jsxs)(L.A,{labelId:"report-select-label",id:"report-select",value:w,label:"Report",onChange:(e,i)=>{y(e.target.value),A(P(e.target.value))},children:[(0,t.jsx)(_.A,{value:c.fT[c.fT.ContactAndConsent],children:"Contact and consent"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.EnjoymentAndSatisfaction],children:"Enjoyment and satisfaction"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.FullReport_v1],children:"Full report (v1)"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.FullReport_v2],children:"Full report (v2)"}),(0,t.jsx)(_.A,{value:c.fT[c.fT.FullReport_v3],children:"Full report (v3)"})]})]}),f&&(0,t.jsx)(m.A,{}),b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{variant:"h3",children:"Report ready"}),(0,t.jsxs)(E.A,{children:[(0,t.jsx)(R.A,{expandIcon:(0,t.jsx)(D.A,{}),"aria-controls":"report-details-panel-content",id:"report-details-panel-header",children:"Report details"}),(0,t.jsx)(F.A,{children:(0,t.jsx)(h.A,{sx:{width:"100%",overflowX:"auto"},children:(0,t.jsx)("pre",{children:k})})})]}),(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1,rowGap:1},children:[(0,t.jsx)(n.A,{variant:"contained",onClick:()=>{let e,i,s;return e=O(N(b.report)),i="report-".concat(b.sessionId,"-").concat(b.reportType,".csv"),void((s=document.createElement("a")).href="data:text/csv;charset=utf-8,".concat(e),s.download=i,s.click())},children:"Download CSV"}),(0,t.jsx)(n.A,{variant:"outlined",color:"buttonStandard",onClick:()=>{let e,i,s;return e="report-".concat(b.sessionId,"-").concat(b.reportType,".json"),i="data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(b))),void((s=document.createElement("a")).href=i,s.download=e,s.click())},children:"Download JSON"})]})]}),null!==u.anonymisationCompletion&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{variant:"h3",children:"Anonymisation report"}),(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:["Success: ",u.anonymisationCompletion.success?"Yes":"No"]}),(0,t.jsxs)("li",{children:["Completion date:"," ",null==(s=(0,z.X)(u.anonymisationCompletion.completionDate))?void 0:s.toLocaleString()]}),(0,t.jsxs)("li",{children:["Originator: ",u.anonymisationCompletion.originator]}),(0,t.jsxs)("li",{children:["Justification: ",u.anonymisationCompletion.justification]}),(0,t.jsxs)("li",{children:["Participants anonymised:"," ",u.anonymisationCompletion.anonymisedParticipants]}),(0,t.jsxs)("li",{children:["Answers extracted: ",u.anonymisationCompletion.extractedAnswers]}),(0,t.jsxs)("li",{children:["Answers erased: ",u.anonymisationCompletion.erasedAnswers]}),(0,t.jsxs)("li",{children:["Fields extracted: ",u.anonymisationCompletion.fieldsExtracted.join(", ")]}),(0,t.jsxs)("li",{children:["Fields erased: ",u.anonymisationCompletion.fieldsErased.join(", ")]})]})]}),null===u.anonymisationCompletion&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{variant:"h3",children:"Anonymisation report"}),(0,t.jsx)(x.A,{variant:"body1",children:"Not yet anonymised"}),u.facilitationState!==c.ve.Closed&&(0,t.jsx)(x.A,{variant:"body2",children:"Anonymisation can only be performed on closed sessions"}),(0,t.jsx)(T.A,{btnKey:"anonymise",variant:"outlined",onClick:()=>{G(!0)},btnText:"Anonymise",busy:f,disabled:f||u.facilitationState!==c.ve.Closed,sx:{alignSelf:"start"}})]})]}),(0,t.jsx)(U.A,{open:q,setOpen:G,prompt:"Are you sure you want to anonymise this workshop? Please ensure you have contacted participants about their honorarium / remuneration.",title:"Anonymise workshop",onSelect:e=>{"anonymise"===e&&Q()},options:[{key:"anonymise",text:"Anonymise",filled:!0},{key:"cancel",text:"Cancel",filled:!1}]})]})]})}var J=s(57402);function Q(e){let i=(0,r.useContext)(v),{api:s,start:l}=(0,r.useContext)(o.F),[a,d]=(0,r.useState)([]),[u,p]=(0,r.useState)([]),[f,g]=(0,r.useState)(!1),[w,y]=(0,r.useState)({type:"include",ids:new Set});(0,r.useEffect)(()=>{j()},[]);let j=()=>{g(!0),d([]),e.onMultiSelection([]),l(s.listDeliberationSessions(i.user.access_token,c.UN.Answered,void 0)).then(e=>{(0,M.s)(e)&&d(e)}).catch(e=>{console.error(e)}).finally(()=>{g(!1)})};return(0,r.useEffect)(()=>{p(a.filter(e=>e.audience!==c.Th.AutomatedTests).sort((e,i)=>new Date(e.sessionStartTime).getTime()-new Date(i.sessionStartTime).getTime()).reverse().map(e=>({id:e.id,workshop:e.sessionName,slug:e.sessionSlug,start:new Date(e.sessionStartTime).toLocaleDateString()+" "+new Date(e.sessionStartTime).toLocaleTimeString(),audience:(e=>{switch(e){case c.Th.LiveWorkshop:return"Live";case c.Th.DemoWorkshop:return"Demo";case c.Th.TestingWorkshop:return"Test"}})(e.audience),location:e.location,participants:e.totalParticipants,questions:e.questionsAnswered,anonymised:!!e.anonymised&&"✅"})))},[a]),(0,r.useEffect)(()=>{switch(w.ids.size){case 0:e.onMultiSelection([]);break;case 1:let i=a.find(e=>e.id===Array.from(w.ids)[0]);e.onMultiSelection(void 0===i?[]:[i]);break;default:e.onMultiSelection(Array.from(w.ids).map(e=>a.find(i=>i.id===e)).filter(e=>void 0!==e))}},[w]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(h.A,{sx:{py:1,minHeight:"100%",display:"flex",flexDirection:"column",gap:1,mb:8},children:[(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",alignItems:"start",justifyContent:"space-between",children:[(0,t.jsx)(x.A,{variant:"h2",children:"Available workshops"}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(n.A,{variant:"outlined",color:"buttonStandard",onClick:()=>{j()},disabled:f,children:"Refresh"})})]}),f&&(0,t.jsx)(m.A,{}),(0,t.jsx)(J.z,{sx:{flexGrow:1},rows:u,columns:[{editable:!1,field:"start",headerName:"Start",width:175},{editable:!1,field:"slug",headerName:"Slug",width:150},{editable:!1,field:"workshop",headerName:"Workshop title",width:250},{editable:!1,field:"audience",headerName:"Audience",width:75},{editable:!1,field:"participants",headerName:"Ppts",width:50},{editable:!1,field:"questions",headerName:"Qs",width:50},{editable:!1,field:"anonymised",headerName:"Anon",width:75},{editable:!1,field:"location",headerName:"Location",width:150}],hideFooter:!0,checkboxSelection:!0,rowSelectionModel:w,onRowSelectionModelChange:e=>y(e),onRowClick:(i,s,t)=>(i=>{let s=a.find(e=>e.id===i);e.onMultiSelection(void 0===s?[]:[s])})(i.row.id)})]})})}function B(){let[e,i]=(0,r.useState)(),[s,o]=(0,r.useState)([]);return(0,r.useEffect)(()=>{switch(s.length){case 0:i(void 0);break;case 1:i((0,t.jsx)(G,{sessionListEntry:s[0],onClose:()=>{o([])}}));break;default:i((0,t.jsx)(q,{sessions:s,onClose:()=>{o([])}}))}},[s]),(0,t.jsx)(C,{menuProportion:.5,menu:(0,t.jsx)(Q,{onMultiSelection:o}),main:e})}var X=s(71398),H=s(75824),K=s(74641),Y=s(41101),V=s(35695),Z=s(4581),$=s(65528),ee=s(16862);function ei(e){var i,s,l,a;let d,u,{user:p}=(0,r.useContext)(v),{start:f,api:g}=(0,r.useContext)(o.F),[w,A]=(0,r.useState)(),[b,S]=(0,r.useState)(),[k,C]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{e.sessionListEntry&&(C(!0),f(g.getDeliberationSessionAdmin(e.sessionListEntry.id,void 0,p.access_token,"preview-".concat(e.sessionListEntry.id))).then(e=>{(0,M.s)(e)&&S(e)}).catch(e=>{console.error(e)}).finally(()=>{C(!1)}))},[e.sessionListEntry]),(0,r.useEffect)(()=>{b&&ee.toDataURL((0,Z.f)(b)).then(e=>{A(e)}).catch(e=>{A(void 0),console.error(e)})},[b]),(0,t.jsxs)(t.Fragment,{children:[k&&(0,t.jsx)(m.A,{}),b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",alignItems:"flex-start",sx:{mb:2,py:1},children:[w&&(0,t.jsx)(h.A,{sx:{mr:2},children:(0,t.jsx)("img",{src:w,style:{width:150,height:150}})}),(0,t.jsxs)(h.A,{flexGrow:1,children:[(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",gap:1,sx:{float:"right"},children:[(0,t.jsx)(T.A,{btnKey:"edit",variant:"outlined",onClick:i=>e.onEditSession(b),btnText:"Edit"}),(0,t.jsx)(T.A,{btnKey:"close",variant:"outlined",onClick:e.onClose,btnText:"Close"})]}),(0,t.jsx)(x.A,{variant:"h2",children:b.sessionName}),(0,t.jsx)(x.A,{variant:"body1",sx:{mt:1},children:(0,t.jsx)("span",{dangerouslySetInnerHTML:{__html:null!=(i=b.sessionDescription)?i:""}})})]})]}),(0,t.jsxs)(y.A,{children:[(0,t.jsx)($.Ay,{children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-type.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"TYPE"}),(0,t.jsxs)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:[c.LQ[b.remoteConfiguration]," ",c.Th[b.audience]]})]})]})}),b.location&&(0,t.jsx)($.Ay,{children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-location.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"LOCATION"}),(0,t.jsx)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:null!=(s=b.location)?s:"(not specified)"})]})]})}),(0,t.jsx)($.Ay,{children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-date.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"DATE"}),(0,t.jsx)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:new Date(b.sessionStartTime).toISOString().substring(0,10)})]})]})}),(0,t.jsx)($.Ay,{children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-time.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"TIME"}),(0,t.jsx)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:"".concat(new Date(b.sessionStartTime).toLocaleTimeString()," - ").concat((d=b.sessionStartTime,u=b.sessionDurationMins,new Date(new Date(d).getTime()+6e4*u)).toLocaleTimeString())})]})]})}),(0,t.jsx)($.Ay,{children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-participants.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"PARTICIPANTS"}),(0,t.jsx)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:null!=(l=b.anticipatedParticipants)?l:"(not specified)"})]})]})}),(0,t.jsx)($.Ay,{children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-participants.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"FACILITATOR"}),(0,t.jsx)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:null!=(a=b.facilitatorEmail)?a:"(not specified)"})]})]})}),(0,t.jsx)(j.A,{onClick:()=>{var e;null==(e=navigator)||e.clipboard.writeText((0,Z.f)(b))},children:(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",children:[(0,t.jsx)("img",{src:"/icons/session-type.svg",style:{height:32,verticalAlign:"middle",marginRight:12}}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(x.A,{variant:"body2",children:"JOIN CODE"}),(0,t.jsx)(x.A,{variant:"body1",style:{fontWeight:"bold"},children:b.joinCode})]})]})})]}),(0,t.jsxs)(h.A,{sx:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"stretch",gap:2,pt:1,borderTop:"solid 1px black"},children:[(0,t.jsx)(n.A,{variant:"contained",color:"buttonStandard",sx:{flexGrow:1},onClick:()=>{window.open((0,Z.k)(b),"_blank","noreferrer")},children:"Enter workshop"}),(0,t.jsx)(n.A,{variant:"contained",color:"buttonStandard",sx:{flexGrow:1},onClick:()=>{var e;null==(e=navigator)||e.clipboard.writeText((0,Z.f)(b))},children:"Copy participant link"})]})]})]})}var es=s(69242),et=s(80946),eo=s(86220),en=s(63913),er=s(54492),el=s(78449),ea=s(71977),ec=s(36114),ed=s(99927),eu=s(61090),eh=s(23745),ep=s(97370),ex=s(30832),em=s.n(ex),ef=s(44370),eg=s(78755);let ev=[{title:"Zeitgeist demo",description:"A Zeitgeist demonstration workshop.",duration_mins:15,audience:c.Th.DemoWorkshop,slug:"zg-demo",uris:["/workshops/zg-demo/presentation.xml"]},{title:"Zeitgeist gallery",description:"A Zeitgeist gallery workshop (for testing).",duration_mins:15,audience:c.Th.TestingWorkshop,slug:"zg-gallery",uris:["/workshops/zg-welcome/presentation.xml","/workshops/zg-gallery/presentation.xml"]},{title:"AI Risk Lab (HACID PAI)",description:"TODO",duration_mins:90,audience:c.Th.LiveWorkshop,slug:"hacid-pai",uris:["/workshops/hacid-pai/00-intro.xml","/workshops/hacid-pai/01-scenario_risk.xml","/workshops/hacid-pai/02-break.xml","/workshops/hacid-pai/03-risk_lists.xml","/workshops/hacid-pai/04-ai_oversight.xml","/workshops/hacid-pai/05-pai_eval.xml","/workshops/hacid-pai/06-closing.xml"]},{title:"AI Safety Label: ADA",description:"A workshop on the AI Safety Label for CCI in Turkey.",duration_mins:120,audience:c.Th.LiveWorkshop,slug:"aisl-cci-tr",uris:["/workshops/aisl-cci-tr/00-intro.xml","/workshops/aisl-cci-tr/01-part-1.xml","/workshops/aisl-cci-tr/02-part-2.xml","/workshops/aisl-cci-tr/03-part-3.xml"]},{title:"A New Era (AFS Delphi)",description:"A workshop with experts on Integrated Family Support Services for Nesta's A Fairer Start mission.",duration_mins:120,audience:c.Th.LiveWorkshop,remoteConfiguration:c.LQ.RemoteWithVideoCall,slug:"afs-delphi",uris:["/workshops/afs-delphi/00-intro.xml","/workshops/afs-delphi/01-why.xml","/workshops/afs-delphi/02-who.xml","/workshops/afs-delphi/03-break.xml","/workshops/afs-delphi/04-what.xml","/workshops/afs-delphi/05-how.xml","/workshops/afs-delphi/06-wrap-up.xml","/workshops/afs-delphi/07-outro.xml"]},{title:"A New Era (AFS Lived Experience)",description:"A workshop with families on Integrated Family Support Services for Nesta's A Fairer Start mission.",duration_mins:90,audience:c.Th.LiveWorkshop,slug:"afs-le",uris:["/workshops/afs-le/00-intro.xml","/workshops/afs-le/01-what.xml","/workshops/afs-le/02-who.xml","/workshops/afs-le/03-break.xml","/workshops/afs-le/04-how.xml","/workshops/afs-le/05-why.xml","/workshops/afs-le/06-outro.xml"]},{title:"Public AI Task Force (FLI System 1)",description:"TODO",duration_mins:210,audience:c.Th.LiveWorkshop,slug:"fli-system-1",uris:["/workshops/fli-system-1/00-the-briefing.xml","/workshops/fli-system-1/01-groundwork.xml","/workshops/fli-system-1/02-mission-deep-dive.xml","/workshops/fli-system-1/03-the-dilemmas.xml","/workshops/fli-system-1/04-mission-debrief.xml"]},{title:"Public AI Task Force with expert (FLI System 1)",description:"TODO",duration_mins:210,audience:c.Th.LiveWorkshop,slug:"fli-system-1-expert",uris:["/workshops/fli-system-1/00-the-briefing.xml","/workshops/fli-system-1/01-groundwork.xml","/workshops/fli-system-1/02-mission-deep-dive.xml","/workshops/fli-system-1/02a-mission-deep-dive_ask-expert.xml","/workshops/fli-system-1/03-the-dilemmas.xml","/workshops/fli-system-1/04-mission-debrief.xml"]},{title:"Situation Room: Water Scarcity",description:"<p>The increasing floods and drought seen across the country in recent years are showing us some of the impacts from climate change. We need to work together to come up with a plan.</p><p><i>Step into The Situation Room, where you will decide how to deal with issues such as flooding, water scarcity and coastal erosion. A series of videos will introduce you to the topic, and you’ll vote on different options to minimise the impact of climate change with your fellow participants. Can you create a successful strategy for your local area?</i></p>",duration_mins:120,audience:c.Th.LiveWorkshop,slug:"sr-water-scarcity",uris:["/workshops/sr-a-intro/presentation.xml","/workshops/sr-b-water-scarcity/0-start.xml","/workshops/sr-b-water-scarcity/1-reuse.xml","/workshops/sr-b-water-scarcity/2-reduce.xml","/workshops/sr-b-water-scarcity/3-restrict.xml","/workshops/sr-b-water-scarcity/4-end.xml","/workshops/sr-z-outro/presentation.xml"]},{title:"Situation Room: Coastal Erosion and Flooding",description:"<p>The increasing floods and drought seen across the country in recent years are showing us some of the impacts from climate change. We need to work together to come up with a plan.</p><p><i>Step into The Situation Room, where you will decide how to deal with issues such as flooding, water scarcity and coastal erosion. A series of videos will introduce you to the topic, and you’ll vote on different options to minimise the impact of climate change with your fellow participants. Can you create a successful strategy for your local area?</i></p>",duration_mins:120,audience:c.Th.LiveWorkshop,slug:"sr-coastal-erosion",uris:["/workshops/sr-a-intro/presentation.xml","/workshops/sr-c-coastal-erosion/0-start.xml","/workshops/sr-c-coastal-erosion/1-pfr.xml","/workshops/sr-c-coastal-erosion/2-engineered.xml","/workshops/sr-c-coastal-erosion/3-nature.xml","/workshops/sr-c-coastal-erosion/4-rollback.xml","/workshops/sr-c-coastal-erosion/5-end.xml","/workshops/sr-z-outro/presentation.xml"]},{title:"Situation Room: Inland Flooding",description:"<p>The increasing floods and drought seen across the country in recent years are showing us some of the impacts from climate change. We need to work together to come up with a plan.</p><p><i>Step into The Situation Room, where you will decide how to deal with issues such as flooding, water scarcity and coastal erosion. A series of videos will introduce you to the topic, and you’ll vote on different options to minimise the impact of climate change with your fellow participants. Can you create a successful strategy for your local area?</i></p>",duration_mins:120,audience:c.Th.LiveWorkshop,slug:"sr-inland-flooding",uris:["/workshops/sr-a-intro/presentation.xml","/workshops/sr-d-inland-flooding/0-start.xml","/workshops/sr-d-inland-flooding/1-pfr.xml","/workshops/sr-d-inland-flooding/2-suds.xml","/workshops/sr-d-inland-flooding/3-engineered.xml","/workshops/sr-d-inland-flooding/4-nature.xml","/workshops/sr-d-inland-flooding/5-end.xml","/workshops/sr-z-outro/presentation.xml"]},{title:"Situation Room: Coastal Erosion and Flooding (for Policy Design community)",description:"<p>The increasing floods and drought seen across the country in recent years are showing us some of the impacts from climate change. We need to work together to come up with a plan.</p><p><i>Step into The Situation Room, where you will decide how to deal with issues such as flooding, water scarcity and coastal erosion. A series of videos will introduce you to the topic, and you’ll vote on different options to minimise the impact of climate change with your fellow participants. Can you create a successful strategy for your local area?</i></p>",duration_mins:120,audience:c.Th.LiveWorkshop,slug:"sr-coastal-erosion-with-policy-design",uris:["/workshops/sr-a-intro/presentation.xml","/workshops/sr-c-coastal-erosion/0-start.xml","/workshops/sr-c-coastal-erosion/1-pfr.xml","/workshops/sr-c-coastal-erosion/2-engineered.xml","/workshops/sr-c-coastal-erosion/3-nature.xml","/workshops/sr-c-coastal-erosion/4-rollback.xml","/workshops/sr-c-coastal-erosion/5-end.xml","/workshops/sr-z-outro/presentation.xml","/workshops/ccid-2024-11-12/presentation.xml"]}];Object.values(c.LQ).filter(e=>!isNaN(Number(e))).map(e=>Number(e));let ew=[{value:c.Th.LiveWorkshop,title:"Live workshop",description:"A live session with real participants."},{value:c.Th.DemoWorkshop,title:"Demo workshop",description:"A demonstration workshop."},{value:c.Th.TestingWorkshop,title:"Test workshop",description:"A test workshop, to review content or test new features."}],ey=e=>{let i=parseInt(e);return isNaN(i)?void 0:i};function ej(e){let i=(0,r.useContext)(v),[s,o]=(0,r.useState)(),[l,a]=(0,r.useState)(),[d,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)(),[m,f]=(0,r.useState)(),[g,w]=(0,r.useState)(),[y,j]=(0,r.useState)(),[A,b]=(0,r.useState)(),[S,k]=(0,r.useState)(),[C,T]=(0,r.useState)(),[D,E]=(0,r.useState)(),[R,F]=(0,r.useState)(),[P,N]=(0,r.useState)(),[O,q]=(0,r.useState)(),[U,z]=(0,r.useState)(),[M,G]=(0,r.useState)(),[J,Q]=(0,r.useState)(),[B,X]=(0,r.useState)(),[H,K]=(0,r.useState)();(0,r.useEffect)(()=>{var i,s;o(null!=(s=null==(i=e.prefill)?void 0:i.sessionSlug)?s:"")},[e.open,e.prefill]),(0,r.useEffect)(()=>{a(ev.find(e=>e.slug===s))},[s,e.prefill]),(0,r.useEffect)(()=>{var s,t,o,n,r,a,d,h,p,m,g,v,y,A,S,k,C,D,R;console.debug("selected template",l),x(null!=(A=null==(s=e.prefill)?void 0:s.sessionName)?A:null==l?void 0:l.title),f(void 0),w(null!=(S=null==(t=e.prefill)?void 0:t.sessionDescription)?S:null==l?void 0:l.description),j(void 0),G((null==(o=e.prefill)?void 0:o.sessionDurationMins)!==void 0?null==(n=e.prefill)?void 0:n.sessionDurationMins:null==l?void 0:l.duration_mins),Q(void 0),b((null==(r=e.prefill)?void 0:r.audience)!==void 0?null==(a=e.prefill)?void 0:a.audience:null==l?void 0:l.audience),T((null==(d=e.prefill)?void 0:d.remoteConfiguration)!==void 0?e.prefill.remoteConfiguration:void 0!==l?null!=(k=l.remoteConfiguration)?k:c.LQ.InPerson:void 0),E(void 0),F((null!=(C=null==(h=e.prefill)?void 0:h.facilitatorEmail)?C:void 0!==l)?null!=(R=i.user.profile.email)?R:"Unknown facilitator":void 0),N(void 0),q((null==(p=e.prefill)?void 0:p.sessionStartTime)!==void 0?em()(null==(m=e.prefill)?void 0:m.sessionStartTime):void 0!==l?em()():void 0),z(void 0),X((null!=(D=null==(g=e.prefill)?void 0:g.location)?D:void 0!==l)?"":void 0),K((null==(v=e.prefill)?void 0:v.anticipatedParticipants)!==void 0?null==(y=e.prefill)?void 0:y.anticipatedParticipants:void 0!==l?12:void 0),u(void 0!==l)},[l,e.prefill]);let Y=()=>{e.busy||e.onCloseRequest()},V=e=>(0,t.jsx)(ef.Ay,{variant:"popover",popupId:e.id,children:i=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eo.A,{sx:{alignSelf:"start"},"aria-label":e.description,...(0,eg.o2)(i),children:(0,t.jsx)(et.A,{})}),(0,t.jsx)(en.Ay,{...(0,eg.dB)(i),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,t.jsx)(h.A,{sx:{p:1},children:e.children})})]})});return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(ec.A,{fullWidth:!0,maxWidth:"sm",open:e.open,onClose:Y,children:[(0,t.jsxs)(er.A,{children:[void 0!==e.prefill?"Edit":"Create new"," session",(0,t.jsx)(h.A,{style:{position:"absolute",top:0,right:0},children:(0,t.jsx)(eo.A,{"aria-label":"close",onClick:Y,children:(0,t.jsx)(es.A,{})})})]}),(0,t.jsx)(ed.A,{children:(0,t.jsxs)(h.A,{sx:{p:1},display:"flex",flexDirection:"column",alignItems:"stretch",gap:2,children:[(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsxs)(W.A,{fullWidth:!0,children:[(0,t.jsx)(I.A,{id:"new-session-template-label",children:"Workshop"}),(0,t.jsx)(L.A,{labelId:"new-session-template-label",value:null!=s?s:"",label:"Workshop",required:!0,disabled:e.busy,onChange:e=>o(e.target.value),children:ev.map(e=>(0,t.jsx)(_.A,{value:e.slug,children:e.title},"session-template-option-".concat(e.slug)))})]})}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",gap:1,children:[(0,t.jsxs)(W.A,{fullWidth:!0,children:[(0,t.jsx)(I.A,{id:"new-session-audience-label",children:"Audience"}),(0,t.jsx)(L.A,{labelId:"new-session-audience-label",value:null!=A?A:"",label:"Audience",required:!0,disabled:!d||e.busy,onChange:e=>b(e.target.value),children:ew.map(e=>(0,t.jsx)(_.A,{value:e.value,children:e.title},"session-audience-option-".concat(e.value)))})]}),(0,t.jsxs)(V,{id:"session-audience-info-popup",description:"Workshop audience info",children:[(0,t.jsx)("p",{children:"Choose between:"}),(0,t.jsx)("ul",{children:ew.map(e=>(0,t.jsxs)("li",{children:[(0,t.jsx)("b",{children:e.title}),": ",e.description]},"session-audience-info-".concat(e.value)))})]})]}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(el.A,{fullWidth:!0,label:"Session title",value:null!=p?p:"",required:!0,onChange:e=>x(e.target.value),disabled:!d||e.busy,error:!!m,helperText:m})}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(el.A,{fullWidth:!0,label:"Session description",value:null!=g?g:"",required:!0,onChange:e=>w(e.target.value),disabled:!d||e.busy,error:!!y,helperText:y})}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(eu.$J,{dateAdapter:ep.R,children:(0,t.jsx)(eh.K,{label:"Session start",value:void 0!==O?O:null,onChange:e=>q(null!=e?e:void 0),disabled:!d||e.busy,slotProps:{textField:{fullWidth:!0,required:!0,error:!!U,helperText:U}}})})}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(el.A,{fullWidth:!0,inputProps:{type:"number"},label:"Duration (mins)",value:null!=M?M:"",required:!0,onChange:e=>G(ey(e.target.value)),disabled:!d||e.busy,error:!!J,helperText:J})}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",gap:1,children:[(0,t.jsxs)(W.A,{fullWidth:!0,children:[(0,t.jsx)(I.A,{id:"new-session-remote-config-label",children:"Remote configuration"}),(0,t.jsxs)(L.A,{labelId:"new-session-remote-config-label",value:null!=C?C:"",label:"Remote configuration",required:!0,onChange:e=>T(e.target.value),disabled:!d||e.busy,error:!!D,children:[(0,t.jsx)(_.A,{value:c.LQ.InPerson,children:"In person"}),(0,t.jsx)(_.A,{value:c.LQ.Remote,children:"Remote"}),(0,t.jsx)(_.A,{value:c.LQ.RemoteWithVideoCall,children:"Remote (with video call)"})]})]}),(0,t.jsx)(V,{id:"remote-config-info-popup",description:"Remote configuration info",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"In person: Audio plays from facilitator only"}),(0,t.jsx)("li",{children:"Remote: Audio plays from all devices"}),(0,t.jsx)("li",{children:"Remote with video call: Audio plays from all devices, embedded video call"})]})})]}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(el.A,{fullWidth:!0,label:"Facilitator",value:null!=R?R:"",onChange:e=>F(e.target.value),required:!0,disabled:!d||e.busy,error:!!P,helperText:P})}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(el.A,{fullWidth:!0,label:"Location",value:null!=B?B:"",onChange:e=>X(e.target.value),disabled:!d||e.busy})}),(0,t.jsx)(h.A,{display:"flex",flexDirection:"row",gap:1,children:(0,t.jsx)(el.A,{fullWidth:!0,label:"Anticipated participants",inputProps:{type:"number"},value:null!=H?H:"",onChange:e=>K(ey(e.target.value)),disabled:!d||e.busy})})]})}),(0,t.jsxs)(ea.A,{children:[(0,t.jsx)(n.A,{variant:"outlined",onClick:Y,disabled:e.busy,children:"Cancel"}),(0,t.jsx)(n.A,{variant:"outlined",onClick:()=>{e.onClearRequest(),o(void 0)},disabled:e.busy,children:"Clear"}),(0,t.jsx)(n.A,{variant:"contained",onClick:()=>{let i;if(i=!0,void 0===p||p.trim().length<1?(f("Title is required"),i=!1):f(void 0),void 0===g||g.trim().length<1?(j("Description is required"),i=!1):j(void 0),void 0===O?(z("Start date is required"),i=!1):z(void 0),void 0===M||M<1?(Q("Duration is required"),i=!1):Q(void 0),void 0===C?(E("Remote configuration is required"),i=!1):E(void 0),void 0===A?(k("Audience is required"),i=!1):k(void 0),void 0===R||R.trim().length<1?(N("Facilitator is required"),i=!1):N(void 0),i){var s,t,o,n,r,a,d;let i={...e.prefill,id:null==(s=e.prefill)?void 0:s.id,sessionName:p,sessionDescription:g,sessionSlug:l.slug,sessionStartTime:O.set("second",0).toDate(),sessionDurationMins:M,remoteConfiguration:C,facilitatorEmail:R,location:B,anticipatedParticipants:H,sessionGraphicAltText:null==(t=e.prefill)?void 0:t.sessionGraphicAltText,sessionPresentationUris:l.uris,answers:null!=(d=null==(o=e.prefill)?void 0:o.answers)?d:[],audience:A,facilitationState:(null==(n=e.prefill)?void 0:n.facilitationState)!==void 0?e.prefill.facilitationState:c.ve.Ready,fullScreen:(null==(r=e.prefill)?void 0:r.fullScreen)===void 0||e.prefill.fullScreen,participantRecords:[],liveExperienceState:(null==(a=e.prefill)?void 0:a.liveExperienceState)!==void 0?e.prefill.liveExperienceState:{slideX:0,slideY:0,videoSync:[],originator:"00000000-0000-0000-0000-000000000000",originatorTimestampsJson:"{}",sequence:0},anonymisationCompletion:null};console.debug("submitting session",i),e.onSubmitRequest(i)}},disabled:e.busy,children:"Submit"})]})]})})}var eA=function(e){return e[e.ShowAutomatedTesting=1]="ShowAutomatedTesting",e[e.ShowManualTesting=2]="ShowManualTesting",e}(eA||{});function eb(){let{api:e,start:i}=(0,r.useContext)(o.F),s=(0,r.useContext)(v),[l,a]=(0,r.useState)(!1),[d,u]=(0,r.useState)([]),[p,f]=(0,r.useState)({}),[g,w]=(0,r.useState)({}),[A,b]=(0,r.useState)(),[S,k]=(0,r.useState)(!1),[T,D]=(0,r.useState)(!1),[E,R]=(0,r.useState)(""),[F,W]=(0,r.useState)(),[I,L]=(0,r.useState)(!1),_=(0,V.useSearchParams)(),[P,N]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=_.get("flags"),i=0;e&&(e.includes("m")&&(i|=2),e.includes("a")&&(i|=1),N(i))},[_]);let O=e=>{var i;if(!e.firstWorkshopDirectory)return;let s=(0,X.G)(e.firstWorkshopDirectory),t=p.hasOwnProperty(s)?p[s]:void 0;return null!=(i=null==t?void 0:t.thumb)?i:null==t?void 0:t.poster},q=async()=>{try{console.debug("Fetching sessions..."),u([]),a(!0);let t=await i(e.listDeliberationSessions(s.user.access_token,c.UN.Upcoming,"overview-list-sessions"));if(console.debug("Sessions",t),(0,M.s)(t)){let e=[...t.filter(e=>e.audience!==c.Th.AutomatedTests||1&P&&e.audience===c.Th.AutomatedTests)].sort((e,i)=>new Date(e.sessionStartTime).getTime()-new Date(i.sessionStartTime).getTime());u(e)}}catch(e){console.error(e)}finally{a(!1)}};(0,r.useEffect)(()=>{let s;b(void 0),d.forEach(s=>{if(void 0===s.firstWorkshopDirectory)return;let t=(0,X.G)(s.firstWorkshopDirectory);if(!p.hasOwnProperty(t)){let o={workshopDirectory:t};i(e.postPublicContentAccessRequest(s.id,o)).then(e=>{(0,M.s)(e)&&f(i=>{let s={...i};return s[o.workshopDirectory]={thumb:e.thumbnailUrl,poster:e.posterUrl},s})})}}),w((s={},d.forEach(e=>{let i=new Date(e.sessionStartTime).toLocaleDateString("en-GB",{month:"long",year:"numeric"});s[i]||(s[i]=[]),s[i].push(e)}),console.debug("sessions grouped by month",s),s))},[d]),(0,r.useEffect)(()=>{q()},[]);let U=async t=>{if(console.debug("New session submission",t),!s.user.access_token){R("Access token unavailable. Please contact support."),D(!0);return}try{L(!0);let o=void 0===t.id?await i(e.postDeliberationSessionAdmin(s.user.access_token,t)):await i(e.putDeliberationSessionAdmin(s.user.access_token,t));if((0,M.s)(o)){if(!(0,M.s)(o.id))throw"Session creation failed.";k(!1),R("Session submitted successfully."),D(!0),q()}}catch(e){console.error(e),R("Session submission failed. Please contact support."),D(!0)}finally{L(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ej,{open:S,busy:I,onCloseRequest:()=>{k(!1)},onClearRequest:()=>{W(void 0)},onSubmitRequest:U,prefill:F}),(0,t.jsx)(H.A,{open:T,autoHideDuration:6e3,onClose:()=>D(!1),message:E}),(0,t.jsx)(C,{menuProportion:.5,menu:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",alignItems:"start",justifyContent:"space-between",py:1,children:[(0,t.jsx)(x.A,{variant:"h2",children:"Upcoming workshops"}),(0,t.jsxs)(h.A,{display:"flex",flexDirection:"row",gap:1,children:[(0,t.jsx)(n.A,{variant:"outlined",color:"buttonStandard",onClick:()=>{W(void 0),k(!0)},disabled:l,children:"Add"}),(0,t.jsx)(n.A,{variant:"outlined",color:"buttonStandard",onClick:()=>{q()},disabled:l,children:"Refresh"})]})]}),l&&(0,t.jsx)(m.A,{}),(0,t.jsx)(y.A,{subheader:(0,t.jsx)("li",{}),children:!!g&&Object.keys(g).map(e=>(0,t.jsx)("li",{children:(0,t.jsxs)("ul",{children:[(0,t.jsx)(K.A,{sx:{background:"transparent",borderBottom:"solid 1px grey",backdropFilter:"blur(5px)",p:1,my:2},children:(0,t.jsx)(x.A,{variant:"h3",sx:{mb:0},children:e})}),g[e].map((e,i)=>(0,t.jsx)(j.A,{alignItems:"center",onClick:()=>b(e),selected:(null==A?void 0:A.id)===e.id,children:(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"row",gap:1,width:"100%"},children:[(0,t.jsxs)(h.A,{sx:{alignSelf:"center",alignItems:"center",borderRight:"solid 2px lightGray",display:"flex",flexDirection:"column",gap:0,px:1},children:[(0,t.jsx)(x.A,{variant:"body2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"][new Date(e.sessionStartTime).getDay()]}),(0,t.jsx)(x.A,{variant:"h4",children:new Date(e.sessionStartTime).getDate()})]}),(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"column",gap:1,flexGrow:1},children:[(0,t.jsx)(x.A,{variant:"body1",children:e.sessionName}),(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:.5,rowGap:.5},children:[(0,t.jsx)(Y.A,{component:"span",size:"small",label:c.ve[e.facilitationState],color:"primary"}),(0,t.jsx)(Y.A,{component:"span",size:"small",label:c.LQ[e.remoteConfiguration],color:"primary"}),(0,t.jsx)(Y.A,{component:"span",size:"small",label:c.Th[e.audience],color:e.audience===c.Th.LiveWorkshop?"error":void 0}),(0,t.jsx)(Y.A,{component:"span",size:"small",label:new Date(e.sessionStartTime).toLocaleTimeString()})]}),(0,t.jsxs)(h.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:.5,rowGap:.5},children:[e.facilitatorEmail&&(0,t.jsx)(Y.A,{component:"span",size:"small",label:e.facilitatorEmail,color:"secondary"}),e.location&&(0,t.jsx)(Y.A,{component:"span",size:"small",label:e.location,color:"secondary"})]})]})]}),O(e)&&(0,t.jsx)("img",{style:{maxWidth:100,height:"auto",alignSelf:"start",justifySelf:"end"},src:O(e),alt:e.sessionGraphicAltText})]})},"session-button-".concat(i)))]})},"overview-month-".concat(e)))})]}),main:A&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(ei,{sessionListEntry:A,onEditSession:e=>{W(e),k(!0)},onDeleteSession:e=>{},onClose:()=>b(void 0)})})})]})}var eS=s(90822);function ek(){(0,r.useContext)(v);let[e,i]=(0,r.useState)(S.Workshops),[s,n]=(0,r.useState)((0,t.jsx)(eb,{}));return(0,r.useEffect)(()=>{void 0!==document&&(document.title="Facilitator overview")},[]),(0,r.useEffect)(()=>{switch(e){case S.Workshops:n((0,t.jsx)(eb,{}));break;case S.Reports:n((0,t.jsx)(B,{}));break;default:throw"".concat(S[e]," not implemented.")}},[e]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(o.A,{children:[(0,t.jsx)(w,{role:c.sW.Controller,children:(0,t.jsx)(C,{sx:{background:"linear-gradient(270deg, rgba(0, 0, 255, 0.25) 0%, rgba(0, 0, 255, 0.00) 50%, rgba(0, 0, 255, 0.00) 100%)"},menu:(0,t.jsx)(k,{onSetSelection:i,showUsername:!0,showSignOut:!0}),menuProportion:.2,main:s})}),(0,t.jsx)(h.A,{sx:{position:"fixed",right:"1em",bottom:"1em"},children:(0,t.jsx)(eS.A,{})})]})})}},57184:(e,i,s)=>{"use strict";function t(e){if(e)return new Date(e)}s.d(i,{X:()=>t})},62951:(e,i,s)=>{Promise.resolve().then(s.bind(s,26659))}},e=>{e.O(0,[287,78,96,639,274,915,424,378,469,75,182,441,964,358],()=>e(e.s=62951)),_N_E=e.O()}]);