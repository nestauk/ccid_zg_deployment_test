"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{2492:(e,t,n)=>{n.d(t,{O:()=>ej,A:()=>eA});var i=n(95155),o=n(80357),r=n(80317),s=n(12115),a=n(98314),l=n(25612),c=n(2768),d=n(57300),u=n(80431),p=n(21644),h=n(84073),x=n(24360),g=n(10310),m=n(18414),f=n(79200),b=n(18932),v=n(62652);function y(e){let{keepAwake:t}=e,[n,o]=(0,s.useState)(),[r,a]=(0,s.useState)();return(0,s.useEffect)(()=>{if(void 0===n&&void 0!==window.navigator){var e;o(null==(e=window.navigator)?void 0:e.wakeLock)}},[]),(0,s.useEffect)(()=>{console.debug("Wake lock: ".concat(void 0===n?"unavailable":"available",", keepAwake: ").concat(t));try{void 0!==n&&(t&&void 0===r&&n.request("screen").then(e=>{console.debug("Wake lock sentinel acquired"),a(e)}).catch(e=>{console.error("Wake lock exception",e)}),t||(void 0!==r&&console.debug("Releasing wake lock sentinel..."),null==r||r.release().then(()=>{console.debug("Wake lock sentinel released."),a(void 0)})))}catch(e){console.warn("Unable to request screen lock",e)}return()=>{void 0!==r&&console.debug("Relesaing wake lock sentinel..."),null==r||r.release().then(()=>{console.debug("Wake lock sentinel released."),a(void 0)})}},[n,t]),(0,i.jsx)(i.Fragment,{})}function w(e){let{children:t}=e;return(0,i.jsx)(o.A,{sx:{position:"fixed",right:"1.5rem",bottom:"1.5rem",zIndex:10},children:t})}function j(e){let{children:t}=e;return(0,i.jsx)(o.A,{sx:{position:"fixed",right:"1.5rem",top:"1.5rem",zIndex:10},children:t})}function A(e){let{children:t}=e;return(0,i.jsx)(o.A,{sx:{position:"fixed",left:"1.5rem",bottom:"1.5rem",zIndex:10},children:t})}var k=n(65016),S=n(25216),C=n(25789),I=n(50301),D=n(60193);function E(e){let{session:t}=(0,s.useContext)(a.$),n=(0,s.useContext)(h.yk),o=(0,s.useMemo)(()=>{var t;return(null==(t=e.elementRef)?void 0:t.current)||document.documentElement},[e.elementRef]),[r,l]=(0,s.useState)(),c=async()=>{try{!1!==document.fullscreenEnabled?o.requestFullscreen?await o.requestFullscreen({navigationUI:"hide"}):o.webkitRequestFullscreen?await o.webkitRequestFullscreen():o.webkitEnterFullscreen?await o.webkitEnterFullscreen():o.mozRequestFullScreen?await o.mozRequestFullScreen():o.msRequestFullscreen?await o.msRequestFullscreen():console.warn("No request full screen variants found"):console.warn("Fullscreen not enabled")}catch(e){console.error("Error entering fullscreen",e)}},d=async()=>{try{let e=document;document.fullscreenElement?await document.exitFullscreen():e.webkitFullscreenElement?await e.webkitExitFullscreen():e.mozFullScreenElement?await e.mozCancelFullScreen():e.msFullscreenElement?await e.msExitFullscreen():console.warn("No exit full screen variants found")}catch(e){console.error("Error exiting fullscreen",e)}};(0,s.useEffect)(()=>{document.onfullscreenchange=e=>{l(null!==document.fullscreenElement)}},[]),(0,s.useEffect)(()=>{n.role===b.sW.Client&&void 0!==o&&(e.goFullScreen&&!r&&t.facilitationState!==b.ve.Closed&&c(),!e.goFullScreen&&r&&d())},[e.goFullScreen,o]),(0,s.useEffect)(()=>{t.facilitationState===b.ve.Closed&&(console.debug("Session closed: exit fullscreen"),d())},[t.facilitationState]);let u=(0,C.A)();return(0,i.jsx)(i.Fragment,{children:n.role===b.sW.Client&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(I.A,{title:r?(0,i.jsx)(v.A,{i18nKey:"button.exitFullScreen"}):(0,i.jsx)(v.A,{i18nKey:"button.goFullScreen"}),children:(0,i.jsx)(D.A,{"aria-label":r?"back to desktop":"go full screen",onClick:()=>r?d():c(),sx:{border:"2px solid",borderColor:u.palette.promptPanelBackground.main,background:u.palette.slideSectionBackground.main,opacity:.75,"&:hover":{backgroundColor:u.palette.slideSectionBackground.main,opacity:1}},children:r?(0,i.jsx)(S.A,{}):(0,i.jsx)(k.A,{})})})})})}var R=n(48081),F=n(4615);let B=[b.jB.Error,b.jB.Offline],P=[b.jB.Disconnected],T=[b.jB.Online,b.jB.Connecting,b.jB.Connected,b.jB.Joining];var q=function(e){return e.Disconnected="Disconnected from the workshop server.",e.Connecting="Please wait, connecting to the workshop server...",e.Error="An error occurred while connecting to the workshop server.",e}(q||{});function W(){let e=(0,s.useContext)(l.j),[t,n]=(0,s.useState)(e.state),[o,r]=(0,s.useState)(void 0);return(0,s.useEffect)(()=>{console.debug("Connection warning, state: ".concat(b.jB[e.state])),n(e.state)},[e.state]),(0,s.useEffect)(()=>{r((e=>{if(P.includes(e))return"Disconnected from the workshop server.";if(T.includes(e))return"Please wait, connecting to the workshop server...";if(B.includes(e))return"An error occurred while connecting to the workshop server."})(t))},[t]),(0,i.jsx)(i.Fragment,{children:o&&(0,i.jsxs)(F.A,{variant:"filled",severity:"An error occurred while connecting to the workshop server."===o?"error":"info",children:[o," (",b.jB[t],")"]})})}var N=n(25148),M=n(69999);function O(e){let[t,n]=(0,s.useState)(!1),[o,r]=(0,s.useState)();(0,s.useEffect)(()=>(M.A.on(M.m.WSS_Update_ConnectionState,r),()=>{M.A.off(M.m.WSS_Update_ConnectionState,r)}),[]),(0,s.useEffect)(()=>{void 0!==o&&o.type===M.m.WSS_Update_ConnectionState&&o.data>=b.jB.Connecting&&n(!0)},[o]);let a=(0,C.A)();return(0,i.jsx)(i.Fragment,{children:t&&(0,i.jsx)(I.A,{title:(0,i.jsx)(v.A,{i18nKey:"button.reconnect"}),children:(0,i.jsx)(D.A,{"aria-label":"refresh",onClick:()=>(()=>{switch(e.mode){case"reconnect-wss":M.A.emit({type:M.m.WSS_Request_Reconnect});break;case"reload-session":M.A.emit({type:M.m.WSS_Refresh_Session})}})(),sx:{border:"2px solid",borderColor:a.palette.promptPanelBackground.main,background:a.palette.slideSectionBackground.main,opacity:.75,"&:hover":{backgroundColor:a.palette.slideSectionBackground.main,opacity:1}},children:(0,i.jsx)(N.A,{})})})})}function L(){let{session:e}=(0,s.useContext)(g.L);return(0,s.useEffect)(()=>{document.title=e.sessionName},[]),(0,i.jsx)(i.Fragment,{})}var U=n(90073);function V(e){return(0,i.jsx)(i.Fragment,{children:e.role===b.sW.Client&&(0,i.jsx)(U.A,{sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:1},children:e.children})})}var K=n(54884);function _(){return(0,s.useEffect)(()=>{var e;let t=[/defaultProps/,/of chart should be greater than 0/,/It will be ignored./,/If you accidentally passed it from a parent component, remove it from the DOM element./,/Form submission canceled because the form is not connected/,/Enriching/,/Added non-passive event/,/Form submission canceled/,/Added non-passive event listener/,/Violation/,/Warning: Invalid DOM/,/Canvas2D/],n=console.error,i=console.warn,o=console.info,r=console.debug,s=null==(e=window)?void 0:e.onerror;return console.error=function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];t.some(e=>i.some(t=>e.test("".concat(t))))||n(...i)},console.warn=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.some(e=>n.some(t=>e.test("".concat(t))))||i(...n)},console.info=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];t.some(e=>n.some(t=>e.test("".concat(t))))||o(...n)},console.debug=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];t.some(e=>n.some(t=>e.test("".concat(t))))||r(...n)},(0,K.s)(window)&&(window.onerror=(e,t,n,i,o)=>{}),()=>{console.error=n,console.warn=i,console.debug=r,console.info=o,(0,K.s)(s)&&(window.onerror=s)}},[]),(0,i.jsx)(i.Fragment,{})}var z=n(48484),H=n(77914),G=n(31240),Z=n(50355),J=n(66622);function Q(e){let{publicContent:t}=(0,s.useContext)(g.L),[n,a]=(0,s.useState)(""),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),p=l&&0===n.trim().length,h=!p&&n.trim().length>0,x=t=>{h&&(e.submitName(n),u(!0))};return(0,i.jsxs)(i.Fragment,{children:[!d&&(0,i.jsx)(J.A,{privacyNotice:!0,workshopInformationUrl:t.workshopInformationUrl,children:(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,i.jsx)(r.A,{variant:"h2",color:"white",children:(0,i.jsx)(v.A,{i18nKey:"onboarding.pleaseEnterName"})}),(0,i.jsx)(r.A,{variant:"body1",color:"white",children:(0,i.jsx)(v.A,{i18nKey:"onboarding.pleaseEnterNameExplanation"})}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x()},style:{alignSelf:"stretch"},children:[(0,i.jsx)(Z.A,{sx:{mb:4,input:{background:"#ffffffcc"}},fullWidth:!0,style:{flexGrow:1},label:(0,i.jsx)(v.A,{i18nKey:"field.yourName"}),variant:"outlined",value:n,autoComplete:"off",autoFocus:!0,onChange:e=>{a(e.target.value),c(!0)},error:p,color:"buttonStandard"}),(0,i.jsx)(G.A,{color:"buttonReverse",btnKey:"submit",busy:!1,disabled:!h,onClick:x,btnText:(0,i.jsx)(v.A,{i18nKey:"button.continue"})})]})]})}),d&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(H.T.Provider,{value:{participantName:n},children:e.children})})]})}var Y=n(89041),X=n(74597),$=n(72034),ee=n(33427),et=n(41133),en=n(94686),ei=n(36471),eo=n(1859),er=n(33652),es=n(74603),ea=n(90584),el=n(92253);let ec={get_request:!1,get_success:!1,get_fail_system:!1,get_fail_user:!1,get_fail_could_not_start:!1,get_fail_unknown_error:!1},ed=e=>e.get_fail_system||e.get_fail_user||e.get_fail_could_not_start||e.get_fail_unknown_error,eu=e=>{let{prompts:t}=e;return(0,i.jsxs)(i.Fragment,{children:[t.get_success&&(0,i.jsx)(F.A,{severity:"success",children:"Your camera and microphone are ready to go!"}),t.get_request&&(0,i.jsx)(F.A,{severity:"info",children:"If prompted by your browser, please grant permission to access your camera and microphone."}),t.get_fail_system&&(0,i.jsx)(F.A,{severity:"error",children:"Your browser has denied access to your camera and microphone. Please check your browser settings and reload the page."}),t.get_fail_user&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.A,{severity:"warning",children:"Your browser has been denied access to your camera and/or microphone."}),(0,i.jsxs)(r.A,{variant:"h4",component:"h2",color:"white",children:["What to do next on ",el.C0]}),el.H8&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)($.A,{fontSize:"inherit"}),children:"If you see a crossed video camera icon at the end of your address bar, click it to change permissions."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(ee.A,{fontSize:"inherit"}),children:"If you don't see a camera icon, click the info icon at the beginning of the address bar for the page settings."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(et.A,{fontSize:"inherit"}),children:"Grant permission to access camera and microphone from there."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(en.A,{fontSize:"inherit"}),children:"When done, reload the page."})]}),el.gm&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)($.A,{fontSize:"inherit"}),children:"If you see a crossed video camera or microphone icon at the start of your address bar, click it to change permissions."}),(0,i.jsxs)(F.A,{severity:"info",icon:(0,i.jsx)(ei.A,{fontSize:"inherit"}),children:["If you don't see those icons, choose ",(0,i.jsx)("b",{children:"Tools"})," > ",(0,i.jsx)("b",{children:"Page Info"})," from the menu."]}),(0,i.jsxs)(F.A,{severity:"info",icon:(0,i.jsx)(et.A,{fontSize:"inherit"}),children:["Grant permission to access camera and microphone from the ",(0,i.jsx)("b",{children:"Permissions"})," tab."]}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(en.A,{fontSize:"inherit"}),children:"When done, reload the page."}),(0,i.jsx)("img",{src:"/instructions/permissions-dialog-ff.png",style:{width:"80%",alignSelf:"center"}})]}),el.nr&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(F.A,{severity:"info",icon:(0,i.jsx)(ei.A,{fontSize:"inherit"}),children:["Choose ",(0,i.jsx)("b",{children:"Safari"})," > ",(0,i.jsx)("b",{children:"Settings"})," from the menu, then click ",(0,i.jsx)("b",{children:"Websites"}),"."]}),(0,i.jsxs)(F.A,{severity:"info",icon:(0,i.jsx)(eo.A,{fontSize:"inherit"}),children:["Choose the Camera settings, and set this site to ",(0,i.jsx)("b",{children:"Allow"}),"."]}),(0,i.jsxs)(F.A,{severity:"info",icon:(0,i.jsx)(er.A,{fontSize:"inherit"}),children:["Choose the Microphone settings, and set this site to ",(0,i.jsx)("b",{children:"Allow"}),"."]}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(es.A,{fontSize:"inherit"}),children:"When done, reload the page."}),(0,i.jsx)("img",{src:"/instructions/permissions-dialog-sf.png",style:{width:"80%",alignSelf:"center"}})]}),el.UP&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(ei.A,{fontSize:"inherit"}),children:"Select Settings and more... and select Settings."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(et.A,{fontSize:"inherit"}),children:"Select Cookies and Site Permissions on the left side."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(en.A,{fontSize:"inherit"}),children:"Under Site Permissions, select Camera or Microphone."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(es.A,{fontSize:"inherit"}),children:"Grant permissions there"}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(ea.A,{fontSize:"inherit"}),children:"When done, reload this page."})]}),!el.H8&&!el.gm&&!el.nr&&!el.UP&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(F.A,{severity:"warning",children:["We don't have instructions for ",el.C0,"."]}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(ei.A,{fontSize:"inherit"}),children:"Please grant camera and microphone permissions for this page."}),(0,i.jsx)(F.A,{severity:"info",icon:(0,i.jsx)(et.A,{fontSize:"inherit"}),children:"When done, reload the page."})]})]}),t.get_fail_could_not_start&&(0,i.jsx)(F.A,{severity:"warning",children:"Your camera and microphone are in use by another application. Please close the other application, refresh this page, and try again."}),t.get_fail_unknown_error&&(0,i.jsx)(F.A,{severity:"error",children:"An unexpected error has prevented us from checking your camera and microphone. Please reload the page to try again."})]})},ep=[{title:"Can we use your microphone and camera during this workshop?",body:"This session will involve participation and discussion, so we will need to use your microphone and camera in order to see and hear you."},{title:"Are you sure?",body:"Unfortunately, without granting access to your microphone and camera you will not be able to participate in the session. Please select below to either allow access, or to navigate out of the session."}];function eh(e){let{session:t}=(0,s.useContext)(g.L),[n,a]=(0,s.useState)(0),[l,c]=(0,s.useState)(ec),[d,u]=(0,s.useState)(!1),[p,h]=(0,s.useState)(!1),x=t.remoteConfiguration===b.LQ.RemoteWithVideoCall;(0,s.useEffect)(()=>{x&&(u(!0),m().then(e=>{h(e)}).catch(e=>{console.error(e)}).finally(()=>{u(!1)}))},[]),(0,s.useEffect)(()=>{p&&e.onGrant(!0)},[p]);let m=async()=>{if(void 0===navigator)return console.warn("Navigator required to check permissions"),!1;try{let e=await navigator.permissions.query({name:"camera"});return"granted"===e.state}catch(e){return console.error("Error checking camera permissions",e),!1}},f=async()=>{let e=await v();if(!0===e||!1===e)h(e),c({...ec,get_success:e,get_fail_unknown_error:!e});else{let{type:t,name:n,message:i}=e;h(!1),console.error("Permission denied: ".concat(n,", ").concat(i)),c({...ec,get_success:!1,get_fail_system:t===X.n1.SystemPermissionDenied,get_fail_user:t===X.n1.UserPermissionDenied,get_fail_could_not_start:t===X.n1.CouldNotStartVideoSource,get_fail_unknown_error:null==t||t===X.n1.Generic})}},v=async()=>{try{let e=await (0,X.yD)();if(void 0!==e)return e;throw{type:X.n1.Generic,name:"Unknown",message:"Unknown error"}}catch(e){if(void 0!==e)return e;return{type:X.n1.Generic,name:"Unknown",message:"Unknown error"}}};return(0,i.jsxs)(i.Fragment,{children:[!p&&x&&(0,i.jsx)(J.A,{children:(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,i.jsx)(r.A,{variant:"h2",color:"white",children:ep[n].title}),(0,i.jsx)(r.A,{variant:"body1",color:"white",children:ep[n].body}),(0,i.jsx)(o.A,{sx:{alignSelf:"stretch",display:"flex",flexDirection:"column",gap:2},children:(0,i.jsx)(eu,{prompts:l})}),(0,i.jsxs)(o.A,{sx:{mt:4,display:"flex",flexDirection:"column",gap:2},children:[d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Y.A,{sx:{mt:4,backgroundColor:"#444444","& .MuiLinearProgress-bar":{backgroundColor:"white"}}}),(0,i.jsx)(r.A,{variant:"body2",color:"white",children:"Checking for permission..."})]}),!d&&!ed(l)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(G.A,{btnKey:"allow",busy:!1,disabled:!1,onClick:f,color:"buttonReverse",btnText:"ALLOW"}),0===n&&(0,i.jsx)(G.A,{btnKey:"deny",variant:"text",busy:!1,disabled:!1,onClick:()=>a(1),color:"buttonReverse",btnText:"DO NOT ALLOW"}),1===n&&(0,i.jsx)(G.A,{btnKey:"deny",variant:"text",busy:!1,disabled:!1,onClick:()=>void window.location.reload(),color:"buttonReverse",btnText:"EXIT WORKSHOP"})]}),!d&&ed(l)&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(G.A,{btnKey:"allow",variant:"outlined",busy:!1,disabled:!1,onClick:()=>{window.location.reload()},color:"buttonReverse",btnText:"RELOAD PAGE"})})]})]})}),(p||!x)&&(0,i.jsx)(i.Fragment,{children:e.children})]})}var ex=n(79005);function eg(e){let{children:t}=e,{publicContent:n,session:r}=(0,s.useContext)(g.L),[a,l]=(0,s.useState)(!1);return(0,i.jsxs)(i.Fragment,{children:[!a&&(0,i.jsx)(J.A,{privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,i.jsx)(ex.A,{session:r,layout:"column",welcome:!0,white:!0}),(0,i.jsx)(G.A,{color:"buttonReverse",btnText:(0,i.jsx)(v.A,{i18nKey:"button.getStarted"}),btnKey:"start",onClick:e=>{l(!0)},sx:{mt:4}})]})}),a&&(0,i.jsx)(i.Fragment,{children:t})]})}function em(e){let{children:t}=e,{session:n}=(0,s.useContext)(g.L),[a,l]=(0,s.useState)(n.remoteConfiguration===b.LQ.InPerson);return(0,i.jsxs)(i.Fragment,{children:[!a&&(0,i.jsx)(J.A,{children:(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"start",gap:2},children:[(0,i.jsx)(r.A,{variant:"h2",color:"white",children:"We recommend using WiFi rather than mobile data"}),(0,i.jsx)(r.A,{variant:"body1",color:"white",children:"This session involves watching some video content which requires more data usage. So we recommend you use WiFi so as not to use up too much mobile data."}),(0,i.jsx)(G.A,{color:"buttonReverse",btnText:"CONTINUE",btnKey:"start",onClick:e=>{l(!0)},sx:{mt:4}})]})}),a&&(0,i.jsx)(i.Fragment,{children:t})]})}let ef=e=>{let{bar:t}=e;return(0,i.jsx)(z.A,{preTitle:(0,i.jsx)(v.A,{i18nKey:"onboarding.welcomeTo"}),title:"Zeitgeist",bar:t})},eb=()=>(0,i.jsx)(z.A,{preTitle:(0,i.jsx)(v.A,{i18nKey:"onboarding.thanks"}),title:(0,i.jsx)(v.A,{i18nKey:"onboarding.almostThere"}),bar:"Synchronizing clocks..."}),ev=()=>(0,i.jsx)(z.A,{preTitle:(0,i.jsx)(v.A,{i18nKey:"onboarding.thanks"}),title:(0,i.jsx)(v.A,{i18nKey:"onboarding.almostThere"}),bar:"Loading workshop content. This may take a few minutes..."}),ey=()=>(0,i.jsx)(z.A,{preTitle:(0,i.jsx)(v.A,{i18nKey:"onboarding.thanks"}),title:(0,i.jsx)(v.A,{i18nKey:"onboarding.almostThere"}),bar:"Connecting you to the workshop..."}),ew=e=>{let{descriptionKey:t,adviceKey:n}=e;return(0,i.jsxs)(o.A,{sx:{width:"100%",height:"100%",border:"solid 4px red",p:2,textWrap:"wrap",display:"flex",flexDirection:"column",gap:2},children:[(0,i.jsxs)(o.A,{children:[(0,i.jsx)(r.A,{variant:"h1",children:(0,i.jsx)(v.A,{i18nKey:t})}),(0,i.jsx)(v.A,{i18nKey:n,wrapper:(0,i.jsx)(r.A,{variant:"body1"})})]}),(0,i.jsxs)(o.A,{children:[(0,i.jsx)(r.A,{variant:"h2",children:(0,i.jsx)(v.A,{i18nKey:"onboarding.warnings.*.description"})}),(0,i.jsx)(v.A,{i18nKey:"onboarding.warnings.*.advice",wrapper:(0,i.jsx)(r.A,{variant:"body1"})})]})]})},ej=(0,s.createContext)({});function eA(e){let{role:t,sid:n,joinCode:r,refresh:k,children:S}=e,[C,I]=(0,s.useState)(!1),[D,F]=(0,s.useState)("Unknown"),[B,P]=(0,s.useState)(!1),[T,q]=(0,s.useState)(!1),N=t===b.sW.Controller;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.A,{sx:{width:"100%",height:"100%"},children:(0,i.jsxs)(m.A,{children:[(0,i.jsx)(w,{children:(0,i.jsx)(R.A,{})}),(0,i.jsx)(_,{}),(0,i.jsx)(h.Ay,{role:t,sid:n,joinCode:r,load:(0,i.jsx)(ef,{bar:"Checking access to the workshop..."}),err:(0,i.jsx)(ew,{descriptionKey:"onboarding.warnings.ZgSessionUserProvider.description",adviceKey:"onboarding.warnings.ZgSessionUserProvider.advice"}),children:(0,i.jsxs)(g.A,{sid:n,init:(0,i.jsx)(ef,{}),load:(0,i.jsx)(ef,{bar:(0,i.jsx)(v.A,{i18nKey:"onboarding.loadingWorkshop"})}),err:(0,i.jsx)(ew,{descriptionKey:"onboarding.warnings.ZgStaticSessionDataProvider.description",adviceKey:"onboarding.warnings.ZgStaticSessionDataProvider.advice"}),children:[(0,i.jsx)(L,{}),(0,i.jsxs)(a.A,{children:[(0,i.jsx)(j,{children:(0,i.jsxs)(V,{role:t,children:[(0,i.jsx)(O,{mode:"reconnect-wss"}),(0,i.jsx)(E,{goFullScreen:C})]})}),(0,i.jsx)(eg,{children:(0,i.jsx)(Q,{submitName:F,children:(0,i.jsx)(eh,{onGrant:P,children:(0,i.jsx)(em,{children:(0,i.jsx)(ej.Provider,{value:{participantName:D,videoCallPermissionsGranted:B,storagePermissionsGranted:T},children:(0,i.jsx)(c.A,{mode:"zg-server-time",load:(0,i.jsx)(eb,{}),error:(0,i.jsx)(ew,{descriptionKey:"onboarding.warnings.ZgServerTimeProvider.description",adviceKey:"onboarding.warnings.ZgServerTimeProvider.advice"}),children:(0,i.jsx)(x.A,{sid:n,refresh:k,init:(0,i.jsx)(ev,{}),load:(0,i.jsx)(ev,{}),err:(0,i.jsx)(ew,{descriptionKey:"onboarding.warnings.ZgStaticSessionContentProvider.description",adviceKey:"onboarding.warnings.ZgStaticSessionContentProvider.advice"}),children:(0,i.jsx)(l.A,{sid:n,load:(0,i.jsx)(ey,{}),error:(0,i.jsx)(ew,{descriptionKey:"onboarding.warnings.ZgResilientWssConnectionProvider.description",adviceKey:"onboarding.warnings.ZgResilientWssConnectionProvider.advice"}),children:(0,i.jsxs)(f.A,{children:[(0,i.jsx)(A,{children:(0,i.jsx)(W,{})}),(0,i.jsx)(u.Ay,{children:(0,i.jsx)(p.A,{store:N,refresh:k,previews:!0,children:(0,i.jsxs)(d.A,{sid:n,children:[(0,i.jsx)(y,{keepAwake:!0}),S]})})})]})})})})})})})})})]})]})})]})})})}},2768:(e,t,n)=>{n.d(t,{A:()=>u,v:()=>c});var i=n(95155),o=n(93096),r=n(12115),s=n(69999),a=n(54884),l=n(18414);let c=(0,r.createContext)({});var d=function(e){return e[e.Init=0]="Init",e[e.Synchronising=1]="Synchronising",e[e.Error=2]="Error",e[e.Complete=3]="Complete",e}(d||{});function u(e){var t;let{api:n,start:d}=(0,r.useContext)(l.F),[u,p]=(0,r.useState)(0),[h,x]=(0,r.useState)(),[g,m]=(0,r.useState)(null!=(t=e.checks)?t:3);(0,r.useEffect)(()=>{switch(u){case 0:s.A.emit({type:s.m.Content_Progress_Update,data:{overall:{completed:0,total:g},bars:{}}}),p(1);break;case 1:f().then(e=>{x(e),p(3)}).catch(e=>{console.error(e),p(2)})}},[u]);let f=async()=>{switch(e.mode){case"server-date-lib":return v();case"zg-server-time":return b();default:throw Error("Unsupported time sync mode")}},b=async()=>{let e;await d(n.getServerTime());let t=Number.MAX_SAFE_INTEGER,i=0;for(let o=0;o<g;o++){let r=Date.now(),l=await d(n.getServerTime());if(!(0,a.s)(l))continue;let c=Date.now(),u=c-r,p=(r+c)/2,h=l.timestamp-p;u<t&&(t=u,i=h,e=l),s.A.emit({type:s.m.Content_Progress_Update,data:{overall:{completed:o+1,total:g},bars:{}}}),await new Promise(e=>setTimeout(e,1e3))}return{offset:i,rtt:t,source:e,toServerTime:e=>Math.round(e+i),fromServerTime:e=>Math.round(e-i)}},v=async()=>{let e;console.warn("ServerDateLib is only accurate to the second.");for(let t=0;t<g;t++){await new Promise(e=>setTimeout(e,1e3));let n=await (0,o.I)();(void 0===e||Math.abs(n.uncertainty)<Math.abs(e.uncertainty))&&(e=n),s.A.emit({type:s.m.Content_Progress_Update,data:{overall:{completed:t+1,total:g},bars:{}}})}return{offset:e.offset,source:e,rtt:e.uncertainty,toServerTime:t=>t+e.offset,fromServerTime:t=>t-e.offset}};return(0,i.jsxs)(i.Fragment,{children:[(0===u||1===u)&&e.load,2===u&&e.error,3===u&&(0,i.jsx)(c.Provider,{value:h,children:e.children})]})}},5611:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(95155),o=n(25789);function r(e){var t,n,r,s,a,l,c,d;let u=(0,o.A)();return(0,i.jsxs)("svg",{width:null!=(t=String(e.width))?t:"43",height:null!=(n=String(e.height))?n:"43",viewBox:"0 0 43 43",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("rect",{x:"11.5",y:"11.11",width:"21",height:"18",fill:null!=(r=e.fill)?r:u.palette.handRaisedFill.main}),(0,i.jsx)("path",{d:"M32.2501 19.7084V10.75C32.2501 9.79968 31.8726 8.88825 31.2006 8.21624C30.5286 7.54424 29.6171 7.16671 28.6668 7.16671C27.7164 7.16671 26.805 7.54424 26.133 8.21624C25.461 8.88825 25.0834 9.79968 25.0834 10.75",fill:null!=(s=e.fill)?s:u.palette.handRaisedFill.main}),(0,i.jsx)("path",{d:"M25.0834 17.9167V7.16671C25.0834 6.21635 24.7059 5.30491 24.0339 4.63291C23.3619 3.9609 22.4505 3.58337 21.5001 3.58337C20.5497 3.58337 19.6383 3.9609 18.9663 4.63291C18.2943 5.30491 17.9168 6.21635 17.9168 7.16671V10.75",fill:null!=(a=e.fill)?a:u.palette.handRaisedFill.main}),(0,i.jsx)("path",{d:"M17.9168 18.8125V10.75C17.9168 9.79968 17.5392 8.88825 16.8672 8.21624C16.1952 7.54424 15.2838 7.16671 14.3334 7.16671C13.3831 7.16671 12.4716 7.54424 11.7996 8.21624C11.1276 8.88825 10.7501 9.79968 10.7501 10.75V25.0834",fill:null!=(l=e.fill)?l:u.palette.handRaisedFill.main}),(0,i.jsx)("path",{d:"M32.2501 14.3334C32.2501 13.383 32.6276 12.4716 33.2996 11.7996C33.9716 11.1276 34.8831 10.75 35.8334 10.75C36.7838 10.75 37.6952 11.1276 38.3672 11.7996C39.0392 12.4716 39.4168 13.383 39.4168 14.3334V25.0834C39.4168 28.8848 37.9067 32.5306 35.2186 35.2186C32.5306 37.9066 28.8849 39.4167 25.0834 39.4167H21.5001C16.4834 39.4167 13.4376 37.8759 10.768 35.2242L4.31802 28.7742C3.70157 28.0915 3.37128 27.1978 3.39553 26.2783C3.41979 25.3588 3.79673 24.4838 4.44831 23.8345C5.09989 23.1852 5.97621 22.8114 6.89582 22.7904C7.81543 22.7694 8.7079 23.1028 9.38844 23.7217L12.5418 26.875",fill:null!=(c=e.fill)?c:u.palette.handRaisedFill.main}),(0,i.jsx)("path",{d:"M32.2501 19.7084V10.75C32.2501 9.79968 31.8726 8.88825 31.2006 8.21624C30.5286 7.54424 29.6171 7.16671 28.6668 7.16671C27.7164 7.16671 26.805 7.54424 26.133 8.21624C25.461 8.88825 25.0834 9.79968 25.0834 10.75M25.0834 17.9167V7.16671C25.0834 6.21635 24.7059 5.30491 24.0339 4.63291C23.3619 3.9609 22.4505 3.58337 21.5001 3.58337C20.5497 3.58337 19.6383 3.9609 18.9663 4.63291C18.2943 5.30491 17.9168 6.21635 17.9168 7.16671V10.75M17.9168 10.75V18.8125M17.9168 10.75C17.9168 9.79968 17.5392 8.88825 16.8672 8.21624C16.1952 7.54424 15.2838 7.16671 14.3334 7.16671C13.3831 7.16671 12.4716 7.54424 11.7996 8.21624C11.1276 8.88825 10.7501 9.79968 10.7501 10.75V25.0834M32.2501 14.3334C32.2501 13.383 32.6276 12.4716 33.2996 11.7996C33.9716 11.1276 34.8831 10.75 35.8334 10.75C36.7838 10.75 37.6952 11.1276 38.3672 11.7996C39.0392 12.4716 39.4168 13.383 39.4168 14.3334V25.0834C39.4168 28.8848 37.9067 32.5305 35.2186 35.2186C32.5306 37.9066 28.8849 39.4167 25.0834 39.4167H21.5001C16.4834 39.4167 13.4376 37.8759 10.768 35.2242L4.31802 28.7742C3.70157 28.0915 3.37128 27.1978 3.39553 26.2783C3.41979 25.3588 3.79673 24.4838 4.44831 23.8345C5.09989 23.1852 5.97621 22.8114 6.89582 22.7904C7.81543 22.7694 8.7079 23.1028 9.38844 23.7217L12.5418 26.875",stroke:null!=(d=e.stroke)?d:u.palette.userNametagIcon.main,strokeWidth:"2.39",strokeLinecap:"round",strokeLinejoin:"round"})]})}},10310:(e,t,n)=>{n.d(t,{A:()=>m,L:()=>g});var i=n(95155),o=n(12115),r=n(30349),s=n(18932),a=n(54884),l=n(57703),c=n(84073),d=n(18414),u=function(e){return e[e.Init=0]="Init",e[e.RetrievingSession=1]="RetrievingSession",e[e.RetrievingPublicContent=2]="RetrievingPublicContent",e[e.SessionError=3]="SessionError",e[e.Ready=4]="Ready",e}(u||{});let p=[3],h=[0],x=[1,2],g=(0,o.createContext)({});function m(e){let{api:t,start:n}=(0,o.useContext)(d.F),{user:m,role:f,sessionToken:b}=(0,o.useContext)(c.yk),[v,y]=(0,o.useState)(0),[w,j]=(0,o.useState)(),[A,k]=(0,o.useState)(),[S,C]=(0,o.useState)(!0),[I,D]=(0,o.useState)(!1),[E,R]=(0,o.useState)(!1);(0,o.useEffect)(()=>{switch(console.debug("Static data state",u[v]),v){case 0:y(1);break;case 1:F().then(e=>{if((0,a.s)(e))j(e),y(2);else throw"Could not retrieve session."}).catch(e=>{console.error(e),y(3)});break;case 2:B().then(e=>{k(e),y(4)}).catch(e=>{console.error(e),y(3)})}D(void 0!==x.find(e=>e===v)),R(void 0!==p.find(e=>e===v)),C(void 0!==h.find(e=>e===v))},[v]);let F=async()=>f===s.sW.Controller?await n(t.getDeliberationSessionAdmin(e.sid,b,m.access_token,void 0)):await (0,r.O)(t,n,e.sid,b),B=async()=>{let e={workshopDirectory:(0,l.G)(w.sessionPresentationUris[0])};return await n(t.postPublicContentAccessRequest(w.id,e))};return(0,i.jsxs)(i.Fragment,{children:[S&&e.init,I&&e.load,E&&e.err,4===v&&(0,i.jsx)(g.Provider,{value:{sid:w.id,session:w,publicContent:A},children:e.children})]})}},11265:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(95155),o=n(80317),r=n(90073);function s(){return(0,i.jsxs)(r.A,{component:"main",sx:{display:"flex",flexDirection:"column",gap:"1rem",padding:"1rem"},children:[(0,i.jsx)(o.A,{variant:"h1",sx:{fontSize:"2.25rem"},children:"The Situation Room"}),(0,i.jsxs)(o.A,{variant:"body1",children:["Thanks for trying to join ",(0,i.jsx)("b",{children:"The Situation Room"}),"."]}),(0,i.jsxs)(o.A,{variant:"body1",children:["Unfortunately, ",(0,i.jsx)("b",{children:"you can't use a phone"})," (or other device with a small screen) to take part in the session."]}),(0,i.jsxs)(o.A,{variant:"body1",children:[(0,i.jsx)("b",{children:"Please use a laptop, tablet"})," or other similar device to join."]})]})}},13202:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(95155),o=n(80357),r=n(12115),s=n(77757);let a={0:{columns:1,rows:1},1:{columns:1,rows:1},2:{columns:1,rows:2},3:{columns:1,rows:3},4:{columns:2,rows:2},5:{columns:2,rows:3},6:{columns:2,rows:3},7:{columns:2,rows:4},8:{columns:2,rows:4},9:{columns:3,rows:3},10:{columns:3,rows:4},11:{columns:3,rows:4},12:{columns:3,rows:4},13:{columns:4,rows:4},14:{columns:4,rows:4},15:{columns:4,rows:4},16:{columns:4,rows:4}};function l(e){let{tiles:t}=(0,r.useContext)(s.qW),[n,l]=(0,r.useState)({rows:1,columns:1});return(0,r.useEffect)(()=>{let e=t.length;if(e<=16)l({rows:a[e].rows,columns:a[e].columns});else{let t=Math.ceil(Math.sqrt(e));l({rows:t,columns:Math.ceil(e/t)})}},[t]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.A,{sx:{...e.sx,width:"100%",height:"100%",display:"grid",gap:1,gridTemplateRows:"repeat(".concat(n.rows,", 1fr)"),gridTemplateColumns:"repeat(".concat(n.columns,", 1fr)")},children:t})})}},17229:(e,t,n)=>{n.d(t,{zs:()=>O,H7:()=>M,ZR:()=>L,Ay:()=>U});var i=n(95155),o=n(18932),r=n(62652),s=n(54884),a=n(79200),l=n(32276),c=n(12115),d=n(55279),u=n(80317),p=n(27855),h=n(48464),x=n(57915),g=n(90073),m=n(37772),f=n(71385),b=n(88379),v=n(79952),y=n(45238),w=n(39268),j=n(76452),A=n(87920),k=n(23405),S=n(45279),C=n(19131),I=n(79158);function D(e){var t;let[n,o]=(0,c.useState)(!1),[s,a]=(0,c.useState)(!1),d=(0,l.Y$K)(e.attendee.chimeAttendeeId).muted,{kickUser:u,lowerHandUser:p,muteUser:h}=(0,j.A)(o),x=e.subscription.participantName.length>40?e.subscription.participantName.substring(0,40)+"...":e.subscription.participantName;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(A.A,{sx:{py:0},children:[(0,i.jsxs)(k.A,{disabled:n||!(null==(t=e.userSignalsForCurrentTile)?void 0:t.raiseHand),onClick:()=>{console.debug('"Lower participant\'s hand" was clicked for participant "'.concat(x,'" (').concat(e.subscription.deviceId,")")),e.requestClose(),p(e.subscription)},children:[(0,i.jsx)(S.A,{children:(0,i.jsx)(I.A,{})}),(0,i.jsx)(C.A,{inset:!1,children:(0,i.jsx)(r.A,{i18nKey:"button.lowerUserHand",options:{name:x}})})]},"attendee-control-menu-item-".concat(e.subscription.subscriptionId,"-lower-hand")),(0,i.jsxs)(k.A,{disabled:n||d,onClick:d?void 0:()=>{e.requestClose(),h(e.subscription)},children:[(0,i.jsx)(S.A,{children:d?(0,i.jsx)("img",{src:"/icons/controls/participant-muted.svg",alt:"muted"}):(0,i.jsx)("img",{src:"/icons/controls/mute-participant.svg",alt:"mute"})}),(0,i.jsx)(C.A,{inset:!1,children:d?"".concat(x," muted"):"Mute ".concat(x)})]},"attendee-control-menu-item-".concat(e.subscription.subscriptionId,"-mute")),(0,i.jsxs)(k.A,{disabled:n,onClick:()=>{a(!0)},children:[(0,i.jsx)(S.A,{children:(0,i.jsx)("img",{src:"/icons/controls/remove-participant.svg",alt:"remove"})}),(0,i.jsxs)(C.A,{inset:!1,children:["Remove ",x]})]},"attendee-control-menu-item-".concat(e.subscription.subscriptionId,"-kick"))]}),(0,i.jsx)(w.A,{prompt:"Remove the participant from the call?",options:[{key:"kick",text:"Remove participant",filled:!0},{key:"cancel",text:"Cancel",filled:!1}],onSelect:t=>{"kick"===t&&u(e.subscription)},open:s,setOpen:a,onClose:e.requestClose})]})}let E="26px",R="37px";function F(e){var t;let n=(0,x.A)();return(0,i.jsx)(g.A,{className:"user-name-tag-icon-container",sx:{alignItems:"center",backgroundColor:null!=(t=e.backgroundColor)?t:n.palette.userNametagIcon.main,borderRadius:"50%",display:"flex",flex:"none",flexDirection:"row",height:e.compactUi?E:R,justifyContent:"center",width:e.compactUi?E:R,...e.sx},children:e.children})}var B=n(18098),P=n(39142);function T(e){let t=(0,l.GVR)(e.attendee.chimeAttendeeId);return(0,i.jsx)(i.Fragment,{children:(null==t?void 0:t.muted)?(0,i.jsx)(B.A,{color:"#ffffffff",height:e.iconSize,strokeWidth:e.iconStrokeWidth,width:e.iconSize}):(0,i.jsx)(P.A,{color:"#ffffffff",height:e.iconSize,strokeWidth:e.iconStrokeWidth,width:e.iconSize})})}var q=n(74246),W=n(5611);function N(e){let t=e.compactUi?"14px":"17px";return(0,i.jsxs)(i.Fragment,{children:[e.raiseHand&&(0,i.jsx)(F,{backgroundColor:"transparent",compactUi:e.compactUi,sx:{mr:1},children:(0,i.jsx)(q.A,{badgeContent:e.raiseHandQueuePosition,color:"userNametagIcon",sx:{"& > .MuiBadge-badge":{borderRadius:"50%",fontWeight:"bold",height:t,minWidth:t,right:e.compactUi?"-1px":"1px",top:e.compactUi?"3px":"4px",width:t}},children:(0,i.jsx)(W.A,{height:e.compactUi?O+5:M+10,width:e.compactUi?O+5:M+10})})}),e.mic&&(0,i.jsx)(F,{compactUi:e.compactUi,children:(0,i.jsx)(T,{attendee:e.attendee,iconSize:e.compactUi?O:M,iconStrokeWidth:L})})]})}let M=22,O=18,L=1.5;function U(e){var t,n;let{isPreview:w}=(0,c.useContext)(y.K),j=function(e){let{roster:t}=(0,l.Abl)(),{allUserSignals:n}=(0,c.useContext)(a.F),i=n.filter(e=>e.raiseHand&&Object.values(t).map(e=>e.externalUserId).includes(e.senderDeviceId)),o=performance.now();i.sort((e,t)=>e.raiseHand.timestamp-t.raiseHand.timestamp);let r=i.findIndex(t=>t.senderDeviceId===e.deviceId)+1,s=performance.now();return s-o>1e3&&console.warn("Queue position calculation took longer than one second: ",s-o),r}(e.subscriptionForCurrentTile),A=(0,x.A)(),k=(0,d.A)(e.subscriptionForCurrentTile.deviceId),[S,C]=(0,c.useState)(!1),I=(0,c.useRef)(null),{roster:E}=(0,l.Abl)(),R=E?null==(t=Object.entries(E).find(t=>{let[n,i]=t;return i.externalUserId===e.subscriptionForCurrentTile.deviceId}))?void 0:t[1]:void 0,F=!w&&!e.banned&&R&&(0,s.s)(k),B=()=>{(0,s.s)(I.current)&&(I.current.scrollWidth>I.current.clientWidth?C(!0):C(!1))};(0,c.useEffect)(()=>{B()},[]);let{width:P}=(0,v.A)({ref:I.current});return(0,c.useEffect)(()=>{(0,s.s)(P)&&B()},[P]),(0,i.jsxs)(g.A,{className:"user-name-tag-container",sx:{alignItems:"center",backgroundColor:"#ffffffff",border:F&&(0,s.s)(null==k?void 0:k.raiseHand)?"2px solid ".concat(A.palette.userNametagIcon.main):"none",borderRadius:e.compactUi?"10px":"15px",display:"flex",flexDirection:"row",fontWeight:"bold",maxWidth:"fit-content",overflow:"hidden",p:F&&(0,s.s)(null==k?void 0:k.raiseHand)?e.compactUi?"2px":"3px":e.compactUi?"4px":"5px",pr:"4px",userSelect:e.thisUser.role===o.sW.Controller?"initial":"none",...e.sx},children:[R&&(0,i.jsx)(g.A,{className:"user-name-tag-icons-container",sx:{display:"flex",flexDirection:"row",mr:e.compactUi?.5:.75},children:(0,i.jsx)(N,{attendee:R,banned:e.banned,compactUi:e.compactUi,mic:!e.banned&&(0,s.s)(R),raiseHand:F&&(0,s.s)(null==k?void 0:k.raiseHand),raiseHandQueuePosition:j})}),(0,i.jsxs)(g.A,{className:"user-name-tag-name-container",sx:{mr:.25,overflow:"hidden",position:"relative"},children:[S&&(0,i.jsx)(g.A,{className:"user-name-tag-name-fadeout",sx:{background:"linear-gradient(90deg, #ffffff00 0%, #ffffffff 95%)",height:"100%",position:"absolute",right:"0",width:"3rem"}}),(0,i.jsxs)(u.A,{className:"user-name-tag-name",ref:I,sx:{textWrap:"nowrap"},children:[e.subscriptionForCurrentTile.participantName," ",e.isLocal&&(0,i.jsxs)(i.Fragment,{children:["(",(0,i.jsx)(r.A,{i18nKey:"userNametags.me"}),")"]}),!R&&!e.banned&&(0,i.jsxs)(i.Fragment,{children:["(",(0,i.jsx)(r.A,{i18nKey:"userNametags.joining"}),")"]}),e.banned&&(0,i.jsxs)(i.Fragment,{children:["(",(0,i.jsx)(r.A,{i18nKey:"userNametags.banned"}),")"]})]})]}),(null==(n=e.thisUser)?void 0:n.role)===o.sW.Controller&&!e.banned&&!e.isLocal&&R&&e.subscriptionForCurrentTile.role!==o.sW.Controller&&(0,i.jsx)(g.A,{className:"user-name-tag-settings-button-container",children:(0,i.jsx)(f.Ay,{popupId:"user-name-tag-controls-menu-".concat(e.subscriptionForCurrentTile.subscriptionId),variant:"popover",children:t=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.A,{className:"user-name-tag-settings-button",disableRipple:!0,sx:e=>({minWidth:"unset",px:.25,py:0,"&:focus-visible":{...e.customStyles.focusRing}}),...(0,b.cO)(t),children:(0,i.jsx)(m.A,{color:A.palette.userNametagIcon.main,height:e.compactUi?O:M,strokeWidth:3,width:e.compactUi?O:M})}),(0,i.jsx)(h.A,{...(0,b.NA)(t),children:(0,i.jsx)(D,{attendee:R,requestClose:t.close,subscription:e.subscriptionForCurrentTile,userSignalsForCurrentTile:k})})]})})})]})}},17448:(e,t,n)=>{n.d(t,{Ay:()=>f});var i=n(95155),o=n(57300),r=n(54884),s=n(90073),a=n(32276),l=n(34678),c=n(12115),d=n(23387),u=n(45238),p=n(80357),h=n(80317);let x=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(p.A,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",border:"solid 2px grey",borderRadius:1},children:"TEST"})}),g=e=>(0,i.jsx)(p.A,{className:"shadow",sx:{borderRadius:"0.5rem",overflow:"hidden",background:"lightgray",height:"100%",width:"100%",position:"relative"},children:(0,i.jsx)(p.A,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,i.jsxs)(h.A,{variant:"body2",color:"gray",align:"center",sx:{mx:4,textWrap:"balance"},children:["space reserved for ",e.name]})})});var m=n(17229);function f(e){return(0,i.jsxs)(i.Fragment,{children:[e.test&&(0,i.jsx)(x,{}),!e.test&&(0,i.jsx)(b,{subscription:e.subscription})]})}let b=e=>{let{tiles:t,attendeeIdToTileId:n}=(0,a.CHz)(),{tileId:s,isVideoEnabled:l}=(0,a.oCg)(),[d,u]=(0,c.useState)(void 0),{thisUser:p}=(0,c.useContext)(o.f),{roster:h}=(0,a.Abl)(),[x,m]=(0,c.useState)(),[f,b]=(0,c.useState)(void 0),[y,w]=(0,c.useState)(void 0),j=e.subscription.deviceId===(null==p?void 0:p.deviceId);return(0,c.useEffect)(()=>{let t=((e,t)=>{var n;return null==(n=Object.entries(t).find(t=>t[1].externalUserId===e))?void 0:n[1]})(e.subscription.deviceId,h);b(null==t?void 0:t.chimeAttendeeId)},[h,e.subscription.deviceId]),(0,c.useEffect)(()=>{u((0,r.s)(f)?n[f]:void 0)},[n,f,t]),(0,c.useEffect)(()=>{j?w(null!=s?s:void 0):w(d)},[s,j,d]),(0,c.useEffect)(()=>{e.test||((0,r.s)(f)?m({isLocal:j,hasVideo:j?l:t.some(e=>e===y),tileId:y,chimeAttendeeId:f,muted:void 0,subscription:e.subscription,thisUser:p}):m(void 0))},[j,l,t,y,f,e.subscription,p,e.test]),(0,i.jsxs)(i.Fragment,{children:[x&&(0,i.jsx)(v,{...x},"video-call-tile-".concat(e.subscription.subscriptionId)),!x&&(0,i.jsx)(g,{name:e.subscription.participantName},"video-call-reservation-".concat(e.subscription.subscriptionId))]})},v=function(e){let{muted:t}=(0,a.GVR)(e.chimeAttendeeId),[n,o]=(0,c.useState)(e);return(0,c.useEffect)(()=>{o({...e,muted:t})},[e,t]),(0,i.jsx)(y,{...n})},y=((a.AWB,(e,t)=>e.tileId===t.tileId),a.fIy,function(e){let{isPreview:t}=(0,c.useContext)(u.K);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.A,{className:"shadow",sx:{borderRadius:"0.5rem",overflow:"hidden",background:"#141414",height:"100%",width:"100%",position:"relative"},children:[e.hasVideo&&!e.isLocal&&!1,e.hasVideo&&!e.isLocal&&(0,i.jsx)(a.AWB,{tileId:e.tileId}),e.hasVideo&&e.isLocal&&!1,e.hasVideo&&e.isLocal&&(0,i.jsx)(a.fIy,{}),!e.hasVideo&&(0,i.jsx)(s.A,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,i.jsx)(l.A,{color:"white"})}),e.thisUser&&e.subscription&&(0,i.jsx)(s.A,{className:"user-name-tag-video-tile-container",sx:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"end",left:0,p:!t&&d.HN?.5:t?2:1,position:"absolute",top:0,width:"100%"},children:(0,i.jsx)(m.Ay,{compactUi:d.HN,isLocal:e.isLocal,subscriptionForCurrentTile:e.subscription,thisUser:e.thisUser})})]})})})},19672:(e,t,n)=>{n.d(t,{A:()=>h,N:()=>p});var i=n(95155),o=n(25789),r=n(60193),s=n(39142),a=n(18098),l=n(60890),c=n(34678),d=n(24274),u=n(57476);let p=32;function h(e){let{t}=(0,d.Bd)(),n=(0,o.A)().palette.callControlButtonIcon.main,h="",x="";return"audio"===e.control?(h=t("audio.enableMic"),x=t("audio.muteMic")):"camera"===e.control&&(h=t("video.enableCamera"),x=t("video.disableCamera")),(0,i.jsxs)(r.A,{disabled:e.busy,disableFocusRipple:!0,"aria-label":e.enabled?x:h,onClick:e.toggleFn,sx:t=>({backgroundColor:e.enabled?"callControlButton.main":"callControlButtonOff.main",height:u.LL,position:e.showMenu?"absolute":"initial",right:e.showMenu?"0":"initial",width:u.LL,"&:hover":{backgroundColor:e.enabled?"callControlButton.dark":"callControlButtonOff.main"},"&:focus-visible":{...t.customStyles.focusRingReverse}}),children:["audio"===e.control&&(0,i.jsx)(i.Fragment,{children:e.enabled?(0,i.jsx)(s.A,{color:n,size:p}):(0,i.jsx)(a.A,{color:n,size:p})}),"camera"===e.control&&(0,i.jsx)(i.Fragment,{children:e.enabled?(0,i.jsx)(l.A,{color:n,size:p}):(0,i.jsx)(c.A,{color:n,size:p})})]})}},21644:(e,t,n)=>{n.d(t,{A:()=>c,z:()=>l});var i=n(95155),o=n(67909),r=n(12115),s=n(84073),a=n(24360);let l=(0,r.createContext)({});function c(e){let t=(0,r.useContext)(a._),[c,d]=(0,r.useState)(),{role:u}=(0,r.useContext)(s.yk);return(0,r.useEffect)(()=>{let r=(0,o.default)(()=>Promise.all([n.e(328),n.e(612),n.e(680)]).then(n.bind(n,1680)),{loadableGenerated:{webpack:()=>[1680]},ssr:!1}),s=(0,o.default)(()=>Promise.all([n.e(551),n.e(268),n.e(612),n.e(101),n.e(758)]).then(n.bind(n,85758)),{loadableGenerated:{webpack:()=>[85758]},ssr:!1});d({presentation:(0,i.jsx)(r,{sid:t.sid,role:u,slides:t.slides,sourcePresentationXml:t.sourceXml.join("\n"),embedded:!0,showBorder:!1,regenerateThumbnails:e.refresh}),previews:e.previews?(0,i.jsx)(s,{sid:t.sid,slides:t.slides,sourcePresentationXml:t.sourceXml.join("\n"),regenerateThumbnails:e.refresh}):void 0})},[]),(0,i.jsx)(i.Fragment,{children:c&&(0,i.jsx)(l.Provider,{value:c,children:e.children})})}},23387:(e,t,n)=>{n.d(t,{BX:()=>s,DY:()=>r,HN:()=>a,YC:()=>o,aW:()=>i,gZ:()=>l});let i=!0,o=!0,r=!0,s=!0,a=!0,l={audio:!0,video:!0,audioDevice:void 0,audioOutputDevice:null,videoDevice:void 0,voiceFocus:!0,backgroundBlur:!1,startMeeting:!0}},23971:(e,t,n)=>{function i(e){if(null!=e&&("string"!=typeof e||""!==e.trim()))return parseInt(e)}function o(e){if(null!=e&&("string"!=typeof e||""!==e.trim()))return r(e)}function r(e){return!0===e||!1===e?e:"number"==typeof e?e>0:("string"==typeof e&&(e=e.toLowerCase()),"true"===e||"false"===e)?"true"===e:"yes"===e||"no"===e?"yes"===e:"t"===e||"f"===e?"t"===e:("y"===e||"n"===e)&&"y"===e}n.d(t,{$_:()=>o,Cb:()=>function e(t){if(t instanceof Array)return t.map(function(t){return"object"==typeof t&&(t=e(t)),t});{let n={};for(let i in t)if(t.hasOwnProperty(i)){let o=(i.charAt(0).toLowerCase()+i.slice(1)||i).toString(),r=t[i];(r instanceof Array||null!==r&&r.constructor===Object)&&(r=e(r)),n[o]=r}return n}},wF:()=>i,yG:()=>r})},24360:(e,t,n)=>{n.d(t,{_:()=>t9,A:()=>ne});var i=n(95155),o=n(16405),r=n(12115),s=n(46671),a=n.n(s),l=n(74879),c=n(23971),d=n(18932),u=n(54884);let p={select:["key","label","layout","groups"],text:["key","label","textPlaceholder","textValidationRegex","textMaxLength"],"multi-select":["key","label","groups","selectionQuestion","selectionObject","selectionObject_plural","minSelections","maxSelections"]},h=e=>{if(!Object.hasOwn(p,e.mode))return{validations:["DemographicInputType mode not recognised: ".concat(e.mode)],requiredFields:[]};let t=p[e.mode],n=[];for(let i of t)(0,u.s)(e[i])||n.push("".concat(e.mode," required field invalid: ").concat(i));return{validations:!(n.length>0)||n,requiredFields:t}},x={gbr:{key:"postcode",label:"Postcode (first half)",mode:"text",layout:"column",textPlaceholder:"What is the first half of your postcode?",textValidationRegex:"^[a-zA-Z]{1,2}[0-9][0-9a-zA-Z]?$",textCapitalisation:!0,textValidationMessage:"Please enter a valid UK postcode",groups:[],textMaxLength:15}},g={key:"gender",label:"Gender",mode:"select",layout:"column",groups:[{label:"Gender",choices:[{display:"Female",key:"f"},{display:"Male",key:"m"},{display:"Non-binary",key:"nb"},{display:"I would rather not say",key:"prefer-not-to-say"}]}]},m={key:"age",label:"Age range",mode:"select",layout:"grid",layoutProps:{columns:2},groups:[{label:"Age",choices:[{display:"14 - 17",key:"14-17"},{display:"18 - 25",key:"18-25"},{display:"26 - 35",key:"26-35"},{display:"36 - 45",key:"36-45"},{display:"46 - 55",key:"46-55"},{display:"56 - 65",key:"56-65"},{display:"66 - 75",key:"66-75"},{display:"76+",key:"76+"},{display:"I would rather not say",key:"prefer-not-to-say"}]}]},f={key:"ethnicity",label:"Ethnicity",mode:"select",layout:"row",groups:[{label:"Asian or Asian British",choices:[{display:"Indian",key:"Indian"},{display:"Pakistani",key:"Pakistani"},{display:"Bangladeshi",key:"Bangladeshi"},{display:"Chinese",key:"Chinese"},{display:"Any other Asian background",key:"Any other Asian background"}]},{label:"Black, Black British, Caribbean or African",choices:[{display:"Caribbean",key:"Caribbean"},{display:"African",key:"African"},{display:"Any other Black, Black British, or Caribbean background",key:"Any other Black, Black British, or Caribbean background"}]},{label:"Mixed or multiple ethnic groups",choices:[{display:"White and Black Caribbean",key:"White and Black Caribbean"},{display:"White and Black African",key:"White and Black African"},{display:"White and Asian",key:"White and Asian"},{display:"Any other Mixed or multiple ethnic background",key:"Any other Mixed or multiple ethnic background"}]},{label:"White",choices:[{display:"English, Welsh, Scottish, Northern Irish or British",key:"English, Welsh, Scottish, Northern Irish or British"},{display:"Irish",key:"Irish"},{display:"Gypsy or Irish Traveller",key:"Gypsy or Irish Traveller"},{display:"Roma",key:"Roma"},{display:"Any other White background",key:"Any other White background"}]},{label:"Other ethnic group",choices:[{display:"Arab",key:"Arab"},{display:"Any other ethnic group",key:"Any other ethnic group"}]},{label:"Unavailable",choices:[{display:"I would rather not say",key:"prefer-not-to-say"}]}]};var b=n(62652),v=n(73017),y=n(84073),w=n(80357),j=n(27855),A=n(74434);function k(e){var t;let n=(0,r.useContext)(y.yk),{answers:o}=(0,v.Ay)(e.qids.qid),[s,a]=(0,r.useState)((0,v.fV)(o,e.qids,null==(t=e.question)?void 0:t.pii)),[l,c]=(0,r.useState)(s),[u,p]=(0,r.useState)(n.role!==d.sW.Controller),[h,x]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{c(s)},[s]),(0,i.jsxs)(i.Fragment,{children:[e.question&&(0,i.jsx)(A.A,{content:e.question}),(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"row",gap:1,justifyContent:e.align},children:e.options.map((t,n)=>{var o;return(0,i.jsx)(j.A,{variant:(null!=(o=t.variant)?o:0===n)?"contained":"outlined",color:t.colour,onClick:()=>(t=>{if(!u)return;x(!0);let n={...l,jsonValue:{answers:[{key:t,booleanValue:!0}]}};e.onAnswer(n).then(e=>{if(e)a(e);else throw"No response from submission"}).catch(e=>{console.error(e)}).finally(()=>{x(!1)})})(t.key),disabled:!u||h,children:t.text},"ack-".concat(e.qids.qid,"-option-").concat(t.key))})})]})}var S=n(25789),C=n(66088),I=n(80317),D=n(90073),E=n(68307);function R(e){let t=e.layoutParams.length>0?parseInt(e.layoutParams[0]):6,n=(0,S.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(D.A,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,i.jsx)(D.A,{sx:{mb:4,mx:8},children:e.question&&(0,i.jsx)(A.A,{content:e.question})}),(0,i.jsx)(C.A,{container:!0,spacing:1,children:e.displayOptions.map((o,r)=>{let s=e.currentlySelectedKeys.find(e=>e===o.key);return(0,i.jsx)(C.A,{size:{xs:t},display:"flex",flexDirection:"column",alignContent:"stretch",children:(0,i.jsx)(j.A,{"aria-label":o.ariaLabel,variant:"contained",style:{display:"flex",flexDirection:"column",justifyContent:"center",border:"solid 4px",background:s?n.palette.optionButtonSelected.main:n.palette.optionButtonUnselected.main,borderColor:s?n.palette.optionButtonSelectedBorder.main:"transparent",color:"black"},onClick:()=>e.onSelectionClick(o.key),children:(0,i.jsx)(I.A,{variant:"submitButton",sx:{fontSize:o.fontSize,textWrap:"balance"},children:o.title})})},"answer-".concat(e.qid,"-").concat(o.key))})}),e.showSubmit&&(0,i.jsx)(D.A,{display:"flex",flexDirection:"row",justifyContent:"flex-end",sx:{mt:4},children:(0,i.jsx)(E.A,{busy:e.busy,inline:!1,enabled:e.enableSubmit,onSubmit:e.onSubmit})})]})})}function F(e){let t=(0,S.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(D.A,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,i.jsx)(D.A,{sx:{mb:4,mx:8},children:e.question&&(0,i.jsx)(A.A,{content:e.question})}),(0,i.jsx)(D.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",gap:1},children:e.displayOptions.map((n,o)=>{let r=e.currentlySelectedKeys.find(e=>e===n.key);return(0,i.jsx)(j.A,{"aria-label":n.ariaLabel,variant:"contained",style:{display:"flex",flexDirection:"column",justifyContent:"center",border:"solid 4px",background:r?t.palette.optionButtonSelected.main:t.palette.optionButtonUnselected.main,borderColor:r?t.palette.optionButtonSelectedBorder.main:"transparent",color:"black"},onClick:()=>e.onSelectionClick(n.key),children:(0,i.jsx)(I.A,{variant:"submitButton",sx:{fontSize:n.fontSize,textWrap:"balance"},children:n.title})},"answer-".concat(e.qid,"-").concat(n.key))})}),e.showSubmit&&(0,i.jsx)(D.A,{display:"flex",flexDirection:"row",justifyContent:"flex-end",sx:{mt:4},children:(0,i.jsx)(E.A,{busy:e.busy,inline:!1,enabled:e.enableSubmit,onSubmit:e.onSubmit})})]})})}function B(e){let t=(0,S.A)(),n=90-90/e.sourceOptions.filter(e=>!e.isAlt).length;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,i.jsx)(w.A,{sx:{mb:4,mx:8},children:e.question&&(0,i.jsx)(A.A,{content:e.question})}),(0,i.jsx)(w.A,{display:"flex",flexDirection:"row",justifyContent:"center",sx:{gap:1,width:"".concat(n,"%")},children:e.displayOptions.filter(e=>!e.isAlt).map((n,o)=>{let r=e.currentlySelectedKeys.find(e=>e===n.key);return(0,i.jsxs)(w.A,{"aria-label":n.ariaLabel,sx:{borderRadius:4,px:1,flexGrow:1,flexBasis:0},style:{minHeight:200,border:"solid 4px",background:r?t.palette.optionButtonSelected.main:t.palette.optionButtonUnselected.main,borderColor:r?t.palette.optionButtonSelectedBorder.main:"transparent",cursor:"pointer"},display:"flex",flexDirection:"column",justifyContent:"center",onClick:()=>e.onSelectionClick(n.key),children:[!!n.graphic&&(0,i.jsx)("img",{src:n.graphic,style:{alignSelf:"center",width:"40%"},alt:"".concat(n.title)}),(0,i.jsx)(I.A,{variant:"yesNoUnsureButton",sx:{fontSize:n.fontSize,textWrap:"balance"},children:n.title})]},"option-".concat(n.key,"-").concat(e.qid))})}),(0,i.jsx)(w.A,{display:"flex",flexDirection:"column",alignItems:"center",sx:{mt:2},children:e.sourceOptions.filter(e=>e.isAlt).map((n,o)=>{let r=e.currentlySelectedKeys.find(e=>e===n.key);return(0,i.jsx)(w.A,{sx:{p:2,borderRadius:4},style:{background:r?t.palette.optionButtonSelected.main:"transparent",border:"solid 4px transparent",borderColor:r?t.palette.optionButtonSelectedBorder.main:"transparent",cursor:"pointer"},onClick:()=>e.onSelectionClick(n.key),display:"flex",flexDirection:"column",justifyContent:"center",children:(0,i.jsx)(I.A,{variant:"yesNoUnsureButton",style:{borderBottom:"solid 1px black",textWrap:"balance"},children:n.title})},"option-".concat(n.key,"-").concat(e.qid))})}),e.showSubmit&&(0,i.jsx)(w.A,{display:"flex",flexDirection:"row",justifyContent:"center",sx:{mt:4},children:(0,i.jsx)(E.A,{busy:e.busy,inline:!1,enabled:e.enableSubmit,onSubmit:e.onSubmit})})]})})}function P(e){var t;let n=1===e.maxSelections,[o,s]=(0,r.useState)(e.shuffle?[...e.options].sort(()=>Math.random()-.5):e.options),{answers:a}=(0,v.Ay)(e.qids.qid),[l,c]=(0,r.useState)((0,v.fV)(a,e.qids,null==(t=e.question)?void 0:t.pii)),[u,p]=(0,r.useState)([]);(0,r.useEffect)(()=>{var t,n;let i;p((i=null!=(n=null==(t=l.jsonValue)?void 0:t.answers.filter(e=>!0===e.booleanValue).map(e=>e.key))?n:[],e.options.filter(e=>!!i.find(t=>t===e.key))))},[l]);let[h,x]=(0,r.useState)(!1),g=e.role===d.sW.Client,m=()=>u.length>=e.minSelections&&u.length<=e.maxSelections,f=async()=>{if(m())try{x(!0);var t={...l,jsonValue:{answers:u.map(t=>({key:t.key,booleanValue:!0,numericValue:1,index:e.options.findIndex(e=>e.key===t.key)}))}},n=await e.onAnswer(t);if(console.debug("Answer submitted ".concat(n?"ok":"error")),console.debug("Received answer response",n),n)c(n);else throw"No response received"}catch(e){console.error("Error submitting answer",e)}finally{x(!1)}},b=t=>{console.debug("ClosedChoiceInput: Option clicked, key: "+t);let i=e.options.find(e=>e.key===t);if(void 0!==i)if(u.find(e=>e.key===t))p(u.filter(e=>e.key!==t));else if(i.exclusive)p([i]);else if(u.length>=e.maxSelections){if(n){let e=u.find(e=>e.key!==t);p([...u.filter(t=>t!==e).filter(e=>!e.exclusive),i])}}else p([...u.filter(e=>!e.exclusive),i]);else console.warn("ClosedChoiceInput: Option key ".concat(t," not found."))},y=()=>({onSubmit:f,onSelectionClick:b,qid:e.qids.qid,question:e.question,sourceOptions:e.options,displayOptions:o,busy:h,showSubmit:g,enableSubmit:m(),minSelections:e.minSelections,maxSelections:e.maxSelections,currentlySelectedKeys:u.map(e=>e.key),layoutParams:e.layoutParams}),[j,A]=(0,r.useState)(y());return(0,r.useEffect)(()=>{A(y())},[h,u]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:(0,i.jsxs)(w.A,{sx:{flexGrow:1,display:"block"},children:["yes-no-unsure"===e.layout&&(0,i.jsx)(B,{...j}),"button-grid"===e.layout&&(0,i.jsx)(R,{...j}),"buttons-inline"===e.layout&&(0,i.jsx)(F,{...j})]})})})}var T=n(41477),q=n(13664),W=n(78095);function N(e){return(0,i.jsxs)(w.A,{sx:{width:"100%",height:"100%",className:"stretch",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,i.jsx)(w.A,{sx:{display:"block",flexGrow:1,overflowY:"auto",overflowX:"hidden"},children:e.children}),(e.startBar||e.endBar)&&(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",pt:1},children:[(0,i.jsx)(w.A,{children:e.startBar}),e.endBar&&(0,i.jsx)(w.A,{children:e.endBar})]})]})}var M=n(31240);function O(e){var t;let n=(0,r.useContext)(y.yk),{answers:o}=(0,v.Ay)(e.qids.qid),[s,a]=(0,r.useState)((0,v.fV)(o,e.qids,null==(t=e.question)?void 0:t.pii)),[l,c]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{var e,t,n;c(null!=(n=null==(t=s.jsonValue)||null==(e=t.answers.find(e=>"consent"===e.key))?void 0:e.booleanValue)&&n)},[s]),(0,r.useEffect)(()=>{p(l&&n.role===d.sW.Client)},[l]);let g=t=>{if(!u)return void console.warn("Only participants can submit answers");x(!0);let n={...s,jsonValue:{answers:[{key:"consent",booleanValue:l},{key:"consentText",stringValue:e.consentText}]}};e.onAnswer(n).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),null!==e)a(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{x(!1)})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(N,{startBar:(0,i.jsx)(()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(T.A,{control:(0,i.jsx)(q.A,{checked:l,onChange:(e,t)=>c(t)}),label:(0,i.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.25rem"},children:e.consentText})})}),{}),endBar:(0,i.jsx)(()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(M.A,{btnKey:"submit",btnText:(0,i.jsx)(b.A,{i18nKey:"button.submit"}),onClick:g,disabled:!u,busy:h})}),{}),children:[e.question&&(0,i.jsx)(A.A,{content:e.question,forceAlign:"left",sx:{fontWeight:"bold"}}),e.content.map((t,n)=>(0,i.jsx)(I.A,{variant:"consentBody",align:"left",dangerouslySetInnerHTML:{__html:(0,W.A)(t)}},"".concat(e.qids.qid,"-consent-body-").concat(n)))]})})}var L=n(86596),U=n(35057),V=n(50355),K=n(51404),_=n(21844),z=n(23405),H=n(34804);let G={objects:0,selectedKeys:[]};function Z(e){let t,n=e.demographic.groups.length>1,o=()=>{var t;return null!=(t=e.skipOption)?t:{key:"prefer-not-to-say",display:"I would rather not say"}},[s,a]=(0,r.useState)((t=e.currentSelection,(0,u.s)(t)&&t.key!==o().key?(e=>{let t=e.key.split(",").map(e=>e.trim()),n=t.filter(e=>e.length>0).length;return{objects:n,selectedKeys:n>0?t:[]}})(t):G)),[l,c]=(0,r.useState)(!1),[d,p]=(0,r.useState)([]),[h,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(s.selectedKeys.every(e=>(0,u.s)(e))),p(s.selectedKeys.map(e=>(0,u.s)(e)&&"empty"!==e))},[s]);let g=t=>{switch(t){case"add":s.objects<e.demographic.maxSelections&&a({...s,objects:s.objects+1,selectedKeys:[...s.selectedKeys,void 0]});break;case"remove":s.objects>e.demographic.minSelections&&a({...s,objects:s.objects-1,selectedKeys:s.selectedKeys.slice(0,s.objects-1)})}},m=(0,S.A)();return(0,i.jsx)(N,{endBar:(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",gap:1},children:[e.skipPermitted&&(0,i.jsx)(M.A,{btnKey:"skip",btnText:(0,i.jsx)(b.A,{i18nKey:"demographic.input.ratherNotSay"}),variant:"outlined",onClick:t=>{e.onSelection(o())}}),(0,i.jsx)(M.A,{btnKey:"submit",btnText:(0,i.jsx)(b.A,{i18nKey:"demographic.input.submit"}),variant:"contained",onClick:t=>{var n,i;l?e.onSelection((n=s,i=e.demographic,{key:n.selectedKeys.join(","),display:n.selectedKeys.map(e=>i.groups.map(t=>t.choices.filter(t=>t.key===e).map(e=>e.display)).flat()).flat().join(", ")})):x(!0)}})]}),children:(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[(0,i.jsx)(j.A,{color:"buttonStandard",variant:"text",onClick:()=>e.onBack(),children:(0,i.jsx)("img",{src:"/icons/arrow-left.svg",alt:"Back"})}),(0,i.jsx)(I.A,{variant:"slideSubHeading",align:"left",children:e.demographic.selectionQuestion})]}),(0,i.jsxs)(C.A,{container:!0,spacing:1,children:[(0,i.jsx)(C.A,{size:{xs:1},sx:{display:"flex",flexDirection:"row"},children:(0,i.jsx)(M.A,{btnKey:"remove",content:(0,i.jsx)(U.A,{}),btnText:"",variant:"outlined",onClick:e=>{g(e)},disabled:s.objects<=e.demographic.minSelections,sx:{flexGrow:.3}})}),(0,i.jsx)(C.A,{size:{xs:10},sx:{display:"flex",flexDirection:"row"},children:(0,i.jsx)(V.A,{label:e.demographic.selectionObject_plural,variant:"outlined",value:"".concat(s.objects),disabled:!0,autoComplete:"off",color:"buttonStandard",InputProps:{sx:{background:"white",fontSize:"2rem"}},sx:{flexGrow:1},InputLabelProps:{sx:{fontSize:"2rem","&.MuiOutlinedInput-notchedOutline":{fontSize:"2rem"}}}})}),(0,i.jsx)(C.A,{size:{xs:1},sx:{display:"flex",flexDirection:"row"},children:(0,i.jsx)(M.A,{btnKey:"add",content:(0,i.jsx)(L.A,{}),btnText:"",variant:"contained",onClick:e=>{g(e)},disabled:s.objects>=e.demographic.maxSelections,sx:{flexGrow:.5}})})]}),(0,i.jsx)(C.A,{container:!0,rowGap:1,children:Array.from(Array(s.objects).keys()).map(t=>{var o;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.A,{size:{xs:2},sx:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"center"},children:(0,i.jsxs)(I.A,{variant:"slideBody",align:"left",children:[e.demographic.selectionObject," ",t+1]})},"demographic-multi-select-for-".concat(e.demographic.key,"-").concat(t,"-label")),(0,i.jsx)(C.A,{size:{xs:10},children:(0,i.jsxs)(K.A,{value:null!=(o=s.selectedKeys[t])?o:"empty",fullWidth:!0,error:h&&!d[t],input:(0,i.jsx)(_.A,{sx:{fontSize:"2rem",color:"black",textAlign:"start"}}),onChange:(e,n)=>{var i;i=e.target.value,a({...s,selectedKeys:s.selectedKeys.map((e,n)=>n===t?"empty"!==i?i:void 0:e)})},children:[(0,i.jsxs)(z.A,{value:"empty",children:[(0,u.s)(e.demographic.selectionItemPrompt)&&(0,i.jsx)(i.Fragment,{children:e.demographic.selectionItemPrompt}),!(0,u.s)(e.demographic.selectionItemPrompt)&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(b.A,{i18nKey:"demographic.multi-select.default-selection-item-prompt"})})]},"demographic-multi-select-for-".concat(e.demographic.key,"-index-").concat(t,"-empty")),e.demographic.groups.map((o,r)=>[n?(0,i.jsx)(H.A,{sx:{p:1,borderBottom:"1px solid ".concat(m.palette.divider)},children:(0,i.jsx)(i.Fragment,{children:o.label})}):void 0,...o.choices.map((o,s)=>(0,i.jsx)(z.A,{value:o.key,sx:{p:1,pl:n?2:void 0},children:(0,i.jsx)(i.Fragment,{children:o.display})},"demographic-multi-select-for-".concat(e.demographic.key,"-index-").concat(t,"-group-").concat(r,"-choice-").concat(s)))])]})},"demographic-multi-select-for-".concat(e.demographic.key,"-").concat(t,"-select"))]})})})]})})}function J(e){let t=e.demographic.groups.length>1;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[(0,i.jsx)(j.A,{color:"buttonStandard",variant:"text",onClick:()=>e.onBack(),children:(0,i.jsx)("img",{src:"/icons/arrow-left.svg",alt:"Back"})}),(0,i.jsx)(I.A,{variant:"slideSubHeading",align:"left",children:e.demographic.label})]}),e.demographic.prompt&&(0,i.jsx)(I.A,{align:"left",component:"p",sx:{mt:"0 !important",textWrap:"balance"},variant:"demographicInputTypeHeading",children:e.demographic.prompt}),(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",gap:4,mb:4},children:e.demographic.groups.map(n=>(0,i.jsxs)(w.A,{display:"flex",flexDirection:"column",alignContent:"start",children:[t&&(0,i.jsx)(I.A,{variant:"demographicGroupHeading",align:"left",sx:{mb:.8},children:n.label}),("row"===e.layout||"column"===e.layout)&&(0,i.jsx)(w.A,{display:"flex",flexDirection:e.layout,gap:1,flexWrap:"row"===e.layout?"wrap":void 0,alignItems:"column"===e.layout?"start":void 0,children:n.choices.map(t=>{var o;return(0,i.jsx)(j.A,{variant:"contained",color:(null==(o=e.currentSelection)?void 0:o.key)===t.key?"buttonStandard":"buttonQuiet",onClick:()=>{e.onSelection(t)},children:(0,i.jsx)(I.A,{variant:"submitButton",children:t.display})},"".concat(e.demographic.label,"-section-").concat(n.label,"-value-").concat(t.key))})}),"grid"===e.layout&&(0,i.jsx)(C.A,{container:!0,sx:{width:e.layoutProps.columns<3?"66%":"100%"},rowGap:1,children:n.choices.map(t=>{var o;return(0,i.jsx)(C.A,{size:{xs:12/e.layoutProps.columns},sx:{px:1},children:(0,i.jsx)(j.A,{variant:"contained",fullWidth:!0,color:(null==(o=e.currentSelection)?void 0:o.key)===t.key?"buttonStandard":"buttonQuiet",onClick:()=>{e.onSelection(t)},children:(0,i.jsx)(I.A,{variant:"submitButton",sx:{py:1},children:t.display})})},"".concat(e.demographic.label,"-section-").concat(n.label,"-value-").concat(t.key))})})]},"".concat(e.demographic.label,"-section-").concat(n.label)))})]})}var Q=n(24274);function Y(e){var t,n,o;let{t:s}=(0,Q.Bd)(),a=()=>{var t;return null!=(t=e.skipOption)?t:{key:"prefer-not-to-say",display:s("demographic.input.ratherNotSay")}},[l,c]=(0,r.useState)((null==(t=e.currentSelection)?void 0:t.key)!==a().key&&null!=(o=null==(n=e.currentSelection)?void 0:n.display)?o:""),[d,u]=(0,r.useState)(""),[p,h]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!0),[m,f]=(0,r.useState)(!1),v=t=>{var n,i;return(f(!0),e.demographic.textMaxLength&&t.length>e.demographic.textMaxLength)?(u(null!=(n=e.demographic.textValidationMessage)?n:"Maximum length: ".concat(e.demographic.textMaxLength," characters")),h(!0),g(!1),!1):e.demographic.textValidationRegex&&!new RegExp(e.demographic.textValidationRegex).test(t)?(c(t),u(null!=(i=e.demographic.textValidationMessage)?i:"Please enter a valid value for ".concat(e.demographic.label,".")),h(!0),g(!1),!1):(c(t),u(""),h(!1),g(!0),!0)};return(0,r.useEffect)(()=>{m&&g(!p)},[m,p]),(0,i.jsx)(N,{endBar:(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",gap:1},children:[e.skipPermitted&&(0,i.jsx)(M.A,{btnKey:"skip",btnText:(0,i.jsx)(b.A,{i18nKey:"demographic.input.ratherNotSay"}),variant:"outlined",onClick:t=>{e.onSelection(a())}}),(0,i.jsx)(M.A,{btnKey:"submit",btnText:(0,i.jsx)(b.A,{i18nKey:"demographic.input.submit"}),variant:"contained",disabled:!x,onClick:t=>{v(l)&&e.onSelection({key:l,display:l})}})]}),children:(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",gap:1},children:[(0,i.jsx)(j.A,{color:"buttonStandard",variant:"text",onClick:()=>e.onBack(),children:(0,i.jsx)("img",{src:"/icons/arrow-left.svg",alt:"Back"})}),(0,i.jsx)(I.A,{variant:"slideSubHeading",align:"left",children:e.demographic.label})]}),(0,i.jsx)(V.A,{label:e.demographic.textPlaceholder,variant:"outlined",defaultValue:l,onChange:e=>{let t=e.target.value.trim();m?v(t):c(t)},helperText:d,error:p,autoComplete:"off",color:"buttonStandard",inputProps:{style:{textTransform:e.demographic.textCapitalisation?"uppercase":void 0}},InputProps:{sx:{background:"white",fontSize:"2rem"}},InputLabelProps:{sx:{fontSize:"2rem","&.MuiOutlinedInput-notchedOutline":{fontSize:"2rem"}}}})]})})}function X(e){var t,n,o,s;let l,{answers:c}=(0,v.Ay)(e.qids.qid),[p,h]=(0,r.useState)((0,v.fV)(c,e.qids,null==(t=e.question)?void 0:t.pii)),[y,k]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),[D,E]=(0,r.useState)((l=[],(null==(n=e.showGender)||n)&&l.push(g),(null==(o=e.showAge)||o)&&l.push(m),(null==(s=e.showEthnicity)||s)&&l.push(f),void 0!==e.showPostcode&&l.push(x[e.showPostcode]),[...l,...e.customDemographics])),[R,F]=(0,r.useState)(),[B,P]=(0,r.useState)({});(0,r.useEffect)(()=>{let e={};(null==p?void 0:p.jsonValue)&&p.jsonValue.answers.forEach(t=>{e[t.key]={key:t.optionKey,display:t.stringValue}}),P(e)},[p]),(0,r.useEffect)(()=>{let t=a().every(D,e=>B.hasOwnProperty(e.key));C(e.role===d.sW.Client&&t)},[B]);let T=async()=>{if(e.role!==d.sW.Client)console.warn("Only participants can submit answers");else{let t={...p,jsonValue:{answers:Object.entries(B).map(e=>({key:e[0],optionKey:e[1].key,stringValue:e[1].display}))}};k(!0),e.onAnswer(t).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)h(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{k(!1)})}},q=!1===e.opaqueInputBox?void 0:{background:"white"},W=e=>{var t;return(0,i.jsx)(j.A,{color:"buttonStandard",variant:"outlined",sx:{alignSelf:"stretch",py:0,...e.inputBoxSx},onClick:()=>e.onClick(),children:(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",flexGrow:1,justifyContent:"space-between"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:0},children:[void 0!==e.display&&(0,i.jsx)(I.A,{variant:"selectTiny",children:e.label}),(0,i.jsx)(I.A,{variant:"selectLarge",component:"div",children:null!=(t=e.display)?t:e.label})]}),(0,i.jsx)("img",{src:"/icons/select-down.svg"})]})})};return(0,i.jsxs)(i.Fragment,{children:[!(0,u.s)(R)&&(0,i.jsx)(N,{endBar:(0,i.jsx)(M.A,{btnKey:"submit",btnText:(0,i.jsx)(b.A,{i18nKey:"button.submit"}),onClick:()=>{T()},disabled:!S,busy:y}),children:(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsx)(w.A,{sx:{mb:4,mx:8},children:e.question&&(0,i.jsx)(A.A,{content:e.question})}),D.map(e=>(0,i.jsx)(W,{label:e.label,display:B.hasOwnProperty(e.key)?B[e.key].display:void 0,onClick:()=>{F(e)},inputBoxSx:q},"overview-demographic-".concat(e.key)))]})}),(0,u.s)(R)&&(0,i.jsxs)(i.Fragment,{children:["select"===R.mode&&(0,i.jsx)(J,{demographic:R,currentSelection:B[R.key],onBack:()=>{F(void 0)},onSelection:e=>{P({...B,[R.key]:e}),F(void 0)},layout:R.layout,layoutProps:R.layoutProps}),"text"===R.mode&&(0,i.jsx)(Y,{demographic:R,skipPermitted:!0,currentSelection:B[R.key],onBack:()=>{F(void 0)},onSelection:e=>{P({...B,[R.key]:e}),F(void 0)}}),"multi-select"===R.mode&&(0,i.jsx)(Z,{demographic:R,skipPermitted:!0,currentSelection:B[R.key],onBack:()=>{F(void 0)},onSelection:e=>{P({...B,[R.key]:e}),F(void 0)}})]})]})}var $=n(69999),ee=function(e){return e[e.Input=0]="Input",e[e.Completion=1]="Completion",e}(ee||{});function et(e){let{answers:t}=(0,v.Ay)(e.qids.qid),n=()=>(0,v._i)(t,e.qids),[o,s]=(0,r.useState)(n()),[a,l]=(0,r.useState)(+!!(0,v.Qy)(o));return(0,r.useEffect)(()=>{s(n())},[t]),(0,r.useEffect)(()=>{l(+!!(0,v.Qy)(o))},[o]),(0,r.useEffect)(()=>{$.A.emit({type:$.m.Request_SlideRefresh})},[a]),(0,i.jsxs)(i.Fragment,{children:[0===a&&e.input,1===a&&e.completion]})}var en=n(91028),ei=n(57915);function eo(e){let{allAnswers:t}=(0,v.Ay)(),n=()=>{for(let n of e.qids)if(!(0,v.Qy)((0,v._i)(t[n.qid],n)))return e.qids.indexOf(n)},[o,s]=(0,r.useState)(n());(0,r.useEffect)(()=>{let e=n();o!==e&&s(e)},[t]);let l=(0,ei.A)(),c=[.2,.25],[d]=(0,en.Q)({duration:500});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{ref:d,className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",p:2,gap:2,boxSizing:"border-box"},children:[void 0!==o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.A,{content:e.question}),(0,i.jsx)(w.A,{sx:{flexGrow:1,boxSizing:"border-box",overflowY:"auto",overflowX:"hidden",display:"block"},children:e.inputs[o]},"input-sequence-element-".concat(e.qids[o].qid))]}),void 0===o&&(0,i.jsx)(w.A,{sx:{flexGrow:1,display:"block"},children:e.completion}),void 0!==o&&e.showProgress&&(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:a().range(0,e.inputs.length).map((t,n)=>(0,i.jsx)(w.A,{sx:{background:t===o?l.palette.progressBlipSelected.main:l.palette.progressBlipUnselected.main,width:"".concat(c[+(t===o)],"em"),height:"".concat(c[+(t===o)],"em"),borderRadius:"".concat(c[+(t===o)]/2,"em")}},"sequence-blip-".concat(t,"-").concat(e.qids[t].qid)))})]})})}var er=n(39846);function es(e){let{answers:t}=(0,v.Ay)(e.qids.qid),n=()=>{var n;return(0,v.fV)(t,e.qids,null==(n=e.question)?void 0:n.pii)},[o,s]=(0,r.useState)(n()),[a,l]=(0,r.useState)(n()),[c,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(e.role===d.sW.Client),[x,g]=(0,r.useState)({});(0,r.useEffect)(()=>{let t={...x};e.options.forEach(n=>{var i,r,s;t[n.key]=null!=(s=null==(r=o.jsonValue)||null==(i=r.answers.find(e=>e.key===n.key))?void 0:i.numericValue)?s:Math.floor((e.min+e.max)/2)}),g(t),l({...o,jsonValue:{answers:e.options.map(n=>{var i,o;return{key:n.key,numericValue:null!=(i=t[n.key])?i:Math.floor((e.min+e.max)/2),description:n.description,index:null!=(o=t[n.key])?o:Math.floor((e.min+e.max)/2)}})}})},[o]);let m=async()=>{e.role!==d.sW.Controller&&(u(!0),e.onAnswer(a).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)s(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{u(!1)}))},f=e.max-e.min,y=f+1,j=Array.from(Array(y).keys()),k=-1!==e.labels.findIndex(t=>t.at===e.max),S=+(0!==e.min);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1,px:e.paddingX||8},children:[(0,i.jsxs)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",gap:1,overflowX:"hidden",overflowY:"auto",justifyContent:"center",px:0},children:[(0,i.jsx)(w.A,{sx:{mb:4},children:e.question&&(0,i.jsx)(A.A,{content:e.question})}),(0,i.jsxs)(C.A,{container:!0,rowSpacing:e.rowSpacing,sx:{alignItems:"center"},children:[(0,i.jsx)(C.A,{size:{xs:4}}),(0,i.jsx)(C.A,{alignSelf:"flex-end",className:"all-labels-container",size:{xs:!0===k?7:8},sx:{display:"grid",gap:"".concat(16,"px"),gridTemplateColumns:"repeat(".concat(f,", 1fr)")},children:j.map((t,n)=>{if(n+1===y)return null;let o=e.labels.findIndex(e=>e.at===t+S);return -1!==o?(0,i.jsx)(w.A,{className:"label-grid-cell",sx:{alignItems:"end",display:"flex",flexDirection:"row"},children:(0,i.jsx)(I.A,{variant:"body1",component:"div",sx:{fontWeight:"bold",textAlign:"center",transform:"translate(calc(-50% - ".concat(8,"px), 0)"),width:"fit-content"},children:e.labels[o].text})},"".concat(e.qids.qid,"-label-").concat(n,"-at-").concat(e.labels[o].at)):(0,i.jsx)(w.A,{className:"empty-label-placeholder"},"step-".concat(t,"-blank-label"))})}),!0===k&&(0,i.jsx)(C.A,{alignSelf:"flex-end",size:{xs:1},children:(0,i.jsx)(I.A,{variant:"body1",component:"div",sx:{fontWeight:"bold",transform:"translate(-50%, 0)",width:"fit-content"},children:e.labels[e.labels.length-1].text})}),(0,i.jsx)(C.A,{sx:{height:"4px"},size:{xs:12}}),e.options.map((t,n)=>{let o;return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsxs)(C.A,{size:{xs:4},children:[(0,i.jsx)(I.A,{variant:"body1",align:"left",component:"div",sx:{pr:6},children:t.title}),e.showDescriptions&&!1]}),(0,i.jsx)(C.A,{size:{xs:!0===k?7:8},children:(0,i.jsx)(er.A,{onCommit:n=>{var i,o,r,s;let c;i=t.key,(c=null!=(r=a.jsonValue)?r:{answers:[]}).answers=c.answers.filter(e=>e.key!==i),c.answers.push({key:i,numericValue:n,description:null!=(s=null==(o=e.options.find(e=>e.key===i))?void 0:o.description)?s:"".concat(n),index:n}),l({...a,jsonValue:c})},color:"secondary",sliderDefault:(o=t.key,x.hasOwnProperty(o)?x[o]:Math.floor((e.min+e.max)/2)),marks:!0,min:e.min,max:e.max,step:1,sliderMode:"multi",sx:{mt:1}})}),!0===k&&(0,i.jsx)(C.A,{size:{xs:1}})]},"".concat(e.qids.qid,"-option-").concat(t.key))})]})]}),e.role===d.sW.Client&&(0,i.jsx)(w.A,{children:(0,i.jsx)(E.A,{onSubmit:m,text:(0,i.jsx)(b.A,{i18nKey:"button.submit"}),busy:c,enabled:p,inline:!1,alignment:"right"})})]})})}var ea=n(67230);function el(e){let t=(0,r.useContext)(y.yk),{answers:n}=(0,v.Ay)(e.qids.qid),o=()=>{var t;return(0,v.fV)(n,e.qids,null==(t=e.question)?void 0:t.pii)},[s,l]=(0,r.useState)(o()),[c,u]=(0,r.useState)(o()),[p,h]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!1),[m,f]=(0,r.useState)(e.points),[j,k]=(0,r.useState)(e.options.map(e=>({min:0,max:e.max}))),[C,D]=(0,r.useState)(e.options.map(()=>0));(0,r.useEffect)(()=>{let n=e.points-a().sum(C);f(n);for(let t=0;t<e.options.length;t++)k(j.map((e,t)=>({min:0,max:C[t]+n})));let i={answers:[]};for(let t=0;t<e.options.length;t++)i.answers.push({key:e.options[t].key,description:e.options[t].title,numericValue:C[t]});u({...c,jsonValue:i}),g(0===n&&t.role!==d.sW.Controller)},[C,e.options,e.points,t.role]);let R=async()=>{h(!0),e.onAnswer(c).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)l(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{h(!1)})},F=(0,S.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"row",gap:1,mb:2},children:e.question&&(0,i.jsx)(A.A,{content:e.question})}),(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"column",gap:1,flexGrow:1,overflowX:"hidden",overflowY:"auto",px:1},children:e.options.map((e,n)=>{let o,r;return(0,i.jsxs)(w.A,{sx:{background:"#f0f0f0",p:2,borderRadius:4,display:"flex",flexDirection:"row",alignItems:"stretch",gap:2},children:[e.graphic&&(0,i.jsx)(w.A,{sx:{width:"20%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url(".concat(e.graphic,")"),borderRadius:2}}),(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"column",gap:1,width:"80%"},children:[(0,i.jsx)(I.A,{variant:"pointsAllocationCategoryTitle",align:"left",children:e.title}),(0,i.jsx)(I.A,{variant:"pointsAllocationCategoryDescription",align:"left",children:e.description}),(0,i.jsx)(w.A,{sx:{px:2},children:(0,i.jsx)(er.A,{onCommit:e=>{D(C.map((t,i)=>i===n?e:t))},color:"secondary",sliderDefault:C[n],marks:(o=e.min,r=e.max,a().range(o,r+1,1).map((e,t)=>({value:e,label:"".concat(e)}))),slots:{markLabel:ea.A},min:e.min,max:e.max,step:1,sliderMode:"multi",acceptableRange:{min:j[n].min,max:j[n].max},disabled:t.role===d.sW.Controller})})]})]},"points-allocation-option-".concat(n))})}),(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"end",gap:1,mx:1},children:[(0,i.jsx)(I.A,{variant:"pointsAllocationCategoryTitle",align:"left",color:F.palette.secondary.main,children:(0,i.jsx)(b.A,{i18nKey:"poll.pointsAllocation.remaining",options:{numberOfPoints:m}})}),(0,i.jsx)(E.A,{enabled:x,inline:!0,busy:p,onSubmit:()=>R()})]})]})})}var ec=n(48266),ed=n(91703);let eu=(e,t,n)=>{if(void 0===e.jsonValue||0===e.jsonValue.answers.length)return ep(t,n);let i=[];return e.jsonValue.answers.forEach(e=>{let n=t.find(t=>t.key===e.key);n&&(i[e.index]=n)}),i},ep=(e,t)=>t?[...e].sort(()=>Math.random()-.5):e.sort((e,t)=>e.startingIndex-t.startingIndex);function eh(e){var t;let n=(0,r.useContext)(y.yk),{answers:o}=(0,v.Ay)(e.qids.qid),[s,a]=(0,r.useState)((0,v.fV)(o,e.qids,null==(t=e.question)?void 0:t.pii)),[l,c]=(0,r.useState)(n.role!==d.sW.Controller),[u,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(ep(e.options,e.shuffle));(0,r.useEffect)(()=>{x(eu(s,e.options,e.shuffle))},[s,e.options,e.shuffle]);let g=async()=>{if(n.role===d.sW.Client&&l){let t;p(!0);let n=(t={answers:[]},h.forEach((e,n)=>{t.answers.push({key:e.key,index:n,numericValue:n,description:e.title})}),{...s,jsonValue:t});e.onAnswer(n).then(t=>{if(console.debug("Answer submitted ".concat(t?"ok":"error")),console.debug("Received answer response",t),null!==t)x(eu(t,e.options,e.shuffle));else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{p(!1)})}else console.warn("Only participants can submit answers")},m=(0,S.A)(),[f]=(0,en.Q)({duration:500});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(N,{endBar:(0,i.jsx)(M.A,{btnKey:"submit",onClick:e=>{g()},disabled:!l,busy:u,variant:"contained",color:"buttonStandard",btnText:(0,i.jsx)(b.A,{i18nKey:"button.submit"})}),children:[e.question&&(0,i.jsx)(w.A,{sx:{mb:2},children:(0,i.jsx)(A.A,{content:e.question})}),(0,i.jsx)(w.A,{ref:f,sx:{display:"flex",flexDirection:"column"},children:h.map((t,n)=>(0,i.jsxs)(w.A,{sx:{border:"solid 1px black",borderRadius:2,p:1.5,display:"flex",flexDirection:"row",gap:1,alignContent:"center",alignItems:"center",background:"white",mb:1,boxSizing:"border-box"},children:[(0,i.jsxs)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",pr:2},children:[t.title&&(0,i.jsx)(I.A,{variant:"rankedListItemTitle",align:"left",children:t.title}),t.description&&(0,i.jsx)(I.A,{variant:"rankedListItemDescription",align:"left",children:t.description})]}),(0,i.jsx)(w.A,{onClick:()=>{let e=h.findIndex(e=>e.key===t.key);if(e>0){let n=[...h];n.splice(e,1),n.splice(e-1,0,t),x(n)}},sx:{display:"flex",flexDirection:"column",background:m.palette.updinkBackground.main,color:m.palette.updinkText.main,p:.5,borderRadius:2,cursor:0===n?void 0:"pointer",opacity:+(0!==n)},children:(0,i.jsx)(ed.A,{sx:{fontSize:"2rem"}})}),(0,i.jsx)(w.A,{onClick:()=>{let e=h.findIndex(e=>e.key===t.key);if(e<h.length-1){let n=[...h];n.splice(e,1),n.splice(e+1,0,t),x(n)}},sx:{display:"flex",flexDirection:"column",background:m.palette.downdinkBackground.main,color:m.palette.downdinkText.main,p:.5,borderRadius:2,cursor:n===h.length-1?void 0:"pointer",opacity:+(n!==h.length-1)},children:(0,i.jsx)(ec.A,{sx:{fontSize:"2rem"}})})]},"ranked-list-".concat(e.qids.qid,"-option-").concat(t.key)))})]})})}var ex=n(91396),eg=n(63608),em=n(86004),ef=n(61451);function eb(e){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"column",gap:2,...e.sx},children:e.children})})}function ev(e){let{sx:t,children:n}=e;return(0,i.jsx)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",...t},children:(0,i.jsx)(w.A,{alignSelf:"center",display:"inline-block",textAlign:"center",children:n})})}function ey(e){let{sx:t,children:n}=e;return(0,i.jsx)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",overflowY:"auto",overflowX:"hidden",display:"block",...t},children:n})}var ew=n(46429);function ej(e){var t;let{ref:n,inView:o}=(0,ew.Wx)({threshold:0}),s=(0,r.useRef)(null),a=null==(t=e.shadow)||t;(0,r.useEffect)(()=>{if(o)(0,u.s)(s.current)&&(s.current.complete?l():s.current.addEventListener("load",l));else{var e;null==(e=s.current)||e.removeEventListener("load",l)}},[o,s]);let l=(0,r.useCallback)(()=>{$.A.emit({type:$.m.Request_SlideRefresh})},[e.src]);return(0,i.jsx)(D.A,{ref:n,sx:{width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center"},children:(0,i.jsx)("img",{ref:s,className:a?"shadow":"",alt:e.alt,style:{objectFit:"contain",marginLeft:"auto",marginRight:"auto",borderRadius:"0.5rem",...e.style},src:e.src})})}function eA(e){let[t,n]=(0,r.useState)(e.sideSx),[o,s]=(0,r.useState)(e.mainSx);return(0,r.useEffect)(()=>{void 0!==e.sideBackgroundImage&&n({backgroundImage:"url(".concat(e.sideBackgroundImage,")"),...e.sideSx}),void 0!==e.mainBackgroundImage&&s({backgroundImage:"url(".concat(e.mainBackgroundImage,")"),...e.mainSx})},[e.sideBackgroundImage,e.mainBackgroundImage,e.sideSx,e.mainSx]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},children:[(0,i.jsx)(w.A,{sx:{width:"35%",display:"block",...e.sideSx},children:e.side}),(0,i.jsx)(w.A,{sx:{px:2,alignSelf:"stretch",display:"block",overflowY:"auto",width:"60%",...e.mainSx},children:e.main})]})})}function ek(e){let t={backgroundImage:"url('".concat(e.src,"')")};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"block",...t,...e.sx},children:e.children})})}function eS(e){let t={...{textWrap:"balance"},...e.sx,color:e.color};return(0,i.jsx)(I.A,{variant:e.variant,component:"div",sx:t,align:e.align,children:e.children})}function eC(e){let t=(0,S.A)(),n=void 0===e.chartBackground||e.chartBackground;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1,overflowY:"hidden"},children:[e.title&&(0,i.jsx)(eS,{color:e.color,variant:"summaryTitle",sx:{p:0,px:1,textWrap:"balance"},align:"left",children:e.title}),e.prompt&&(0,i.jsx)(eS,{color:e.color,variant:"summaryPrompt",sx:{p:0,px:1,textWrap:"balance"},align:"left",children:e.prompt}),(0,i.jsx)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"row",gap:1,alignItems:"stretch",overflowY:"hidden"},children:e.children.map((e,o)=>(0,i.jsx)(w.A,{sx:{background:n?t.palette.summaryChartBackground.main:void 0,borderRadius:n?4:void 0,flexGrow:1,flexBasis:0,p:2,display:"block",overflow:"auto"},children:e},"summary-slide-child-".concat(o)))})]})})}function eI(e){return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("img",{src:e.src,style:e.style,alt:e.alt})})}function eD(e){var t;let{content:n,sx:o}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",...o},children:[(0,i.jsx)(I.A,{variant:"slideHeading",children:null!=(t=n.message)?t:"Thanks!"}),n.factoid&&(0,i.jsx)(I.A,{variant:"slideBody",sx:{mt:8},children:n.factoid})]})})}var eE=n(67370);let eR=e=>{let t=parseInt(e.replace("#",""),16);return[t>>16&255,t>>8&255,255&t]},eF=(e,t,n,i)=>{let o=eR(n),r=eR(i),s=Math.round(o[0]+(r[0]-o[0])*e/t),a=Math.round(o[1]+(r[1]-o[1])*e/t),l=Math.round(o[2]+(r[2]-o[2])*e/t);return"rgb(".concat(s,",").concat(a,",").concat(l,")")};function eB(e){let{answers:t}=(0,v.Ay)(e.qids.qid),[n,o]=(0,r.useState)([]),[s,a]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),d=(0,S.A)();return(0,r.useEffect)(()=>{o(null!=t?t:[])},[t]),(0,r.useEffect)(()=>{var t;let i;a((t=e.options,Object.entries((i={},n.forEach(e=>{var t;null==(t=e.jsonValue)||t.answers.forEach(e=>{var t;let n=e.key,o=null!=(t=e.numericValue)?t:0;i.hasOwnProperty(n)||(i[n]=0),i[n]+=o})}),i)).map(e=>{var n,i,o;return{key:e[0],title:null!=(o=null==(n=t.find(t=>t.key===e[0]))?void 0:n.title)?o:"",description:null==(i=t.find(t=>t.key===e[0]))?void 0:i.description,value:e[1]}})))},[n,e.options]),(0,r.useEffect)(()=>{var t;let n=d.palette.secondary.main,i=null!=(t=e.mode)?t:"normal",o=s.sort((e,t)=>e.value-t.value);"normal"===i&&(o=o.reverse()),c([...o.map((t,i)=>{var o,r;return{backgroundColor:eF(i,s.length,null!=(o=e.startColour)?o:n,null!=(r=e.endColour)?r:"#FFFFFF"),textColor:"#000000",option:t}})])},[s,e.startColour,e.endColour,d.palette.secondary.main,e.mode]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",flexDirection:"column",display:"flex",gap:1},children:[e.question&&(0,i.jsx)(A.A,{content:e.question}),(0,i.jsx)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",gap:1,justifyContent:"start"},children:l.map((t,n)=>(0,i.jsx)(w.A,{sx:{backgroundColor:t.backgroundColor,color:t.textColor,borderRadius:2,display:"flex",flexDirection:"column",p:2},children:(0,i.jsxs)(I.A,{variant:"orderedListItemTitle",align:"left",children:[n+1,". ",t.option.title]})},"ordered-display-".concat(e.qids.qid,"-option-").concat(t.option.key,"-").concat(n)))})]})})}function eP(e){let t=(0,S.A)(),n=1===e.headings.filter(e=>e.expanded).length;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e.question&&(0,i.jsx)(A.A,{content:e.question,forceAlign:"left"}),e.headings.map((o,r)=>(0,i.jsxs)(w.A,{sx:{flexGrow:o.expanded?1:void 0,flexBasis:o.expanded?0:void 0,display:"flex",flexDirection:"row",gap:2,p:2,alignItems:"stretch",backgroundColor:t.palette.summaryChartBackground.main,borderRadius:4},children:[o.expanded&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.A,{sx:{display:"inline-block",borderRadius:2,flexGrow:0,flexShrink:0,flexBasis:n?"50%":"20%",backgroundImage:"url(".concat(o.graphic,")"),backgroundSize:"cover",backgroundPosition:"center",mr:2}}),(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"column",gap:2,alignSelf:"center"},children:[(0,i.jsx)(I.A,{variant:"sectionHeadingTitle",align:"left",children:o.title}),o.description&&(0,i.jsx)(I.A,{variant:"sectionHeadingDescription",align:"left",children:o.description})]})]}),!o.expanded&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(I.A,{variant:"sectionHeadingTitleQuiet",align:"left",children:o.title})})]},"section-heading-".concat(e.uid,"-").concat(r)))]})})}function eT(e){let{answers:t}=(0,v.Ay)(e.qids.qid),n=(0,S.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",overflowX:"hidden",overflowY:"auto"},children:[e.question&&(0,i.jsx)(A.A,{content:e.question}),(0,i.jsx)(w.A,{display:"flex",flexDirection:"column",alignItems:"center",children:t.map((t,o)=>{var r;return(0,i.jsx)(i.Fragment,{children:null==(r=t.jsonValue)?void 0:r.answers.map(t=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{sx:{mb:4,px:2,mx:8},className:"shadow",style:{background:"white",border:"solid 2px",borderColor:o%2==0?n.palette.primary.main:n.palette.secondary.main,borderRadius:12,transform:"rotate(".concat(o%2==0?1.5:-1.5,"deg)")},children:(0,i.jsx)(I.A,{variant:"slideBody",children:t.stringValue})},"speech-bubble-".concat(e.qids.qid,"-").concat(t.key))}))})})})]})})}var eq=n(74084);function eW(e){let{answers:t}=(0,v.Ay)(e.qids.qid),[n,o]=(0,r.useState)([]),[s,a]=(0,r.useState)([]);(0,r.useEffect)(()=>{o(((e,t)=>{if(!e||0===e.length)return[];let n=new Map;return e.forEach(e=>{var t;null==(t=e.jsonValue)||t.answers.forEach(e=>{var t;let i=e.key,o=null!=(t=e.numericValue)?t:0;n.has(i)||n.set(i,0),n.set(i,n.get(i)+o)})}),Array.from(n.entries()).sort((e,t)=>e[1]-t[1]).reverse().slice(0,t).map(e=>({key:e[0],count:e[1]}))})(t,e.displayCount))},[t,e.displayCount]),(0,r.useEffect)(()=>{var t;a((t=e.options,n&&0!==n.length?t&&0!==t.length?n.map(e=>{let i=t.find(t=>t.key===e.key);return i?{key:e.key,title:i.title,description:i.description,graphic:i.graphic,count:e.count}:void console.warn("No description found for option: ".concat(e.key),n,t)}).filter(e=>!!e).map(e=>e):(console.warn("No described options available"),[]):[]))},[n,e.options]);let l=(0,S.A)();return(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[e.question&&(0,i.jsx)(A.A,{content:e.question}),(0,i.jsx)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"row",alignItems:"stretch",justifyContent:"stretch",gap:1},children:s.map((t,n)=>(0,i.jsxs)(w.A,{sx:{flexGrow:1,flexBasis:0,p:2,borderRadius:2,background:l.palette.summaryChartBackground.main,display:"flex",flexDirection:"column",gap:1,mt:2*n},children:[(0,i.jsx)(I.A,{variant:"topOptionsOptionRank",align:"left",children:(0,eq.V)(n+1)}),(0,i.jsxs)(I.A,{variant:"topOptionsOptionPoints",align:"left",children:["Total points: ",t.count]}),(0,i.jsx)(w.A,{sx:{width:"10%",height:0,border:"4px solid black",borderRadius:"4px",mt:1,mb:3}}),(0,i.jsx)(I.A,{variant:"topOptionsOptionTitle",align:"left",children:t.title}),void 0!==t.graphic&&(0,i.jsx)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"end"},children:(0,i.jsx)(w.A,{sx:{maxHeight:"20vh",height:"20vh",backgroundImage:"url(".concat(t.graphic,")"),backgroundSize:"cover",backgroundPosition:"center",borderRadius:2}})},"".concat(e.qids.qid,"-top-option-").concat(n,"-graphic-").concat(t.key))]},"".concat(e.qids.qid,"-top-option-").concat(n,"-description-").concat(t.key)))})]})}function eN(e){let t=(0,S.A)();return(0,i.jsxs)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsxs)(w.A,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,i.jsx)("img",{src:"/icons/updown/qmark.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,i.jsx)(eS,{variant:"upDownCategory",children:e.divisiveDescription})]}),e.mostDivisive.map((e,n)=>(0,i.jsx)(eS,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDivided.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-divisive-".concat(n,"-qid-").concat(e.qid,"-entry")))]}),(0,i.jsxs)(w.A,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,i.jsx)("img",{src:"/icons/updown/check.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,i.jsx)(eS,{variant:"upDownCategory",children:e.supportedDescription})]}),e.mostlySupported.map((e,n)=>(0,i.jsx)(eS,{variant:"upDownQuestion",sx:{background:t.palette.backgroundAgree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-supported-".concat(n,"-qid-").concat(e.qid,"-entry")))]}),(0,i.jsxs)(w.A,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,i.jsx)("img",{src:"/icons/updown/cross.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,i.jsx)(eS,{variant:"upDownCategory",children:e.opposedDescription})]}),e.mostlyOpposed.map((e,n)=>(0,i.jsx)(eS,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDisagree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-disagreed-".concat(n,"-qid-").concat(e.qid,"-entry")))]})]})}function eM(e){let t=(0,S.A)(),n=t.palette.secondary.main;return(0,i.jsx)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:(0,i.jsx)(w.A,{sx:{background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",py:2},children:e.ordered.map((t,o)=>(0,i.jsxs)(eS,{variant:"orderedListItemTitle",sx:{background:eF(o,e.ordered.length,n,"#FFFFFF"),borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:[o+1,". ",t.assertion," ",0==o&&"(highest)",o==e.ordered.length-1&&"(lowest)"]},"summary-updown-ordered-".concat(o,"-qid-").concat(t.qid,"-entry")))})})}function eO(e){let t=(0,S.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:(0,i.jsxs)(C.A,{container:!0,flexGrow:1,children:[(0,i.jsx)(C.A,{size:{xs:12},sx:{pb:1},children:(0,i.jsxs)(w.A,{sx:{height:"100%",width:"100%",background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",overflowX:"hidden",overflowY:"auto"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,i.jsx)("img",{src:"/icons/updown/qmark.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,i.jsx)(eS,{variant:"upDownCategory",children:e.divisiveDescription})]}),e.mostDivisive.map((e,n)=>(0,i.jsx)(eS,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDivided.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-divisive-".concat(n,"-qid-").concat(e.qid,"-entry")))]})}),(0,i.jsx)(C.A,{size:{xs:6},sx:{pr:1},children:(0,i.jsxs)(w.A,{sx:{height:"100%",width:"100%",background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",overflowX:"hidden",overflowY:"auto"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,i.jsx)("img",{src:"/icons/updown/check.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,i.jsx)(eS,{variant:"upDownCategory",children:e.supportedDescription})]}),e.mostlySupported.map((e,n)=>(0,i.jsx)(eS,{variant:"upDownQuestion",sx:{background:t.palette.backgroundAgree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-supported-".concat(n,"-qid-").concat(e.qid,"-entry")))]})}),(0,i.jsx)(C.A,{size:{xs:6},sx:{p:0},children:(0,i.jsxs)(w.A,{sx:{height:"100%",width:"100%",background:t.palette.summaryChartBackground.main,borderRadius:4,display:"flex",flexDirection:"column",alignItems:"stretch",overflowX:"hidden",overflowY:"auto"},children:[(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",mx:2,gap:1},children:[(0,i.jsx)("img",{src:"/icons/updown/cross.svg",alt:"Disagree icon",style:{width:"auto",height:"2rem"}}),(0,i.jsx)(eS,{variant:"upDownCategory",children:e.opposedDescription})]}),e.mostlyOpposed.map((e,n)=>(0,i.jsx)(eS,{variant:"upDownQuestion",sx:{background:t.palette.backgroundDisagree.main,borderRadius:2,mx:2,p:2,mb:1,textAlign:"start"},children:e.assertion},"summary-updown-opposed-".concat(n,"-qid-").concat(e.qid,"-entry")))]})})]})})})}function eL(e){let{allAnswers:t}=(0,v.Ay)(),[n,o]=(0,r.useState)([]),[s,a]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[p,h]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let n=[],i=[],r=[],s=[],l=[];Object.entries(t).forEach(t=>{let[o,a]=t;if(void 0!==Object.keys(e.questions).find(e=>e===o)){let t=a.filter(e=>{var t,n;return(null==(n=e.jsonValue)||null==(t=n.answers[0])?void 0:t.numericValue)!==void 0&&(0,em.M9)(e.jsonValue.answers[0].numericValue)===em.UW.Yes}).length,c=a.filter(e=>{var t,n;return(null==(n=e.jsonValue)||null==(t=n.answers[0])?void 0:t.numericValue)!==void 0&&(0,em.M9)(e.jsonValue.answers[0].numericValue)===em.UW.No}).length,d=a.filter(e=>{var t,n;return(null==(n=e.jsonValue)||null==(t=n.answers[0])?void 0:t.numericValue)!==void 0&&(0,em.M9)(e.jsonValue.answers[0].numericValue)===em.UW.Unsure}).length,u=e.questions[o].assertion,p={qid:o,assertion:u,yes:t,no:c,unsure:d,score:t-c},h=t+c;h>0?t>=2*h/3?n=[...n,p]:c>=2*h/3?i=[...i,p]:r=[...r,p]:s=[...s,p],l.push(p)}}),l.sort((e,t)=>t.score-e.score),a(n),c(i),o(r),u(s),h(l)},[t,e.questions]),(0,i.jsxs)(i.Fragment,{children:["tshape"===e.layout&&(0,i.jsx)(eO,{mostDivisive:n,mostlySupported:s,mostlyOpposed:l,unanswered:d,ordered:p,divisiveDescription:e.divisiveDescription,supportedDescription:e.supportedDescription,opposedDescription:e.opposedDescription,unansweredDescription:e.unansweredDescription}),"column"===e.layout&&(0,i.jsx)(eN,{mostDivisive:n,mostlySupported:s,mostlyOpposed:l,unanswered:d,ordered:p,divisiveDescription:e.divisiveDescription,supportedDescription:e.supportedDescription,opposedDescription:e.opposedDescription,unansweredDescription:e.unansweredDescription}),"ordered"===e.layout&&(0,i.jsx)(eM,{mostDivisive:n,mostlySupported:s,mostlyOpposed:l,unanswered:d,ordered:p,divisiveDescription:e.divisiveDescription,supportedDescription:e.supportedDescription,opposedDescription:e.opposedDescription,unansweredDescription:e.unansweredDescription})]})}var eU=n(25804),eV=n(76709),eK=n(92747),e_=n(42271),ez=n(5082),eH=n(11107),eG=n(87551),eZ=n(76278);function eJ(e){let t=(0,ei.A)();return(0,i.jsxs)(D.A,{sx:{alignItems:"center",border:"1px solid ".concat(t.palette.rankingBreakdownBoxBorder.main),borderRadius:"5px",display:"flex",flexDirection:"row",gap:"0.15rem",padding:"0 0.2rem",minWidth:"2.75rem"},children:[e.vote===em.UW.No&&(0,i.jsxs)(i.Fragment,{children:["arrow"===e.style&&(0,i.jsx)(eU.A,{htmlColor:t.palette.rankingBarNegative.main}),"icon"===e.style&&(0,i.jsx)(eK.A,{htmlColor:t.palette.rankingBarNegative.main}),"thumb"===e.style&&(0,i.jsx)(eG.A,{htmlColor:t.palette.rankingBarNegative.main})]}),e.vote===em.UW.Unsure&&(0,i.jsxs)(i.Fragment,{children:["arrow"===e.style&&(0,i.jsx)(eH.A,{htmlColor:t.palette.rankingBarNeutral.main}),"icon"===e.style&&(0,i.jsx)(ez.A,{htmlColor:t.palette.rankingBarNeutral.main}),"thumb"===e.style&&(0,i.jsx)(eH.A,{htmlColor:t.palette.rankingBarNeutral.main})]}),e.vote===em.UW.Yes&&(0,i.jsxs)(i.Fragment,{children:["arrow"===e.style&&(0,i.jsx)(eV.A,{htmlColor:t.palette.rankingBreakdownArrowPositive.main}),"icon"===e.style&&(0,i.jsx)(e_.A,{htmlColor:t.palette.rankingBreakdownArrowPositive.main}),"thumb"===e.style&&(0,i.jsx)(eZ.A,{htmlColor:t.palette.rankingBreakdownArrowPositive.main})]}),(0,i.jsx)(I.A,{variant:"body1",sx:{margin:"0 !important"},children:e.count})]})}function eQ(e){return(0,i.jsx)(D.A,{sx:{alignItems:"center",display:"flex",flexDirection:"row",height:"2.5rem",marginRight:"0.25rem"},children:(0,i.jsxs)(D.A,{sx:{display:"flex",flexDirection:"row",gap:"0.25rem",height:"1.75rem",userSelect:"none"},children:[(0,i.jsx)(eJ,{style:"arrow",count:e.answer.no,vote:em.UW.No}),(0,i.jsx)(eJ,{style:"arrow",count:e.answer.unsure,vote:em.UW.Unsure}),(0,i.jsx)(eJ,{style:"arrow",count:e.answer.yes,vote:em.UW.Yes})]})})}function eY(e){let t=(0,ei.A)();return(0,i.jsxs)(D.A,{sx:{alignItems:"center",display:"flex",flexDirection:"row",marginRight:"0.25rem"},children:[(0,i.jsx)(eQ,{answer:e.answer}),(0,i.jsx)(D.A,{sx:{alignItems:"center",backgroundColor:"color-mix(in srgb, ".concat(0!==e.answer.score?e.answer.score>0?t.palette.rankingBreakdownArrowPositive.main:t.palette.rankingBarNegative.main:t.palette.rankingBarNeutral.main,", transparent 80%)"),border:"1px solid ".concat(0!==e.answer.score?e.answer.score>0?t.palette.rankingBreakdownArrowPositive.main:t.palette.rankingBarNegative.main:t.palette.rankingBarNeutral.main),borderRadius:"50%",display:"flex",flexDirection:"row",height:"2rem",justifyContent:"center",width:"2rem"},children:(0,i.jsx)(I.A,{sx:{color:t.palette.rankingBarBorder.main,margin:"0 !important",textAlign:"center",userSelect:"none"},variant:"body1",children:e$(e.answer.score)})})]})}function eX(e){let t=(0,ei.A)(),n="1.5rem",o="10rem";if(void 0===e.highestScore||void 0===e.lowestScore)return null;{let r=Math.abs(e.answer.score);0===r&&(r=1);let s=e.highestScore;Math.abs(e.lowestScore)>e.highestScore?s=Math.abs(e.lowestScore):0===e.lowestScore&&0===e.highestScore&&(s=4);let a="".concat(r/s*50,"%");return(0,i.jsxs)(D.A,{sx:{backgroundColor:t.palette.rankingBarBackground.main,border:"".concat("1px"," solid ").concat(t.palette.rankingBarBorder.main),borderRadius:"5px",height:"calc(".concat(n," + (2 * ").concat("1px","))"),marginRight:"0.25rem",overflow:"hidden",width:"calc(".concat(o," + (2 * ").concat("1px","))")},children:[(0,i.jsx)(D.A,{sx:{backgroundColor:"".concat(0!==e.answer.score?e.answer.score>0?t.palette.rankingBarPositive.main:t.palette.rankingBarNegative.main:t.palette.rankingBarNeutral.main),height:"".concat(n),position:"relative",left:"".concat(0!==e.answer.score?e.answer.score>0?"calc(".concat(o," / 2)"):"calc((".concat(o," / 2) - ").concat(a,")"):"calc((".concat(o," / 2) - (").concat(a," / 2))")),width:"".concat(0===e.answer.score?"calc(".concat(a," + ").concat("1px",")"):"".concat(a))}}),(0,i.jsx)(D.A,{sx:{backgroundColor:t.palette.rankingBarCentreLine.main,height:"".concat(n),left:"50%",position:"relative",top:"calc(-".concat(n,")"),width:"".concat("1px")}})]})}}let e$=e=>"".concat(e>0?"+":"").concat(e);function e0(e){switch(e.visualisationType){case"bar-centre-scale":default:return(0,i.jsx)(eX,{answer:e.answer,highestScore:e.highestScore,lowestScore:e.lowestScore});case"breakdown-only":return(0,i.jsx)(eQ,{answer:e.answer});case"breakdown-with-score":return(0,i.jsx)(eY,{answer:e.answer})}}function e1(e){let t=(0,ei.A)(),{allAnswers:n}=(0,v.Ay)(),o=new RegExp("^".concat(e.qid).concat(ef.L,"[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$")),r=Object.entries(n).filter(e=>{let[t,n]=e;return o.test(t)});if(0===r.length)return null;let s=[];for(let t of r){let n=t[0].replace("".concat(e.qid).concat(ef.L),""),i=0,o=0,r=0,l=0;for(let e of t[1]){var a;let t=null==(a=e.jsonValue)?void 0:a.answers[0].numericValue;void 0!==t&&(i+=t,-1===t?r+=1:0===t?l+=1:1===t&&(o+=1))}s.push({originalAnswerId:n,score:i,yes:o,no:r,unsure:l})}s.sort((e,t)=>t.score-e.score);let l=s[s.length-1].score,c=s[0].score;return(0,i.jsx)(D.A,{sx:{margin:"0.5rem auto 0 auto"},children:s.map((o,r)=>{var s;return(0,i.jsxs)(D.A,{sx:{backgroundColor:"".concat(r%2!=0?t.palette.rankedListAltBackground.main:"none"),borderBottom:"1px solid ".concat(t.palette.rankedListItemBorder.main),display:"grid",gap:"0",gridTemplateColumns:"42rem 1fr",padding:"0.5rem 0"},children:[(0,i.jsx)(D.A,{sx:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,i.jsx)(I.A,{sx:{margin:"0 !important",padding:"0 1rem 0 0.25rem",textAlign:"left"},children:null==(s=n[e.qid][n[e.qid].findIndex(e=>e.id===o.originalAnswerId)].jsonValue)?void 0:s.answers[0].stringValue})}),(0,i.jsx)(D.A,{sx:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"end"},children:(0,i.jsx)(e0,{answer:o,highestScore:c,lowestScore:l,visualisationType:e.visualisationType})})]},o.originalAnswerId)})})}var e2=n(98314),e5=n(2768),e8=n(18414),e3=n(80015),e4=n(25091),e7=n(89041),e6=n(34814),e9=n.n(e6),te=n(57300),tt=n(50301);function tn(e){let{subscriptions:t,thisUser:n}=(0,r.useContext)(te.f),{readiness:o}=function(e){let{records:t}=function(){let{session:e}=(0,r.useContext)(e2.$);return{records:e.participantRecords}}(),[n,i]=(0,r.useState)([]);return(0,r.useEffect)(()=>{i(t.filter(t=>t.subject===e).map(e=>{var t;return{pid:e.participantId,ready:null==(t=(0,e3._h)(e.extendedDataJson))?void 0:t.ready}}))},[t,e]),{vid:e,readiness:n}}(e.videoId),[s,a]=(0,r.useState)([]);(0,r.useEffect)(()=>{a(t.filter(e=>e.deviceId!==(null==n?void 0:n.deviceId)).map(e=>e.deviceId).map(e=>{var t;return{pid:e,ready:o.some(t=>t.pid===e)?null==(t=o.find(t=>t.pid===e))?void 0:t.ready:void 0}}))},[o,t]);let l=e=>void 0===e?"gray":e?"green":"red";return(0,i.jsxs)(i.Fragment,{children:[s.some(e=>!0!==e.ready)&&(0,i.jsxs)(I.A,{variant:"body2",color:"black",component:"div",children:[" ",(0,i.jsx)(b.A,{i18nKey:"video.notAllReady"})]}),(0,i.jsx)(w.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",gap:1},children:s.map((n,o)=>{var r,s,a;let c;return(0,i.jsx)(tt.A,{title:"".concat(null!==(s=n.pid,r=null==(a=t.find(e=>e.deviceId===s))?void 0:a.participantName)&&void 0!==r?r:"Unknown"," (").concat(void 0===(c=n.ready)?"checking":c?"ready":"not ready yet",")"),children:(0,i.jsx)(w.A,{sx:{width:"0.75rem",height:"0.75rem",borderRadius:"50%",borderColor:l(n.ready),borderWidth:"2px",borderStyle:"solid",backgroundColor:n.ready?l(n.ready):"transparent"}})},"video-".concat(e.videoId,"-readiness-").concat(o,"-").concat(n.pid))})})]})}var ti=n(39268),to=n(92253);let tr=(e,t,n)=>t===d.sW.Controller||e||!n||!to.nr;function ts(e){let{api:t,start:n}=(0,r.useContext)(e8.F),[o,s]=(0,r.useState)(tr(e.playedOnce,e.role,e.audio)),[a,l]=(0,r.useState)(!1),[c,p]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e.inView&&s(tr(e.playedOnce,e.role,e.audio))},[e.playedOnce,e.role,e.audio,e.inView]),(0,r.useEffect)(()=>{e.setMayPlay(o)},[o]),(0,r.useEffect)(()=>{let t,n,i,r;l((t=e.playMode,n=e.role,i=e.audio,r=e.inView,t!==d.Vn.Playing&&!o&&n!==d.sW.Controller&&i&&to.nr&&r))},[e.playMode,o,e.role,e.audio,e.inView]),(0,r.useEffect)(()=>{let i=async i=>{let o={action:"video-readiness-update",sessionId:e.sessionId,deviceId:e.deviceId,ticks:Date.now(),parameters:{videoId:e.videoId,ready:i}};try{p(!0),await n(t.postParticipantAction(e.sessionToken,o,!1))}catch(e){console.error(e),x(!0)}finally{p(!1)}};e.role===d.sW.Client&&e.inView&&i(o)},[o,e.inView,e.role,t,e.deviceId,e.sessionId,e.sessionToken,e.videoId]);let g=async e=>{try{await m()}catch(e){console.error(e),s(!1),x(!0)}};(0,r.useEffect)(()=>{e.setShowActivationFailed(h),e.setOverrideControls(h)},[h]);let m=async()=>{if(!(0,u.s)(e.playerRef.current))throw Error("Unable to activate video: Player not ready");try{await e.playerRef.current.play(),e.playerRef.current.pause()}catch(e){throw console.error(e),Error("Failed to activate video")}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ti.A,{open:e.inView&&a,setOpen:l,onSelect:g,dismissible:!1,showCloseButton:!1,title:"Ready for video?",prompt:"Please let us know when you are ready to watch the video.",promptGraphicUri:e.posterUri,options:[{key:"ready",text:"Ready",filled:!0}],busy:c})})}function ta(e){let{toServerTime:t,fromServerTime:n}=(0,r.useContext)(e5.v),{sid:o}=(0,r.useContext)(t9),{api:s,start:a}=(0,r.useContext)(e8.F),{user:l,sessionToken:c,role:p,deviceId:h}=(0,r.useContext)(y.yk),{session:x}=(0,r.useContext)(e2.$),g=(0,r.useRef)(null),[m,f]=(0,r.useState)(!1),{ref:v,inView:j}=(0,ew.Wx)({threshold:0}),[A,k]=(0,r.useState)(!1),[S,C]=(0,r.useState)(0),[D,E]=(0,r.useState)(d.Vn.NotStarted),R=(0,r.useRef)(void 0),[F,B]=(0,r.useState)(0),[P,T]=(0,r.useState)(),[q,W]=(0,r.useState)(),N=(0,r.useRef)((0,e3.gL)(x.liveExperienceState.originatorTimestampsJson)),[O,L]=(0,r.useState)(!1),[U,V]=(0,r.useState)(!1),[K,_]=(0,r.useState)(!1),[z,H]=(0,r.useState)(!1),[G,Z]=(0,r.useState)(!1),J=(0,r.useContext)(e4.GG);(0,r.useEffect)(()=>{(0,u.s)(g.current)&&(g.current.addEventListener("play",e=>{L(!0),E(d.Vn.Playing)}),g.current.addEventListener("pause",e=>{E(d.Vn.Paused)}),g.current.addEventListener("ended",e=>{E(d.Vn.Ended)}),document.addEventListener("visibilitychange",()=>k("visible"===document.visibilityState)),k("visible"===document.visibilityState))},[g]),(0,r.useEffect)(()=>{if((0,u.s)(g.current)&&(0,u.s)(null==J?void 0:J.state.current.audioOutputDevice))if((0,u.s)(g.current.setSinkId))try{g.current.setSinkId(J.state.current.audioOutputDevice)}catch(e){console.warn("Error setting audio output device for SimplifiedVideoSlide",e)}else console.debug("Audio.setSinkId not defined")},[g,null==J?void 0:J.state.current.audioOutputDevice]),(0,r.useEffect)(()=>{j?(C(1),Q().then(()=>{C(2)}).catch(e=>{console.error(e),C(3)}).finally(()=>{er(),L(!1),E(d.Vn.Paused)})):Y().then(()=>{C(0)}).catch(e=>{console.error(e),C(3)}).finally(()=>{er(),L(!1),E(d.Vn.NotStarted),p===d.sW.Controller&&X(d.Vn.NotStarted)})},[j]),(0,r.useEffect)(()=>{_(p!=d.sW.Controller&&D!==d.Vn.Playing)},[p,D]);let Q=async()=>{if(!(0,u.s)(g.current))throw Error("Player not ready to load video");console.debug("Loading video ".concat(e.videoId)),g.current.setAttribute("src",e.videoUri),g.current.load()},Y=async()=>{if(null===g.current)throw Error("Player not ready");console.debug("Unloading video ".concat(e.videoId)),g.current.removeAttribute("src"),g.current.load()},X=async(n,i)=>{if(null===g.current)throw Error("Player not ready");try{f(!0);let r=g.current.currentTime,u={sessionId:o,videoId:e.videoId,modeChange:n,modeChangePosition_s:n===d.Vn.NotStarted?0:r,modeChangeServerTime_ms:t(null!=i?i:Date.now())},p={action:"set-video-sync",sessionId:o,parameters:u,originator:h,ticks:Date.now()};await a(s.postFacilitatorAction(l.access_token,c,p,!1))}catch(e){console.error("sync error",e)}finally{f(!1)}},ee=e=>{if(!(0,u.s)(g.current))return void console.warn("Video player not ready for user interactions");switch(e){case"restart":g.current.currentTime=0,g.current.pause(),X(d.Vn.NotStarted),eo();break;case"back":g.current.currentTime-=15,g.current.pause(),X(d.Vn.Paused),eo();break;case"play-pause":D===d.Vn.Playing?X(d.Vn.Paused):X(d.Vn.Playing,Date.now()+2e3);break;case"fwd":g.current.currentTime+=15,g.current.pause(),X(d.Vn.Paused),eo()}};(0,r.useEffect)(()=>{var t,n,i,o;let r=x.liveExperienceState,s=r.originator,a=(0,e3.gL)(r.originatorTimestampsJson),l=e3.zD.VideoSync(e.videoId),c=!(0,u.s)(null==(t=N.current[l])?void 0:t[s])||(0,u.s)(null==(n=a[l])?void 0:n[s])&&(null==(i=a[l])?void 0:i[s])>=N.current[l][s];if(!(0,u.s)(q)||c){N.current=a;let t=(null==(o=r.videoSync)?void 0:o.videoId)===e.videoId?r.videoSync:void 0;(0,u.s)(t)&&et(q,t)&&W(t)}},[x.liveExperienceState]);let et=(e,t)=>!!e9()(e)||e.modeChange!==t.modeChange||e.modeChangePosition_s!==t.modeChangePosition_s||e.modeChangeServerTime_ms!==t.modeChangeServerTime_ms;(0,r.useEffect)(()=>{2===S&&(eo(),j&&(0,u.s)(q)&&G&&en(q))},[S,j,q,D,G]);let en=e=>{if((0,u.s)(g.current)||console.warn("Video player not ready to enact sync"),void 0!==P&&(clearTimeout(P),T(void 0)),e.modeChange!==d.Vn.Playing)return void ei(e);let t=n(e.modeChangeServerTime_ms)-Date.now();console.debug("Video sync scheduled for "+t+"ms");let i=t<0?Math.abs(t/1e3):0,o={...e,modeChangePosition_s:e.modeChangePosition_s+i},r=setTimeout(()=>{T(void 0),ei(o)},Math.max(0,t));T(r)},ei=e=>{if(null===g.current)return void console.warn("Player not ready to enact sync");console.debug("Video sync enaction: ".concat(d.Vn[e.modeChange]," at ").concat(e.modeChangePosition_s,"s"));let t=Math.min(Math.round((e.modeChangePosition_s+Number.EPSILON)*1e3)/1e3,isFinite(g.current.duration)?g.current.duration:0);console.debug("newPosition",t),console.debug("duration",g.current.duration),g.current.currentTime=t,e.modeChange===d.Vn.Playing&&g.current.currentTime<g.current.duration?g.current.play():g.current.pause()};(0,r.useEffect)(()=>{let t={type:$.m.Media_Playback_Update,data:{muteFacilitator:e.muteFacilitator,videoId:e.videoId,isPlaying:D===d.Vn.Playing}};$.A.emit(t),eo(),void 0!==R.current&&(clearInterval(R.current),R.current=void 0),D===d.Vn.Playing&&void 0===R.current&&(R.current=setInterval(()=>{D===d.Vn.Playing?eo():(0,u.s)(R.current)&&(clearInterval(R.current),R.current=void 0)},100))},[D,e.videoId]);let eo=()=>{(0,u.s)(g.current)?B(g.current.currentTime/g.current.duration*100):console.warn("Player not ready to update progress bar")},er=()=>{B(0)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ts,{role:p,videoId:e.videoId,audio:e.audio,inView:j,docVisible:A,state:S,playMode:D,deviceId:h,sessionId:o,playedOnce:O,playerRef:g,sessionToken:c,setOverrideControls:V,setShowActivationFailed:H,setMayPlay:Z,posterUri:e.posterUri}),(0,i.jsxs)(w.A,{className:"stretch",ref:v,sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",gap:1,p:0},children:[3!==S&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{sx:{flexGrow:1,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)(w.A,{sx:{position:"relative",flexGrow:1},children:[(0,i.jsxs)(w.A,{sx:{position:"absolute",top:"100%",left:0,right:0},children:[K&&(0,i.jsx)(I.A,{variant:"body2",color:"white",children:(0,i.jsx)(b.A,{i18nKey:"video.videoReadiness"})}),z&&(0,i.jsx)(I.A,{variant:"body2",color:"red",children:(0,i.jsx)(b.A,{i18nKey:"video.videoInitFailed"})}),U&&(0,i.jsx)(I.A,{variant:"body2",color:"red",children:(0,i.jsx)(b.A,{i18nKey:"video.videoManualControl"})})]}),(0,i.jsx)("video",{ref:g,style:{width:"100%",height:"100%",borderRadius:"0.5rem",overflow:"hidden",objectFit:"contain",backgroundColor:"rgba(0,0,0,0.5)"},poster:e.posterUri,preload:"auto",loop:!1,autoPlay:!1,controls:U,disablePictureInPicture:!0,muted:!e.audio,crossOrigin:"anonymous",className:"shadow",playsInline:!0,"webkit-playsinline":"true"}),e.controls&&null!==g.current&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(w.A,{sx:{position:"absolute",left:"50%",bottom:0},children:(0,i.jsxs)(w.A,{sx:{position:"relative",left:"-50%",bottom:0,p:1,background:"rgba(255,255,255,0.75)",borderRadius:"0.5rem",alignSelf:"center",display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsx)(e7.A,{variant:1===S?"indeterminate":"determinate",value:F,color:1===S?"primary":"error"}),(0,i.jsxs)(w.A,{sx:{display:"flex",flexDirection:"row",alignSelf:"stretch",justifyContent:"center",gap:1},children:[(0,i.jsx)(M.A,{variant:"outlined",disabled:2!==S||m,btnKey:"restart",btnText:"Restart",onClick:ee}),(0,i.jsx)(M.A,{variant:"outlined",disabled:2!==S||m,btnKey:"back",btnText:"-15s",onClick:ee}),(0,i.jsx)(M.A,{disabled:2!==S||m,btnKey:"play-pause",variant:D===d.Vn.Playing?"outlined":"contained",busy:void 0!==P,btnText:D===d.Vn.Playing?"Pause":"Play",onClick:ee}),(0,i.jsx)(M.A,{variant:"outlined",disabled:2!==S||m,btnKey:"fwd",btnText:"+15s",onClick:ee})]}),(0,i.jsx)(tn,{videoId:e.videoId})]})})})]})})}),3===S&&(0,i.jsx)("p",{children:(0,i.jsx)(b.A,{i18nKey:"video.videoInitFailed"})})]})]})}var tl=n(80431);function tc(e){let{setAllSlideAnswerRules:t}=(0,tl.zJ)(),[n,i]=(0,r.useState)(void 0);return(0,r.useEffect)(()=>{let t=[];e.children.forEach(e=>{(0,r.isValidElement)(e)&&e.props.qIds.qid&&t.push(e.props.qIds.qid)}),i(t)},[e.children]),(0,r.useEffect)(()=>{void 0!==n&&void 0!==t&&n.forEach(n=>{t(t=>({...t,[n]:function(e){let t={};return Object.entries(e).forEach(e=>{let[n,i]=e;"noselfvoting"===n&&"true"===i&&(t[n]=!0)}),t}(e.rules)}))})},[n,e.rules,t]),e.children}function td(e){let{session:t}=(0,r.useContext)(e2.$);return t.remoteConfiguration===e.config?e.children:null}var tu=n(79178);let tp=e=>({replace:(t,n)=>th(t,e)}),th=(e,t)=>{if(e instanceof o.Hg&&e.attribs){var n;let i;switch(e.tagName.toLowerCase()){case"sidebarlayout":i=tz(e,t);break;case"fullpagescrollinglayout":i=tH(e,t);break;case"fullpagecentredlayout":i=tG(e,t);break;case"columnlayout":i=tZ(e,t);break;case"slidebackgroundimage":i=tJ(e,t);break;case"imageslide":i=tV(e,t);break;case"videoslide":i=tw(e,t);break;case"summaryslidelayout":i=tj(e,t);break;case"sectionheading":i=tY(e,t);break;case"slidetext":i=tX(e,t);break;case"slideimage":case"img":i=t$(e,t);break;case"inputorcompletion":i=tK(e,t);break;case"inputsequence":i=t_(e,t);break;case"sliderinput":i=tA(e,t);break;case"textinput":i=tD(e,t);break;case"demographicinput":i=tF(e,t);break;case"updownvoteinput":i=tB(e,t);break;case"updownvoteinputsequence":i=tP(e,t);break;case"closedchoiceinput":i=tT(e,t);break;case"pointsallocationinput":i=tq(e,t);break;case"multisliderinput":i=tW(e,t);break;case"acknowledgementinput":i=tN(e,t);break;case"rankedlistinput":i=tM(e,t);break;case"consentinput":i=tO(e,t);break;case"completion":i=tQ(e,t);break;case"speechbubbles":i=tI(e,t);break;case"selectiongraph":i=tk(e,t);break;case"updownvoteresults":i=tS(e,t);break;case"updownvoteresultsrankedlist":i=tC(e,t);break;case"topoptions":i=tL(e,t);break;case"orderedlist":i=tU(e,t);break;case"answerrules":i=tv(e,t);break;case"remoteconfiguration":i=ty(e,t);break;default:return e}return null!=(n=(0,tu.p1)(i,t.keyPrefix))?n:i}},tx=(e,t)=>{let n=e.children.map((e,n)=>tp(t).replace(e,n)).filter(e=>null!=e&&!1!==e).map(e=>e instanceof o.Hg?(0,o.zd)([e],tp(t)):e);return r.Children.toArray(n)},tg=e=>{let t=[];for(let n of e.children)if(n instanceof o.Hg&&"option"===n.tagName){let e=n.attribs.key||n.attribs.value,i=n.attribs.title||n.attribs.display,o=n.attribs.description,r=n.attribs["aria-label"],s=n.attribs.fontsize,a=n.attribs.graphic,l=(0,c.$_)(n.attribs.isalt),d=(0,c.$_)(n.attribs.exclusive);if((0,u.s)(e)&&(0,u.s)(i)){let n={key:e,title:i,description:o,ariaLabel:r,fontSize:s,graphic:a,isAlt:l,exclusive:d};t.push(n)}else throw console.warn("KeyedOption option without key or title",n),"KeyedOption option without key or title"}return t},tm=(e,t)=>{let n=[];for(let i of e.children.filter(e=>e instanceof o.Hg).map(e=>e))void 0!==i.attribs.qid?n.push(tf(t,i)):n=[...n,...tm(i,t)];return n},tf=(e,t)=>{let n=t.attribs.qid;if(void 0===n)throw console.error("Question id not found for element",t),"Question id not found for element";return{sid:e.sessionId,pid:e.deviceId,qid:n}},tb=e=>{var t,n;let i=e.attribs.instruction,o=null!=(n=null!=(t=e.attribs.question)?t:e.attribs.statement)?n:e.attribs.prompt,r=e.attribs.explanation,s=(0,c.yG)(e.attribs.pii);return i||o||r||void 0!==s?{instruction:i,question:o,explanation:r,pii:s}:void 0},tv=(e,t)=>{let n=e.attribs,o=tx(e,t);return(0,i.jsx)(tc,{rules:n,children:o})},ty=(e,t)=>{let n=Number(e.attribs.config),o=tx(e,t);return(0,i.jsx)(td,{config:n,children:o})},tw=(e,t)=>{var n;console.debug("Enriching VideoSlide tag as VideoSlide...",e);let o=e.attribs.id,r=e.attribs.videouri,s=e.attribs.posteruri,a=t.role===d.sW.Controller,l=t.role===d.sW.Controller||t.remoteMedia,u=null==(n=(0,c.$_)(e.attribs["mute-facilitator"]))||n;return(0,i.jsx)(ta,{videoId:o,controls:a,audio:l,videoUri:r,posterUri:s,muteFacilitator:u})},tj=(e,t)=>{console.debug("Enriching SummarySlideLayout tag as SummarySlideLayout...",e);let n=e.attribs.color,o=e.attribs.title,r=e.attribs.prompt,s=void 0!==e.attribs.chartbackground?(0,c.yG)(e.attribs.chartbackground):void 0,a=tx(e,t);return(0,i.jsx)(eC,{color:n,title:o,prompt:r,chartBackground:s,children:a})},tA=(e,t)=>{var n;console.debug("Enriching SliderInput tag as SliderInput...",e);let o=tf(t,e),r=tb(e),s=(0,tu.Qs)(e.attribs.type),a=s===ex.a.categorical?(0,tu.F8)(e.attribs.marks):void 0,l=s!==ex.a.categorical?null==(n=(0,tu.F8)(e.attribs.range))?void 0:n.map(e=>(0,tu.SP)(e.trim())):void 0,d=s!==ex.a.categorical?(0,tu.SP)(e.attribs.step):void 0,u=(0,c.yG)(e.attribs.showunsure);return(0,i.jsx)(ex.A,{qids:o,role:t.role,type:s,marks:a,numericRange:l,numericStep:d,question:r,showUnsure:u,onAnswer:t.onAnswer})},tk=(e,t)=>{var n;console.debug("Enriching SelectionGraph tag as AnswerGraphMuiChart...",e);let o=tf(t,e),r=tb(e),s=(0,tu.$1)(e.attribs.orientation),l=(0,c.$_)(e.attribs.showorientationcontrols),d=(0,tu.tX)(e.attribs.type),u=null==(n=(0,tu.F8)(e.attribs.range))?void 0:n.map(e=>a().toNumber(e.trim())),p=(0,tu.UI)((0,tu.F8)(e.attribs.categories)),h={sortOn:e.attribs.sorton,sortOrder:e.attribs.sortorder},x=tg(e),g={left:e.attribs.marginleft?Number(e.attribs.marginleft):void 0},m=e.attribs.categorieslegendfontsize,f=e.attribs.valueslegendfontsize;if(o&&void 0!==d)return(0,i.jsx)(eE.A,{role:t.role,qids:o,question:r,inputType:d,orientation:s,showOrientationControls:l,categories:p,sorting:h,range:u?{lo:u[0],hi:u[1],step:u[2]}:void 0,margin:g,categoriesLegendFontSize:m,valuesLegendFontSize:f,options:x});throw console.error("SelectionGraph without qIds, type, or range",e.attribs),"SelectionGraph without qIds, type, or range"},tS=(e,t)=>{console.debug("Enriching UpDownVoteResults tag as UpDownVoteResults...",e);let n=e.attribs.layout,r=e.attribs.divisivedescription,s=e.attribs.supporteddescription,a=e.attribs.opposeddescription,l=e.attribs.unanswereddescription,c={};for(let t of e.children)if(t instanceof o.Hg&&"result"===t.tagName){let e=t.attribs.qid,n=t.attribs.assertion;void 0!==e&&(c[e]={assertion:n})}return(0,i.jsx)(eL,{questions:c,layout:n,divisiveDescription:null!=r?r:(0,i.jsx)(b.A,{i18nKey:"upDownResult.divisiveDescription"}),supportedDescription:null!=s?s:(0,i.jsx)(b.A,{i18nKey:"upDownResult.supportedDescription"}),opposedDescription:null!=a?a:(0,i.jsx)(b.A,{i18nKey:"upDownResult.opposedDescription"}),unansweredDescription:null!=l?l:(0,i.jsx)(b.A,{i18nKey:"upDownResult.unansweredDescription"})})},tC=(e,t)=>(console.debug("Enriching UpDownVoteResultsRankedList tag as UpDownVoteResultsRankedList...",e),(0,i.jsx)(e1,{qid:e.attribs.qid,visualisationType:e.attribs.visualisationtype})),tI=(e,t)=>{console.debug("Enriching SpeechBubbles tag as SpeechBubbles (with children)...",e);let n=tf(t,e),o=tb(e);return(0,i.jsx)(eT,{qids:n,question:o})},tD=(e,t)=>{var n;let r;console.debug("Enriching TextInput tag as TextInput...",e);let s=tf(t,e),l=tb(e),d=(0,tu.Ap)(e.attribs.type),u=e.attribs.label,p=e.attribs.help,h=e.attribs.submittext,x=e.attribs.skiptext,g=a().parseInt(e.attribs.mincheckboxes),m=(0,c.yG)(null!=(n=e.attribs.textrequired)?n:"true"),f=[];for(let t of e.childNodes)if(t instanceof o.Hg&&"information"===t.tagName&&(r={heading:t.attribs.heading,body:t.children}),t instanceof o.Hg&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.text,i=(0,c.yG)(t.attribs.required);f.push({key:e,text:n,initial:!1,required:i,checked:!1})}let b=e.attribs.maxlength,v=(0,c.yG)(e.attribs.maxlengthcounter),y=e.attribs.minlength,w=e.attribs.minrows,j=(0,c.yG)(e.attribs.multiline),A=(0,c.yG)(e.attribs.fullheight),k=e.attribs.pattern,S=e.attribs.patternerrormessage;if(void 0===l||void 0===l.pii)throw"pii not defined for TextInput";return(0,i.jsx)(eg.A,{qids:s,role:t.role,type:d,label:u,help:p,textRequired:m,minCheckboxes:g,information:r,onAnswer:t.onAnswer,checkboxes:f,question:l,submitText:h,skipText:x,maxLength:b?Number(b):void 0,maxLengthCounter:v,minLength:y?Number(y):void 0,minRows:w?Number(w):void 0,multiline:j,fullHeight:A,pattern:k,patternErrorMessage:S})},tE=e=>{let t=[];for(let n of e)if(n instanceof o.Hg&&"demographicgroup"===n.tagName){let e=n.attribs.label;if(e){let i=tR(n.children);t.push({label:e,choices:i})}else throw console.warn("DemographicGroup without label",n),"DemographicGroup without label"}return t},tR=e=>{let t=[];for(let n of e)if(n instanceof o.Hg&&"demographic"===n.tagName){let e=n.attribs.display,i=n.attribs.value;if(e&&i)t.push({display:e,key:i});else throw console.warn("Demographic without display or value",n),"Demographic without display or value"}return t},tF=(e,t)=>{console.debug("Enriching DemographicInput tag as DemographicInput...",e);let n=tf(t,e),r=tb(e),s=(0,c.yG)(e.attribs.showage),a=(0,c.yG)(e.attribs.showgender),l=(0,c.yG)(e.attribs.showethnicity),d=e.attribs.showpostcode,u=(e=>{let t=[];for(let n of e)if(n instanceof o.Hg&&"demographicinputtype"===n.tagName){let e=n.attribs.key,i=n.attribs.label,o=n.attribs.layout,r=n.attribs.mode,s=n.attribs.textplaceholder,a=n.attribs.textvalidationregex,l=(0,c.wF)(n.attribs.textmaxlength),d=(0,c.wF)(n.attribs.columns),u=void 0!==d?{columns:d}:void 0,p=n.attribs.selectionquestion,x=n.attribs.selectionobject,g=n.attribs.selectionobject_plural,m=n.attribs.selectionitemprompt,f=(0,c.wF)(n.attribs.minselections),b={key:e,label:i,layout:o,layoutProps:u,groups:[],mode:r,textPlaceholder:s,textValidationRegex:a,textMaxLength:l,selectionQuestion:p,selectionObject:x,selectionObject_plural:g,selectionItemPrompt:m,minSelections:f,maxSelections:(0,c.wF)(n.attribs.maxselections),prompt:n.attribs.prompt},{validations:v,requiredFields:y}=h(b);if(!0!==v)throw console.error("Invalid DemographicInputTypes",v),"Invalid DemographicInputTypes:\n"+v.join("\n");y.find(e=>"groups"===e)&&(b.groups=tE(n.children)),t.push(b)}return t})(e.children);return(0,i.jsx)(X,{role:t.role,qids:n,onAnswer:t.onAnswer,question:r,showAge:s,showGender:a,showEthnicity:l,showPostcode:d,customDemographics:u})},tB=(e,t)=>{console.debug("Enriching UpDownVoteInput tag as UpDownVoteInput...",e);let n=tf(t,e),o=tb(e),r=e.attribs.assertion;return(0,i.jsx)(em.Ay,{qids:n,role:t.role,question:o,assertion:r,onAnswer:t.onAnswer})},tP=(e,t)=>{console.debug("Enriching UpDownVoteInputSequence tag as UpDownVoteInputSequence...",e);let n=tf(t,e),o=tb(e),r=(0,c.yG)(e.attribs.showprogress),s=tx(e,t),a=s[s.length-1];return(0,i.jsx)(ef.A,{completion:a,onAnswer:t.onAnswer,qIds:n,question:o,role:t.role,showProgress:r})},tT=(e,t)=>{console.debug("Enriching ClosedChoiceInput tag as ClosedChoiceInput...",e);let n=tf(t,e),o=tb(e),r=parseInt(e.attribs.minselections),s=parseInt(e.attribs.maxselections),a=e.attribs.layout,l=e.attribs.layoutparams,d=l?(0,tu.F8)(l):[],u=(0,c.yG)(e.attribs.shuffle),p=tg(e);return(0,i.jsx)(P,{qids:n,role:t.role,question:o,options:p,shuffle:u,onAnswer:t.onAnswer,layout:a,layoutParams:d,minSelections:r,maxSelections:s,contentStore:t.contentStore})},tq=(e,t)=>{console.debug("Enriching PointsAllocationInput tag as PointsAllocationInput...",e);let n=tf(t,e),r=tb(e),s=parseInt(e.attribs.points),a=[];for(let t of e.children)if(t instanceof o.Hg&&"option"===t.tagName){let e=t.attribs.title,n=t.attribs.description,i=t.attribs.key,o=parseInt(t.attribs.min),r=parseInt(t.attribs.max),s=t.attribs.graphic;if(e&&n&&i&&void 0!==o&&void 0!==r)a.push({title:e,description:n,key:i,min:o,max:r,graphic:s});else throw"PointsAllocationInput Option without title, description, key, min, or max"}return(0,i.jsx)(el,{qids:n,question:r,points:s,options:a,onAnswer:t.onAnswer})},tW=(e,t)=>{console.debug("Enriching MultiSliderInput tag as MultiSliderInput...",e);let n=tf(t,e),r=tb(e),s=parseInt(e.attribs.min),a=parseInt(e.attribs.max),l=[],d=[],u=Number(e.attribs.paddingX)||void 0,p=Number(e.attribs.rowspacing)||void 0,h=(0,c.yG)(e.attribs.showdescriptions);for(let t of e.children)if(t instanceof o.Hg&&"label"===t.tagName){let e=parseFloat(t.attribs.at),n=t.attribs.text;void 0!==e&&n&&l.push({at:e,text:n})}else if(t instanceof o.Hg&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.title,i=t.attribs.description;e&&n&&d.push({key:e,title:n,description:i})}return(0,i.jsx)(es,{qids:n,question:r,min:s,max:a,labels:l,options:d,paddingX:u,rowSpacing:p,showDescriptions:h,role:t.role,onAnswer:t.onAnswer})},tN=(e,t)=>{console.debug("Enriching AcknowledgementInput tag as AcknowledgementInput...",e);let n=tf(t,e),r=tb(e),s=e.attribs.align,a=[];for(let t of e.children)if(t instanceof o.Hg&&"option"===t.tagName){let e=t.attribs.text,n=t.attribs.key,i=t.attribs.variant,o=t.attribs.colour;e&&n&&a.push({text:e,key:n,variant:i,colour:o})}return(0,i.jsx)(k,{qids:n,question:r,options:a,align:s,onAnswer:t.onAnswer})},tM=(e,t)=>{console.debug("Enriching RankedListInput tag as RankedListInput...",e);let n=tf(t,e),r=tb(e),s=[],a=(0,c.yG)(e.attribs.shuffle),l=0;for(let t of e.children)if(t instanceof o.Hg&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.title,i=t.attribs.description;n&&s.push({key:e,title:n,description:i,startingIndex:l++})}return(0,i.jsx)(eh,{qids:n,question:r,options:s,shuffle:a,onAnswer:t.onAnswer})},tO=(e,t)=>{console.debug("Enriching ConsentInput tag as ConsentInput...",e);let n=tf(t,e),o=tb(e),r=e.attribs.consenttext;return(0,i.jsx)(O,{qids:n,question:o,consentText:r,onAnswer:t.onAnswer,content:e.children})},tL=(e,t)=>{console.debug("Enriching TopOptions tag as TopOptionsSummary...",e);let n=tf(t,e),r=tb(e),s=parseInt(e.attribs.count),a=[];for(let t of e.children)if(t instanceof o.Hg&&"option"===t.tagName){let e=t.attribs.key,n=t.attribs.title,i=t.attribs.description,o=t.attribs.graphic;e&&n&&i&&a.push({key:e,title:n,description:i,graphic:o})}return(0,i.jsx)(eW,{qids:n,question:r,options:a,displayCount:s})},tU=(e,t)=>{console.debug("Enriching OrderedList tag as OrderedListDisplay...",e);let n=tf(t,e),o=tb(e),r=e.attribs.startcolour,s=e.attribs.endcolour,a=e.attribs.mode,l=tg(e);return(0,i.jsx)(eB,{qids:n,question:o,options:l,role:t.role,startColour:r,endColour:s,mode:a})},tV=(e,t)=>{console.debug("Enriching ImageSlide tag as ImageSlide...",e);let n=e.attribs.src,o=e.attribs.alt,r=(0,tu.$u)(e.attribs.style);return(0,i.jsx)(ej,{style:r,alt:o,src:n})},tK=(e,t)=>{let n=tx(e,t);console.debug("Enriching InputOrCompletion tag as InputOrCompletion (with children)...",n);let o=tf(t,e);return(0,i.jsx)(et,{qids:o,input:n[0],completion:n[1]})},t_=(e,t)=>{let n=tx(e,t);console.debug("Enriching InputSequence tag as InputSequence (with children)...",n);let o=[];for(let e=0;e<n.length-1;e++)o.push(n[e]);let r=n[n.length-1],s=tb(e),a=(0,c.yG)(e.attribs.showprogress),l=tm(e,t);return(0,i.jsx)(eo,{question:s,showProgress:a,qids:l,inputs:o,completion:r,role:t.role})},tz=(e,t)=>{console.debug("Enriching SideBarLayout tag as SideBarLayout (with children)...",e);let n=tx(e,t),o=(0,tu.zd)(e.attribs.sidestyle),r=(0,tu.zd)(e.attribs.mainstyle),s=e.attribs.sidebackgroundimage,a=e.attribs.mainbackgroundimage;return(0,i.jsx)(eA,{side:n[0],sideSx:o,main:n[1],mainSx:r,sideBackgroundImage:s,mainBackgroundImage:a,contentStore:t.contentStore})},tH=(e,t)=>{console.debug("Enriching FullPageScrollingLayout tag as FullPageScrollingLayout (with children)...",e);let n=(0,tu.zd)(e.attribs.sx),o=tx(e,t);return(0,i.jsx)(ey,{sx:n,children:o})},tG=(e,t)=>{console.debug("Enriching FullPageCentredLayout tag as FullPageCentredLayout (with children)...",e);let n=(0,tu.zd)(e.attribs.sx),o=tx(e,t);return(0,i.jsx)(ev,{sx:n,children:o})},tZ=(e,t)=>{console.debug("Enriching ColumnLayout tag as ColumnLayout (with children)...",e);let n=(0,tu.zd)(e.attribs.sx),o=tx(e,t);return(0,i.jsx)(eb,{sx:n,children:o})},tJ=(e,t)=>{console.debug("Enriching SlideBackgroundImage tag as SlideBackgroundImage (with children)...",e);let n=tx(e,t),o=e.attribs.src,r=(0,tu.zd)(e.attribs.sx);return(0,i.jsx)(ek,{src:o,sx:r,children:n})},tQ=(e,t)=>{console.debug("Enriching Completion tag as CompletionDisplay (with children)...",e);let n=e.attribs.message,o=e.attribs.factoid,r=(0,tu.zd)(e.attribs.sx);return(0,i.jsx)(eD,{content:{message:n,factoid:o},sx:r})},tY=(e,t)=>{console.debug("Enriching SectionHeading tag as SectionHeading...",e);let n=(0,l.A)(),r=tb(e),s=[];for(let t of e.children)if(t instanceof o.Hg&&"heading"===t.tagName){let e=t.attribs.title,n=t.attribs.description,i=t.attribs.graphic,o=(0,c.yG)(t.attribs.expanded);if(e)s.push({title:e,description:n,graphic:i,expanded:o});else throw console.warn("SectionHeading without title",t),"SectionHeading without title"}return(0,i.jsx)(eP,{question:r,headings:s,uid:n})},tX=(e,t)=>{console.debug("Enriching SlideText tag as SlideText (with children)...",e);let n=tx(e,t),o=(0,tu.zd)(e.attribs.sx),r=e.attribs.color,s=e.attribs.align,a=e.attribs.variant;return(0,i.jsx)(eS,{variant:a,sx:o,color:r,align:s,children:n})},t$=(e,t)=>{console.debug("Enriching ImageSlide tag as ImageSlide...",e);let n=e.attribs.src,o=(0,tu.$u)(e.attribs.style);return(0,i.jsx)(eI,{src:n,style:o})},t0=["src","graphic","videoUri","posterUri","sideBackgroundImage","mainBackgroundImage","data-background-image"],t1=["style","sideStyle","mainStyle"];class t2{getAsSectionTags(e,t){let n=new DOMParser().parseFromString(e,"text/xml").getElementsByTagName("section"),i=[];console.debug("Module ".concat(t," contains ").concat(n.length," sections."));for(let e=0;e<n.length;e++){let o=n.item(e);o&&o.setAttribute("key","module-".concat(t,"-section-").concat(e));let r=new XMLSerializer().serializeToString(o);i.push(r)}return a().join(i,"\n")}reset(){this.progressData={overall:{completed:0,total:0},bars:{}},this.sendUpdate()}updateProgress(e,t,n){this.progressData.bars[e]={completed:t,total:n},this.progressData.overall.completed=a().sum(Object.entries(this.progressData.bars).map(e=>e[1].completed)),this.progressData.overall.total=a().sum(Object.entries(this.progressData.bars).map(e=>e[1].total)),this.sendUpdate()}sendUpdate(){var e;null==(e=this.onUpdate)||e.call(this,{overall:this.progressData.overall,bars:{}})}findAllReplacements(e,t){void 0===e&&(e=this.dom.documentElement),t=this.appendNodeReplacements(e,t);for(let n=0;n<e.childNodes.length;n++)t=this.findAllReplacements(e.childNodes[n],t);return t}appendNodeReplacements(e,t){let n=[...t];if(e.nodeType===Node.ELEMENT_NODE){for(let t of t0)if(e.hasAttribute(t)||e.hasAttribute(t.toLowerCase())){var i;let o=null!=(i=e.getAttribute(t))?i:e.getAttribute(t.toLowerCase());if(void 0===n.find(e=>e.key===o)){let e=async()=>{try{return await this.zcs.getAsUrl(o,(e,t,n)=>{this.updateProgress(e,t,n)})}catch(e){throw console.error("Error fetching ".concat(t,": ").concat(o),e),e}},i={key:o,getUrlPromise:e,targets:[],attempts:0};n.push(i)}n.find(e=>e.key===o).targets.push({element:e,attribute:t})}for(let t of t1)if(e.hasAttribute(t)){let i=e.getAttribute(t);if(i.includes("url(")){let o=i.match(/url\(([^)]+)\)/)[1];if(o=a().trim(o,"\"' ()"),void 0===n.find(e=>e.key===o)){let e=async()=>{try{return await this.zcs.getAsUrl(o,(e,t,n)=>{this.updateProgress(e,t,n)})}catch(e){throw console.error("Error fetching ".concat(t,": ").concat(o),e),e}},i={key:o,getUrlPromise:e,targets:[],attempts:0};n.push(i)}n.find(e=>e.key===o).targets.push({element:e,attribute:t})}}}return n}async replaceAllReplacements(e){do{let t=e.filter(e=>this.shouldTryAgain(e)),n=await Promise.all(t.map(e=>this.replace(e)));if(n.some(e=>!e.succeeded)){let e=n.filter(e=>!1===e.succeeded);console.warn("".concat(e.length," failed replacements"),e),await new Promise(e=>setTimeout(e,1e3))}}while(e.some(e=>this.shouldTryAgain(e)));if(e.some(e=>!1===e.succeeded)){let t=e.filter(e=>!1===e.succeeded);console.error("".concat(t.length," replacements failed"),t)}return new XMLSerializer().serializeToString(this.dom)}async replace(e){try{e.attempts++;let t=await e.getUrlPromise();for(let n of e.targets){let i=n.element.getAttribute(n.attribute),o=null==i?void 0:i.replace(e.key,t);n.element.setAttribute(n.attribute,o)}e.succeeded=!0}catch(t){console.warn("Error fetching ".concat(e.key),t),e.succeeded=!1,e.error=t}finally{return e}}shouldTryAgain(e){return!0!==e.succeeded&&e.attempts<3}constructor(e,t,n){this.source=e,this.zcs=t,this.onUpdate=n,this.progressData={overall:{completed:0,total:0},bars:{}},this.dom=new DOMParser().parseFromString(e,"text/xml"),this.reset()}}class t5{async init(){if(this.initialised)return;this.storageAvailable="none"!==this.storageFlag&&void 0!==window&&void 0!==window.navigator&&void 0!==window.navigator.storage,this.persistAvailable=this.storageAvailable&&void 0!==window.navigator.storage.persist,this.mayPersist=this.storageAvailable&&void 0!==window.navigator.storage.persist&&await window.navigator.storage.persist(),this.retrieveAvailable=this.storageAvailable&&void 0!==window.navigator.storage.getDirectory,this.estimateAvailable=this.storageAvailable&&void 0!==window.navigator.storage.estimate;let e={"Workshop dir":this.workshopDir,"Storage Available":this.storageAvailable,"Persist Available":this.persistAvailable,"Retrieve available":this.retrieveAvailable,"Estimate available":this.estimateAvailable,"May Persist":this.mayPersist};if(this.estimateAvailable){let t=await navigator.storage.estimate();e.Quota=t.quota,e.Usage=t.usage}else e.Quota="N/K",e.Usage="N/K";console.table(e),this.initialised=!0}async getAsUrl(e,t){if(!this.initialised)throw"Not initialised";if(e.startsWith("blob:"))return console.debug("getAsUrl","blob: url requested - passing back the same url."),e;let n=await this.getAsEntry(e,t);try{return URL.createObjectURL(n.content)}catch(t){return console.warn("getAsUrl","Unable to create blob URL for: ".concat(e),t),n.sourceUrl}}async getAsEntry(e,t){if(!this.initialised)throw"Not initialised";if(e.startsWith("blob:")){let n=e.substring(5);return await this.getAsEntry(n,t)}let n=this.forceFetch?null:await this.getCacheData(e);if(this.forceFetch&&console.debug("getAsEntry","cache skip for: ".concat(e)),null!==n&&(void 0===n.content||0===n.content.size)&&(n=null),console.debug("getAsEntry","Cache ".concat(null===n?"miss for":"hit for",": ").concat(e)),null===n){try{n=await this.fetchContent({key:e},t)}catch(t){throw console.error("getAsEntry","Unable to fetch data for: ".concat(e),t),t}try{void 0!==n.content&&n.content.size>0?(console.debug("getAsEntry","Cacheing ".concat(n.content.size," bytes of data for: ").concat(e),n),await this.storeCacheData(n)):(void 0===n.content&&console.warn("getAsEntry","Content for ".concat(e," is undefined.")),void 0!==n.content&&0===n.content.size&&console.warn("getAsEntry","Content for ".concat(e," has 0 bytes.")))}catch(t){console.warn("getAsEntry","Unable to cache the data for: ".concat(e),t)}}return n}async storeCacheData(e){if(this.persistAvailable){var t;let n=e.key.split("/").slice(-1)[0],i=new Date;e.created=null!=(t=e.created)?t:i,e.updated=i;let o=await window.navigator.storage.getDirectory(),r=await o.getDirectoryHandle("workshops",{create:!0}),s=await r.getDirectoryHandle(this.workshopDir,{create:!0}),a=await s.getDirectoryHandle("content",{create:!0}),l=await a.getFileHandle(n,{create:!0}),c=await l.createWritable();try{await c.write(e.content)}catch(e){throw console.warn("storeCacheData","error writing to cache",e),e}finally{await c.close(),console.debug("storeCacheData","content stored",e.key)}}}async getCacheData(e){if(!this.retrieveAvailable)return null;try{let t=e.split("/").slice(-1)[0],n=await window.navigator.storage.getDirectory(),i=await n.getDirectoryHandle("workshops",{create:!0}),o=await i.getDirectoryHandle(this.workshopDir,{create:!0}),r=await o.getDirectoryHandle("content",{create:!0}),s=await r.getFileHandle(t),a=await s.getFile();return{key:e,content:a}}catch(e){return console.warn("getCacheData - error encountered, this is a cache miss",e),null}}async fetchContent(e,t){return(await this.fetchContents([e],t))[0]}async fetchContents(e,t){let n=await this.getAccessUrls(e.map(e=>this.fixKeyForS3(e.key))),i=e.map(e=>({key:e.key,url:n.objectKeysToAccessUrls[this.fixKeyForS3(e.key)]}));console.debug("fetchContents","Fetched keysToUrls",i);let o=i.map(e=>this.download(e,t));console.debug("fetchContents","Fetching ".concat(o.length," content items..."));let r=await Promise.all(o);return console.debug("fetchContents","fetch contents complete",r),r}async download(e,t){let n=0;do{try{var i;let n=await fetch(e.url);if(null===n.body)throw"No content found in response for: ".concat(e.key,", at: ").concat(e.url);let o=n.headers.get("Content-Length");if(null===o)throw"Content-Length not found in response for: ".concat(e.key,", at: ").concat(e.url);let r=null!=(i=n.headers.get("Content-Type"))?i:void 0;if(void 0===r)throw"Content-Type not found in response for: ".concat(e.key,", at: ").concat(e.url);console.debug("download","".concat(e.key," content-type: ").concat(r));let s=n.body.getReader(),a=Number.parseInt(o);void 0!==t&&t(e.key,0,a);let l=[],c=0;for(;;){let{done:n,value:i}=await s.read();if(n)break;l.push(i),c+=i.length,void 0!==t&&t(e.key,c,a)}let d=new Uint8Array(c),u=0;for(let e of l)d.set(e,u),u+=e.length;return{content:new Blob(l,{type:r}),sourceUrl:e.url,key:e.key}}catch(t){console.warn("download","Error fetching: ".concat(e.key,", attempt: ").concat(n),t),await new Promise(e=>setTimeout(e,1e3))}n++}while(n<3);throw"Failed to fetch: ".concat(e.key)}async getAccessUrls(e){let t={objectKeys:e.filter(e=>this.isKeyForS3(e))},n=e.filter(e=>!this.isKeyForS3(e));console.debug("getAccessUrls","requests to s3 for:",t);let i=await this.start(this.api.postWorkshopContentAccessRequest(this.session.id,this.sessionToken,t));if((0,u.s)(i))return n.forEach(e=>i.objectKeysToAccessUrls[e]=e),i;throw"No access urls response"}fixKeyForS3(e){if(this.isKeyForS3(e)){e=a().trim(e,"/");let t="workshops/".concat(this.workshopDir,"/");e.startsWith(t)||(e="".concat(t).concat(e))}return e}isKeyForS3(e){return!e.startsWith("https://")&&!e.startsWith("http://")}constructor(e,t,n,i,o,r,s){this.api=e,this.start=t,this.session=n,this.sessionToken=i;let a=o.split("/").slice(-2)[0];this.workshopDir=a,this.forceFetch=r,this.initialised=!1,this.storageAvailable=!1,this.persistAvailable=!1,this.mayPersist=!1,this.retrieveAvailable=!1,this.estimateAvailable=!1,this.storageFlag=s}}var t8=n(78211),t3=function(e){return e[e.Init=0]="Init",e[e.RetrievingRawSlides=1]="RetrievingRawSlides",e[e.RawSlidesError=2]="RawSlidesError",e[e.EnrichingSlides=3]="EnrichingSlides",e[e.EnrichmentError=4]="EnrichmentError",e[e.InflatingSlides=5]="InflatingSlides",e[e.InflationError=6]="InflationError",e[e.Ready=7]="Ready",e}(t3||{});let t4=[0,1],t7=[2,4,6],t6=[3,5],t9=(0,r.createContext)({});function ne(e){let{api:t,start:n}=(0,r.useContext)(e8.F),{session:s}=(0,r.useContext)(e2.$),a=(0,r.useContext)(y.yk),[l,c]=(0,r.useState)(0),[u,p]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),[g,m]=(0,r.useState)(void 0),[f,b]=(0,r.useState)(!0),[v,w]=(0,r.useState)(!1),[j,A]=(0,r.useState)(!1),{storage:k}=(0,r.useContext)(t8.c);(0,r.useEffect)(()=>{switch(console.debug("Static content state",t3[l]),l){case 0:c(1);break;case 1:S().then(e=>{p(e),c(3)}).catch(e=>{console.error(e),c(2)});break;case 3:I().then(e=>{x(e),c(5)}).catch(e=>{console.error(e),c(4)});break;case 5:D().then(e=>{m(e),c(7)}).catch(e=>{console.error(e),c(6)})}b(void 0!==t4.find(e=>e===l)),w(void 0!==t6.find(e=>e===l)),A(void 0!==t7.find(e=>e===l))},[l]);let S=async()=>{let e=[];for(let i of s.sessionPresentationUris||[]){if(!i)throw"Presentation link empty in session data.";let o=new t5(t,n,s,a.sessionToken,i,!0,k);await o.init();let r=i.split("/").pop(),l=await o.getAsEntry(r,void 0),c=await l.content.text();if(!c)throw"No content found in presentation file.";e.push(c)}return e},C=e=>{$.A.emit({type:$.m.Content_Progress_Update,data:e})},I=async()=>{let i=[];for(let o=0;o<u.length;o++){let r=s.sessionPresentationUris[o],l=u[o];if(!r)throw"Presentation link empty in session data.";let c=new t5(t,n,s,a.sessionToken,r,e.refresh,k);await c.init();let d=new t2(l,c,C),p=d.findAllReplacements(void 0,[]);console.debug("".concat(p.length," unique resources to replace"),p);let h=await d.replaceAllReplacements(p),x=d.getAsSectionTags(h,o);if(!x)throw"No sections found in presentation.";i.push(x)}return i},D=async()=>{let i=[];for(let r=0;r<h.length;r++){let l=s.sessionPresentationUris[r],c=h[r];if(!l)throw"Presentation link empty in session data.";if(!c)throw"No content found in presentation xml.";let u=new t5(t,n,s,a.sessionToken,l,e.refresh,k);await u.init();let p={sessionId:s.id,deviceId:a.deviceId,role:a.role,remoteMedia:s.remoteConfiguration!==d.LQ.InPerson,remoteCall:s.remoteConfiguration===d.LQ.RemoteWithVideoCall,keyPrefix:"module-".concat(r),contentStore:u,onAnswer:E},x=(0,o.Ay)(c,tp(p)),g=(x instanceof Array?x:[x]).map((e,t)=>(0,tu.p1)(e,"module-".concat(r))).filter(e=>void 0!==e);i.push(...g)}return i},E=async i=>{var o;return null!=(o=await n(t.postDeliberationAnswer(e.sid,i,a.sessionToken)))?o:null};return(0,i.jsxs)(i.Fragment,{children:[f&&e.init,v&&e.load,j&&e.err,7===l&&(0,i.jsx)(t9.Provider,{value:{sid:e.sid,presentationXml:h,sourceXml:u,slides:g},children:e.children})]})}},25091:(e,t,n)=>{n.d(t,{GG:()=>x,Ay:()=>m,EI:()=>g});var i=n(95155),o=n(32276),r=n(12115),s=n(98314),a=n(78211),l=n(84073),c=n(54884);let d=["Microsoft Teams Audio","ZoomAudioDevice"];var u=n(23387),p=n(80890),h=n(59850);let x=(0,r.createContext)(void 0);function g(){let e=(0,r.useContext)(x);if(void 0===e)throw"Error: this component must be used within a <ZgMeetingConfigProvider>";return e}function m(e){var t,n;let{meetingStatus:g,isStarted:m}=(0,r.useContext)(h.s),f=(0,r.useContext)(a.c),b=(0,o.GYC)(),{isVideoEnabled:v,toggleVideo:y}=(0,o.oCg)(),{muted:w,toggleMute:j}=(0,o.abu)(),[A,k]=(0,r.useState)(),[S,C]=(0,r.useState)(),[I,D]=(0,r.useState)(),{selectedDevice:E,devices:R}=(0,o.xtX)(),{selectedDevice:F,devices:B}=(0,o.gDU)(),{selectedDevice:P,devices:T}=(0,o.O54)(),{isVoiceFocusSupported:q,addVoiceFocus:W}=(0,o.IMw)(),{isBackgroundBlurSupported:N,createBackgroundBlurDevice:M}=(0,o.F6c)(),{session:O}=(0,r.useContext)(s.$),{deviceId:L}=(0,r.useContext)(l.yk),[U,V]=(0,r.useState)(!1),K={settings:{offerVoiceFocus:null!=(t=f.voiceFocus)?t:u.DY,offerBackgroundBlur:null!=(n=f.backgroundBlur)?n:u.YC},preference:(0,c.s)(e.initialPrefs)?{...e.initialPrefs,startMeeting:!0}:u.gZ,current:{isInitialised:!1,isMeetingStarted:m,isAudioEnabled:!w,isVideoEnabled:v,isVoiceFocusEnabled:!1,isVoiceFocusSupported:q,isBackgroundBlurEnabled:!1,isBackgroundBlurSupported:N,audioInputDevice:E,audioOutputDevice:F,videoInputDevice:P,availableAudioInputDevices:A,availableAudioOutputDevices:S,availableVideoInputDevices:I}},[_,z]=(0,r.useState)(K);return(0,r.useEffect)(()=>{_.current.isInitialised||(_.current.isMeetingStarted&&(0,c.s)(_.current.videoInputDevice)&&(0,c.s)(_.current.audioInputDevice)?(console.debug("ZgMeetingConfigProvider: Video call initialised"),z(t=>({...t,preference:{...t.preference,...e.initialPrefs},current:{...t.current,isInitialised:!0}}))):console.warn("ZgMeetingConfigProvider: Video call not initialised",{isMeetingStarted:_.current.isMeetingStarted,videoInputDevice:_.current.videoInputDevice,audioInputDevice:_.current.audioInputDevice}))},[_.current.isInitialised,_.current.isMeetingStarted,_.current.videoInputDevice,_.current.audioInputDevice]),(0,r.useEffect)(()=>{k(R.map(e=>e).filter(e=>!d.some(t=>e.label.toLowerCase().includes(t.toLowerCase())))),C(B.map(e=>e).filter(e=>!d.some(t=>e.label.toLowerCase().includes(t.toLowerCase())))),D(T.map(e=>e).filter(e=>!0))},[R,B,T]),(0,r.useEffect)(()=>{var t;null==(t=e.onUpdatePrefs)||t.call(e,_.preference)},[_.preference]),(0,r.useEffect)(()=>{z(e=>({...e,current:{...e.current,availableAudioInputDevices:A,availableAudioOutputDevices:S,availableVideoInputDevices:I}}))},[A,S,I]),(0,r.useEffect)(()=>{console.debug("Audio enabled: ".concat(!w)),z(e=>({...e,current:{...e.current,isAudioEnabled:!w}}))},[w]),(0,r.useEffect)(()=>{console.debug("Video enabled: ".concat(v)),z(e=>({...e,current:{...e.current,isVideoEnabled:v}}))},[v]),(0,r.useEffect)(()=>{_.current.isInitialised&&(0,c.s)(E)&&_.preference.audio===w&&(console.debug("toggling audio to ".concat(_.preference.audio?"on":"off")),j())},[_.current.isInitialised,_.preference.audio,w,E]),(0,r.useEffect)(()=>{(async()=>{_.current.isInitialised&&(0,c.s)(P)&&_.preference.video!==v&&(console.debug("toggling video to ".concat(_.preference.video?"on":"off")),await y())})()},[_.current.isInitialised,_.preference.video,v,P]),(0,r.useEffect)(()=>{(0,c.s)(E)&&(console.debug("Audio input device started",E),z(e=>({...e,current:{...e.current,audioInputDevice:E,isVoiceFocusEnabled:(0,p.Xb)(E)}})))},[E]),(0,r.useEffect)(()=>{(0,c.s)(F)&&(console.debug("Audio output device started",F),z(e=>({...e,current:{...e.current,audioOutputDevice:F}})))},[F]),(0,r.useEffect)(()=>{(0,c.s)(P)&&(console.debug("Video input device started",P),z(e=>({...e,current:{...e.current,videoInputDevice:P,isBackgroundBlurEnabled:(0,p.wS)(P)}})))},[P]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.l1)(E);if(!(0,c.s)(_.preference.audioDevice))return void z(t=>({...t,preference:{...t.preference,audioDevice:e}}));if(e!==_.preference.audioDevice&&(0,c.s)(_.preference.audioDevice))if((0,p.Xb)(E)&&(0,c.s)(_.preference.audioDevice)&&_.preference.voiceFocus){let e=await E.chooseNewInnerDevice(_.preference.audioDevice);await b.startAudioInputDevice(e)}else await b.startAudioInputDevice(_.preference.audioDevice)};_.current.isInitialised&&e()},[_.current.isInitialised,_.preference.audioDevice,E]),(0,r.useEffect)(()=>{let e=async()=>{if(!(0,c.s)(_.preference.audioOutputDevice))return void z(e=>({...e,preference:{...e.preference,audioOutputDevice:F}}));F!==_.preference.audioOutputDevice&&(0,c.s)(_.preference.audioOutputDevice)&&await b.startAudioOutputDevice(_.preference.audioOutputDevice)};_.current.isInitialised&&e()},[_.current.isInitialised,_.preference.audioOutputDevice,F]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.oq)(P);if(!(0,c.s)(_.preference.videoDevice))return void z(t=>({...t,preference:{...t.preference,videoDevice:e}}));(0,c.s)(_.current.audioInputDevice)&&e!==_.preference.videoDevice&&(0,c.s)(_.preference.videoDevice)&&await b.startVideoInputDevice(_.preference.videoDevice)};_.current.isInitialised&&_.current.isVideoEnabled&&e()},[_.current.isInitialised,_.preference.videoDevice,P,_.current.audioInputDevice,_.current.isVideoEnabled]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.Fp)(_.current.isVoiceFocusSupported,_.preference.voiceFocus,E,W);(0,c.s)(e)&&e!==E&&await b.startAudioInputDevice(e)};_.settings.offerVoiceFocus&&_.current.isInitialised&&e()},[_.current.isInitialised,_.settings.offerVoiceFocus,_.current.isVoiceFocusSupported,_.preference.voiceFocus,E]),(0,r.useEffect)(()=>{let e=async()=>{let e=await (0,p.eb)(_.current.isBackgroundBlurSupported,_.preference.backgroundBlur,P,M);(0,c.s)(e)&&P!==e&&(console.debug("Switching video device (BB)",P,e),await b.startVideoInputDevice(e))};_.settings.offerBackgroundBlur&&_.current.isInitialised&&_.current.isVideoEnabled&&e()},[_.current.isInitialised,_.current.isVideoEnabled,_.settings.offerBackgroundBlur,_.current.isBackgroundBlurSupported,_.preference.backgroundBlur,P]),(0,r.useEffect)(()=>{z(e=>({...e,current:{...e.current,isVoiceFocusSupported:q}}))},[q]),(0,r.useEffect)(()=>{z(e=>({...e,current:{...e.current,isBackgroundBlurSupported:N}}))},[N]),(0,r.useEffect)(()=>{z(e=>({...e,current:{...e.current,isMeetingStarted:m}}))},[m]),(0,r.useEffect)(()=>{z(e=>({...e,current:{...e.current,isMeetingStarted:g===o.e0s.Succeeded}}))},[g]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(x.Provider,{value:{state:_,controls:{selectAudioEnabled:e=>{z(t=>({...t,preference:{...t.preference,audio:e}}))},selectVideoEnabled:e=>z(t=>({...t,preference:{...t.preference,video:e}})),selectAudioDevice:e=>z(t=>({...t,preference:{...t.preference,audioDevice:e}})),selectAudioOutputDevice:e=>z(t=>({...t,preference:{...t.preference,audioOutputDevice:e}})),selectVideoDevice:e=>z(t=>({...t,preference:{...t.preference,videoDevice:e}})),selectVoiceFocus:e=>z(t=>({...t,preference:{...t.preference,voiceFocus:e}})),selectBackgroundBlur:e=>z(t=>({...t,preference:{...t.preference,backgroundBlur:e}})),selectStartMeeting:e=>z(t=>({...t,preference:{...t.preference,startMeeting:e}}))}},children:e.children})})}},25612:(e,t,n)=>{n.d(t,{A:()=>b,j:()=>m});var i=n(95155),o=n(12115),r=n(71450),s=n(2462),a=n(6027),l=n(23971),c=n(18932),d=n(69999),u=n(74821),p=n(54884),h=n(84073),x=n(77914);let g=new u.m,m=(0,o.createContext)({}),f=[c.jB.Online,c.jB.Connecting,c.jB.Connected,c.jB.Joining];function b(e){let t=(0,o.useContext)(h.yk),n=(0,o.useContext)(x.T),u=(0,o.useRef)(void 0),[b,v]=(0,o.useState)(c.jB.Init),y=(0,o.useRef)(void 0),[w,j]=(0,o.useState)(!1),[A,k]=(0,o.useState)(),[S,C]=(0,o.useState)();(0,o.useEffect)(()=>(d.A.on(d.m.WSS_Request_Reconnect,C),d.A.on(d.m.WSS_Request_Disconnect,C),()=>{d.A.off(d.m.WSS_Request_Reconnect,C),d.A.off(d.m.WSS_Request_Disconnect,C)}),[]),(0,o.useEffect)(()=>{if(void 0!==S)switch(S.type){case d.m.WSS_Request_Reconnect:v(c.jB.Connecting);break;case d.m.WSS_Request_Disconnect:v(c.jB.UserDisconnecting)}},[S]);let I=(0,o.useCallback)(e=>{try{return u.current.send(JSON.stringify(e)),!0}catch(e){return console.error("ZgResilientWssConnectionProvider",e),!1}},[u]),[D,E]=(0,o.useState)({state:b,joinedOnce:w,sendMessage:I});(0,o.useEffect)(()=>{let i;k((i=e.sid,{deviceId:t.deviceId,sessionId:i,sessionToken:t.sessionToken,role:t.role,deviceName:void 0,participantName:n.participantName}))},[e.sid,t,n]),(0,o.useEffect)(()=>{E({state:b,joinedOnce:w,sendMessage:I})},[u,b,w,I]),(0,o.useEffect)(()=>{let t=async e=>{if(null==e?void 0:e.data){let t=(0,l.Cb)(JSON.parse(e.data));if(!(0,p.s)(t))return void console.error("ZgResilientWssConnectionProvider: Could not deserialize message.");try{if(await g.acquire(),console.debug("WSS: message received: action = ".concat(t.action,", type = ").concat(t.type)),"send"===t.action)switch(t.type){case"remote-log":switch(t.content.severity){case"debug":console.debug("WSS: Remote debug log",t.content.message);break;case"info":console.info("WSS: Remote info log",t.content.message);break;case"warn":console.warn("WSS: Remote warn log",t.content.message);break;case"error":console.error("WSS: Remote error log",t.content.message);break;default:console.log("WSS: Remote log",t.content.message)}break;case"join-confirmation":console.info("WSS: Join confirmation"),v(c.jB.Joined);break;default:d.A.emit({type:d.m.WSS_Distribute_Message,data:t})}else"user-signals-distribution"===t.type?d.A.emit({type:d.m.User_Signals_Update,data:t.content}):d.A.emit({type:d.m.WSS_Distribute_Message,data:t})}finally{g.release()}}},n=(e,n)=>{try{(0,p.s)(u.current)&&u.current.close()}catch(e){console.warn("ZgResilientWssConnectionProvider",e)}finally{u.current=n?new r.H("wss://im82qhhf54.execute-api.eu-west-1.amazonaws.com/test").withBackoff(new s._(1e3,4)).withBuffer(new a.j).onOpen((e,t)=>{v(c.jB.Connected)}).onReconnect((e,t)=>{v(c.jB.Connected)}).onRetry((e,t)=>{}).onClose((e,t)=>{v(c.jB.Disconnected)}).onError((e,t)=>{v(c.jB.Error)}).onMessage((e,n)=>{t(n)}).build():void 0,v(e)}};if(y.current!==b)switch(console.debug("WSS: state change",c.jB[b]),d.A.emit({type:d.m.WSS_Update_ConnectionState,data:b}),y.current=b,b){case c.jB.Init:if(!(0,p.s)(window)||!(0,p.s)(window.navigator))throw console.error("ZgResilientWssConnectionProvider: Window or navigator is undefined."),"Window undefined.";window.addEventListener("online",()=>{v(c.jB.Online)}),window.addEventListener("offline",()=>{v(c.jB.Offline)}),console.debug("WSS: online = ".concat(window.navigator.onLine)),v(window.navigator.onLine?c.jB.Online:c.jB.Offline);break;case c.jB.Offline:n(c.jB.Offline,!1);break;case c.jB.Online:v(c.jB.Connecting);break;case c.jB.Connecting:n(c.jB.Connected,!0);break;case c.jB.Connected:v(c.jB.Joining);break;case c.jB.Joining:var i,o;console.info("ZgResilientWssConnectionProvider: Joining session...");let h={action:"join",deviceId:A.deviceId,sessionId:A.sessionId,sessionToken:A.sessionToken,deviceName:null!=(i=A.deviceName)?i:null,participantName:null!=(o=A.participantName)?o:null,role:A.role};u.current.send(JSON.stringify(h));break;case c.jB.Joined:j(!0),I({action:"user-signals",content:{signalAction:"snapshot"},sid:e.sid,type:"user-signals-request"});break;case c.jB.Error:setTimeout(()=>{console.debug("ZgResilientWssConnectionProvider: Recreating socket..."),v(c.jB.Connecting)},2e3);break;case c.jB.UserDisconnecting:n(c.jB.Disconnected,!1)}},[A,e.sid,I,b]);let R=b===c.jB.Error;return(0,i.jsxs)(i.Fragment,{children:[R&&!w&&(0,i.jsx)("p",{children:e.error}),!R&&!w&&f.includes(b)&&e.load,w&&(0,i.jsx)(m.Provider,{value:D,children:e.children})]})}},25790:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(95155),o=n(12115),r=n(98314),s=n(80431),a=n(84073),l=n(18932),c=n(25091),d=n(54884);function u(){let{role:e}=(0,o.useContext)(a.yk),{session:t}=(0,o.useContext)(r.$),{slideData:n}=(0,s.Zm)(),u=(0,o.useRef)(void 0),p=(0,o.useContext)(c.GG),h=(0,o.useCallback)(async()=>{let e=new Audio("/sounds/00-ding.mp3");if(e.volume=.5,(0,d.s)(null==p?void 0:p.state.current.audioOutputDevice))if((0,d.s)(e.setSinkId))try{await e.setSinkId(p.state.current.audioOutputDevice)}catch(e){console.warn("Error setting audio output device for SlideTransitionSound",e)}else console.debug("Audio.setSinkId not defined");return e},[p]),x=(0,o.useCallback)(async()=>{(await h()).play()},[h]);return(0,o.useEffect)(()=>{(e===l.sW.Controller||t.remoteConfiguration!==l.LQ.InPerson)&&n.index!==u.current&&n.transitionSound&&(u.current=n.index,x())},[e,t.remoteConfiguration,n.index,n.transitionSound,x]),(0,i.jsx)(i.Fragment,{})}},30349:(e,t,n)=>{n.d(t,{O:()=>r});var i=n(54884),o=n(80015);let r=async(e,t,n,r)=>{let s,a=await t(e.postSessionSnapshotRequest(n,r,o.WT.RequestsToMake)),l={};if((0,i.s)(a)&&a.data.length>0){let c=a.data.map(async s=>{let a=await t(e.postSessionSnapshotRequest(n,r,s.action,s.filter));if((0,i.s)(a))switch(s.action){case o.WT.SessionWithoutCollections:l.sessionWithoutCollections=a.data;break;case o.WT.ChimeMeetingData:l.chimeMeetingData=a.data;break;case o.WT.LiveExperienceState:l.liveExperienceState=a.data;break;case o.WT.ParticipantRecords:l.participantRecords=a.data;break;case o.WT.AnswersByQid:(0,i.s)(l.answers)||(l.answers=[]),l.answers.push(...a.data)}});return await Promise.all(c),s=l.sessionWithoutCollections,(0,i.s)(l.chimeMeetingData)&&(s.chimeMeetingData=l.chimeMeetingData),(0,i.s)(l.liveExperienceState)&&(s.liveExperienceState=l.liveExperienceState),(0,i.s)(l.participantRecords)&&(s.participantRecords=l.participantRecords),(0,i.s)(l.answers)&&(s.answers=l.answers),s}}},39268:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(95155),o=n(29999),r=n(27747),s=n(2021),a=n(99496),l=n(80357),c=n(60193),d=n(80317),u=n(12115),p=n(31240);function h(e){var t,n,h;let x=()=>{if(!1!==e.dismissible){var t;e.setOpen(!1),null==(t=e.onClose)||t.call(e)}},g=(0,u.useId)();return(0,u.useEffect)(()=>{console.debug("dialog open",e.open)},[e.open]),(0,i.jsxs)(r.A,{fullWidth:null==(t=e.fullWidth)||t,maxWidth:null!=(n=e.maxWidth)?n:"sm",open:e.open,disableEscapeKeyDown:!e.dismissible,onClose:x,children:[e.title&&(0,i.jsx)(s.A,{align:"center",children:e.title}),(0,i.jsxs)(a.A,{children:[(null==(h=e.showCloseButton)||h)&&(0,i.jsx)(l.A,{style:{position:"absolute",top:0,right:0},children:(0,i.jsx)(c.A,{"aria-label":"close",onClick:x,children:(0,i.jsx)(o.A,{})})}),(0,i.jsxs)(l.A,{sx:{p:2,gap:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.jsxs)(l.A,{sx:{width:"100%",display:"flex",flexDirection:"start",alignItems:"start"},children:[e.promptGraphicUri&&(0,i.jsx)("img",{src:e.promptGraphicUri,alt:"Illustrative graphic",style:{width:"25%"}}),e.prompt&&(0,i.jsx)(d.A,{variant:"body1",sx:{width:"75%",mb:2,textAlign:"center",textWrap:"balance"},children:e.prompt})]}),e.content,e.options.map(t=>(0,i.jsx)(p.A,{btnKey:"dialog-".concat(g,"-option-").concat(t.key),sx:{width:"66%"},variant:t.filled?"contained":"outlined",color:"buttonStandard",onClick:()=>{var n,i,o;return n=t.key,void(e.setOpen(!1),null==(i=e.onClose)||i.call(e),null==(o=e.onSelect)||o.call(e,n))},btnText:t.text,busy:e.busy},"dialog-".concat(g,"-option-").concat(t.key)))]})]})]})}},39846:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(95155),o=n(49714),r=n(74577),s=n(12115);function a(e){var t;let[n,a]=(0,s.useState)(null!=(t=e.sliderDefault)?t:0),[l,c]=(0,s.useState)("solo"===e.sliderMode?1:.5),d=(0,s.useMemo)(()=>(0,o.Ay)(r.Ay)({color:"secondary",height:"".concat(.8*l,"em"),"& .MuiSlider-thumb":{height:"".concat(1.6*l,"em"),width:"".concat(1.6*l,"em"),backgroundColor:"secondary",boxShadow:"0px 4px 10px 0px rgba(0, 0, 0, 0.25) inset","&::before":{display:"none"}},"& .MuiSlider-rail":{borderRadius:"".concat(.4*l,"em"),boxShadow:"0px 4px 10px 0px rgba(0, 0, 0, 0.25) inset"},"& .MuiSlider-track":{borderRadius:"".concat(.4*l,"em"),boxShadow:"0px 4px 10px 0px rgba(0, 0, 0, 0.25) inset"},"& .MuiSlider-markLabel":{fontSize:"".concat(+l,"rem"),marginTop:"".concat(2.5*l,"em")}}),[l]);return(0,i.jsx)(d,{...e,value:n,onChange:(e,t)=>{a(t)},onChangeCommitted:(t,n)=>{let i=n;e.acceptableRange&&i>e.acceptableRange.max&&(i=e.acceptableRange.max),e.acceptableRange&&i<e.acceptableRange.min&&(i=e.acceptableRange.min),a(i),e.onCommit(i)}})}},45238:(e,t,n)=>{n.d(t,{A:()=>x,K:()=>h});var i=n(95155),o=n(4615),r=n(12115),s=n(98314),a=n(84073),l=n(18414),c=n(18932),d=n(2492),u=n(54884),p=function(e){return e[e.Init=0]="Init",e[e.NoMeeting=1]="NoMeeting",e[e.Joining=2]="Joining",e[e.JoiningError=3]="JoiningError",e[e.Ready=4]="Ready",e}(p||{});let h=(0,r.createContext)({});function x(e){var t,n;let[x,g]=(0,r.useState)(0),{session:m}=(0,r.useContext)(s.$),{api:f,start:b}=(0,r.useContext)(l.F),{deviceId:v,sessionToken:y,user:w}=(0,r.useContext)(a.yk),{participantName:j}=(0,r.useContext)(d.O),[A,k]=(0,r.useState)();(0,r.useEffect)(()=>{0===x&&g(m.remoteConfiguration===c.LQ.RemoteWithVideoCall?2:1)},[x,m]),(0,r.useEffect)(()=>{2!==x||C.current||S()},[x]);let S=async()=>{try{let t=await I();(0,u.s)(t)?(k({zgJoinResponse:t,isPreview:e.isPreview}),g(4)):console.debug("postMeetingJoinRequest superseded")}catch(e){console.error(e),g(3)}};(0,r.useEffect)(()=>{if(!e.isPreview&&4===x){var t,n;(null==(t=m.chimeMeetingData)?void 0:t.chimeMeetingId)!==(null==A||null==(n=A.zgJoinResponse)?void 0:n.chimeMeetingId)&&g(2)}},[null==(t=m.chimeMeetingData)?void 0:t.chimeMeetingId,null==A||null==(n=A.zgJoinResponse)?void 0:n.chimeMeetingId,e.isPreview]),(0,r.useEffect)(()=>{2===x&&(0,u.s)(null==A?void 0:A.zgJoinResponse)&&g(4)},[A]);let C=(0,r.useRef)(!1),I=async()=>{if(!C.current){console.debug("posting meeting join request"),C.current=!0;try{return await b(f.postMeetingJoinRequest(m.id,y,v,e.isPreview,j,null==w?void 0:w.access_token))}catch(e){throw e}finally{C.current=!1}}};return(0,r.useEffect)(()=>{console.debug("MeetingDataProvider state: ".concat(p[x]),A)},[x,A]),(0,i.jsxs)(i.Fragment,{children:[0===x&&(0,i.jsx)(i.Fragment,{children:e.joinView}),2===x&&(0,i.jsx)(i.Fragment,{children:e.joinView}),1===x&&(0,i.jsx)(o.A,{severity:"error",children:"This is not a remote video call workshop."}),3===x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.A,{severity:"error",children:["There was an unexpected error setting up the video call",e.isPreview?" preview":"","."]}),(0,i.jsx)(o.A,{severity:"info",children:"Please reload the page."})]}),4===x&&(null==A?void 0:A.zgJoinResponse)&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(h.Provider,{value:A,children:e.children})})]})}},48484:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(95155),o=n(69999),r=n(80357),s=n(80317),a=n(89041),l=n(12115),c=n(66622);function d(e){let[t,n]=(0,l.useState)(),[d,u]=(0,l.useState)({overall:{completed:0,total:0},bars:{}});return(0,l.useEffect)(()=>(o.A.on(o.m.Content_Progress_Update,n),()=>{o.A.off(o.m.Content_Progress_Update,n)}),[]),(0,l.useEffect)(()=>{void 0!==t&&t.type===o.m.Content_Progress_Update&&u(t.data)},[t]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(c.A,{children:(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.preTitle&&(0,i.jsx)(s.A,{variant:"body1",color:"white",children:e.preTitle}),e.title&&(0,i.jsx)(s.A,{variant:"h2",color:"white",children:e.title}),(0,i.jsx)(a.A,{sx:{mt:4,backgroundColor:"#444444","& .MuiLinearProgress-bar":{backgroundColor:"white"}},value:d.overall.total>0?100*d.overall.completed/d.overall.total:void 0,variant:d.overall.total>0?"determinate":"indeterminate"}),e.bar&&(0,i.jsx)(s.A,{variant:"body2",color:"white",children:e.bar})]})})})}},53285:(e,t,n)=>{n.d(t,{A:()=>ec});var i=n(95155),o=n(98314),r=n(84073),s=n(18932),a=n(23387),l=n(80357),c=n(89041),d=n(4615),u=n(32276),p=n(34824),h=n(12115),x=n(30218),g=n(54884);class m{debug(e){this.logger.debug(e)}info(e){this.logger.info(e)}warn(e){this.logger.warn(e),this.observers.forEach(t=>t(p.LogLevel.WARN,e))}error(e){this.logger.error(e),this.observers.forEach(t=>t(p.LogLevel.ERROR,e))}setLogLevel(e){this.logger.setLogLevel(e)}getLogLevel(){return this.logger.getLogLevel()}addObserver(e){this.observers.push(e)}clearObservers(){this.observers=[]}constructor(e){this.logger=new p.ConsoleLogger("ZgObservableLogger",e),this.observers=[]}}let f=(0,h.createContext)({}),b=(0,h.memo)(function(e){let[t]=(0,h.useState)(new m(e.level)),[n,o]=(0,h.useState)({logger:t}),r=(0,h.useRef)(void 0),s=(0,h.useRef)(void 0);(0,h.useEffect)(()=>((0,g.s)(window)&&(r.current=window.onerror,window.onerror=a,console.debug("Captured window.onerror"),s.current=console.error,console.error=l,console.debug("Captured console.error")),t.addObserver((e,t)=>{o({...n,lastLog:{level:e,msg:t}})}),()=>{t.clearObservers(),(0,g.s)(window)&&(0,g.s)(r.current)&&(window.onerror=r.current),(0,g.s)(s.current)&&(console.error=s.current)}),[]);let a=(0,h.useCallback)((e,t,i,s,a)=>{if((0,g.s)(e)){var l;null==(l=r.current)||l.call(r,e,t,i,s,a),o({...n,lastLog:{level:0,msg:"[WINDOW] ".concat(null==a?void 0:a.message)}})}},[r,o]),l=(0,h.useCallback)(function(){for(var e,t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];(0,g.s)(i)&&(null==(e=s.current)||e.call(s,...i),o({...n,lastLog:{level:1,msg:JSON.stringify([...i])}}))},[s,o]);return(0,i.jsx)(f.Provider,{value:n,children:(0,i.jsx)(u.IBQ,{logger:t,children:e.children})})},()=>!0);function v(e){let{logger:t}=(0,h.useContext)(f);return(0,i.jsx)(u.DNH,{options:{logger:t},children:e.children})}var y=n(25612),w=n(25091),j=n(80890),A=n(59850);function k(e){let{state:t}=(0,h.useContext)(y.j),{state:n}=(0,w.EI)(),{meetingStatus:o}=(0,h.useContext)(A.s),{lastLog:r}=(0,h.useContext)(f),s=(0,u.GYC)(),{selectedDevice:a}=(0,u.xtX)(),l=(0,u.j6L)(),[c,d]=(0,h.useState)(),[x]=(0,h.useState)({voiceFocusFellBackToInnerStream:(e,t)=>{console.warn("VoiceFocus fell back to inner stream",e,t)},voiceFocusInsufficientResources:()=>{console.warn("VoiceFocus insufficient resources")}});(0,h.useEffect)(()=>{a!==c&&(0,j.Xb)(c)&&c.removeObserver(x),d(a),(0,j.Xb)(a)&&a.addObserver(x)},[a]);let m=(0,h.useRef)(!1),b=async e=>{if(o!==u.e0s.Succeeded)return void console.debug("ZgChimeMonitor: Meeting not in Succeeded state, not restarting audio input.");if(m.current)return void console.debug("ZgChimeMonitor: Already restarting audio input.");m.current=!0,console.debug("ZgChimeMonitor: Restarting audio input shortly..."),await new Promise(t=>setTimeout(t,e)),console.debug("ZgChimeMonitor: Restarting audio input now."),m.current=!0;try{var t,i;let e=(0,j.Xb)(c)?c.getInnerDevice():(0,g.s)(c)?c:null!=(i=n.preference.audioDevice)?i:null==(t=s.audioInputDevices)?void 0:t[0];if(console.info("ZgChimeMonitor: Restarting audio input device",e),(0,g.s)(e)){if((0,j.Xb)(c))try{await c.stop()}catch(e){console.warn("Error encountered stopping audio transform device.",e)}await s.startAudioInputDevice(e)}else throw"No device preferences found."}catch(e){console.error("ZgChimeMonitor: Failed to restart audio input device",e)}finally{m.current=!1}};(0,h.useEffect)(()=>{void 0!==r&&(r.msg.includes("SendingAudioFailure health policy maximum warnings breached.")&&(console.warn("ZgChimeMonitor: Detected audio failure log."),b(0)),r.msg.includes("Cannot read properties of undefined (reading 'destroy_audio_buffer')")&&(console.warn("ZgChimeMonitor: Detected uncaught transform error log."),b(0)))},[r]);let v=["signalingDropped","sendingAudioFailed","meetingReconnected"];(0,h.useEffect)(()=>{void 0!==l&&(console.debug("ZgChimeMonitor: Meeting event",l.name),v.some(e=>e===l.name)&&!m.current&&b(2e3))},[l]);let k=(0,h.useRef)(!1);(0,h.useEffect)(()=>{console.debug("ZgChimeMonitor: Meeting status: ".concat(u.e0s[o])),o===u.e0s.Succeeded&&k.current&&b(0),k.current=!0},[o]),(0,h.useEffect)(()=>{o===u.e0s.Succeeded?p.DefaultDeviceController.getAudioContext().addEventListener("statechange",S):p.DefaultDeviceController.getAudioContext().removeEventListener("statechange",S)},[]);let S=(0,h.useCallback)(async e=>{let t=p.DefaultDeviceController.getAudioContext();if("suspended"===t.state)for(console.warn("ZgChimeMonitor: Audio context state: ".concat(t.state));"suspended"===t.state;)await t.resume(),await new Promise(e=>setTimeout(e,100)),"suspended"===t.state&&console.warn("ZgChimeMonitor: Failed to resume audio context - attempt ".concat(1," of 10."))},[]),C=(0,h.useRef)(void 0),[I,D]=(0,h.useState)(),[E,R]=(0,h.useState)();return(0,h.useEffect)(()=>{var e;D(null==(e=n.current.availableAudioInputDevices)?void 0:e.find(e=>"default"===e.deviceId))},[n.current.availableAudioInputDevices]),(0,h.useEffect)(()=>{(async e=>{R(await (0,u.IPJ)(e))})(n.current.audioInputDevice)},[n.current.audioInputDevice]),(0,h.useEffect)(()=>{"default"===E&&(0,g.s)(I)&&(0,g.s)(C.current)&&I.label!==C.current.label&&b(0),C.current=I},[I]),(0,i.jsx)(i.Fragment,{children:e.children})}var S=n(45238),C=n(69999);function I(e){let[t,n]=(0,h.useState)({}),[o,a]=(0,h.useState)(!1),[l,c]=(0,h.useState)(),{deviceId:d,role:u}=(0,h.useContext)(r.yk),p=(0,w.EI)(),[x,g]=(0,h.useState)();(0,h.useEffect)(()=>(C.A.on(C.m.WSS_Distribute_Message,g),C.A.on(C.m.Media_Playback_Update,g),()=>{C.A.off(C.m.WSS_Distribute_Message,g),C.A.off(C.m.Media_Playback_Update,g)}),[]),(0,h.useEffect)(()=>{if(void 0!==x)switch(x.type){case C.m.WSS_Distribute_Message:f(x.data);break;case C.m.Media_Playback_Update:m(x.data)}},[x]);let m=e=>{n({...t,[e.videoId]:{update:e}})};(0,h.useEffect)(()=>{a(Object.entries(t).some(e=>e[1].update.isPlaying))},[t]),(0,h.useEffect)(()=>{o&&(c(p.state.current.isAudioEnabled),p.state.current.isAudioEnabled&&(u===s.sW.Controller&&Object.entries(t).some(e=>{let[t,n]=e;return!0===n.update.isPlaying&&!1===n.update.muteFacilitator})||p.controls.selectAudioEnabled(!1))),o||void 0===l||p.state.current.isAudioEnabled===l||p.controls.selectAudioEnabled(l)},[o]);let f=e=>{"mute-update"===e.type&&b(e.content.pids)},b=e=>{p.state.current.isAudioEnabled&&(e.some(e=>e===d)||e.some(e=>"*"===e))&&p.controls.selectAudioEnabled(!1)};return(0,i.jsx)(i.Fragment,{children:e.children})}var D=n(62652),E=n(48484);function R(e){let[t,n]=(0,h.useState)(),{zgJoinResponse:o}=(0,h.useContext)(S.K);return(0,h.useEffect)(()=>{console.debug("ZgVoiceFocus notes a change in joinResponse",o),(0,g.s)(null==o?void 0:o.createMeetingResponseJson)&&n(JSON.parse(o.createMeetingResponseJson))},[o]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(u.GZo,{options:{preload:!0},createMeetingResponse:t,children:e.children})})}let F=(0,h.memo)(function(e){return(0,h.useEffect)(()=>{console.debug("Meeting preferences updated:",e.preferences)},[e.preferences]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(b,{level:p.LogLevel.WARN,children:(0,i.jsx)(u.Fjh,{children:(0,i.jsx)(S.A,{joinView:(0,i.jsx)(()=>(0,i.jsxs)(i.Fragment,{children:[e.isPreview&&(0,i.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsx)(c.A,{}),(0,i.jsx)(d.A,{severity:"info",children:"Setting up video call preview..."})]}),!e.isPreview&&(0,i.jsx)(E.A,{preTitle:(0,i.jsx)(D.A,{i18nKey:"onboarding.thanks"}),title:(0,i.jsx)(D.A,{i18nKey:"onboarding.almostThere"}),bar:"Connecting your video call..."})]}),{}),isPreview:e.isPreview,children:(0,i.jsx)(v,{children:(0,i.jsx)(A.A,{children:(0,i.jsx)(R,{children:(0,i.jsx)(w.Ay,{initialPrefs:e.preferences,onUpdatePrefs:e.onUpdatePrefs,children:(0,i.jsx)(I,{children:(0,i.jsx)(k,{children:(0,i.jsx)(x.NP,{theme:u._kl,children:e.children})})})})})})})})})})})});var B=n(31240),P=n(57476),T=n(77757),q=n(13202);let W=(0,h.memo)(function(e){let[t,n]=(0,h.useState)(!1),{role:o}=(0,h.useContext)(r.yk),s=(0,h.useRef)(void 0);return(0,h.useEffect)(()=>{e.onSubmitPreferences(t,s.current)},[t]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(l.A,{className:"preview-call-and-alert-container",sx:{display:"flex",flexDirection:"column",gap:1,height:"45vh",width:"100%"},children:(0,i.jsx)(F,{isPreview:!0,preferences:void 0,onUpdatePrefs:e=>{s.current=e},children:(0,i.jsx)(T.Ay,{role:o,children:(0,i.jsxs)(l.A,{className:"preview-call-container",sx:{backgroundColor:"callControlPanelBackground.main",borderRadius:"10px",display:"flex",flexDirection:"column",height:"100%"},children:[(0,i.jsx)(q.A,{isPreview:!0}),(0,i.jsxs)(l.A,{className:"preview-call-controls-container",sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",pl:2},children:[(0,i.jsx)(P.Ay,{direction:"row",showAudioConfigMenu:!0,showCameraConfigMenu:!0,busy:!1,isPreview:!0}),(0,i.jsx)(l.A,{className:"join-button-container",sx:{alignContent:"center"},children:(0,i.jsx)(e=>{let{intent:t}=e;return console.debug("Button with intent to join:",t),(0,i.jsx)(B.A,{btnKey:"join",disableFocusRipple:!0,sx:e=>({backgroundColor:"callControlButton.main",color:"buttonStandard.main",mr:2,my:1,"&:hover":{backgroundColor:"callControlButton.light"},"&:focus-visible":{...e.customStyles.focusRingReverse,outlineOffset:"2px"}}),variant:t?"outlined":"contained",onClick:e=>n(!t),btnText:t?(0,i.jsx)(D.A,{i18nKey:"onboarding.leaveWorkshop"}):(0,i.jsx)(D.A,{i18nKey:"onboarding.joinWorkshop"})})},{intent:t})})]})]})})})})})},(e,t)=>!0);var N=n(58375),M=n(10310),O=n(66622),L=n(18414);function U(e){let{sid:t,period_ms:n=3e4,enabled:i=!0,duration_ms:o=6e5}=e,r=(0,h.useRef)(null),s=(0,h.useRef)(Date.now()),[a,l]=(0,h.useState)(),{api:c,start:d}=(0,h.useContext)(L.F);return(0,h.useEffect)(()=>(s.current=Date.now(),r.current=setInterval(async()=>{let e=Date.now()-s.current;if(i&&("indefinite"===o||e<=o)){let e=await d(c.getBasicDeliberationSession(t,"session-state-poll"));(0,g.s)(e)&&l(e)}},n),()=>{(0,g.s)(r.current)&&clearInterval(r.current)}),[t,n,o,i]),{session:a}}var V=n(80317),K=n(24274);function _(){let{setParticipantSessionFlags:e}=(0,h.useContext)(N.C),{sid:t}=(0,h.useContext)(M.L),{t:n}=(0,K.Bd)(),{session:o}=U({sid:t});(0,h.useEffect)(()=>{C.A.emit({type:C.m.WSS_Request_Disconnect})},[]),(0,h.useEffect)(()=>{(0,g.s)(o)&&o.facilitationState===s.ve.Closed&&r()},[o]);let r=()=>{e({leftTheWorkshop:!1}),C.A.emit({type:C.m.WSS_Request_Reconnect})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{color:"white",sx:{mb:4},variant:"h1",children:(0,i.jsx)(D.A,{i18nKey:"workshop.participantLeftHeading"})}),(0,i.jsx)(V.A,{color:"white",sx:{mb:6},variant:"h2",children:(0,i.jsx)(D.A,{i18nKey:"workshop.participantLeftGuidance"})}),(0,i.jsx)(B.A,{color:"buttonReverse",btnText:n("workshop.rejoinCta"),btnKey:"start",onClick:r})]})}var z=n(37440),H=n(52769);function G(e){let t="collective.intelligence@nesta.org.uk",n=e.showHeading,o=e.showSignupMethods&&!0,[r,a]=(0,h.useState)(),{sid:c}=(0,h.useContext)(M.L),{session:d}=U({sid:c});(0,h.useEffect)(()=>{C.A.emit({type:C.m.WSS_Request_Disconnect})},[]),(0,h.useEffect)(()=>{(0,g.s)(d)&&d.facilitationState!==s.ve.Closed&&u()},[d]);let u=()=>{C.A.emit({type:C.m.WSS_Request_Reconnect})};return(0,h.useEffect)(()=>{{let e="".concat(window.location.host,"/signup");H.toDataURL(e).then(e=>{a(e)}).catch(e=>{a(void 0),console.error(e)})}},[!0]),(0,i.jsxs)(l.A,{color:"#fff",sx:{display:"flex",flexDirection:"column",gap:"1.5vh"},children:[n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{variant:"h2",sx:{fontWeight:"bold"},children:(0,i.jsx)(D.A,{i18nKey:"onboarding.sessionClosed.sessionIsClosedRegisterLinkAvailable"})}),(0,i.jsx)(V.A,{color:"white",component:"h2",variant:"h5",sx:{mt:1},children:(0,i.jsx)(D.A,{i18nKey:"onboarding.sessionClosed.encouragement"})})]}),o&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(l.A,{children:[(0,i.jsx)(V.A,{sx:{borderTop:n?"1px solid #fff;":"none",mt:2*!!n,pt:3*!!n},children:(0,i.jsx)(D.A,{i18nKey:"onboarding.sessionClosed.visitWebsite"})}),(0,i.jsx)(z.A,{href:"/signup",target:"_blank",variant:"h3",color:"#fff",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.sessionClosed.signUpText"})}),r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{sx:{pt:2},children:(0,i.jsx)(D.A,{i18nKey:"onboarding.sessionClosed.orScanQrCode"})}),(0,i.jsx)("img",{alt:"QR code for signup link: ".concat(window.location.host,"/signup}"),src:r,style:{borderRadius:"5px",marginTop:"0.5rem",height:"175px",width:"175px"}})]}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{sx:{borderTop:"1px solid #ffffffff;",mt:3,pt:3},children:(0,i.jsx)(D.A,{i18nKey:"onboarding.sessionClosed.emailUs"})}),(0,i.jsx)(z.A,{href:"mailto:".concat(t),target:"_blank",variant:"h5",color:"#fff",children:t})]})]})})]})}var Z=n(79005),J=n(90073);function Q(e){return(0,i.jsxs)(J.A,{sx:{display:"flex",flexDirection:"column",gap:1,pt:4},children:[e.session.facilitationState>=s.ve.Closed&&(0,i.jsx)(d.A,{severity:"warning",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.thisWorkshopIsClosed"})}),e.session.facilitationState===s.ve.Open&&!e.banned&&(0,i.jsxs)(d.A,{severity:"success",children:[(0,i.jsx)(D.A,{i18nKey:"onboarding.thisWorkshopIsOpen"}),(0,i.jsx)("br",{}),(0,i.jsx)(D.A,{i18nKey:"onboarding.pressJoinToEnter"})]}),e.banned&&(0,i.jsx)(d.A,{severity:"error",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.youAreRemoved"})})]})}function Y(e){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{variant:"body1",color:"white",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.youAreAboutToJoin"})}),(0,i.jsx)(Z.A,{session:e.session,welcome:!1,layout:"column",white:!0}),(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"column",gap:1,mt:4},children:(0,i.jsx)(Q,{session:e.session,banned:!0})})]})}var X=n(91028),$=n(39620),ee=n(25148),et=n(2218),en=n(14962),ei=n(77524),eo=n(24251);function er(){let[e,t]=(0,h.useState)(!1),[n,o]=(0,h.useState)(!1),[r,s]=(0,h.useState)(!1);(0,h.useEffect)(()=>{e&&setTimeout(()=>{s(!0)},3e3)},[e]);let[a]=(0,X.Q)();return(0,i.jsxs)(en.A,{children:[(0,i.jsx)(ei.A,{expandIcon:(0,i.jsx)($.A,{}),"aria-controls":"support-panel-content",id:"support-panel",children:(0,i.jsx)(V.A,{variant:"body1",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.supportInfoHeading"})})}),(0,i.jsx)(eo.A,{children:(0,i.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:1},ref:a,children:[(0,i.jsx)(V.A,{variant:"body2",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.supportInfoText1"})}),(0,i.jsx)(B.A,{variant:"outlined",btnKey:"reconnect",size:"small",busy:n,startIcon:(0,i.jsx)(ee.A,{}),onClick:()=>{C.A.emit({type:C.m.WSS_Refresh_Session}),o(!0),setTimeout(()=>{o(!1),t(!0)},2e3)},btnText:(0,i.jsx)(D.A,{i18nKey:"button.reconnect"})}),r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{variant:"body2",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.supportInfoText2"})}),(0,i.jsx)(B.A,{variant:"outlined",btnKey:"reconnect",size:"small",startIcon:(0,i.jsx)(et.A,{}),onClick:()=>window.location.reload(),btnText:(0,i.jsx)(D.A,{i18nKey:"button.reload"})})]})]})})]})}function es(e){let t=e=>e.facilitationState===s.ve.Ready;return console.debug("session join info: start intention = ",e.startIntention),console.debug("session join info: isWaiting = ",t(e.session)),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.A,{variant:"body1",color:"white",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.youAreAboutToJoin"})}),(0,i.jsx)(Z.A,{session:e.session,welcome:!1,layout:"column",white:!0}),(0,i.jsx)(Q,{session:e.session,banned:e.banned}),e.startIntention&&t(e.session)&&(0,i.jsxs)(J.A,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsx)(d.A,{severity:"info",children:(0,i.jsx)(D.A,{i18nKey:"onboarding.waitingForOpen"})}),(0,i.jsx)(er,{})]})]})}let ea=e=>e.remoteConfiguration===s.LQ.RemoteWithVideoCall;function el(e){let{session:t}=(0,h.useContext)(o.$),{publicContent:n}=(0,h.useContext)(M.L),{deviceId:a}=(0,h.useContext)(r.yk),[l,c]=(0,h.useState)(!1);console.debug("ZgOnboardingMeetingSetup render"),(0,h.useEffect)(()=>{(0,g.s)(t.deviceIdBanList)&&c(t.deviceIdBanList.includes(a))},[t,a]);let d=t.facilitationState===s.ve.Closed&&e.role===s.sW.Client;return(0,i.jsxs)(i.Fragment,{children:[l&&(0,i.jsx)(O.A,{background:!0,rightPanel:void 0,privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,i.jsx)(Y,{session:t})}),d&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(O.A,{background:!0,rightHalfBackground:"#3E7075CC",rightPanel:(0,i.jsx)(G,{showHeading:!1,showSignupMethods:!0}),privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,i.jsx)(G,{showHeading:!0,showSignupMethods:!1})})}),!d&&e.participantLeft&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(O.A,{background:!0,rightHalfBackground:"#3E7075CC",privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,i.jsx)(_,{})})}),!l&&!d&&!e.participantLeft&&(0,i.jsxs)(i.Fragment,{children:[ea(t)&&(0,i.jsx)(O.A,{background:!1,rightPanel:e.videoCallPreview,privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,i.jsx)(es,{session:t,banned:l,role:e.role,startIntention:e.startIntention})}),!ea(t)&&(0,i.jsx)(O.A,{background:!1,rightPanel:void 0,privacyNotice:!0,workshopInformationUrl:n.workshopInformationUrl,children:(0,i.jsx)(es,{session:t,banned:l,role:e.role,startIntention:e.startIntention})})]})]})}function ec(e){var t;let{session:n}=(0,h.useContext)(o.$),{deviceId:l}=(0,h.useContext)(r.yk),{participantSessionFlags:c}=(0,h.useContext)(N.C),d=n.remoteConfiguration===s.LQ.RemoteWithVideoCall,u=(0,h.useRef)(void 0),[p,x]=(0,h.useState)(!1),[g,m]=(0,h.useState)(!1),[f,b]=(0,h.useState)(!d),[v,y]=(0,h.useState)(!1),w=(0,h.useCallback)((e,t)=>{console.debug("onStartIntention",e,t),u.current=t,b(e)},[]);return(0,h.useEffect)(()=>{console.debug("deviceId changed",l)},[l]),(0,h.useEffect)(()=>{var e,t;x(n.facilitationState===s.ve.Open),m(null!=(t=null==(e=n.deviceIdBanList)?void 0:e.includes(l))&&t)},[n]),(0,h.useEffect)(()=>{let t,n;y((t=e.role,n=null==c?void 0:c.leftTheWorkshop,f&&(p||t===s.sW.Controller)&&(!g||t===s.sW.Controller)&&(!n||t===s.sW.Controller)))},[p,f,g,e.role,null==c?void 0:c.leftTheWorkshop]),(0,i.jsxs)(i.Fragment,{children:[!v&&(0,i.jsx)(el,{participantLeft:null==c?void 0:c.leftTheWorkshop,role:e.role,startIntention:f,videoCallPreview:d?(0,i.jsx)(W,{onSubmitPreferences:w}):void 0}),v&&d&&(0,i.jsx)(F,{isPreview:!1,preferences:null!=(t=u.current)?t:a.gZ,children:e.children}),v&&!d&&(0,i.jsx)(i.Fragment,{children:e.children})]})}},55279:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(79200),o=n(12115);function r(e){let{allUserSignals:t}=(0,o.useContext)(i.F);return e?t.find(t=>t.senderDeviceId===e):void 0}},57300:(e,t,n)=>{n.d(t,{A:()=>g,f:()=>x});var i=n(95155),o=n(46671),r=n.n(o),s=n(12115),a=n(60071),l=n(69999),c=n(74821),d=n(54884),u=n(98314),p=n(84073);let h=new c.m,x=(0,s.createContext)({});function g(e){let t=(0,s.useContext)(p.yk),{session:n}=(0,s.useContext)(u.$),[o,c]=(0,s.useState)([]),[g,m]=(0,s.useState)(o.find(e=>e.deviceId===t.deviceId)),[f,b]=(0,s.useState)([]),[v,y]=(0,s.useState)();return(0,s.useEffect)(()=>(l.A.on(l.m.WSS_Distribute_Message,y),()=>{l.A.off(l.m.WSS_Distribute_Message,y)}),[]),(0,s.useEffect)(()=>{if((0,d.s)(v)&&v.type===l.m.WSS_Distribute_Message){var e=v.data;if("distribute"===e.action&&"ZgDiff"===e.type){let t=e.content;"subscriptions"===t.updateTarget&&(e=>{h.acquire();try{c(e)}finally{h.release()}})(e=>(e=>{let t=r().uniq(e.filter(t=>e.filter(e=>e.subscriptionId===t.subscriptionId).length>1).map(e=>e.subscriptionId)),n=r().uniq(e.filter(t=>e.filter(e=>e.deviceId===t.deviceId).length>1).map(e=>e.deviceId));return t.length>0&&console.warn("Obvious duplicate subscriptions: ".concat(t.join(", "))),n.length>0&&console.warn("Duplicate dids: ".concat(n.join(", "))),e.filter((t,i)=>!n.includes(t.deviceId)||i===e.findLastIndex(e=>e.deviceId===t.deviceId))})((0,a.$)(e,t)))}}},[v]),(0,s.useEffect)(()=>{let e=o.filter(e=>e.deviceId===t.deviceId);e.length>1&&console.warn("Multiple subscriptions found for deviceId: ".concat(t.deviceId)),m(e.at(-1))},[o,t]),(0,s.useEffect)(()=>{var e;b(null!=(e=n.deviceIdBanList)?e:[])},[n.deviceIdBanList]),(0,i.jsx)(x.Provider,{value:{subscriptions:o,thisUser:g,deviceIdBanList:f},children:e.children})}},57476:(e,t,n)=>{n.d(t,{LL:()=>z,jg:()=>H,xP:()=>G,Ui:()=>Z,CX:()=>J,Ay:()=>Q,E0:()=>_});var i=n(95155),o=n(78211),r=n(84073),s=n(10310),a=n(18414),l=n(18932),c=n(62652),d=n(31240),u=n(54884),p=n(25789),h=n(80357),x=n(80317),g=n(32276),m=n(39142),f=n(71385),b=n(12115),v=n(25091),y=n(80890),w=n(84389),j=n(34804),A=n(19131),k=n(23405),S=n(45279),C=n(48464),I=n(39970),D=n(5917),E=n(35130),R=n(88379),F=n(90073);function B(e){let t=(0,g.YGn)(),[n,o]=(0,b.useState)(0),{muted:r}=(0,g.abu)(),s=(0,b.useCallback)(e=>{r?o(0):o(parseFloat(e.toFixed(2)))},[o,r]);(0,g.q8N)(s);let a=e=>(0,i.jsx)(F.A,{sx:{borderWidth:1,flexGrow:1,height:"".concat(.25,"rem"),borderTopLeftRadius:e.isStart?"".concat(.125,"rem"):0,borderBottomLeftRadius:e.isStart?"".concat(.125,"rem"):0,borderTopRightRadius:e.isEnd?"".concat(.125,"rem"):0,borderBottomRightRadius:e.isEnd?"".concat(.125,"rem"):0,backgroundColor:n>=e.min?e.indicatorColor:"transparent",...e.sx}});return(0,i.jsxs)(F.A,{sx:{display:"flex",flexDirection:"row",gap:0,...e.sx},children:[!r&&Array(20).fill(void 0).map((e,t)=>.05*t).map((e,o)=>(0,i.jsx)(a,{min:e,value:n,indicatorColor:"callControlMenuItem.main",isStart:0===o,isEnd:e<=n&&n<e+.05},"meter-".concat(t,"-cell-").concat(o))),r&&(0,i.jsx)(c.A,{i18nKey:"audio.muted"})]})}function P(e){let t=(0,p.A)(),n=async()=>{let t=new Audio("/sounds/00-ding.mp3");if(t.volume=.5,(0,u.s)(e.config.state.current.audioOutputDevice))if((0,u.s)(t.setSinkId))try{await t.setSinkId(e.config.state.current.audioOutputDevice)}catch(e){console.warn("Error setting audio output device for AudioMenu (test speaker)",e)}else console.debug("Audio.setSinkId not defined");return t},o=(0,b.useCallback)(async()=>{(await n()).play()},[n]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.A,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),(0,i.jsx)(j.A,{disableSticky:!0,sx:{backgroundColor:"transparent",py:Z},children:(0,i.jsx)(A.A,{sx:{color:"callControlMenuItem.main",pl:G,userSelect:"none"},children:(0,i.jsx)("b",{children:(0,i.jsx)(c.A,{i18nKey:"audio.audioOutputSelection"})})})}),e.audioOutputDeviceList.map(t=>(0,i.jsxs)(k.A,{disableRipple:!0,onClick:()=>{var n;return n=t.deviceType.deviceId,void e.config.controls.selectAudioOutputDevice(n)},sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[t.selected&&(0,i.jsx)(S.A,{sx:{color:"callControlButton.main"},children:(0,i.jsx)(D.A,{})}),(0,i.jsx)(A.A,{inset:!t.selected,sx:{color:t.selected?"callControlButton.main":"callControlMenuItem.main"},children:_(t.deviceType)})]},"menu-item-select-".concat(t.deviceType.label))),(0,i.jsx)(w.A,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),(0,i.jsxs)(k.A,{disableRipple:!1,sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),onClick:()=>{o()},children:[(0,i.jsx)(S.A,{children:(0,i.jsx)(E.A,{color:t.palette.callControlButtonIcon.main,size:"1.25rem"})}),(0,i.jsx)(A.A,{sx:{color:"callControlMenuItem.main"},children:"Test speaker"})]},"menu-item-output-audio-test")]})}function T(e){var t,n;let o=(0,p.A)(),r=async t=>{e.config.controls.selectVoiceFocus(t)},s=e.config.state.settings.offerVoiceFocus&&!0===e.config.state.current.isVoiceFocusSupported;return(0,i.jsxs)(C.A,{...(0,R.NA)(e.popupState),anchorPosition:{left:null==(t=e.popupState.anchorEl)?void 0:t.getBoundingClientRect().left,top:(null==(n=e.popupState.anchorEl)?void 0:n.getBoundingClientRect().top)-H},anchorReference:"anchorPosition",sx:J,transformOrigin:{vertical:"bottom",horizontal:"left"},children:[(0,i.jsx)(j.A,{disableSticky:!0,sx:{backgroundColor:"transparent",py:Z},children:(0,i.jsx)(A.A,{sx:{color:"callControlMenuItem.main",pl:G,userSelect:"none"},children:(0,i.jsx)("b",{children:(0,i.jsx)(c.A,{i18nKey:"audio.audioInputSelection"})})})}),e.audioInputDeviceList&&e.audioInputDeviceList.map(t=>(0,i.jsxs)(k.A,{disableRipple:!0,onClick:()=>{var n;return n=t.deviceType.deviceId,void e.config.controls.selectAudioDevice(n)},sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[t.selected&&(0,i.jsx)(S.A,{sx:{color:"callControlButton.main"},children:(0,i.jsx)(D.A,{})}),(0,i.jsx)(A.A,{inset:!t.selected,sx:{color:t.selected?"callControlButton.main":"callControlMenuItem.main"},children:_(t.deviceType)})]},"menu-item-select-".concat(t.deviceType.label))),s&&(0,i.jsx)(w.A,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),s&&(0,i.jsxs)(k.A,{disableRipple:!0,onClick:()=>r(!e.config.state.current.isVoiceFocusEnabled),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.config.state.current.isVoiceFocusEnabled&&(0,i.jsx)(S.A,{sx:{color:e.config.state.current.isVoiceFocusEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,i.jsx)(D.A,{})}),(0,i.jsx)(A.A,{inset:!e.config.state.current.isVoiceFocusEnabled,sx:{color:e.config.state.current.isVoiceFocusEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,i.jsx)(c.A,{i18nKey:"audio.reduceBackgroundNoise"})})]},"menu-item-select-voice-focus"),e.showAudioInputVisualisation&&(0,i.jsx)(w.A,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),e.showAudioInputVisualisation&&(0,i.jsxs)(I.Ay,{sx:{mb:1},children:[(0,i.jsx)(S.A,{sx:{minWidth:"36px"},children:(0,i.jsx)(m.A,{color:o.palette.callControlButtonIcon.main,size:"1.25rem"})}),(0,i.jsx)(A.A,{sx:{pl:0},children:(0,i.jsx)(B,{sx:{width:"100%",minWidth:"100px",userSelect:"none",color:"callControlMenuItem.main"}})})]},"menu-item-input-audio-visualisation"),e.audioOutputDeviceList&&0!==e.audioOutputDeviceList.length&&(0,i.jsx)(P,{config:e.config,audioOutputDeviceList:e.audioOutputDeviceList})]})}var q=n(19672),W=n(50533),N=n(53e3),M=n(60193),O=n(24274);function L(e){let{t}=(0,O.Bd)(),n="";return"audio"===e.control?n=t("audio.settingsMenu"):"camera"===e.control&&(n=t("video.settingsMenu")),(0,i.jsx)(M.A,{disabled:e.busy,disableFocusRipple:!0,"aria-label":n,...(0,R.cO)(e.popupState),sx:t=>({backgroundColor:e.enabled?"callControlMenuButton.main":"callControlButtonOff.dark",borderRadius:"30px",height:"100%",pl:"10px",pr:"calc(".concat(z," + 6px)"),"&:hover":{backgroundColor:e.enabled?"callControlButton.main":"callControlButtonOff.dark"},"&:focus-visible":{...t.customStyles.focusRingReverse}}),children:e.popupState.isOpen?(0,i.jsx)(W.A,{sx:{color:"callControlButtonIcon.main"}}):(0,i.jsx)(N.A,{sx:{color:"callControlButtonIcon.main"}})})}var U=n(26667);function V(e){var t,n;let o=async t=>{e.config.controls.selectBackgroundBlur(t)},r=e.config.state.settings.offerBackgroundBlur&&!0===e.config.state.current.isBackgroundBlurSupported;return(0,i.jsxs)(C.A,{...(0,R.NA)(e.popupState),anchorPosition:{left:null==(t=e.popupState.anchorEl)?void 0:t.getBoundingClientRect().left,top:(null==(n=e.popupState.anchorEl)?void 0:n.getBoundingClientRect().top)-H},anchorReference:"anchorPosition",sx:J,transformOrigin:{vertical:"bottom",horizontal:"left"},children:[(0,i.jsx)(j.A,{disableSticky:!0,sx:{backgroundColor:"transparent",py:Z},children:(0,i.jsx)(A.A,{sx:{color:"callControlMenuItem.main",pl:G,userSelect:"none"},children:(0,i.jsx)("b",{children:(0,i.jsx)(c.A,{i18nKey:"video.videoInputSelection"})})})}),e.videoDeviceList&&e.videoDeviceList.map(t=>(0,i.jsxs)(k.A,{disableRipple:!0,onClick:()=>{var n;return n=t.deviceType.deviceId,void e.config.controls.selectVideoDevice(n)},sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[t.selected&&(0,i.jsx)(S.A,{sx:{color:"callControlButton.main"},children:(0,i.jsx)(D.A,{})}),(0,i.jsx)(A.A,{inset:!t.selected,sx:{color:t.selected?"callControlButton.main":"callControlMenuItem.main"},children:_(t.deviceType)})]},"menu-item-select-".concat(t.deviceType.label))),r&&(0,i.jsx)(w.A,{component:"li",sx:{borderColor:"callControlMenuDivider.main"}}),r&&(0,i.jsxs)(k.A,{disableRipple:!0,onClick:()=>o(!e.config.state.current.isBackgroundBlurEnabled),sx:e=>({"&:hover":{backgroundColor:"callControlMenuBackground.light"},"&:focus-visible":{...e.customStyles.focusRingReverse}}),children:[e.config.state.current.isBackgroundBlurEnabled&&(0,i.jsx)(S.A,{sx:{color:e.config.state.current.isBackgroundBlurEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,i.jsx)(U.A,{})}),(0,i.jsx)(A.A,{inset:!e.config.state.current.isBackgroundBlurEnabled,sx:{color:e.config.state.current.isBackgroundBlurEnabled?"callControlButton.main":"callControlMenuItem.main"},children:(0,i.jsx)(c.A,{i18nKey:"video.blurBackground"})})]},"menu-item-select-background-blur")]})}var K=n(23387);let _=e=>e.label,z="52px",H=8,G="36px",Z="6px",J={"& .MuiPaper-root":{backgroundColor:"callControlMenuBackground.main",border:"2px solid",borderColor:"callControlButton.main",borderRadius:"10px"}};function Q(e){let{meetingDebug:t}=(0,b.useContext)(o.c),[n,w]=(0,b.useState)(),[j,A]=(0,b.useState)(),[k,S]=(0,b.useState)(),{start:C,api:I}=(0,b.useContext)(a.F),{sid:D}=(0,b.useContext)(s.L),{role:E,user:R,sessionToken:F,deviceId:P}=(0,b.useContext)(r.yk),W=(0,v.EI)(),N=(0,p.A)(),M=async()=>{W.controls.selectVideoEnabled(!W.state.current.isVideoEnabled)},O=async()=>{W.controls.selectAudioEnabled(!W.state.current.isAudioEnabled)};(0,b.useEffect)(()=>{(async()=>{if((0,u.s)(W.state.current.availableAudioInputDevices)){let e=(0,u.s)(W.state.current.audioInputDevice)?await (0,g.IPJ)(await (0,y.l1)(W.state.current.audioInputDevice)):void 0;w(W.state.current.availableAudioInputDevices.map(t=>({deviceType:t,selected:t.deviceId===e})))}})()},[W.state.current.availableAudioInputDevices,W.state.current.audioInputDevice]),(0,b.useEffect)(()=>{(async()=>{if((0,u.s)(W.state.current.availableAudioOutputDevices)){let e=(0,u.s)(W.state.current.audioOutputDevice)?await (0,g.IPJ)(W.state.current.audioOutputDevice):void 0;A(W.state.current.availableAudioOutputDevices.map(t=>({deviceType:t,selected:t.deviceId===e})))}})()},[W.state.current.availableAudioOutputDevices,W.state.current.audioOutputDevice]),(0,b.useEffect)(()=>{(async()=>{if((0,u.s)(W.state.current.availableVideoInputDevices)){let e=(0,u.s)(W.state.current.videoInputDevice)?await (0,y.oq)(W.state.current.videoInputDevice):void 0;S(W.state.current.availableVideoInputDevices.map(t=>({deviceType:t,selected:t.deviceId===e})))}})()},[W.state.current.availableVideoInputDevices,W.state.current.videoInputDevice]);let U=e=>(0,i.jsx)(h.A,{className:e.className,sx:{height:z,mx:"auto",position:"relative",width:"fit-content"},children:e.children});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(h.A,{className:e.className,sx:{display:"flex",flexDirection:e.direction,gap:2,justifyContent:"center",my:2,...e.sx},children:[(0,i.jsxs)(h.A,{className:"outer-container",children:[(0,i.jsxs)(U,{className:"camera-controls-container",children:[e.showCameraConfigMenu&&(0,i.jsx)(f.Ay,{variant:"popover",popupId:"camera-menu-popup",children:t=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L,{busy:e.busy,control:"camera",enabled:W.state.current.isVideoEnabled,popupState:t}),(0,i.jsx)(V,{config:W,popupState:t,videoDeviceList:k})]})}),(0,i.jsx)(q.A,{busy:e.busy,control:"camera",enabled:W.state.current.isVideoEnabled,showMenu:e.showCameraConfigMenu,toggleFn:M})]}),K.BX&&(0,i.jsx)(x.A,{sx:{color:"white",textAlign:"center",userSelect:"none"},children:(0,i.jsx)(c.A,{i18nKey:"video.videoInputSelection"})})]}),(0,i.jsxs)(h.A,{className:"outer-container",children:[(0,i.jsxs)(U,{className:"audio-controls-container",children:[e.showAudioConfigMenu&&(0,i.jsx)(f.Ay,{variant:"popover",popupId:"audio-menu-popup",children:t=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L,{busy:e.busy,control:"audio",enabled:W.state.current.isAudioEnabled,popupState:t}),(0,i.jsx)(T,{audioInputDeviceList:n,audioOutputDeviceList:j,config:W,showAudioInputVisualisation:!0,popupState:t})]})}),(0,i.jsx)(q.A,{busy:e.busy,control:"audio",enabled:W.state.current.isAudioEnabled,showMenu:e.showAudioConfigMenu,toggleFn:O})]}),K.BX&&(0,i.jsx)(x.A,{sx:{color:"white",textAlign:"center",userSelect:"none"},children:(0,i.jsx)(c.A,{i18nKey:"audio.audioInputSelection"})})]}),e.isPreview&&(0,i.jsxs)(h.A,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[(0,i.jsx)(h.A,{sx:{color:"callControlMenuItem.main",fontSize:"0.75rem",userSelect:"none"},children:(0,i.jsx)(c.A,{i18nKey:"onboarding.preview.audio.prompt"})}),(0,i.jsxs)(h.A,{sx:{alignItems:"center",display:"flex",flexDirection:"row",gap:.5,height:"1.5rem"},children:[(0,i.jsx)(m.A,{color:N.palette.callControlButtonIcon.main,size:"1.25rem"}),(0,i.jsx)(B,{sx:{color:"callControlMenuItem.main",width:"100px"}})]})]}),!e.isPreview&&t&&E===l.sW.Controller&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(d.A,{btnKey:"init-meeting",variant:"outlined",color:"buttonReverse",onClick:()=>{C(I.postFacilitatorAction(R.access_token,F,{action:"init-meeting",sessionId:D,ticks:new Date().getTime(),originator:P,parameters:{force:!0}}))},btnText:"RE-INIT"})})]})})}},58375:(e,t,n)=>{n.d(t,{C:()=>ed,A:()=>eu});var i=n(95155),o=n(12115),r=n(92253),s=n(18932),a=n(53285),l=n(25790),c=n(54884),d=n(11265),u=n(80431),p=n(21644),h=n(10310),x=n(62652),g=n(57476),m=n(24274),f=n(60193),b=n(80317),v=n(91911),y=n(57915),w=n(90073),j=n(25612),A=n(57300),k=n(5611),S=n(55279),C=n(23387),I=n(19672);function D(e){let{thisUser:t}=(0,o.useContext)(A.f),n=(0,o.useContext)(j.j),[r,s]=(0,o.useState)(!1),a=(0,o.useRef)(null),l=(0,o.useRef)(null),d=(0,o.useRef)(void 0),u=(0,y.A)(),{t:p}=(0,m.Bd)(),h=(0,S.A)(null==t?void 0:t.deviceId);return(0,o.useEffect)(()=>{(0,c.s)(null==h?void 0:h.raiseHand)||!0!==l.current?(0,c.s)(null==h?void 0:h.raiseHand)&&!0!==l.current&&(l.current=!0):(s(!0),l.current=!1,d.current=setTimeout(()=>{s(!1)},5e3))},[h]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(w.A,{className:"raise-hand-container",sx:{display:"flex",flexDirection:"column",mb:2,ml:0,mt:2},children:[(0,i.jsx)(w.A,{className:"raise-hand-button-container",sx:{display:"flex",flexDirection:"row",height:g.LL,justifyContent:"center"},children:(0,i.jsx)(f.A,{"aria-label":p((0,c.s)(null==h?void 0:h.raiseHand)?"button.lowerHand":"button.raiseHand"),disableRipple:!0,disableFocusRipple:!0,onClick:()=>{n.sendMessage({action:"user-signals",content:{signal:{kind:"raiseHand"},signalAction:(0,c.s)(null==h?void 0:h.raiseHand)?"remove":"add"},sid:e.session.id,type:"user-signals-request"})},ref:a,sx:e=>({backgroundColor:(0,c.s)(null==h?void 0:h.raiseHand)?"#ffffffff":"callControlButton.main",flexShrink:0,height:g.LL,mx:"auto",width:g.LL,"&:focus-visible":{backgroundColor:"callControlButton.dark",...e.customStyles.focusRingReverse},"&:hover":{backgroundColor:"callControlButton.dark"}}),children:(0,i.jsx)(k.A,{fill:(0,c.s)(null==h?void 0:h.raiseHand)?void 0:"transparent",height:I.N,stroke:(0,c.s)(null==h?void 0:h.raiseHand)?void 0:u.palette.callControlButtonIcon.main,width:I.N})})}),C.BX&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.A,{"aria-hidden":"true",sx:{height:0,textWrap:"nowrap",visibility:"hidden"},children:(0,i.jsx)(x.A,{i18nKey:"button.lowerHand"})}),(0,i.jsx)(b.A,{color:"white",sx:{textWrap:"nowrap",userSelect:"none"},children:(0,c.s)(null==h?void 0:h.raiseHand)?(0,i.jsx)(x.A,{i18nKey:"button.lowerHand"}):(0,i.jsx)(x.A,{i18nKey:"button.raiseHand"})})]})]}),(0,i.jsx)(v.Ay,{anchorEl:a.current,anchorOrigin:{horizontal:"center",vertical:-10},onClose:()=>{s(!1),clearTimeout(d.current)},open:r,slotProps:{paper:{sx:{backgroundColor:"transparent",boxShadow:"none"}}},transformOrigin:{horizontal:"center",vertical:"bottom"},children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.A,{sx:{backgroundColor:"#ffffffff",borderRadius:"15px",boxShadow:"2px 4px 3px 0px #00000040",margin:"10px 10px 0 10px",padding:1.5},children:(0,i.jsx)(b.A,{sx:{userSelect:"none"},children:(0,i.jsx)(x.A,{i18nKey:"feedback.handLowered"})})}),(0,i.jsx)(w.A,{sx:{borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderTop:"12px solid #ffffffff",height:0,margin:"0 auto",width:0}})]})})]})}var E=n(77757),R=n(78055),F=n(91028),B=n(8085),P=n(95831),T=n(25789),q=n(80357),W=n(17448);let N={w:960,h:700},M="".concat(N.w," / ").concat(N.h),O={1:{col:3,row:1,span:{cols:1,rows:1}},2:{col:3,row:2,span:{cols:1,rows:1}},3:{col:3,row:3,span:{cols:1,rows:1}},4:{col:2,row:3,span:{cols:1,rows:1}},5:{col:1,row:3,span:{cols:1,rows:1}},6:{col:4,row:1,span:{cols:1,rows:1}},7:{col:4,row:2,span:{cols:1,rows:1}},8:{col:4,row:3,span:{cols:1,rows:1}},9:{col:4,row:4,span:{cols:1,rows:1}},10:{col:3,row:4,span:{cols:1,rows:1}},11:{col:2,row:4,span:{cols:1,rows:1}},12:{col:1,row:4,span:{cols:1,rows:1}},13:{col:5,row:1,span:{cols:1,rows:1}},14:{col:5,row:2,span:{cols:1,rows:1}},15:{col:5,row:3,span:{cols:1,rows:1}},16:{col:5,row:4,span:{cols:1,rows:1}},17:{col:6,row:1,span:{cols:1,rows:1}},18:{col:6,row:2,span:{cols:1,rows:1}},19:{col:6,row:3,span:{cols:1,rows:1}},20:{col:6,row:4,span:{cols:1,rows:1}},21:{col:6,row:5,span:{cols:1,rows:1}},22:{col:5,row:5,span:{cols:1,rows:1}},23:{col:4,row:5,span:{cols:1,rows:1}},24:{col:3,row:5,span:{cols:1,rows:1}},25:{col:2,row:5,span:{cols:1,rows:1}},26:{col:1,row:5,span:{cols:1,rows:1}}},L={0:{[R.t.default]:{cols:1,rows:1},[R.t.deliberation]:{cols:1,rows:1}},1:{[R.t.default]:{cols:3,rows:2},[R.t.deliberation]:{cols:3,rows:2}},2:{[R.t.default]:{cols:3,rows:2},[R.t.deliberation]:{cols:3,rows:2}},3:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:3,rows:3}},4:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:3,rows:3}},5:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:3,rows:3}},6:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:3}},7:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:3}},8:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:3}},9:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:4}},10:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:4}},11:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:4}},12:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:4,rows:4}},13:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:5,rows:4}},14:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:5,rows:4}},15:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:5,rows:4}},16:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:5,rows:4}},17:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:4}},18:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:4}},19:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:4}},20:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:4}},21:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:5}},22:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:5}},23:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:5}},24:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:5}},25:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:5}},26:{[R.t.default]:{cols:6,rows:5},[R.t.deliberation]:{cols:6,rows:5}}},U={0:{[R.t.default]:{col:1,row:1,span:{cols:1,rows:1}},[R.t.deliberation]:{col:1,row:1,span:{cols:1,rows:1}}},1:{[R.t.default]:{col:1,row:1,span:{cols:2,rows:2}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},2:{[R.t.default]:{col:1,row:1,span:{cols:2,rows:2}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},3:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:3}}},4:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},5:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},6:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},7:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},8:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},9:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},10:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},11:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},12:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},13:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},14:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},15:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},16:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},17:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},18:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},19:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},20:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},21:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},22:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},23:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},24:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},25:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}},26:{[R.t.default]:{col:1,row:1,span:{cols:5,rows:5}},[R.t.deliberation]:{col:1,row:1,span:{cols:2,rows:2}}}},V=(0,o.memo)(function(e){var t,n,s,a,l,c,d,u;let{tiles:p}=(0,o.useContext)(E.qW),[h,x]=(0,o.useState)(!1),[g,m]=(0,o.useState)(),b=void 0!==e.testSubscriptions;(0,o.useEffect)(()=>{var t,n;let o=Math.min(null!=(n=null==p?void 0:p.length)?n:null==(t=e.testSubscriptions)?void 0:t.length,26),r=e.activity,s=L[o][r],a={w:s.cols*N.w,h:s.rows*N.h},l="repeat(".concat(s.cols,", 1fr)"),c="repeat(".concat(s.rows,", 1fr)"),d=e.enableExpandButton&&o>0&&e.activity===R.t.deliberation;m({colsTemplate:l,rowsTemplate:c,cells:s,gridAspect:a,litter:o,activity:r,showExpandButton:d,tiles:e.testSubscriptions?e.testSubscriptions.map((e,t)=>(0,i.jsx)(W.Ay,{test:!0,subscription:e},"test-tile-".concat(t,"-").concat(e.subscriptionId))):p})},[b,p,e.testSubscriptions,e.activity,e.enableExpandButton]),(0,o.useEffect)(()=>{g&&g.activity!==R.t.deliberation&&x(!1)},[g]);let[v]=(0,F.Q)({duration:200}),y="0.5rem",w=(0,T.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(q.A,{className:"tiles-inner-container",sx:{width:null!=(d=null==(t=e.availableSpace)?void 0:t.w)?d:"100%",height:null!=(u=null==(n=e.availableSpace)?void 0:n.h)?u:"100%",position:"relative"},children:g&&(0,i.jsx)(q.A,{className:"tiles-container",sx:{aspectRatio:"".concat(g.gridAspect.w,"/").concat(g.gridAspect.h),objectFit:"contain",height:r.nr?null==(s=e.availableSpace)?void 0:s.h:void 0,width:r.nr?null==(a=e.availableSpace)?void 0:a.w:void 0,maxHeight:null==(l=e.availableSpace)?void 0:l.h,maxWidth:null==(c=e.availableSpace)?void 0:c.w,mx:"auto",my:"auto",p:1},children:(0,i.jsxs)(q.A,{className:"tiles-grid",ref:v,sx:{width:"100%",height:"100%",display:"grid",gap:y,gridTemplateColumns:g.colsTemplate,gridTemplateRows:g.rowsTemplate},children:[(0,i.jsxs)(q.A,{sx:{position:h?"absolute":"relative",gridColumnStart:h?void 0:U[g.litter][g.activity].col,gridColumnEnd:h?void 0:U[g.litter][g.activity].col+U[g.litter][g.activity].span.cols,gridRowStart:h?void 0:U[g.litter][g.activity].row,gridRowEnd:h?void 0:U[g.litter][g.activity].row+U[g.litter][g.activity].span.rows,width:h?void 0:"100%",height:h?void 0:"100%",left:h?"2.5vh":void 0,top:h?"2.5vh":void 0,bottom:h?"2.5vh":void 0,right:h?"2.5vh":void 0,zIndex:h?10:void 0},children:[g.showExpandButton&&(0,i.jsx)(q.A,{sx:{position:"absolute",top:"1rem",right:"1rem",zIndex:20},children:(0,i.jsx)(f.A,{"aria-label":"expand presentation button",onClick:()=>x(!h),sx:{border:"2px solid",borderColor:w.palette.promptPanelBackground.main,background:w.palette.slideSectionBackground.main},children:h?(0,i.jsx)(B.A,{}):(0,i.jsx)(P.A,{})})}),(0,i.jsx)(q.A,{sx:{width:"100%",height:"100%",borderRadius:2,border:h?"solid 2px white":void 0},className:"shadow",children:e.presentation})]},"presentation-cell"),g.activity===R.t.deliberation&&(0,i.jsx)(i.Fragment,{children:g.tiles.map((e,t)=>{let n=O[t+1];return void 0!==n?(0,i.jsx)(q.A,{sx:{gridColumnStart:n.col,gridColumnEnd:n.col+n.span.cols,gridRowStart:n.row,gridRowEnd:n.row+n.span.rows},children:e},"video-cell-at-".concat(t)):(console.warn("Tile with index ".concat(t," not rendered - no position data available")),(0,i.jsx)(i.Fragment,{}))})}),g.activity!=R.t.deliberation&&(0,i.jsxs)(i.Fragment,{children:[g.tiles.slice(0,Math.min(2,g.litter)).map((e,t)=>(0,i.jsx)(q.A,{sx:{gridColumn:L[g.litter][g.activity].cols,gridRow:t+1},children:e},"video-cell-at-".concat(t))),g.litter>2&&(0,i.jsx)(q.A,{sx:{gridColumn:g.cells.cols,gridRowStart:3,gridRowEnd:g.cells.rows+1,overflowY:"auto"},children:g.tiles.slice(2).map((e,t)=>(0,i.jsx)(q.A,{sx:{width:"100%",aspectRatio:M,mb:y},children:e},"video-cell-at-".concat(t)))})]})]})})})})},(e,t)=>{var n,i;let o=e.activity===t.activity,r=e.availableSpace===t.availableSpace,s=e.enableExpandButton===t.enableExpandButton,a=e.presentation===t.presentation,l=(0,E.nh)(null!=(n=e.testSubscriptions)?n:[],null!=(i=t.testSubscriptions)?i:[]);return o&&r&&s&&a&&l});var K=n(89207),_=n(48484),z=n(8553),H=n(27855),G=n(39268);function Z(){let[e,t]=(0,o.useState)(!1),{setParticipantSessionFlags:n}=(0,o.useContext)(ed),{t:r}=(0,m.Bd)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.A,{disableFocusRipple:!0,sx:e=>({border:"2px solid",borderColor:"buttonDangerReverse.main",color:"buttonDangerReverse.main",fontWeight:"bold",height:"fit-content",px:3,py:1,width:"max-content","&:hover":{backgroundColor:"buttonDangerReverse.main",border:"2px solid",borderColor:"buttonDangerReverse.main",color:"buttonStandard.main"},"&:focus-visible":{...e.customStyles.focusRingReverse,backgroundColor:"buttonDangerReverse.main",color:"buttonStandard.main",outlineOffset:"2px"}}),variant:"outlined",onClick:()=>t(!0),children:(0,i.jsx)(x.A,{i18nKey:"onboarding.leaveWorkshop"})}),(0,i.jsx)(G.A,{open:e,setOpen:t,onSelect:e=>{"leave"===e&&n({leftTheWorkshop:!0})},prompt:r("workshop.leaveConfirm"),options:[{key:"leave",text:r("workshop.leaveCta"),filled:!0},{key:"return",text:r("workshop.returnCta"),filled:!1}]})]})}var J=n(35626),Q=n(65229),Y=n(27747),X=n(2021),$=n(99496),ee=n(37440),et=n(62995),en=n(68060),ei=n(51404),eo=n(23405),er=function(e){return e.None="",e.CannotHearOthers="cannot-hear-others",e.OthersCannotHearMe="others-cannot-hear-me",e.StillNeedHelp="still-need-help",e}(er||{});function es(e){let[t,n]=(0,o.useState)(""),{t:r}=(0,m.Bd)(),s=()=>{e.setShowTechSupport(!1),n("")},a=()=>{s()};return(0,i.jsxs)(Y.A,{className:"tech-support-dialog",fullWidth:!0,maxWidth:"sm",onClose:()=>{s()},open:e.showTechSupport,PaperProps:{sx:{border:"3px solid #A5A5FF",borderRadius:"10px",pointerEvents:"auto"}},scroll:"paper",sx:{pointerEvents:"none","& .MuiDialog-container":{height:e.backdropHeight||"100%"}},slots:{backdrop:()=>(0,i.jsx)(q.A,{onClick:a,sx:{backgroundColor:"rgba(0,0,0,0.7)",height:e.backdropHeight||"100%",pointerEvents:"auto",position:"fixed",width:"100%"}})},transitionDuration:0,children:[(0,i.jsxs)(q.A,{className:"tech-support-dialog-controls",sx:{display:"flex",flexDirection:"row",justifyContent:""===t?"end":"space-between"},children:[""!==t&&(0,i.jsx)(f.A,{"aria-label":"back",onClick:()=>{n("")},sx:{width:"fit-content"},children:(0,i.jsx)(J.A,{size:"24px"})}),(0,i.jsx)(f.A,{"aria-label":"close",onClick:s,sx:{width:"fit-content"},children:(0,i.jsx)(Q.A,{size:"24px"})})]}),(0,i.jsxs)(X.A,{align:"center",color:"#292D32",sx:{mx:1,userSelect:"none"},variant:"h3",children:[""===t&&"What problem are you experiencing?","cannot-hear-others"===t&&(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.heading"}),"others-cannot-hear-me"===t&&(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.othersCannotHearMe.heading"}),"still-need-help"===t&&"Please tell us about the problem you're experiencing"]}),"cannot-hear-others"===t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X.A,{align:"center",color:"#292D32",component:"h3",variant:"h4",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.pleaseCheck"})}),(0,i.jsx)($.A,{sx:{mx:1,my:2,pb:0},children:(0,i.jsxs)("ol",{style:{margin:"0"},children:[(0,i.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("b",{children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.tip1Heading"})}),(0,i.jsx)("br",{}),(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.tip1Body"})]}),(0,i.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("b",{children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.tip2Heading"})}),(0,i.jsx)("br",{}),(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.tip2Body"})]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("b",{children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.tip3Heading"})}),(0,i.jsx)("br",{}),(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.tip3Body"})]})]})})]}),"others-cannot-hear-me"===t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X.A,{align:"center",color:"#292D32",component:"h3",variant:"h4",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.pleaseCheck"})}),(0,i.jsx)($.A,{children:(0,i.jsxs)("ol",{children:[(0,i.jsxs)("li",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("b",{children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.othersCannotHearMe.tip1Heading"})}),(0,i.jsx)("br",{}),(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.othersCannotHearMe.tip1Body"})]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("b",{children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.othersCannotHearMe.tip2Heading"})}),(0,i.jsx)("br",{}),(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.othersCannotHearMe.tip2Body"})]})]})})]}),""!==t&&"still-need-help"!==t&&(0,i.jsxs)($.A,{sx:{display:"flex",flexDirection:"row",gap:2,justifyContent:"center",mb:1,p:2},children:[(0,i.jsx)(H.A,{color:"buttonStandard",onClick:()=>{s()},sx:{fontWeight:"bold",p:"0.5rem 2rem",textTransform:"uppercase"},variant:"outlined",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.buttons.problemSolved"})}),(0,i.jsx)(H.A,{color:"buttonStandard",onClick:()=>{n("still-need-help")},sx:{fontWeight:"bold",p:"0.5rem 2rem",textTransform:"uppercase"},variant:"contained",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.buttons.stillNeedHelp"})})]}),"still-need-help"===t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X.A,{align:"center",color:"#292D32",component:"h3",sx:{mx:1},variant:"h4",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.teamIsAvailable"})}),(0,i.jsx)($.A,{children:(0,i.jsxs)(q.A,{sx:{display:"grid",gap:1,gridTemplateColumns:"auto 1fr",mx:"auto",my:2,width:"fit-content"},children:[(0,i.jsx)(b.A,{sx:{mr:1},variant:"body1",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.phone"})}),(0,i.jsx)(ee.A,{href:"tel:020 7031 7209",sx:{color:"#000000ff",fontWeight:"bold"},target:"_blank",children:"020 7031 7209"}),(0,i.jsx)(b.A,{children:(0,i.jsx)(x.A,{i18nKey:"techSupport.email"})}),(0,i.jsx)(ee.A,{href:"mailto:workshop-support@nesta.org.uk?subject=Workshop tech support",sx:{color:"#000000ff",fontWeight:"bold"},target:"_blank",children:"workshop-support@nesta.org.uk"})]})})]}),""===t&&(0,i.jsx)($.A,{sx:{textAlign:"center"},children:(0,i.jsxs)(et.A,{sx:{my:3,minWidth:"24rem",userSelect:"none"},children:[(0,i.jsx)(en.A,{id:"select-problem",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.chooseProblem"})}),(0,i.jsxs)(ei.A,{label:r("techSupport.chooseProblem"),labelId:"select-problem",onChange:e=>{n(e.target.value)},value:t,children:[(0,i.jsx)(eo.A,{value:"cannot-hear-others",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.cannotHearOthers.description"})}),(0,i.jsx)(eo.A,{value:"others-cannot-hear-me",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.othersCannotHearMe.description"})}),(0,i.jsx)(eo.A,{value:"still-need-help",children:(0,i.jsx)(x.A,{i18nKey:"techSupport.problems.differentProblem.description"})})]})]})})]})}var ea=n(49502);function el(){let{session:e}=(0,o.useContext)(h.L),{slideData:t}=(0,u.Zm)(),n=(0,o.useContext)(p.z),[r,a]=(0,o.useState)(!1),[l,c]=(0,o.useState)(!1),{t:d}=(0,m.Bd)(),[v,y]=(0,o.useState)({activity:t.activity,enableExpandButton:!0,presentation:n.presentation,availableSpace:void 0});(0,o.useEffect)(()=>{a(e.remoteConfiguration===s.LQ.RemoteWithVideoCall)},[e]),(0,o.useEffect)(()=>{y({...v,activity:t.activity,enableExpandButton:!0,presentation:n.presentation})},[t.activity]);let[j,A]=(0,z.W_)();return(0,o.useEffect)(()=>{A&&A.width&&A.height&&(y({...v,availableSpace:{w:A.width,h:A.height}}),console.debug("available space: ".concat(A.width," x ").concat(A.height)))},[A]),(0,i.jsxs)(i.Fragment,{children:[r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(K.A,{sx:{flexGrow:1},joinView:(0,i.jsx)(()=>(0,i.jsx)(_.A,{preTitle:(0,i.jsx)(x.A,{i18nKey:"onboarding.thanks"}),title:(0,i.jsx)(x.A,{i18nKey:"onboarding.almostThere"}),bar:"Connecting your video call..."}),{}),children:[(0,i.jsxs)(w.A,{className:"available-space-and-controls-container",sx:{width:"100%",height:"100%",position:"absolute",left:0,top:0,right:0,bottom:0,display:"flex",flexDirection:"column"},children:[(0,i.jsx)(w.A,{className:"available-space-ref",ref:j,sx:{display:"block",flexGrow:1,m:0,p:0}}),(0,i.jsxs)(w.A,{className:"call-controls-container",sx:{backgroundColor:"callControlPanelBackground.main",display:"grid",gap:2,gridTemplateColumns:"1fr 1fr 1fr"},children:[(0,i.jsx)(w.A,{className:"left-controls-container"}),(0,i.jsxs)(w.A,{className:"centre-controls-container",sx:{alignItems:"flex-start",display:"flex",flexDirection:"row",gap:2,justifyContent:"center"},children:[(0,i.jsx)(g.Ay,{direction:"row",showAudioConfigMenu:!0,showCameraConfigMenu:!0,busy:!1,isPreview:!1}),(0,i.jsx)(D,{session:e})]}),(0,i.jsxs)(w.A,{className:"right-controls-container",sx:{alignItems:"center",alignSelf:"center",display:"flex",flexDirection:"row",justifySelf:"end",pr:1},children:[(0,i.jsx)(Z,{}),(0,i.jsxs)(f.A,{"aria-label":d("techSupport.buttons.support"),disableFocusRipple:!0,onClick:()=>{c(e=>!e)},sx:e=>({borderRadius:"4px",flexDirection:"column",ml:2,mr:1,p:.5,"&:focus-visible":{...e.customStyles.focusRingReverse,outlineOffset:"2px"},"&:hover":{"> p":{color:"#6C63FF"},"> svg":{stroke:"#6C63FF"}}}),children:[(0,i.jsx)(ea.A,{color:"#f5f5f5",size:"32px"}),(0,i.jsx)(b.A,{color:"white",sx:{fontSize:"14px",textTransform:"uppercase"},children:(0,i.jsx)(x.A,{i18nKey:"techSupport.buttons.support"})})]})]})]})]}),(0,i.jsx)(w.A,{className:"tiles-outer-container",sx:{position:"absolute",left:0,top:0,right:0,display:"block"},children:(0,i.jsx)(E.Ay,{role:s.sW.Client,children:(0,i.jsx)(V,{activity:v.activity,enableExpandButton:v.enableExpandButton,presentation:v.presentation,availableSpace:v.availableSpace})})})]}),(0,i.jsx)(es,{backdropHeight:A.height,showTechSupport:l,setShowTechSupport:c})]}),!r&&(0,i.jsx)(w.A,{sx:{width:"100%",height:"100%",p:1,position:"relative"},children:n.presentation})]})}var ec=n(96827);let ed=(0,o.createContext)({});function eu(e){let[t,n]=(0,o.useState)({leftTheWorkshop:!1});(0,o.useEffect)(()=>((0,c.s)(window)&&(!1===t.leftTheWorkshop?window.addEventListener("beforeunload",u):window.removeEventListener("beforeunload",u)),()=>{window.removeEventListener("beforeunload",u)}),[t.leftTheWorkshop]);let u=e=>{e.preventDefault()};return(0,i.jsx)(i.Fragment,{children:r.XF?(0,i.jsx)(d.A,{}):(0,i.jsx)(ed.Provider,{value:{participantSessionFlags:t,setParticipantSessionFlags:n},children:(0,i.jsx)(ec.A,{sid:e.sid,joinCode:e.joinCode,refresh:e.refresh,role:s.sW.Client,children:(0,i.jsxs)(a.A,{role:s.sW.Client,children:[(0,i.jsx)(l.A,{}),(0,i.jsx)(el,{})]})})})})}},59850:(e,t,n)=>{n.d(t,{A:()=>m,s:()=>g});var i=n(95155),o=n(32276),r=n(34824),s=n(12115),a=n(98314),l=n(78211),c=n(57300),d=n(84073),u=n(18932),p=n(54884),h=n(23387),x=n(45238);let g=(0,s.createContext)({});function m(e){let t=(0,o.GYC)(),n=(0,o.VjK)(),m=(0,s.useContext)(l.c),[f,b]=(0,s.useState)({meetingStatus:n,isStarted:!1}),{session:v}=(0,s.useContext)(a.$),{subscriptions:y}=(0,s.useContext)(c.f),{role:w,deviceId:j}=(0,s.useContext)(d.yk),{zgJoinResponse:A,isPreview:k}=(0,s.useContext)(x.K),[S,C]=(0,s.useState)(),[I,D]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{(0,p.s)(v.deviceIdBanList)&&D(v.deviceIdBanList.includes(j))},[v,j]),(0,s.useEffect)(()=>()=>{t.getAttendee=void 0,t.leave()},[t]),(0,s.useEffect)(()=>{b(e=>({...e,meetingStatus:n}))},[n]),(0,s.useEffect)(()=>{n===o.e0s.Succeeded&&I&&t.leave()},[n,I,t]),(0,s.useEffect)(()=>{let e;if(e=v.facilitationState,!I&&void 0!==A&&(w===u.sW.Controller||e===u.ve.Open||k)){if(A.chimeMeetingId!==(null==S?void 0:S.meetingId)){let e=new r.MeetingSessionConfiguration({MeetingId:A.chimeMeetingId,MediaPlacement:{AudioHostUrl:A.audioHostUrl,SignalingUrl:A.signalingUrl,TurnControlUrl:A.turnControlUrl,AudioFallbackUrl:A.audioFallbackUrl,EventIngestionUrl:A.eventIngestionUrl,ScreenDataUrl:A.screenDataUrl,ScreenViewingUrl:A.screenViewingUrl}},{ExternalUserId:A.chimeAttendeeExternalId,AttendeeId:A.chimeAttendeeId,JoinToken:A.chimeJoinToken});console.debug("ZgMeetingConnectionProvider: updating meeting config",A,e),C(e)}}else C(void 0)},[w,v.facilitationState,A,k,S,I]),(0,s.useEffect)(()=>{(async()=>{if(t.meetingId!==(null==S?void 0:S.meetingId)&&(console.debug("ZgMeetingConnectionProvider: Current meeting id has changed...",null==S?void 0:S.meetingId),n===o.e0s.Succeeded&&(console.debug("ZgMeetingConnectionProvider: Disconnecting from previous meeting..."),await t.leave()),(0,p.s)(null==S?void 0:S.meetingId)&&n!==o.e0s.Succeeded&&n!==o.e0s.Reconnecting))try{let e;console.debug("ZgMeetingConnectionProvider: Joining meeting...",S);await t.join(S,(null!=m.voiceFocus||h.aW,{deviceLabels:o.iin.AudioAndVideo,enableWebAudio:!0,eventController:(e=S,new r.DefaultEventController(e,new r.ConsoleLogger("SDK",r.LogLevel.INFO),new r.NoOpEventReporter))})),console.debug("ZgMeetingConnectionProvider: Successfully joined meeting."),console.debug("ZgMeetingConnectionProvider: Starting meeting..."),await t.start(),console.debug("ZgMeetingConnectionProvider: Meeting start succeeded.")}catch(e){console.error("ZgMeetingConnectionProvider: Error joining meeting",e)}})()},[S,m.voiceFocus,t,n]),(0,s.useEffect)(()=>{t.getAttendee=async(e,t)=>{void 0===t&&console.warn("Undefined pid passed from chime.");var n,i=y.find(e=>e.deviceId===t);return void 0===i&&console.warn("No subscription found for pid: ".concat(t),y),{name:null!=(n=null==i?void 0:i.participantName)?n:"Unknown"}}},[t,y]),(0,s.useEffect)(()=>{console.debug("ZgMeetingConnectionProvider: meeting status: ".concat(o.e0s[n])),b(e=>({...e,isStarted:n===o.e0s.Succeeded}))},[n]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(g.Provider,{value:f,children:e.children})})}},60071:(e,t,n)=>{n.d(t,{$:()=>c});var i=n(73905),o=n(53682),r=n(13187),s=n(70361),a=n.n(s),l=n(54884);let c=(e,t)=>{let n=a()(e);for(let e of t.patches){let t=(0,r.E)({path:e.jsonPath,json:n,resultType:"pointer",flatten:!0}),s=[];for(let r of t){let t,a=[];for(let t of e.jsonPatch){let e=u(r,t.path),n=(0,l.B)()(t,"from")?u(r,t.from):void 0,i={...t,from:n,path:e};a.push(i)}let c=0,p=1+2*a.length;do{if(++c>p)throw Error("".concat(p," cycles.\n\n").concat(JSON.stringify(a,null,2)));let e=(0,o.tf)(a,n);if(t=!1,(0,l.s)(e))if("OPERATION_PATH_UNRESOLVABLE"===e.name&&"replace"===e.operation.op)a=a.map(t=>"replace"===t.op&&t.path===e.operation.path?{...e.operation,op:"add"}:t),t=!0;else if("OPERATION_PATH_UNRESOLVABLE"===e.name&&"remove"===e.operation.op)a=a.filter(t=>"remove"!==t.op||t.path!==e.operation.path),t=!0;else if("OPERATION_PATH_CANNOT_ADD"===e.name&&"add"===e.operation.op){let o=e.operation.path.split("/"),r=n;for(let e of o.slice(1,-1))Object.hasOwn(r,e)&&(0,i.O)(r[e])||(r[e]={}),r=r[e];t=!0}else throw Error("JSON patch invalid after pre-processing: ".concat(e.name,": ").concat(e.message," for op ").concat(JSON.stringify(e.operation)))}while(t);s=[...s,...a.filter(e=>d(e))];let h=a.filter(e=>!d(e));n=(0,o.X6)(n,h,!0,!1).newDocument}s.sort((e,t)=>{let n=parseInt(e.path.split("/").pop());return parseInt(t.path.split("/").pop())-n}),n=(0,o.X6)(n,s,!0,!1).newDocument}return n},d=e=>"remove"===e.op&&/^.*\/\d+$/.test(e.path),u=(e,t)=>(0,l.s)(t)&&0!==t.length?(e.endsWith("/")&&(e=e.slice(0,-1)),(null==t?void 0:t.startsWith("/"))&&(t=t.slice(1)),"".concat(e,"/").concat(t)):e},61451:(e,t,n)=>{n.d(t,{A:()=>x,L:()=>h});var i=n(95155),o=n(73017),r=n(91028),s=n(57915),a=n(90073),l=n(46671),c=n.n(l),d=n(12115),u=n(74434),p=n(86004);let h="_";function x(e){let{allAnswers:t}=(0,o.Ay)(),n=t[e.qIds.qid],l=[],x=[];if(n)for(let t of n){var g;let n=t.id,o=null==(g=t.jsonValue)?void 0:g.answers[0].stringValue,r="".concat(e.qIds.qid).concat(h).concat(n);n&&o&&t.participantId!==e.qIds.pid&&(l.push({qid:r,sid:e.qIds.sid,pid:e.qIds.pid}),x.push((0,i.jsx)(p.Ay,{qids:{qid:r,sid:e.qIds.sid,pid:e.qIds.pid},role:e.role,assertion:o,onAnswer:e.onAnswer})))}let m=()=>{for(let e of l)if(!(0,o.Qy)((0,o._i)(t[e.qid],e)))return l.indexOf(e)},[f,b]=(0,d.useState)(m());(0,d.useEffect)(()=>{let e=m();f!==e&&b(e)},[t]);let v=(0,s.A)(),y=[.2,.25],[w]=(0,r.Q)({duration:500});return n&&0!==l.length?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(a.A,{ref:w,className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"stretch",p:2,gap:2,boxSizing:"border-box"},children:[void 0!==f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.A,{content:e.question}),(0,i.jsx)(a.A,{sx:{flexGrow:1,boxSizing:"border-box",overflowY:"auto",overflowX:"hidden",display:"block"},children:x[f]},"input-sequence-element-".concat(l[f].qid))]}),void 0===f&&(0,i.jsx)(a.A,{sx:{flexGrow:1,display:"block"},children:e.completion}),void 0!==f&&e.showProgress&&(0,i.jsx)(a.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:c().range(0,x.length).map((e,t)=>(0,i.jsx)(a.A,{sx:{background:e===f?v.palette.progressBlipSelected.main:v.palette.progressBlipUnselected.main,width:"".concat(y[+(e===f)],"em"),height:"".concat(y[+(e===f)],"em"),borderRadius:"".concat(y[+(e===f)]/2,"em")}},"sequence-blip-".concat(e,"-").concat(l[e].qid)))})]})}):null}},63608:(e,t,n)=>{n.d(t,{G:()=>I,A:()=>R});var i=n(95155),o=n(73017),r=n(18932),s=n(29999),a=n(33427),l=n(25789),c=n(80357),d=n(50355),u=n(41477),p=n(13664),h=n(27855),x=n(27747),g=n(99496),m=n(60193),f=n(80317),b=n(78095),v=n(12115),y=n(74434),w=n(68307),j=n(74084),A=n(70439),k=n(54884);let S=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,C=()=>(0,i.jsx)(A.A,{children:(0,i.jsx)("svg",{focusable:"false","aria-hidden":"true","data-testid":"CheckBoxBlankIcon",children:(0,i.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5",fill:"white"})})});var I=function(e){return e[e.text=0]="text",e[e.email=1]="email",e}({});let D=(e,t)=>({...e,jsonValue:{answers:[{key:"text",stringValue:t.answer},...t.checks.map(e=>({key:e.key,stringValue:e.text,booleanValue:e.checked}))]}}),E=(e,t)=>{var n,i;return{answer:null==(i=e.jsonValue)||null==(n=i.answers.find(e=>"text"===e.key))?void 0:n.stringValue,checks:t.map(t=>{var n,i,o;return{key:t.key,text:t.text,initial:t.initial,checked:null!=(o=null==(i=e.jsonValue)||null==(n=i.answers.find(e=>e.key===t.key))?void 0:n.booleanValue)?o:t.initial,required:t.required}})}};function R(e){var t;let{answers:n}=(0,o.Ay)(e.qids.qid),[A,R]=(0,v.useState)((0,o.fV)(n,e.qids,e.question.pii)),[F,B]=(0,v.useState)({answer:void 0,checks:[]}),[P,T]=(0,v.useState)(!1),[q,W]=(0,v.useState)(!0),[N,M]=(0,v.useState)(e.role===r.sW.Client),[O,L]=(0,v.useState)(!1),[U,V]=(0,v.useState)(!1),[K,_]=(0,v.useState)([]),[z,H]=(0,v.useState)(),[G,Z]=(0,v.useState)(!1),J=()=>{Z(!1)};(0,v.useEffect)(()=>{"virtualKeyboard"in navigator&&(navigator.virtualKeyboard.overlaysContent=!0)},[]),(0,v.useEffect)(()=>{B(E(A,e.checkboxes))},[A,e.checkboxes]);let Q=()=>{var t,n;let i=[...((e,t)=>{if(console.debug("Validating checkboxes",e),void 0===e)return["Checkbox data undefined."];let n=e.filter(e=>e.checked).length,i=e.map((e,t)=>e.required&&!e.checked?"The ".concat((0,j.V)(t+1)," checkbox is required."):null).filter(e=>null!==e).map(e=>e),o=[];return n<t&&o.push("Please select at least ".concat(t," ").concat(1===t?"checkbox":"checkboxes",".")),[...i,...o]})(F.checks,e.minCheckboxes),...((e,t,n,i,o)=>{let r=[],s=null!=t?t:"";switch(e){case I.text:let a=n?s.length>0?null:"Please enter an answer.":null;null!==a&&r.push(a),(0,k.s)(i)&&!0!==new RegExp(i).test(s)&&r.push("".concat(null!=o?o:"Validation error","."));break;case I.email:let l=S.test(s.trim()),c=n?s.trim().length>0&&l?null:"Please enter a valid email address.":0===s.trim().length||l?null:"Please enter a valid email address.";null!==c&&r.push(c);break;default:throw"Unsupported TextInputType"}return r})(e.type,F.answer,e.textRequired,e.pattern,e.patternErrorMessage)],o=(null!=(n=null==(t=F.answer)?void 0:t.length)?n:0)>0;return W(!U||0===i.length&&(o||!e.textRequired)),_(i),0===i.length};(0,v.useEffect)(()=>{U&&Q()},[F]);let Y=async()=>{if(e.role===r.sW.Client&&q){if(V(!0),Q()){let t=D(A,F);console.debug("Submitting TextInput",t),T(!0),e.onAnswer(t).then(t=>{if(console.debug("Answer submitted ".concat(t?"ok":"error")),console.debug("Received answer response",t),null!==t)B(E(t,e.checkboxes));else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{T(!1)})}}else console.warn("Only participants can submit answers")},X=async()=>{let t=D(A,{...F,answer:void 0,checks:[]});T(!0),e.onAnswer(t).then(t=>{if(console.debug("Answer submitted ".concat(t?"ok":"error")),console.debug("Received answer response",t),null!==t)B(E(t,e.checkboxes));else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{T(!1)})};(0,v.useEffect)(()=>{H(K.join(" ")),L(K.length>0)},[K]);let $={maxLength:e.maxLength,minLength:e.minLength,pattern:e.pattern};return(0,l.A)(),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(c.A,{className:"stretch",sx:{width:"100%",height:e.fullHeight?"100%":"initial",display:"flex",flexDirection:"column",justifyContent:"center"},children:[(e.question.explanation||e.question.instruction||e.question.question)&&(0,i.jsx)(c.A,{sx:{mb:4},children:(0,i.jsx)(y.A,{content:e.question})}),(0,i.jsx)(d.A,{label:e.label,variant:"outlined",defaultValue:F.answer,helperText:z,type:1===e.type?"email":"text",onChange:e=>{B({...F,answer:e.target.value})},error:O,color:"buttonStandard",autoComplete:"off",InputProps:{sx:{background:"white",fontSize:"2rem"}},InputLabelProps:{sx:{fontSize:"2rem","&.MuiOutlinedInput-notchedOutline":{fontSize:"2rem"}}},sx:{mb:2},minRows:e.minRows,multiline:e.multiline,slotProps:{htmlInput:$}}),F.checks.map((t,n)=>(0,i.jsx)(c.A,{display:"flex",flexDirection:"row",children:(0,i.jsx)(u.A,{control:(0,i.jsx)(p.A,{checked:t.checked,onChange:(e,n)=>{var i;let o;return i=t.key,void((o={...F,checks:[...F.checks]}).checks.find(e=>e.key===i).checked=n,B(o))},icon:e.forceCheckboxesWhite?(0,i.jsx)(C,{}):void 0}),label:t.text})},"checkbox-".concat(e.qids.qid,"-").concat(n,"-").concat(t.key))),e.information&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.A,{variant:"text",fullWidth:!1,color:"buttonStandard",sx:{textDecoration:"underline",alignSelf:"start",mt:2},startIcon:(0,i.jsx)(a.A,{}),onClick:()=>Z(!0),children:e.information.heading}),(0,i.jsx)(x.A,{fullWidth:!0,maxWidth:"md",open:G,onClose:J,children:(0,i.jsxs)(g.A,{children:[(0,i.jsx)(c.A,{style:{position:"absolute",top:0,right:0},children:(0,i.jsx)(m.A,{"aria-label":"close",onClick:J,children:(0,i.jsx)(s.A,{})})}),(0,i.jsx)(c.A,{sx:{p:2},display:"flex",flexDirection:"column",children:e.information.body.map((t,n)=>(0,i.jsx)(f.A,{variant:"slideInfoText",align:"left",dangerouslySetInnerHTML:{__html:(0,b.A)(t)}},"".concat(e.qids.qid,"-info-body-").concat(n)))})]})})]}),e.maxLength&&e.maxLengthCounter&&(0,i.jsx)(f.A,{sx:{margin:"0 !important",textAlign:"left"},variant:"body1",children:"".concat((null==(t=F.answer)?void 0:t.length)||0," / ").concat(e.maxLength)}),(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"row",gap:1,justifyContent:"end",alignItems:"end"},children:[e.skipText&&(0,i.jsx)(w.A,{inline:!0,busy:P,onSubmit:X,large:!0,variant:"outlined",text:e.skipText,enabled:!0}),(0,i.jsx)(w.A,{inline:!0,busy:P,onSubmit:Y,large:!0,text:e.submitText,enabled:!U||q})]})]})})}},66622:(e,t,n)=>{n.d(t,{A:()=>k});var i=n(95155),o=n(80357),r=n(12115),s=n(24274),a=n(3207),l=n(37440),c=n(27747),d=n(2021),u=n(99496),p=n(73224),h=n(66370),x=n(27855),g=n(72970),m=n(78211),f=n(62652),b=n(80317),v=n(39970),y=n(29518);let w={a:e=>(0,i.jsx)(l.A,{href:e.href,rel:"noopener",sx:{color:"#000"},target:"_blank",children:e.children}),h1:e=>(0,i.jsx)(b.A,{sx:{fontSize:"3rem",marginBottom:"1.25rem"},variant:"h1",children:e.children}),h2:e=>(0,i.jsx)(b.A,{sx:{fontSize:"1.875rem",marginBottom:"1.5rem",marginTop:"3.25rem","&:first-of-type":{marginTop:"2.25rem"}},variant:"h2",children:e.children}),li:e=>(0,i.jsx)(v.Ay,{sx:{display:"list-item",paddingBottom:"0",paddingTop:"0"},children:e.children}),ol:e=>(0,i.jsx)(y.A,{component:"ol",start:e.start,sx:{listStyleType:"lower-alpha",marginTop:"0",paddingBottom:"0",paddingInlineStart:"2rem",paddingTop:"0"},children:e.children}),p:e=>(0,i.jsx)(b.A,{sx:{marginBottom:"1.25rem"},variant:"body3",children:e.children}),ul:e=>(0,i.jsx)(y.A,{sx:{listStyleType:"disc",paddingBottom:"0",paddingInlineStart:"2rem",paddingTop:"0"},children:e.children})};function j(){let{t:e}=(0,s.Bd)(),{language:t}=(0,r.useContext)(m.c),[n,o]=(0,r.useState)(!1),[b,v]=(0,r.useState)(void 0),y=t||g.Rg||g.Nm;(0,r.useEffect)(()=>{fetch("/privacy-notice-".concat(y,".md")).then(e=>{if(!0===e.ok)return e.text();throw Error("Response not OK")}).then(e=>{v(e)}).catch(t=>{console.error("Error fetching privacy notice: ",t),v(e("onboarding.privacyNotice.errorLoading",{email:"collective.intelligence@nesta.org.uk"}))})},[]);let j=()=>{o(!1)};return void 0!==b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.A,{color:"#fff",href:"#privacy-notice",onClick:e=>{e.preventDefault(),o(!0)},variant:"body3",children:(0,i.jsx)(f.A,{i18nKey:"onboarding.privacyNotice.link"})}),(0,i.jsxs)(c.A,{"aria-labelledby":"privacy-notice-dialog-title",maxWidth:"md",onClose:j,open:n,scroll:"paper",children:[(0,i.jsx)(d.A,{id:"privacy-notice-dialog-title",children:(0,i.jsx)(f.A,{i18nKey:"onboarding.privacyNotice.heading"})}),(0,i.jsx)(u.A,{dividers:!0,sx:{padding:"0"},children:(0,i.jsx)(p.A,{color:"#000",component:"div",ref:e=>{null!==e&&e.focus()},sx:{padding:"2.5rem",":focus-visible":{outline:"none"}},tabIndex:0,variant:"body3",children:(0,i.jsx)(a.oz,{components:w,children:b})})}),(0,i.jsx)(h.A,{children:(0,i.jsx)(x.A,{color:"buttonStandard",onClick:j,sx:{fontSize:"1rem"},children:(0,i.jsx)(f.A,{i18nKey:"button.close"})})})]})]}):null}function A(e){let[t,n]=(0,r.useState)(!1),[s,g]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{fetch(e.workshopInformationUrl).then(e=>{if(!0===e.ok)return e.text();throw Error("Response not OK")}).then(e=>{g(e)}).catch(e=>console.error("Error fetching workshop information: ",e))},[e.workshopInformationUrl]);let m=()=>{n(!1)};return void 0!==s?(0,i.jsxs)(o.A,{sx:{borderLeft:"1px solid #ffffffaa",marginLeft:"1rem",paddingLeft:"1rem"},children:[(0,i.jsx)(l.A,{color:"#fff",href:"#workshop-information",onClick:e=>{e.preventDefault(),n(!0)},variant:"body3",children:(0,i.jsx)(f.A,{i18nKey:"onboarding.workshopInformationLink"})}),(0,i.jsxs)(c.A,{"aria-labelledby":"workshop-information-dialog-title",maxWidth:"md",onClose:m,open:t,scroll:"paper",children:[(0,i.jsx)(d.A,{id:"workshop-information-dialog-title",children:(0,i.jsx)(f.A,{i18nKey:"onboarding.workshopInformationLink"})}),(0,i.jsx)(u.A,{dividers:!0,sx:{padding:"0"},children:(0,i.jsx)(p.A,{color:"#000",component:"div",ref:e=>{null!==e&&e.focus()},sx:{padding:"2.5rem",":focus-visible":{outline:"none"}},tabIndex:0,variant:"body3",children:(0,i.jsx)(a.oz,{components:w,children:s})})}),(0,i.jsx)(h.A,{children:(0,i.jsx)(x.A,{color:"buttonStandard",onClick:m,sx:{fontSize:"1rem"},children:(0,i.jsx)(f.A,{i18nKey:"button.close"})})})]})]}):null}function k(e){var t;let n=null==(t=e.background)||t;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(o.A,{sx:{width:"100%",height:"100%",backgroundImage:n?"url(/images/zg-poster.png)":void 0,backgroundSize:"cover",backgroundPosition:"center",position:"relative",overflow:"hidden"},children:[(0,i.jsx)(o.A,{sx:{position:"absolute",left:0,top:0,width:"50%",bottom:0,backgroundColor:"#3E7075CC"}}),e.rightHalfBackground&&(0,i.jsx)(o.A,{sx:{position:"absolute",right:"0",top:0,width:"50%",bottom:0,backgroundColor:e.rightHalfBackground}}),(0,i.jsxs)(o.A,{sx:{position:"absolute",left:"5%",right:"5%",top:0,bottom:0,display:"flex",flexDirection:"column",justifyContent:"center",overflowY:"auto"},children:[(0,i.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"center"},children:(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"row",alignItems:"start"},children:[(0,i.jsx)(o.A,{sx:{flexGrow:1,flexBasis:0,p:2,pr:"10%"},children:e.children}),(0,i.jsx)(o.A,{sx:{flexGrow:1,flexBasis:0,p:2},children:e.rightPanel})]})}),(0,i.jsxs)(o.A,{className:"onboarding-full-width-footer-container",sx:{display:"flex",flexDirection:"row",pl:2,pb:4},children:[e.privacyNotice&&(0,i.jsx)(j,{}),e.workshopInformationUrl&&(0,i.jsx)(A,{workshopInformationUrl:e.workshopInformationUrl})]})]})]})})}},67230:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(95155),o=n(74577),r=n(80317);let s=e=>{let t=e["data-index"],n=e.ownerState.marks[t],s=e.ownerState.marks.length,a={...e.style,width:"".concat(100/s,"%"),wordWrap:"normal",whiteSpace:"wrap"};return(0,i.jsx)(o.xO,{...e,style:a,children:(0,i.jsx)(r.A,{variant:"sliderMark",style:{display:"block",wordWrap:"normal",whiteSpace:"wrap"},children:n.label})})}},67370:(e,t,n)=>{n.d(t,{A:()=>y,x:()=>v});var i=n(95155),o=n(73017),r=n(54884),s=n(90775),a=n(16751),l=n(25789),c=n(90073),d=n(83958),u=n(97853),p=n(46671),h=n.n(p),x=n(12115),g=n(79952),m=n(31240),f=n(74434),b=n(76150),v=function(e){return e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",e}({});function y(e){var t,n,v,y;let{answers:w}=(0,o.Ay)(e.qids.qid),[j,A]=(0,x.useState)(),k=h().max(null==j?void 0:j.map(e=>e.votes)),{ref:S,height:C}=(0,g.A)();(0,x.useEffect)(()=>{switch(e.inputType){case b.zv.keyed:A((0,b.fo)(w,e.options,e.sorting));break;case b.zv.categorical:A((0,b.hG)(w,e.categories,e.range,e.sorting));break;case b.zv.numerical:A((0,b.xT)((0,b.DU)(w,e.range,e.sorting)));break;default:throw"Unsupported GraphInputType"}},[w,e.categories,e.inputType,e.range]);let I={"& .MuiBarLabel-root":{fill:"white",fontWeight:"bolder"},["& .".concat(d.u.line)]:{strokeDasharray:"5 3",strokeWidth:1}},D={bar:{rx:4,ry:4}},[E,R]=(0,x.useState)(1===e.orientation),F=e=>{R("vertical"===e)},B={tickLabelStyle:{fontSize:null!=(n=e.categoriesLegendFontSize)?n:"1rem"}},P={tickInterval:h().range(0,1e3,1),tickLabelInterval:e=>(0,p.isInteger)(e),valueFormatter:e=>"".concat(e.toFixed(0)),tickLabelStyle:{fontSize:null!=(v=e.valuesLegendFontSize)?v:"1rem"}},T={disableLine:!0,disableTicks:!0,position:"none"},q=void 0,W=!(0,r.s)(k)||k<25,N=(0,l.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(c.A,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e.question&&(0,i.jsx)(f.A,{content:e.question}),(0,i.jsx)(c.A,{ref:S,sx:{flexGrow:1,overflow:"hidden"},children:(0,i.jsxs)(c.A,{children:[(0,r.s)(j)&&E&&(0,i.jsx)(u.E,{layout:"vertical",height:C,xAxis:[{...B,dataKey:"category",height:60}],yAxis:[{...P,...T}],dataset:j,series:[{dataKey:"votes",label:q,color:N.palette.secondary.main}],barLabel:"value",sx:{...I},slotProps:{...D},grid:{vertical:!1,horizontal:W}}),(0,r.s)(j)&&!E&&(0,i.jsx)(u.E,{layout:"horizontal",height:C,yAxis:[{...B,dataKey:"category",width:null!=(y=null==(t=e.margin)?void 0:t.left)?y:150}],xAxis:[{...P,...T}],dataset:j,series:[{dataKey:"votes",label:q,color:N.palette.secondary.main}],barLabel:"value",sx:{...I},slotProps:{...D},grid:{vertical:W,horizontal:!1}})]})}),e.showOrientationControls&&(0,i.jsxs)(c.A,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,i.jsx)(m.A,{btnKey:"vertical",onClick:F,content:(0,i.jsx)(a.A,{}),showText:!1,variant:E?"contained":"outlined",disabled:E,size:"small"}),(0,i.jsx)(m.A,{btnKey:"horizontal",onClick:F,content:(0,i.jsx)(s.A,{}),showText:!1,variant:E?"outlined":"contained",disabled:!E,size:"small"})]})]})})}},68307:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(95155),o=n(80357),r=n(31240);function s(e){let t=()=>{var t;return(0,i.jsx)(r.A,{btnKey:"submit",btnText:e.text,busy:e.busy,disabled:!e.enabled,variant:null!=(t=e.variant)?t:"contained",size:!0===e.large?"large":"medium",sx:e.sx,onClick:t=>e.onSubmit?e.onSubmit():null})},n="left"===e.alignment?"flex-start":"right"===e.alignment?"flex-end":"stretch";return(0,i.jsxs)(i.Fragment,{children:[e.inline&&(0,i.jsx)(t,{}),!e.inline&&(0,i.jsx)(o.A,{sx:e.sx,display:"flex",flexDirection:"row",justifyContent:n,children:(0,i.jsx)(t,{})})]})}},72970:(e,t,n)=>{n.d(t,{Nm:()=>a,Rg:()=>l,Ay:()=>c});var i=n(30338),o=n(24274);let r=JSON.parse('{"button":{"close":"Close","continue":"CONTINUE","getStarted":"GET STARTED","reconnect":"Reconnect","reload":"Reload page","submit":"Submit","goFullScreen":"Go full screen","exitFullScreen":"Exit full screen","retryUpload":"Retry upload","unsure":"Unsure","lowerAllHands":"Lower all hands","lowerHand":"Lower hand","lowerUserHand":"Lower {{name}}\'s hand","muteAll":"Mute all","raiseHand":"Raise hand"},"connectivityCheck":{"failure":{"heading":" Sorry, there\'s a problem","message":"There seems to be a problem with your connection to the workshop."},"fixGuidance":{"checkAgain":"To check again, just reload this page.","message":"To fix this, you could try:","mobileHotspot":"Tether to your phone\'s mobile hotspot.","wiFiNetwork":"A different network, e.g. guest Wi-Fi, or your home Wi-Fi."},"loading":"Checking your connection, please wait a moment.","success":"Your workshop connection is working well ","supportEmail":{"bodyPart1":"Hi Workshop Tech Team,%0D%0A%0D%0AI ran the workshop connectivity checker for an upcoming workshop that I\'m taking part in.%0D%0A%0D%0AThere seems to be a problem with:%0D%0A%0D%0A","bodyPart2":"%0D%0AMy workshop date is: [please enter your workshop date]%0D%0A%0D%0AMy workshop time is: [please enter your workshop time]%0D%0A%0D%0APlease get back to me ASAP via email or [please enter your phone number].%0D%0A%0D%0AMany thanks,%0D%0A%0D%0A[please enter your name]"},"techGuidance":{"contactUs":"If your workshop is starting soon, please email us and we will try to solve the issue quickly:","contactUsCopyEmail":"Copy email address","heading":"If you\'re still stuck","unblock":"Please ask your IT department to unblock the following:"},"title":"Workshop connectivity check","videoCallCheck":"Please also check your audio and camera settings:","videoCallCheckCta":"Check settings","videoCallCheckCtaTip":"(This will open the Amazon Chime Readiness Checker.)"},"label":{"date":"DATE","time":"TIME"},"field":{"yourName":"Your name"},"onboarding":{"warnings":{"*":{"description":" This could have been caused by a poor internet connection","advice":"Please check your wifi or mobile network signal strength and reload this page."},"ZgSessionUserProvider":{"description":" Authorisation did not succeed","advice":["If you are a facilitator, please log in with your facilitator account and try again.","If you are a participant, please contact support for assistance."]},"ZgStaticSessionDataProvider":{"description":" Unable to access information about this workshop session","advice":"Please confirm that you are using the correct url for your workshop."},"ZgServerTimeProvider":{"description":" Unable to synchronise clock with the server","advice":"This is required to play back videos and other media in sync with other participants."},"ZgStaticSessionContentProvider":{"description":" Unable to retrieve session content","advice":"Videos and other media are required to participate in the workshop. This can take a few minutes, and needs a good internet connection."},"ZgResilientWssConnectionProvider":{"description":" Unable to establish a live connection to the workshop","advice":"This is required to participate in the workshop."}},"welcomeTo":"WELCOME TO","loadingWorkshop":"Loading workshop information...","almostThere":"Almost there","pleaseEnterName":"Please enter your name","pleaseEnterNameExplanation":"This is so we know what to call you during the session, your name will not be saved or stored","thanks":"THANKS","youAreAboutToJoin":"YOU ARE ABOUT TO JOIN","thisWorkshopIsClosed":"This workshop is closed.","thisWorkshopIsOpen":"This workshop is open.","pressJoinToEnter":"Press JOIN WORKSHOP to enter.","youAreRemoved":"You have been removed from this workshop.","joinWorkshop":"JOIN WORKSHOP","leaveWorkshop":"LEAVE WORKSHOP","waitingForOpen":"Waiting for the host to begin the session. Please wait...","supportInfoHeading":"Support information","supportInfoText1":"If your workshop start time has passed and you are still waiting to enter the workshop, it\'s possible your device has become disconnected. Please check your internet connection, and use the reconnect button to try again.","supportInfoText2":"If you are still unable to enter the workshop, please check your invite for technical support contact information. We may ask you to reload the page.","privacyNotice":{"heading":"Zeitgeist Privacy Notice","link":"Privacy notice","errorLoading":"# Privacy notice unavailable\\n\\nWe\'re sorry, we should be able to show you a privacy notice here, but for some reason it\'s unavailable.\\n\\nPlease email [{{email}}](mailto:{{email}}) to let us know."},"workshopInformationLink":"Workshop information","sessionClosed":{"sessionIsClosed":"This workshop is now closed.","sessionIsClosedRegisterLinkAvailable":"This workshop is now closed, but please join us for a future session.","encouragement":"Use one of these methods to register, and please share with friends and family.","visitWebsite":"Visit the website","orScanQrCode":"Or scan the QR code","signUpText":"Sign up for more workshops","emailUs":"Email us at"},"preview":{"audio":{"prompt":"Your mic level"}}},"workshop":{"leaveConfirm":"Are you sure you want to leave the workshop?","leaveCta":"LEAVE THE WORKSHOP","participantLeftHeading":"Thank you for participating in this workshop!","participantLeftGuidance":"Feel free to close this tab. Or if you didn\'t mean to leave, click below to rejoin.","rejoinCta":"Rejoin workshop","returnCta":"RETURN TO THE WORKSHOP"},"videoCall":{"outcomeMessages":{"joining":"Joining the workshop video call...","interaction":{"title":"Are you there?","content":"Please click anywhere in this window to let us know you are ready to join the meeting."},"failed":"Failed to connect to the meeting. Please reload the page.","ended":"This meeting has ended.","joinedFromAnotherDevice":"You appear to have joined from another tab. Please close all other tabs and reload the page.","terminalFailure":"Unable to connect to the meeting. Please reload the page.","left":"You have left the meeting."}},"poll":{"pointsAllocation":{"remaining":"{{numberOfPoints}} points remaining"},"upDown":{"notSure":"Unsure"}},"demographic":{"multi-select":{"default-selection-item-prompt":"Please select an option","add-item":"Add","remove-item":"Remove"},"overview":{"submit":"Submit"},"input":{"submit":"Confirm","ratherNotSay":"I would rather not say"}},"audio":{"audioInputSelection":"Microphone","audioOutputSelection":"Speaker","enableMic":"Enable microphone","muteMic":"Mute microphone","reduceBackgroundNoise":"Reduce background noise","settingsMenu":"Audio settings","muted":"Muted"},"audioRecorder":{"checkMic":"Check microphone","preferredMicProblem":"Your browser seems to be using the wrong microphone. Please check your settings and select the Anker PowerConf device."},"transcribing":{"automaticTranscribing":"Automatic transcribing","downloadTranscription":"Download transcription","startTranscribing":"Start transcribing","stopTranscribing":"Stop transcribing","transcribing":"Transcribing","transcriptionId":"Transcription id","transcribingInformation":"Transcribing information","transcriptionCouldNotUpload":"The transcription could not be uploaded","transcriptionUploadFailed":"Transcription upload failed"},"techSupport":{"buttons":{"problemSolved":"Problem solved","stillNeedHelp":"I still need help","support":"Support"},"chooseProblem":"Choose from the list","email":"Email:","phone":"Phone:","pleaseCheck":"Please check the following:","problems":{"cannotHearOthers":{"description":"Audio: I can\'t hear other people","heading":"We\'re sorry that you can\'t hear other people","tip1Heading":"Check if your device\'s sound is switched on","tip1Body":"Look for a volume icon on your screen or keyboard.","tip2Heading":"Check your audio settings","tip2Body":"Click the arrow next to the microphone icon below, then select your preferred speaker from the list.","tip3Heading":"Check your tab isn\'t muted","tip3Body":"In your browser, right-click the tab and look for an \'Unmute site\' option."},"differentProblem":{"description":"A different problem"},"othersCannotHearMe":{"description":"Audio: other people can\'t hear me","heading":"We\'re sorry that other people can\'t hear you","tip1Heading":"Check your microphone isn\'t muted","tip1Body":"Look for the microphone button at the bottom of your screen. If it is red, others won\'t be able to hear you.","tip2Heading":"Check your microphone settings","tip2Body":"Click the arrow next to the microphone icon below, then select your preferred microphone from the list."}},"teamIsAvailable":"Our team is on hand and will get back to you as soon as possible."},"video":{"blurBackground":"Blur my background","disableCamera":"Disable camera","enableCamera":"Enable camera","settingsMenu":"Camera settings","videoInitFailed":"Video failed to initialise.","videoInputSelection":"Camera","videoManualControl":"Please use the video controls to start your video.","videoReadiness":"Your facilitator will start the video as soon as everybody is ready...","notAllReady":"Not all participants are ready to play video."},"upDownResult":{"divisiveDescription":"These statements split the room...","supportedDescription":"Most people agreed with...","opposedDescription":"Most people disagreed with...","unansweredDescription":"Most did not answer..."},"userNametags":{"banned":"banned","joining":"joining","me":"me"},"feedback":{"handLowered":"Your hand has been lowered"}}'),s=JSON.parse('{"button":{"continue":"DEVAM ET","getStarted":"Balayn","reconnect":"Tekrar balan","submit":"G\xf6nder","goFullScreen":"Tam ekran moduna ge\xe7","exitFullScreen":"Tam ekran kapat","unsure":"Fikrim yok"},"label":{"date":"Tarih","time":"Saat"},"field":{"yourName":"Adnz"},"onboarding":{"welcomeTo":"Ho Geldiniz","loadingWorkshop":"At\xf6lye bilgilerini y\xfckl\xfcyor...","almostThere":"Neredeyse bitti","pleaseEnterName":"L\xfctfen adnz girin","pleaseEnterNameExplanation":"Bu, seans srasnda size nasl hitap edeceimizi bilmek i\xe7indir, adnz kaydedilmeyecek veya saklanmayacaktr","thanks":"Teekk\xfcrler","youAreAboutToJoin":"Katlmak \xfczeresiniz","waitingForOpen":"Sunucuyu seans balatmay bekliyor. L\xfctfen bekleyin."},"poll":{"pointsAllocation":{"remaining":"{{numberOfPoints}} puan kald"},"upDown":{"notSure":"Fikrim yok"}},"video":{"videoInitFailed":"Video balatlamad","videoManualControl":"Videonuzu balatmak i\xe7in video kontrollerini kullann l\xfctfen","videoReadiness":"Kolaylatrcnz herkes hazr olduunda videoyu balatacak..."}}'),a="en",l="en";if(!l)throw"No language found in environment";let c=e=>(i.Ay.isInitialized||i.Ay.use(o.r9).init({resources:{en:{common:r},tr:{common:s}},lng:null!=e?e:l,fallbackLng:a,defaultNS:"common",returnObjects:!0}),i.Ay)},73017:(e,t,n)=>{n.d(t,{Ay:()=>c,Qy:()=>l,_i:()=>a,fV:()=>s});var i=n(12115),o=n(98314);let r=e=>{let t={};return e.forEach(e=>{var n;t[e.questionId]=[...null!=(n=t[e.questionId])?n:[],e]}),t},s=(e,t,n)=>{var i;return null!=(i=a(e,t))?i:((e,t)=>{let{sid:n,pid:i,qid:o}=e;return{id:void 0,created:void 0,deliberationSessionId:n,questionId:o,participantId:i,jsonValue:void 0,pII:t}})(t,null!=n&&n)},a=(e,t)=>null==e?void 0:e.find(e=>e.questionId===t.qid&&e.participantId===t.pid),l=e=>(null==e?void 0:e.jsonValue)!==void 0;function c(e){var t;let{session:n}=(0,i.useContext)(o.$),[s,a]=(0,i.useState)(null!=(t=n.answers)?t:[]),[l,c]=(0,i.useState)(r(n.answers));return(0,i.useEffect)(()=>{var t;a(void 0!==e?n.answers.filter(t=>t.questionId===e):[]),c(null!=(t=r(n.answers))?t:{})},[n.answers]),{answers:s,allAnswers:l}}},74084:(e,t,n)=>{n.d(t,{V:()=>i});let i=e=>{let t=e%10,n=e%100;return 1===t&&11!==n?e+"st":2===t&&12!==n?e+"nd":3===t&&13!==n?e+"rd":e+"th"}},74434:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(95155),o=n(80357),r=n(80317);function s(e){var t,n,s,a,l,c;return(0,i.jsx)(i.Fragment,{children:((null==(t=e.content)?void 0:t.explanation)||(null==(n=e.content)?void 0:n.instruction)||(null==(s=e.content)?void 0:s.question))&&(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch"},children:[e.content.instruction&&(0,i.jsx)(r.A,{variant:"questionInstruction",align:null!=(a=e.forceAlign)?a:"center",component:"div",sx:{alignSelf:"stretch",textWrap:"balance",...e.sx},children:e.content.instruction}),e.content.question&&(0,i.jsx)(r.A,{variant:"questionPrompt",align:null!=(l=e.forceAlign)?l:"center",component:"div",sx:{alignSelf:"stretch",textWrap:"balance",...e.sx},children:e.content.question}),e.content.explanation&&(0,i.jsx)(r.A,{variant:"questionExplanation",align:null!=(c=e.forceAlign)?c:"center",component:"div",sx:{alignSelf:"stretch",textWrap:"balance",...e.sx},children:e.content.explanation})]})})}},74821:(e,t,n)=>{n.d(t,{m:()=>i});class i{constructor(){this.isLocked=!1,this.acquisitions=0,this.releases=0,this.queue=[],this.acquire=()=>new Promise(e=>{this.isLocked?this.queue.push(()=>{this.acquisitions++,e()}):(this.isLocked=!0,this.acquisitions++,e())}),this.release=()=>{this.releases++,this.queue.length>0?this.queue.shift()():this.isLocked=!1}}}},76150:(e,t,n)=>{n.d(t,{DU:()=>u,fo:()=>c,hG:()=>d,xT:()=>f,zv:()=>s});var i=n(54884),o=n(46671),r=n.n(o),s=function(e){return e[e.categorical=0]="categorical",e[e.numerical=1]="numerical",e[e.keyed=2]="keyed",e}({});let a=e=>{var t,n;return r().range(e.lo,e.hi+(null!=(t=e.step)?t:1),null!=(n=e.step)?n:1)},l=e=>e.replace(/\\n/g,"\n"),c=(e,t,n)=>p(t.map(t=>({category:l(t.title),votes:g(e,t.key)})),n),d=(e,t,n,i)=>p(h(t,n).map((t,n)=>({category:l(t),votes:x(e,n)})),i),u=(e,t,n)=>p(a(t).map(t=>({value:t,votes:m(e,t)})),n),p=(e,t)=>{if((0,i.s)(t.sortOn)){switch(t.sortOn){case"category":(e=>e.length>0&&"category"in e[0]&&"votes"in e[0])(e)&&e.sort((e,t)=>e.category<t.category?-1:1);break;case"value":(e=>e.length>0&&"value"in e[0]&&"votes"in e[0])(e)&&e.sort((e,t)=>e.value<t.value?-1:1);break;case"votes":e.sort((e,t)=>e.votes-t.votes);break;default:throw"Unsupported sortOn: ".concat(t.sortOn)}"desc"===t.sortOrder&&e.reverse()}return e},h=(e,t)=>{let n=void 0!==e?e:void 0!==t?a(t).map(e=>"".concat(e)):void 0;if(void 0===n)throw"Cannot determine categories";return n.filter(e=>void 0!==e).map(e=>e)},x=(e,t)=>r().sum(e.map(e=>{var n;return r().sum(null==(n=e.jsonValue)?void 0:n.answers.filter(e=>e.index===t).map(e=>{var t;return null!=(t=e.numericValue)?t:0}))})),g=(e,t)=>r().sum(e.map(e=>{var n;return r().sum(null==(n=e.jsonValue)?void 0:n.answers.filter(e=>e.key===t).map(e=>{var t;return null!=(t=e.numericValue)?t:0}))})),m=(e,t)=>x(e,t),f=e=>e.map(e=>({category:"".concat(e.value),votes:e.votes}))},76452:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(98314),o=n(25612),r=n(84073),s=n(18414),a=n(12115);function l(e){let{session:t}=(0,a.useContext)(i.$),{user:n,deviceId:l,sessionToken:c}=(0,a.useContext)(r.yk),{api:d,start:u}=(0,a.useContext)(s.F),p=(0,a.useContext)(o.j);return{kickUser:async i=>{try{e(!0);let o={action:"kick",sessionId:t.id,ticks:Date.now(),originator:l,parameters:{pid:i.deviceId}};await u(d.postFacilitatorAction(n.access_token,c,o,!1))}catch(e){console.warn(e)}finally{e(!1)}},lowerHandsAll:(e,n)=>{try{if(!p.sendMessage({action:"user-signals",content:{signal:{kind:"raiseHand"},signalAction:"remove",targetDeviceIds:e.map(e=>e.deviceId).filter(e=>e!==(null==n?void 0:n.deviceId))},sid:t.id,type:"user-signals-request"}))throw"Couldn't lower everybody's hands"}catch(e){console.warn(e)}},lowerHandUser:e=>{try{if(!p.sendMessage({action:"user-signals",content:{signal:{kind:"raiseHand"},signalAction:"remove",targetDeviceIds:[e.deviceId]},sid:t.id,type:"user-signals-request"}))throw"Couldn't lower ".concat(e.participantName,"'s hand")}catch(e){console.warn(e)}},muteAll:async()=>{try{e(!0);let i={action:"mute",sessionId:t.id,ticks:Date.now(),originator:l,parameters:{pids:["*"]}};await u(d.postFacilitatorAction(n.access_token,c,i,!1))}finally{e(!1)}},muteUser:async i=>{try{e(!0);let o={action:"mute",sessionId:t.id,ticks:Date.now(),originator:l,parameters:{pids:[i.deviceId]}};await u(d.postFacilitatorAction(n.access_token,c,o,!1))}catch(e){console.warn(e)}finally{e(!1)}}}}},77757:(e,t,n)=>{n.d(t,{Ay:()=>u,nh:()=>d,qW:()=>c});var i=n(95155),o=n(18932),r=n(12115),s=n(57300),a=n(45238),l=n(17448);let c=(0,r.createContext)({}),d=(e,t)=>{if(void 0===e&&void 0===t)return!0;if(void 0===e||void 0===t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].subscriptionId!=e[n].subscriptionId)return!1;return!0};function u(e){let{subscriptions:t,deviceIdBanList:n,thisUser:u}=(0,r.useContext)(s.f),{isPreview:p}=(0,r.useContext)(a.K),[h,x]=(0,r.useState)([]),[g,m]=(0,r.useState)([]),[f,b]=(0,r.useState)({tiles:[]});(0,r.useEffect)(()=>{let i=t.filter(e=>void 0===n.find(t=>e.deviceId===t)),r=[...i.filter(e=>e.deviceId!==(null==u?void 0:u.deviceId)&&e.role===o.sW.Controller)].sort((e,t)=>e.deviceId.localeCompare(t.deviceId)),s=[...i.filter(e=>e.deviceId!==(null==u?void 0:u.deviceId)&&e.role===o.sW.Client)].sort((e,t)=>e.deviceId.localeCompare(t.deviceId)),a=p?u?[u]:[]:e.role===o.sW.Client?[...r,...u?[u]:[],...s]:[...u?[u]:[],...r,...s];d(a,h)||x(a)},[t,n]);let v=e=>"video-tile-".concat(e.subscriptionId);return(0,r.useEffect)(()=>{let e=[];h.forEach((t,n)=>{let o=g.find(e=>e.key===v(t));o?e.push(o):e.push((0,i.jsx)(l.Ay,{subscription:t,test:!1},v(t)))}),((e,t)=>{if(void 0===e&&void 0===t)return!0;if(void 0===e||void 0===t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n].key!==t[n].key)return!1;return!0})(e,g)||m(e)},[h]),(0,r.useEffect)(()=>{b({tiles:g})},[g]),(0,i.jsx)(c.Provider,{value:f,children:e.children})}},77914:(e,t,n)=>{n.d(t,{T:()=>i});let i=(0,n(12115).createContext)({})},78055:(e,t,n)=>{n.d(t,{M:()=>o,t:()=>i});var i=function(e){return e[e.default=0]="default",e[e.deliberation=1]="deliberation",e}({});let o={index:0,activity:0,recordingId:void 0,notes:"",qids:[],secs:void 0,transitionSound:!1}},78211:(e,t,n)=>{n.d(t,{A:()=>a,c:()=>s});var i=n(95155),o=n(12115),r=n(23971);let s=(0,o.createContext)({});function a(e){var t;let[n,a]=(0,o.useState)({language:null!=(t=e.searchParams.get("lang"))?t:void 0,voiceFocus:(0,r.$_)(e.searchParams.get("vf")),backgroundBlur:(0,r.$_)(e.searchParams.get("bb")),storage:e.searchParams.get("storage"),meetingDebug:(0,r.$_)(e.searchParams.get("md"))});return(0,i.jsx)(s.Provider,{value:n,children:e.children})}},79005:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(95155),o=n(62652),r=n(80357),s=n(80317),a=n(27855);function l(e){let t=!0===e.white?"white":"black",n=!0===e.white?{filter:"invert(100%) sepia(3%) saturate(594%) hue-rotate(149deg) brightness(117%) contrast(100%)"}:void 0;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.A,{sx:{mb:2},children:[e.welcome&&(0,i.jsx)(s.A,{variant:"body1",color:t,children:(0,i.jsx)(o.A,{i18nKey:"onboarding.welcomeTo"})}),(0,i.jsx)(s.A,{variant:"h2",color:t,children:e.session.sessionName})]}),(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column"===e.layout?"column":"row"},gap:2,children:[(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"row",alignItems:"column"===e.layout?"start":"center",gap:1},children:[(0,i.jsx)("img",{src:"/icons/session-date.svg",style:n}),(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column"===e.layout?"column":"row",alignItems:"column"===e.layout?"flex-start":"center",gap:1},children:[(0,i.jsx)(s.A,{variant:"body2",color:t,children:(0,i.jsx)(o.A,{i18nKey:"label.date"})}),(0,i.jsx)(s.A,{variant:"body1",style:{fontWeight:"bold"},color:t,children:new Date(e.session.sessionStartTime).toDateString()})]})]}),(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"row",alignItems:"column"===e.layout?"start":"center",gap:1},children:[(0,i.jsx)("img",{src:"/icons/session-time.svg",style:n}),(0,i.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column"===e.layout?"column":"row",alignItems:"column"===e.layout?"flex-start":"center",gap:1},children:[(0,i.jsx)(s.A,{variant:"body2",color:t,children:(0,i.jsx)(o.A,{i18nKey:"label.time"})}),(0,i.jsx)(s.A,{variant:"body1",style:{fontWeight:"bold"},color:t,children:new Date(e.session.sessionStartTime).toLocaleTimeString()})]})]})]}),void 0!==e.onAdvance&&(0,i.jsx)(a.A,{variant:"contained",color:"primary",onClick:e.onAdvance,sx:{alignSelf:"start"},children:"Next"})]})}},79178:(e,t,n)=>{n.d(t,{$1:()=>b,$u:()=>p,Ap:()=>v,F8:()=>h,Fq:()=>y,Qs:()=>m,SP:()=>g,UI:()=>x,p1:()=>d,tX:()=>f,zd:()=>u});var i=n(56599),o=n(74879),r=n(78055),s=n(91396),a=n(63608),l=n(67370),c=n(76150);let d=(e,t)=>{if(void 0!==e){let i=(0,o.A)();if(void 0!==e.key&&null!==e.key){var n;return{...e,key:"".concat(t,"-").concat(null!=(n=e.key)?n:"undefined","+").concat(i)}}}},u=e=>e?Object.fromEntries(e.split(";").map(e=>e.trim().split(":").map(e=>e.trim()))):{},p=e=>e?Object.fromEntries(e.split(";").map(e=>e.trim().split(":").map(e=>e.trim()))):{},h=e=>{if(null!=e&&0!==e.length)return(0,i.q)(e,{columns:!1,skip_empty_lines:!0,trim:!0})[0]},x=e=>null==e?void 0:e.map((e,t)=>""===e?" ".repeat(t):e),g=e=>{let t=parseFloat(null!=e?e:"");return isNaN(t)?void 0:t},m=e=>{let t=null==e?void 0:e.toLowerCase(),n=s.a[t];if(void 0===n)throw console.error("Unknown slider input type: ".concat(e)),"Unknown slider input type: ".concat(e);return n},f=e=>{let t=null==e?void 0:e.toLowerCase(),n=c.zv[t];if(void 0===n)throw console.error("Unknown graph input type: ".concat(e)),"Unknown graph input type: ".concat(e);return n},b=e=>{let t=null==e?void 0:e.toLowerCase(),n=l.x[t];if(void 0===n)throw console.error("Unknown graph orientation: ".concat(e)),"Unknown graph orientation: ".concat(e);return n},v=e=>{let t=null==e?void 0:e.toLowerCase(),n=a.G[t];if(void 0===n)throw console.error("Unknown text input type: ".concat(e)),"Unknown text input type: ".concat(e);return n},y=e=>{let t=null==e?void 0:e.toLowerCase(),n=r.t[t];if(void 0===n)throw console.error("Unknown slide activity: ".concat(e)),"Unknown slide activity: ".concat(e);return n}},79200:(e,t,n)=>{n.d(t,{A:()=>a,F:()=>s});var i=n(95155),o=n(12115),r=n(69999);let s=(0,o.createContext)({allUserSignals:[]});function a(e){let[t,n]=(0,o.useState)([]),[a,l]=(0,o.useState)();return(0,o.useEffect)(()=>(r.A.on(r.m.User_Signals_Update,l),()=>{r.A.off(r.m.User_Signals_Update,l)}),[]),(0,o.useEffect)(()=>{if(void 0!==a&&a.type===r.m.User_Signals_Update){var e;e=a.data,n(t=>[...t.filter(t=>!e.some(e=>e.userSignalsId===t.userSignalsId)),...e])}},[a]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.Provider,{value:{allUserSignals:t},children:e.children})})}},80431:(e,t,n)=>{n.d(t,{Ay:()=>b,O6:()=>x,Of:()=>g,Zm:()=>h,cA:()=>u,nI:()=>p,zJ:()=>m});var i=n(95155),o=n(12115),r=n(18932),s=n(78055),a=n(54884),l=n(98314),c=n(84073),d=n(18414);let u=()=>{let{revealIndex:e,setRevealIndex:t,targetIndex:n,setTargetIndex:i}=(0,o.useContext)(f);if(!(0,a.s)(t))throw Error("useRevealState should be used within ZgSessionLiveSlideDataProvider");return{revealIndex:e,setRevealIndex:t,targetIndex:n,setTargetIndex:i}},p=()=>{let{revealIndex:e,setTargetIndex:t}=(0,o.useContext)(f);if(!(0,a.s)(t))throw Error("useRevealControls should be used within ZgSessionLiveSlideDataProvider");return{revealIndex:e,setTargetIndex:t}},h=()=>{let{slideData:e}=(0,o.useContext)(f);if(!(0,a.s)(e))throw Error("useSlideData should be used within ZgSessionLiveSlideDataProvider");return{slideData:e}},x=()=>{let{setSlideData:e}=(0,o.useContext)(f);if(!(0,a.s)(e))throw Error("useSlideData should be used within ZgSessionLiveSlideDataProvider");return{setSlideData:e}},g=()=>{let{allSlideAnswerRules:e}=(0,o.useContext)(f);if(!(0,a.s)(e))throw Error("useSlideAnswerRules should be used within ZgSessionLiveSlideDataProvider");return{allSlideAnswerRules:e}},m=()=>{let{setAllSlideAnswerRules:e}=(0,o.useContext)(f);if(!(0,a.s)(e))throw Error("useWriteSlideAnswerRules should be used within ZgSessionLiveSlideDataProvider");return{setAllSlideAnswerRules:e}},f=(0,o.createContext)({});function b(e){let{role:t}=(0,o.useContext)(c.yk),{session:n}=(0,o.useContext)(l.$),{user:u,sessionToken:p,deviceId:h}=(0,o.useContext)(c.yk),[x,g]=(0,o.useState)({}),[m,b]=(0,o.useState)(s.M),[v,y]=(0,o.useState)(),[w,j]=(0,o.useState)();(0,o.useRef)(0);let{start:A,api:k}=(0,o.useContext)(d.F);(0,o.useEffect)(()=>{t===r.sW.Controller&&S()},[]),(0,o.useEffect)(()=>{(0,a.s)(v)&&t===r.sW.Controller&&(C(v),I(v))},[v]);let S=()=>{let e=window.localStorage.getItem("RevealState-".concat(n.id));e&&j(JSON.parse(e).index)},C=e=>{if(t===r.sW.Controller){let t=JSON.stringify({index:e});window.localStorage.setItem("RevealState-".concat(n.id),t)}},I=async e=>{if(!(0,a.s)(u)||t!==r.sW.Controller||!(0,a.s)(n.id)||!(0,a.s)(p))return;let i={action:"set-slide-position",sessionId:n.id,ticks:Date.now(),originator:h,parameters:{indexh:e}};await A(k.postFacilitatorAction(u.access_token,p,i))};return(0,i.jsx)(f.Provider,{value:{allSlideAnswerRules:x,setAllSlideAnswerRules:g,slideData:m,setSlideData:b,revealIndex:v,setRevealIndex:y,targetIndex:w,setTargetIndex:j},children:e.children})}},80890:(e,t,n)=>{n.d(t,{Fp:()=>c,Xb:()=>r,eb:()=>d,l1:()=>a,oq:()=>l,wS:()=>s});var i=n(34824),o=n(54884);function r(e){return(0,o.s)(e)&&e instanceof i.VoiceFocusTransformDevice}function s(e){return(0,o.s)(e)&&e instanceof i.DefaultVideoTransformDevice}let a=async e=>(0,o.s)(e)?r(e)?await e.getInnerDevice():e:void 0,l=async e=>(0,o.s)(e)?s(e)?await e.getInnerDevice():e:void 0,c=async(e,t,n,i)=>{if(t&&!r(n)&&void 0===e)return console.debug("Unable to apply Voice Focus: not ready yet"),n;if(t&&!r(n)&&!1===e)return console.warn("Unable to apply Voice Focus: not supported"),n;let s=!0===e&&!0===t&&(0,o.s)(n)&&!r(n),a=!1===t&&(0,o.s)(n)&&r(n);return s?await i(n):a?(n.stop(),n.getInnerDevice()):void 0},d=async(e,t,n,i)=>{if(t&&!s(n)&&void 0===e)return console.debug("Unable to apply Background Blur: not ready yet"),n;if(t&&!s(n)&&!1===e)return console.warn("Unable to apply Background Blur: not supported"),n;let r=!0===e&&!0===t&&(0,o.s)(n)&&!s(n),a=!1===t&&(0,o.s)(n)&&s(n);return r?(console.debug("Applying background blur to video device",n),await i(n)):a?n.getInnerDevice():void 0}},84073:(e,t,n)=>{n.d(t,{Ay:()=>p,yk:()=>u});var i=n(95155),o=n(12115),r=n(74840),s=n(74879),a=n(18932),l=n(54884),c=n(18414),d=function(e){return e[e.Init=0]="Init",e[e.Authenticating=1]="Authenticating",e[e.AuthError=2]="AuthError",e[e.AuthNotRequired=3]="AuthNotRequired",e[e.Authenticated=4]="Authenticated",e[e.ExchangingJoinCode=5]="ExchangingJoinCode",e[e.JoinCodeError=6]="JoinCodeError",e[e.JoinCodeAccepted=7]="JoinCodeAccepted",e[e.Ready=8]="Ready",e}({});let u=(0,o.createContext)({});function p(e){var t,n;let[p,h]=(0,o.useState)(null!=(n=null==(t=window)?void 0:t.localStorage.getItem("DeviceId"))?n:(0,s.A)());(0,o.useEffect)(()=>{window&&window.localStorage.setItem("DeviceId",p)},[p]);let[x,g]=(0,o.useState)(0),[m,f]=(0,o.useState)(void 0),[b,v]=(0,o.useState)(e.role),[y,w]=(0,o.useState)(),[j,A]=(0,o.useState)(!1),[k,S]=(0,o.useState)(!1),[C,I]=(0,o.useState)({deviceId:p,role:b,state:x,user:m,sessionToken:y,noUserWarning:k});(0,o.useEffect)(()=>{I({...C,state:x})},[x]),(0,o.useEffect)(()=>{I({...C,user:m})},[m]),(0,o.useEffect)(()=>{I({...C,role:b})},[b]),(0,o.useEffect)(()=>{I({...C,sessionToken:y})},[y]),(0,o.useEffect)(()=>{I({...C,noUserWarning:k})},[k]);let D=(0,r.As)(),{api:E,start:R}=(0,o.useContext)(c.F);return(0,o.useEffect)(()=>D.events.addAccessTokenExpiring(async()=>{console.debug("Access token renewal with auth.signinSilent()...");let e=await D.signinSilent();console.debug("User renewal: ".concat(e?"found":"not found")),f(e)}),[D.events,D.signinSilent]),(0,o.useEffect)(()=>{switch(console.debug("User state",d[x]),x){case 0:switch(b){case a.sW.Controller:g(1);break;case a.sW.Client:g(3),f(null);break;default:throw"Unsupported role: ".concat(a.sW[b])}break;case 1:D.signinSilent().then(e=>{null!==e?(console.info("User found",e.profile.email),f(e),g(4)):(console.debug("Not authenticated"),f(void 0),g(2))}).catch(e=>{console.error(e),f(void 0),g(2)});break;case 2:case 6:break;case 4:case 3:g(5);break;case 5:let t={deviceId:p,role:b,joinCode:e.joinCode,sessionId:e.sid};R(E.exchangeJoinCodeForSessionToken(t,null==m?void 0:m.access_token)).then(e=>{(0,l.s)(e)?(w(e.sessionToken),g(7)):console.debug("Join code exchange superseded.")}).catch(e=>{console.error(e),g(6)});break;case 7:g(8)}A(!![2,6].find(e=>e===x))},[x]),(0,o.useEffect)(()=>{S(null===m),null===m&&8===x&&console.error("No user found through Auth. The facilitator will not be able to manage the session.")},[m]),(0,i.jsxs)(i.Fragment,{children:[j&&e.err,8!==x&&!j&&e.load,8===x&&!j&&(0,i.jsx)(u.Provider,{value:C,children:e.children})]})}},86004:(e,t,n)=>{n.d(t,{Ay:()=>m,M9:()=>g,UW:()=>x});var i=n(95155),o=n(73017),r=n(18932),s=n(62652),a=n(80357),l=n(75970),c=n(60193),d=n(80317),u=n(57915),p=n(12115),h=n(74434),x=function(e){return e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unsure=2]="Unsure",e}({});let g=e=>1===e?0:-1===e?1:2;function m(e){var t;let{answers:n}=(0,o.Ay)(e.qids.qid),[g,m]=(0,p.useState)((0,o.fV)(n,e.qids,null==(t=e.question)?void 0:t.pii)),[f,b]=(0,p.useState)(g),[v,y]=(0,p.useState)(!1),w=e.role===r.sW.Client;(0,p.useEffect)(()=>{b({...g})},[g]);let j=async e=>{if(w&&!v){let t={...f,jsonValue:{answers:[{key:"vote",stringValue:x[e],numericValue:0===e?1:1===e?-1:0}]}};await A(t)}},A=async t=>{try{y(!0);let n=await e.onAnswer(t);if(null!==n)m(n);else throw"Failed to submit answer"}catch(e){console.error(e)}finally{y(!1)}},k=(0,u.A)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(a.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,i.jsx)(h.A,{content:e.question}),(0,i.jsxs)(a.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,i.jsxs)(l.A,{elevation:0,sx:{p:4,mb:2,width:"60%",height:"70%",alignSelf:"center",minHeight:200,borderRadius:4,background:k.palette.promptPanelBackground.main,display:"flex",flexDirection:"row",alignContent:"center",justifyContent:"stretch"},children:[(0,i.jsx)(a.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,i.jsx)("div",{style:{position:"absolute",width:"15%",height:"20%",padding:0,margin:0},children:(0,i.jsx)(c.A,{sx:{position:"relative",left:"-100%",top:0,width:"100%",height:"100%",m:0,p:0},onClick:()=>j(1),disabled:!w||v,style:{opacity:w&&!v?1:.5},children:(0,i.jsx)("img",{src:"/icons/updown/cross.svg",alt:"False button icon"})})})}),(0,i.jsx)(a.A,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center",p:2},children:(0,i.jsx)(d.A,{variant:"upDownQuestion",sx:{textAlign:"center",alignSelf:"center"},children:e.assertion})}),(0,i.jsx)(a.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,i.jsx)("div",{style:{position:"absolute",width:"15%",height:"20%",padding:0,margin:0},children:(0,i.jsx)(c.A,{sx:{position:"relative",right:0,top:0,width:"100%",height:"100%",m:0,p:0},style:{opacity:w&&!v?1:.5},onClick:()=>j(0),disabled:!w||v,children:(0,i.jsx)("img",{src:"/icons/updown/check.svg",alt:"True button icon"})})})})]}),(0,i.jsx)(a.A,{sx:{p:2,borderRadius:4,cursor:"pointer",opacity:w&&!v?1:.5,alignSelf:"center"},onClick:()=>j(2),display:"flex",flexDirection:"column",justifyContent:"center",children:(0,i.jsx)(d.A,{variant:"submitButton",style:{borderBottom:"solid 1px black"},children:(0,i.jsx)(s.A,{i18nKey:"poll.upDown.notSure"})})})]})]})})}},89207:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(95155),o=n(80357),r=n(4615),s=n(32276),a=n(12115),l=n(24274),c=n(62652),d=n(39268),u=n(59850);let p=[s.e0s.Failed,s.e0s.Ended,s.e0s.JoinedFromAnotherDevice,s.e0s.TerminalFailure,s.e0s.Left];function h(e){let{meetingStatus:t}=(0,a.useContext)(u.s),[n,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t===s.e0s.Succeeded&&h(!0)},[t]);let[x,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{g(t===s.e0s.Succeeded||n&&!p.some(e=>e===t))},[t,n]);let m=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(t===s.e0s.Loading){var e;m.current=null!=(e=m.current)?e:setTimeout(()=>{f()},5e3)}return()=>{m.current&&(clearTimeout(m.current),m.current=null)}},[t]);let f=()=>{m.current&&(clearTimeout(m.current),m.current=null),x||v(!0)};(0,a.useEffect)(()=>{x&&(v(!1),m.current&&(clearTimeout(m.current),m.current=null))},[x]);let[b,v]=(0,a.useState)(!1),{t:y}=(0,l.Bd)();return(0,i.jsxs)(i.Fragment,{children:[x&&e.children,!x&&(0,i.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",...e.sx},children:[(t===s.e0s.Loading||t===s.e0s.Reconnecting)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.A,{severity:"info",children:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.joining"})}),(0,i.jsx)(d.A,{options:[{key:"ready",text:"Ready",filled:!1}],open:b,setOpen:v,title:y("videoCall.outcomeMessages.interaction.title"),content:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.interaction.content"})})]}),t===s.e0s.Failed&&(0,i.jsx)(r.A,{severity:"error",children:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.failed"})}),t===s.e0s.Ended&&(0,i.jsx)(r.A,{severity:"warning",children:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.ended"})}),t===s.e0s.JoinedFromAnotherDevice&&(0,i.jsx)(r.A,{severity:"warning",children:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.joinedFromAnotherDevice"})}),t===s.e0s.TerminalFailure&&(0,i.jsx)(r.A,{severity:"error",children:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.terminalFailure"})}),t===s.e0s.Left&&(0,i.jsx)(r.A,{severity:"info",children:(0,i.jsx)(c.A,{i18nKey:"videoCall.outcomeMessages.left"})})]})]})}},91396:(e,t,n)=>{n.d(t,{A:()=>v,a:()=>f});var i=n(95155),o=n(73017),r=n(18932),s=n(80357),a=n(41477),l=n(13664),c=n(46671),d=n.n(c),u=n(12115),p=n(62652),h=n(74434),x=n(68307),g=n(39846),m=n(67230),f=function(e){return e[e.continuous=0]="continuous",e[e.discrete=1]="discrete",e[e.categorical=2]="categorical",e}({});let b=(e,t)=>{var n;return{answers:[{key:"".concat(e),index:e,description:null!=(n=null==t?void 0:t[e])?n:"".concat(e),numericValue:1}]}};function v(e){var t;let{answers:n}=(0,o.Ay)(e.qids.qid),c=()=>{var t;return(0,o.fV)(n,e.qids,null==(t=e.question)?void 0:t.pii)},[v,y]=(0,u.useState)(c()),[w,j]=(0,u.useState)(c()),[A,k]=(0,u.useState)(!1),[S,C]=(0,u.useState)(e.role===r.sW.Client),[I,D]=(0,u.useState)(!1);(0,u.useEffect)(()=>{var t;j({...v,jsonValue:null!=(t=v.jsonValue)?t:b(Math.floor((F()+B())/2),e.marks)})},[v]);let E=async()=>{if(e.role!==r.sW.Client)return void console.warn("Only participants can submit answers");k(!0),e.onAnswer(w).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)y(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{k(!1)})},R=async()=>{if(e.role!==r.sW.Client)return void console.warn("Only participants can submit answers");k(!0);let t={...w,jsonValue:{answers:[{key:"unsure",description:"unsure",numericValue:1}]}};e.onAnswer(t).then(e=>{if(console.debug("Answer submitted ".concat(e?"ok":"error")),console.debug("Received answer response",e),e)y(e);else throw"No response received"}).catch(e=>{console.error(e)}).finally(()=>{k(!1)})},F=()=>{switch(e.type){case 2:return 0;case 0:case 1:return e.numericRange?e.numericRange[0]:0;default:throw"Unsupported SliderInputType ".concat(f[e.type])}},B=()=>{switch(e.type){case 2:return e.marks.length-1;case 0:case 1:return e.numericRange?e.numericRange[1]:10;default:throw"Unsupported SliderInputType ".concat(f[e.type])}},P=()=>{var t,n;switch(e.type){case 2:return 1;case 0:return null!=(t=e.numericStep)?t:.01;case 1:return null!=(n=e.numericStep)?n:1;default:throw"Unsupported SliderInputType ".concat(f[e.type])}},T=e.marks?100-100/e.marks.length:void 0,q=T?"".concat(T,"%"):void 0;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.A,{className:"stretch",sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,i.jsxs)(s.A,{sx:{display:"flex",flexDirection:"column",flexGrow:1,alignItems:"center",justifyContent:"center",px:4,gap:8},children:[(0,i.jsx)(s.A,{children:e.question&&(0,i.jsx)(h.A,{content:e.question})}),(0,i.jsx)(s.A,{sx:{width:null!=q?q:"95%"},children:(0,i.jsx)(g.A,{onCommit:t=>{j({...w,jsonValue:b(t,e.marks)})},color:"secondary",disabled:I,sliderDefault:w.jsonValue?d().toNumber(w.jsonValue.answers[0].index):Math.floor((F()+B())/2),marks:null!=(t=(()=>{switch(e.type){case 2:return e.marks.map((e,t)=>({value:t,label:e}));case 0:return;case 1:return d().range(e.numericRange[0],e.numericRange[1]+1,P()).map((e,t)=>({value:e,label:"".concat(e)}))}})())&&t,slots:{markLabel:m.A},min:F(),max:B(),step:P(),sliderMode:"solo"})}),e.showUnsure&&(0,i.jsx)(s.A,{children:(0,i.jsx)(a.A,{control:(0,i.jsx)(l.A,{checked:I,onChange:(e,t)=>D(t)}),label:(0,i.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.25rem"},children:(0,i.jsx)(p.A,{i18nKey:"button.unsure"})})})})]}),e.role===r.sW.Client&&(0,i.jsx)(s.A,{children:(0,i.jsx)(x.A,{onSubmit:()=>{I?R():E()},text:(0,i.jsx)(p.A,{i18nKey:"button.submit"}),busy:A,enabled:S,inline:!1,alignment:"right"})})]})})}},96827:(e,t,n)=>{n.d(t,{A:()=>c});var i=n(95155),o=n(72970),r=n(12115),s=n(24274),a=n(78211),l=n(2492);function c(e){let{language:t}=(0,r.useContext)(a.c),[n,c]=(0,r.useState)((0,o.Ay)(t));return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.xC,{i18n:n,children:(0,i.jsx)(l.A,{sid:e.sid,role:e.role,refresh:e.refresh,joinCode:e.joinCode,children:e.children})})})}},98314:(e,t,n)=>{n.d(t,{$:()=>x,A:()=>g});var i=n(95155),o=n(12115),r=n(80015),s=n(30349),a=n(60071),l=n(18932),c=n(69999),d=n(54884),u=n(84073),p=n(10310),h=n(18414);let x=(0,o.createContext)({});function g(e){let{sid:t,publicContent:n,session:g}=(0,o.useContext)(p.L),{sessionToken:m}=(0,o.useContext)(u.yk),[f,b]=(0,o.useState)(g),{api:v,start:y}=(0,o.useContext)(h.F),w=(0,o.useContext)(u.yk),[j,A]=(0,o.useState)([]),k=e=>{A(t=>[...t,e])},S=e=>{A(t=>t.filter(t=>t.id!==e.id))};(0,o.useEffect)(()=>(c.A.on(c.m.WSS_Distribute_Message,k),c.A.on(c.m.WSS_Update_ConnectionState,k),c.A.on(c.m.WSS_Refresh_Session,k),()=>{c.A.off(c.m.WSS_Distribute_Message,k),c.A.off(c.m.WSS_Update_ConnectionState,k),c.A.off(c.m.WSS_Refresh_Session,k)}),[]);let C=(0,o.useRef)(!1);(0,o.useEffect)(()=>{let e=async()=>{console.debug("Refresh session...");try{if(w.role===l.sW.Controller){var e;if((null==(e=w.user)?void 0:e.access_token)===void 0)throw"User or access token is undefined";let n=await y(v.getDeliberationSessionAdmin(t,m,w.user.access_token,"live-session-refresh"));(0,d.s)(n)?b(n):console.warn("Received undefined session on refresh.")}else{let e=await (0,s.O)(v,y,t,m);(0,d.s)(e)&&b(e)}}catch(e){console.error("Error fetching session data.",e)}},n=t=>{console.debug("Connection state changed: ".concat(l.jB[t])),t===l.jB.Joined&&(e(),C.current=!0)};for(let t of j)try{switch(t.type){case c.m.WSS_Update_ConnectionState:n(t.data);break;case c.m.WSS_Distribute_Message:I(t.data);break;case c.m.WSS_Refresh_Session:e()}}finally{S(t)}},[v,j,m,t,y,w.role,w.user]);let I=e=>{if("distribute"===e.action)if("ZgDiff"!==e.type)return void console.warn("Unhandled distribution message type: ".concat(e.type));else{let t=e.content;"session"===t.updateTarget&&b(e=>(0,a.$)(e,t))}if("send"===e.action)switch(e.type){case"full-session-update":let t=e.content.session;b(e=>{var n;return{...t,joinCode:null!=(n=t.joinCode)?n:e.joinCode}});break;case"simple-session-update":console.warn("Ignoring deprecated simple-session-update message");break;case"live-state-update":console.warn("Ignoring deprecated live-state-update message");break;case"participant-record-distribution":let n=e.content.record;b(e=>({...e,participantRecords:[...e.participantRecords.filter(e=>!(0,r.eC)(e,n)),n]}));break;case"meeting-update":console.warn("Ignoring deprecated meeting-update message");break;case"answer-summary-update":console.warn("Ignoring deprecated answer-summary-update message")}};return(0,i.jsx)(x.Provider,{value:{session:f,publicContent:n},children:e.children})}}}]);